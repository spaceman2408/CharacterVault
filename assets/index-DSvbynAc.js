import{r as cw,g as Ed,a as hw,c as y4}from"./ui-C6Febm84.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var qm={exports:{}},rc={};var Ub;function x4(){if(Ub)return rc;Ub=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,s){var o=null;if(s!==void 0&&(o=""+s),a.key!==void 0&&(o=""+a.key),"key"in a){s={};for(var c in a)c!=="key"&&(s[c]=a[c])}else s=a;return a=s.ref,{$$typeof:n,type:r,key:o,ref:a!==void 0?a:null,props:s}}return rc.Fragment=e,rc.jsx=t,rc.jsxs=t,rc}var Vb;function v4(){return Vb||(Vb=1,qm.exports=x4()),qm.exports}var b=v4(),z=cw();const Ci=Ed(z);var Um={exports:{}},ic={},Vm={exports:{}},Fm={};var Fb;function b4(){return Fb||(Fb=1,(function(n){function e(X,ve){var Te=X.length;X.push(ve);e:for(;0<Te;){var Ee=Te-1>>>1,q=X[Ee];if(0<a(q,ve))X[Ee]=ve,X[Te]=q,Te=Ee;else break e}}function t(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var ve=X[0],Te=X.pop();if(Te!==ve){X[0]=Te;e:for(var Ee=0,q=X.length,ye=q>>>1;Ee<ye;){var Ce=2*(Ee+1)-1,B=X[Ce],$e=Ce+1,rt=X[$e];if(0>a(B,Te))$e<q&&0>a(rt,B)?(X[Ee]=rt,X[$e]=Te,Ee=$e):(X[Ee]=B,X[Ce]=Te,Ee=Ce);else if($e<q&&0>a(rt,Te))X[Ee]=rt,X[$e]=Te,Ee=$e;else break e}}return ve}function a(X,ve){var Te=X.sortIndex-ve.sortIndex;return Te!==0?Te:X.id-ve.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var h=[],d=[],p=1,g=null,k=3,w=!1,A=!1,E=!1,j=!1,D=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function J(X){for(var ve=t(d);ve!==null;){if(ve.callback===null)r(d);else if(ve.startTime<=X)r(d),ve.sortIndex=ve.expirationTime,e(h,ve);else break;ve=t(d)}}function ee(X){if(E=!1,J(X),!A)if(t(h)!==null)A=!0,H||(H=!0,ne());else{var ve=t(d);ve!==null&&re(ee,ve.startTime-X)}}var H=!1,L=-1,me=5,he=-1;function I(){return j?!0:!(n.unstable_now()-he<me)}function te(){if(j=!1,H){var X=n.unstable_now();he=X;var ve=!0;try{e:{A=!1,E&&(E=!1,U(L),L=-1),w=!0;var Te=k;try{t:{for(J(X),g=t(h);g!==null&&!(g.expirationTime>X&&I());){var Ee=g.callback;if(typeof Ee=="function"){g.callback=null,k=g.priorityLevel;var q=Ee(g.expirationTime<=X);if(X=n.unstable_now(),typeof q=="function"){g.callback=q,J(X),ve=!0;break t}g===t(h)&&r(h),J(X)}else r(h);g=t(h)}if(g!==null)ve=!0;else{var ye=t(d);ye!==null&&re(ee,ye.startTime-X),ve=!1}}break e}finally{g=null,k=Te,w=!1}ve=void 0}}finally{ve?ne():H=!1}}}var ne;if(typeof O=="function")ne=function(){O(te)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,ge=pe.port2;pe.port1.onmessage=te,ne=function(){ge.postMessage(null)}}else ne=function(){D(te,0)};function re(X,ve){L=D(function(){X(n.unstable_now())},ve)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):me=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return k},n.unstable_next=function(X){switch(k){case 1:case 2:case 3:var ve=3;break;default:ve=k}var Te=k;k=ve;try{return X()}finally{k=Te}},n.unstable_requestPaint=function(){j=!0},n.unstable_runWithPriority=function(X,ve){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var Te=k;k=X;try{return ve()}finally{k=Te}},n.unstable_scheduleCallback=function(X,ve,Te){var Ee=n.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?Ee+Te:Ee):Te=Ee,X){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=Te+q,X={id:p++,callback:ve,priorityLevel:X,startTime:Te,expirationTime:q,sortIndex:-1},Te>Ee?(X.sortIndex=Te,e(d,X),t(h)===null&&X===t(d)&&(E?(U(L),L=-1):E=!0,re(ee,Te-Ee))):(X.sortIndex=q,e(h,X),A||w||(A=!0,H||(H=!0,ne()))),X},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(X){var ve=k;return function(){var Te=k;k=ve;try{return X.apply(this,arguments)}finally{k=Te}}}})(Fm)),Fm}var Kb;function k4(){return Kb||(Kb=1,Vm.exports=b4()),Vm.exports}var Gb;function w4(){if(Gb)return ic;Gb=1;var n=k4(),e=cw(),t=hw();function r(i){var l="https://react.dev/errors/"+i;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var l=i,u=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,(l.flags&4098)!==0&&(u=l.return),i=l.return;while(i)}return l.tag===3?u:null}function o(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function c(i){if(i.tag===31){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function h(i){if(s(i)!==i)throw Error(r(188))}function d(i){var l=i.alternate;if(!l){if(l=s(i),l===null)throw Error(r(188));return l!==i?null:i}for(var u=i,f=l;;){var y=u.return;if(y===null)break;var x=y.alternate;if(x===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===x.child){for(x=y.child;x;){if(x===u)return h(y),i;if(x===f)return h(y),l;x=x.sibling}throw Error(r(188))}if(u.return!==f.return)u=y,f=x;else{for(var T=!1,_=y.child;_;){if(_===u){T=!0,u=y,f=x;break}if(_===f){T=!0,f=y,u=x;break}_=_.sibling}if(!T){for(_=x.child;_;){if(_===u){T=!0,u=x,f=y;break}if(_===f){T=!0,f=x,u=y;break}_=_.sibling}if(!T)throw Error(r(189))}}if(u.alternate!==f)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?i:l}function p(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i;for(i=i.child;i!==null;){if(l=p(i),l!==null)return l;i=i.sibling}return null}var g=Object.assign,k=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),O=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),he=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function ne(i){return i===null||typeof i!="object"?null:(i=te&&i[te]||i["@@iterator"],typeof i=="function"?i:null)}var pe=Symbol.for("react.client.reference");function ge(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===pe?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case E:return"Fragment";case D:return"Profiler";case j:return"StrictMode";case ee:return"Suspense";case H:return"SuspenseList";case he:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case A:return"Portal";case O:return i.displayName||"Context";case U:return(i._context.displayName||"Context")+".Consumer";case J:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case L:return l=i.displayName||null,l!==null?l:ge(i.type)||"Memo";case me:l=i._payload,i=i._init;try{return ge(i(l))}catch{}}return null}var re=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ve=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te={pending:!1,data:null,method:null,action:null},Ee=[],q=-1;function ye(i){return{current:i}}function Ce(i){0>q||(i.current=Ee[q],Ee[q]=null,q--)}function B(i,l){q++,Ee[q]=i.current,i.current=l}var $e=ye(null),rt=ye(null),Qe=ye(null),wt=ye(null);function ft(i,l){switch(B(Qe,l),B(rt,i),B($e,null),l.nodeType){case 9:case 11:i=(i=l.documentElement)&&(i=i.namespaceURI)?hb(i):0;break;default:if(i=l.tagName,l=l.namespaceURI)l=hb(l),i=fb(l,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Ce($e),B($e,i)}function Ot(){Ce($e),Ce(rt),Ce(Qe)}function Fe(i){i.memoizedState!==null&&B(wt,i);var l=$e.current,u=fb(l,i.type);l!==u&&(B(rt,i),B($e,u))}function Yt(i){rt.current===i&&(Ce($e),Ce(rt)),wt.current===i&&(Ce(wt),Ju._currentValue=Te)}var dt,wn;function vn(i){if(dt===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);dt=l&&l[1]||"",wn=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+dt+i+wn}var un=!1;function Pn(i,l){if(!i||un)return"";un=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var Me=function(){throw Error()};if(Object.defineProperty(Me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Me,[])}catch(xe){var de=xe}Reflect.construct(i,[],Me)}else{try{Me.call()}catch(xe){de=xe}i.call(Me.prototype)}}else{try{throw Error()}catch(xe){de=xe}(Me=i())&&typeof Me.catch=="function"&&Me.catch(function(){})}}catch(xe){if(xe&&de&&typeof xe.stack=="string")return[xe.stack,de.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),T=x[0],_=x[1];if(T&&_){var V=T.split(`
`),ce=_.split(`
`);for(y=f=0;f<V.length&&!V[f].includes("DetermineComponentFrameRoot");)f++;for(;y<ce.length&&!ce[y].includes("DetermineComponentFrameRoot");)y++;if(f===V.length||y===ce.length)for(f=V.length-1,y=ce.length-1;1<=f&&0<=y&&V[f]!==ce[y];)y--;for(;1<=f&&0<=y;f--,y--)if(V[f]!==ce[y]){if(f!==1||y!==1)do if(f--,y--,0>y||V[f]!==ce[y]){var we=`
`+V[f].replace(" at new "," at ");return i.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",i.displayName)),we}while(1<=f&&0<=y);break}}}finally{un=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?vn(u):""}function Qn(i,l){switch(i.tag){case 26:case 27:case 5:return vn(i.type);case 16:return vn("Lazy");case 13:return i.child!==l&&l!==null?vn("Suspense Fallback"):vn("Suspense");case 19:return vn("SuspenseList");case 0:case 15:return Pn(i.type,!1);case 11:return Pn(i.type.render,!1);case 1:return Pn(i.type,!0);case 31:return vn("Activity");default:return""}}function mn(i){try{var l="",u=null;do l+=Qn(i,u),u=i,i=i.return;while(i);return l}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Xn=Object.prototype.hasOwnProperty,Fn=n.unstable_scheduleCallback,Pe=n.unstable_cancelCallback,Rt=n.unstable_shouldYield,$t=n.unstable_requestPaint,Pt=n.unstable_now,yn=n.unstable_getCurrentPriorityLevel,ie=n.unstable_ImmediatePriority,be=n.unstable_UserBlockingPriority,Ke=n.unstable_NormalPriority,tt=n.unstable_LowPriority,it=n.unstable_IdlePriority,Ne=n.log,Be=n.unstable_setDisableYieldValue,je=null,He=null;function De(i){if(typeof Ne=="function"&&Be(i),He&&typeof He.setStrictMode=="function")try{He.setStrictMode(je,i)}catch{}}var Se=Math.clz32?Math.clz32:mi,ot=Math.log,mt=Math.LN2;function mi(i){return i>>>=0,i===0?32:31-(ot(i)/mt|0)|0}var Ve=256,Ha=262144,Hl=4194304;function gi(i){var l=i&42;if(l!==0)return l;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ql(i,l,u){var f=i.pendingLanes;if(f===0)return 0;var y=0,x=i.suspendedLanes,T=i.pingedLanes;i=i.warmLanes;var _=f&134217727;return _!==0?(f=_&~x,f!==0?y=gi(f):(T&=_,T!==0?y=gi(T):u||(u=_&~i,u!==0&&(y=gi(u))))):(_=f&~x,_!==0?y=gi(_):T!==0?y=gi(T):u||(u=f&~i,u!==0&&(y=gi(u)))),y===0?0:l!==0&&l!==y&&(l&x)===0&&(x=y&-y,u=l&-l,x>=u||x===32&&(u&4194048)!==0)?l:y}function ia(i,l){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&l)===0}function $d(i,l){switch(i){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rh(){var i=Hl;return Hl<<=1,(Hl&62914560)===0&&(Hl=4194304),i}function ji(i){for(var l=[],u=0;31>u;u++)l.push(i);return l}function Yr(i,l){i.pendingLanes|=l,l!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ru(i,l,u,f,y,x){var T=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var _=i.entanglements,V=i.expirationTimes,ce=i.hiddenUpdates;for(u=T&~u;0<u;){var we=31-Se(u),Me=1<<we;_[we]=0,V[we]=-1;var de=ce[we];if(de!==null)for(ce[we]=null,we=0;we<de.length;we++){var xe=de[we];xe!==null&&(xe.lane&=-536870913)}u&=~Me}f!==0&&Ul(i,f,0),x!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=x&~(T&~l))}function Ul(i,l,u){i.pendingLanes|=l,i.suspendedLanes&=~l;var f=31-Se(l);i.entangledLanes|=l,i.entanglements[f]=i.entanglements[f]|1073741824|u&261930}function en(i,l){var u=i.entangledLanes|=l;for(i=i.entanglements;u;){var f=31-Se(u),y=1<<f;y&l|i[f]&l&&(i[f]|=l),u&=~y}}function Sn(i,l){var u=l&-l;return u=(u&42)!==0?1:iu(u),(u&(i.suspendedLanes|l))!==0?0:u}function iu(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function qa(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Vl(){var i=ve.p;return i!==0?i:(i=window.event,i===void 0?32:Lb(i.type))}function Fl(i,l){var u=ve.p;try{return ve.p=i,l()}finally{ve.p=u}}var _i=Math.random().toString(36).slice(2),an="__reactFiber$"+_i,Cn="__reactProps$"+_i,gr="__reactContainer$"+_i,Ua="__reactEvents$"+_i,Qd="__reactListeners$"+_i,Di="__reactHandles$"+_i,au="__reactResources$"+_i,Or="__reactMarker$"+_i;function js(i){delete i[an],delete i[Cn],delete i[Ua],delete i[Qd],delete i[Di]}function Oi(i){var l=i[an];if(l)return l;for(var u=i.parentNode;u;){if(l=u[gr]||u[an]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(i=vb(i);i!==null;){if(u=i[an])return u;i=vb(i)}return l}i=u,u=i.parentNode}return null}function Qt(i){if(i=i[an]||i[gr]){var l=i.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return i}return null}function Rr(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i.stateNode;throw Error(r(33))}function or(i){var l=i[au];return l||(l=i[au]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function An(i){i[Or]=!0}var aa=new Set,Kl={};function yi(i,l){Ri(i,l),Ri(i+"Capture",l)}function Ri(i,l){for(Kl[i]=l,i=0;i<l.length;i++)aa.add(l[i])}var la=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),lu={},Gl={};function ih(i){return Xn.call(Gl,i)?!0:Xn.call(lu,i)?!1:la.test(i)?Gl[i]=!0:(lu[i]=!0,!1)}function bt(i,l,u){if(ih(l))if(u===null)i.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(l);return}}i.setAttribute(l,""+u)}}function Yl(i,l,u){if(u===null)i.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttribute(l,""+u)}}function $r(i,l,u,f){if(f===null)i.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(l,u,""+f)}}function Wn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Va(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function ah(i,l,u){var f=Object.getOwnPropertyDescriptor(i.constructor.prototype,l);if(!i.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var y=f.get,x=f.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return y.call(this)},set:function(T){u=""+T,x.call(this,T)}}),Object.defineProperty(i,l,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(T){u=""+T},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function _s(i){if(!i._valueTracker){var l=Va(i)?"checked":"value";i._valueTracker=ah(i,l,""+i[l])}}function su(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var u=l.getValue(),f="";return i&&(f=Va(i)?i.checked?"true":"false":i.value),i=f,i!==u?(l.setValue(i),!0):!1}function Ht(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var $l=/[\n"\\]/g;function Kn(i){return i.replace($l,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Li(i,l,u,f,y,x,T,_){i.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.type=T:i.removeAttribute("type"),l!=null?T==="number"?(l===0&&i.value===""||i.value!=l)&&(i.value=""+Wn(l)):i.value!==""+Wn(l)&&(i.value=""+Wn(l)):T!=="submit"&&T!=="reset"||i.removeAttribute("value"),l!=null?Ql(i,T,Wn(l)):u!=null?Ql(i,T,Wn(u)):f!=null&&i.removeAttribute("value"),y==null&&x!=null&&(i.defaultChecked=!!x),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?i.name=""+Wn(_):i.removeAttribute("name")}function Ds(i,l,u,f,y,x,T,_){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.type=x),l!=null||u!=null){if(!(x!=="submit"&&x!=="reset"||l!=null)){_s(i);return}u=u!=null?""+Wn(u):"",l=l!=null?""+Wn(l):u,_||l===i.value||(i.value=l),i.defaultValue=l}f=f??y,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=_?i.checked:!!f,i.defaultChecked=!!f,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.name=T),_s(i)}function Ql(i,l,u){l==="number"&&Ht(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function xi(i,l,u,f){if(i=i.options,l){l={};for(var y=0;y<u.length;y++)l["$"+u[y]]=!0;for(u=0;u<i.length;u++)y=l.hasOwnProperty("$"+i[u].value),i[u].selected!==y&&(i[u].selected=y),y&&f&&(i[u].defaultSelected=!0)}else{for(u=""+Wn(u),l=null,y=0;y<i.length;y++){if(i[y].value===u){i[y].selected=!0,f&&(i[y].defaultSelected=!0);return}l!==null||i[y].disabled||(l=i[y])}l!==null&&(l.selected=!0)}}function ou(i,l,u){if(l!=null&&(l=""+Wn(l),l!==i.value&&(i.value=l),u==null)){i.defaultValue!==l&&(i.defaultValue=l);return}i.defaultValue=u!=null?""+Wn(u):""}function Xl(i,l,u,f){if(l==null){if(f!=null){if(u!=null)throw Error(r(92));if(re(f)){if(1<f.length)throw Error(r(93));f=f[0]}u=f}u==null&&(u=""),l=u}u=Wn(l),i.defaultValue=u,f=i.textContent,f===u&&f!==""&&f!==null&&(i.value=f),_s(i)}function sa(i,l){if(l){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=l;return}}i.textContent=l}var Xd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mt(i,l,u){var f=l.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?i.setProperty(l,""):l==="float"?i.cssFloat="":i[l]="":f?i.setProperty(l,u):typeof u!="number"||u===0||Xd.has(l)?l==="float"?i.cssFloat=u:i[l]=(""+u).trim():i[l]=u+"px"}function uu(i,l,u){if(l!=null&&typeof l!="object")throw Error(r(62));if(i=i.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var y in l)f=l[y],l.hasOwnProperty(y)&&u[y]!==f&&Mt(i,y,f)}else for(var x in l)l.hasOwnProperty(x)&&Mt(i,x,l[x])}function cu(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),yr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function vi(i){return yr.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Sr(){}var Qr=null;function Os(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var oa=null,cn=null;function Lr(i){var l=Qt(i);if(l&&(i=l.stateNode)){var u=i[Cn]||null;e:switch(i=l.stateNode,l.type){case"input":if(Li(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),l=u.name,u.type==="radio"&&l!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Kn(""+l)+'"][type="radio"]'),l=0;l<u.length;l++){var f=u[l];if(f!==i&&f.form===i.form){var y=f[Cn]||null;if(!y)throw Error(r(90));Li(f,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(l=0;l<u.length;l++)f=u[l],f.form===i.form&&su(f)}break e;case"textarea":ou(i,u.value,u.defaultValue);break e;case"select":l=u.value,l!=null&&xi(i,!!u.multiple,l,!1)}}}var ua=!1;function Fa(i,l,u){if(ua)return i(l,u);ua=!0;try{var f=i(l);return f}finally{if(ua=!1,(oa!==null||cn!==null)&&($h(),oa&&(l=oa,i=cn,cn=oa=null,Lr(l),i)))for(l=0;l<i.length;l++)Lr(i[l])}}function ca(i,l){var u=i.stateNode;if(u===null)return null;var f=u[Cn]||null;if(f===null)return null;u=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(r(231,l,typeof u));return u}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hu=!1;if(Gn)try{var ur={};Object.defineProperty(ur,"passive",{get:function(){hu=!0}}),window.addEventListener("test",ur,ur),window.removeEventListener("test",ur,ur)}catch{hu=!1}var Xr=null,Rs=null,Ka=null;function Ga(){if(Ka)return Ka;var i,l=Rs,u=l.length,f,y="value"in Xr?Xr.value:Xr.textContent,x=y.length;for(i=0;i<u&&l[i]===y[i];i++);var T=u-i;for(f=1;f<=T&&l[u-f]===y[x-f];f++);return Ka=y.slice(i,1<f?1-f:void 0)}function Ya(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function Wl(){return!0}function lh(){return!1}function _n(i){function l(u,f,y,x,T){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=x,this.target=T,this.currentTarget=null;for(var _ in i)i.hasOwnProperty(_)&&(u=i[_],this[_]=u?u(x):x[_]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Wl:lh,this.isPropagationStopped=lh,this}return g(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Wl)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Wl)},persist:function(){},isPersistent:Wl}),l}var ha={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ls=_n(ha),Bi=g({},ha,{view:0,detail:0}),Bs=_n(Bi),Zl,fu,Jl,zs=g({},Bi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fa,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Jl&&(Jl&&i.type==="mousemove"?(Zl=i.screenX-Jl.screenX,fu=i.screenY-Jl.screenY):fu=Zl=0,Jl=i),Zl)},movementY:function(i){return"movementY"in i?i.movementY:fu}}),Is=_n(zs),du=g({},zs,{dataTransfer:0}),sh=_n(du),Ps=g({},Bi,{relatedTarget:0}),$a=_n(Ps),Hs=g({},ha,{animationName:0,elapsedTime:0,pseudoElement:0}),oh=_n(Hs),Zd=g({},ha,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Qa=_n(Zd),pu=g({},ha,{data:0}),qs=_n(pu),mu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function es(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=Yn[i])?!!l[i]:!1}function fa(){return es}var uh=g({},Bi,{key:function(i){if(i.key){var l=mu[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=Ya(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?gu[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fa,charCode:function(i){return i.type==="keypress"?Ya(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ya(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Us=_n(uh),ch=g({},zs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yu=_n(ch),Vs=g({},Bi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fa}),xu=_n(Vs),da=g({},ha,{propertyName:0,elapsedTime:0,pseudoElement:0}),vu=_n(da),bu=g({},zs,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Fs=_n(bu),ku=g({},ha,{newState:0,oldState:0}),hh=_n(ku),Jd=[9,13,27,32],ts=Gn&&"CompositionEvent"in window,zi=null;Gn&&"documentMode"in document&&(zi=document.documentMode);var ep=Gn&&"TextEvent"in window&&!zi,Ks=Gn&&(!ts||zi&&8<zi&&11>=zi),Gs=" ",fh=!1;function wu(i,l){switch(i){case"keyup":return Jd.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dh(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var pa=!1;function ph(i,l){switch(i){case"compositionend":return dh(l);case"keypress":return l.which!==32?null:(fh=!0,Gs);case"textInput":return i=l.data,i===Gs&&fh?null:i;default:return null}}function tp(i,l){if(pa)return i==="compositionend"||!ts&&wu(i,l)?(i=Ga(),Ka=Rs=Xr=null,pa=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ks&&l.locale!=="ko"?null:l.data;default:return null}}var mh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ys(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!mh[i.type]:l==="textarea"}function Su(i,l,u,f){oa?cn?cn.push(f):cn=[f]:oa=f,l=tf(l,"onChange"),0<l.length&&(u=new Ls("onChange","change",null,u,f),i.push({event:u,listeners:l}))}var Xa=null,ns=null;function np(i){ab(i,0)}function $s(i){var l=Rr(i);if(su(l))return i}function rs(i,l){if(i==="change")return l}var Wr=!1;if(Gn){var hn;if(Gn){var Wa="oninput"in document;if(!Wa){var ma=document.createElement("div");ma.setAttribute("oninput","return;"),Wa=typeof ma.oninput=="function"}hn=Wa}else hn=!1;Wr=hn&&(!document.documentMode||9<document.documentMode)}function gh(){Xa&&(Xa.detachEvent("onpropertychange",Qs),ns=Xa=null)}function Qs(i){if(i.propertyName==="value"&&$s(ns)){var l=[];Su(l,ns,i,Os(i)),Fa(np,l)}}function yh(i,l,u){i==="focusin"?(gh(),Xa=l,ns=u,Xa.attachEvent("onpropertychange",Qs)):i==="focusout"&&gh()}function ga(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return $s(ns)}function Cu(i,l){if(i==="click")return $s(l)}function Za(i,l){if(i==="input"||i==="change")return $s(l)}function Ii(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var cr=typeof Object.is=="function"?Object.is:Ii;function m(i,l){if(cr(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var u=Object.keys(i),f=Object.keys(l);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!Xn.call(l,y)||!cr(i[y],l[y]))return!1}return!0}function v(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function S(i,l){var u=v(i);i=0;for(var f;u;){if(u.nodeType===3){if(f=i+u.textContent.length,i<=l&&f>=l)return{node:u,offset:l-i};i=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=v(u)}}function C(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?C(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function N(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var l=Ht(i.document);l instanceof i.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)i=l.contentWindow;else break;l=Ht(i.document)}return l}function M(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}var R=Gn&&"documentMode"in document&&11>=document.documentMode,P=null,K=null,le=null,G=!1;function F(i,l,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;G||P==null||P!==Ht(f)||(f=P,"selectionStart"in f&&M(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),le&&m(le,f)||(le=f,f=tf(K,"onSelect"),0<f.length&&(l=new Ls("onSelect","select",null,l,u),i.push({event:l,listeners:f}),l.target=P)))}function Q(i,l){var u={};return u[i.toLowerCase()]=l.toLowerCase(),u["Webkit"+i]="webkit"+l,u["Moz"+i]="moz"+l,u}var Z={animationend:Q("Animation","AnimationEnd"),animationiteration:Q("Animation","AnimationIteration"),animationstart:Q("Animation","AnimationStart"),transitionrun:Q("Transition","TransitionRun"),transitionstart:Q("Transition","TransitionStart"),transitioncancel:Q("Transition","TransitionCancel"),transitionend:Q("Transition","TransitionEnd")},Y={},$={};Gn&&($=document.createElement("div").style,"AnimationEvent"in window||(delete Z.animationend.animation,delete Z.animationiteration.animation,delete Z.animationstart.animation),"TransitionEvent"in window||delete Z.transitionend.transition);function oe(i){if(Y[i])return Y[i];if(!Z[i])return i;var l=Z[i],u;for(u in l)if(l.hasOwnProperty(u)&&u in $)return Y[i]=l[u];return i}var fe=oe("animationend"),se=oe("animationiteration"),ke=oe("animationstart"),_e=oe("transitionrun"),qe=oe("transitionstart"),Ue=oe("transitioncancel"),Oe=oe("transitionend"),Xe=new Map,Ye="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ye.push("scrollEnd");function Re(i,l){Xe.set(i,l),yi(l,[i])}var We=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},pt=[],kt=0,at=0;function gt(){for(var i=kt,l=at=kt=0;l<i;){var u=pt[l];pt[l++]=null;var f=pt[l];pt[l++]=null;var y=pt[l];pt[l++]=null;var x=pt[l];if(pt[l++]=null,f!==null&&y!==null){var T=f.pending;T===null?y.next=y:(y.next=T.next,T.next=y),f.pending=y}x!==0&&Pi(u,y,x)}}function Xt(i,l,u,f){pt[kt++]=i,pt[kt++]=l,pt[kt++]=u,pt[kt++]=f,at|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function hr(i,l,u,f){return Xt(i,l,u,f),Ja(i)}function Vt(i,l){return Xt(i,null,null,l),Ja(i)}function Pi(i,l,u){i.lanes|=u;var f=i.alternate;f!==null&&(f.lanes|=u);for(var y=!1,x=i.return;x!==null;)x.childLanes|=u,f=x.alternate,f!==null&&(f.childLanes|=u),x.tag===22&&(i=x.stateNode,i===null||i._visibility&1||(y=!0)),i=x,x=x.return;return i.tag===3?(x=i.stateNode,y&&l!==null&&(y=31-Se(u),i=x.hiddenUpdates,f=i[y],f===null?i[y]=[l]:f.push(l),l.lane=u|536870912),x):null}function Ja(i){if(50<Gu)throw Gu=0,hm=null,Error(r(185));for(var l=i.return;l!==null;)i=l,l=i.return;return i.tag===3?i.stateNode:null}var Xs={};function eA(i,l,u,f){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Br(i,l,u,f){return new eA(i,l,u,f)}function rp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ya(i,l){var u=i.alternate;return u===null?(u=Br(i.tag,l,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=l,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,l=i.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function qy(i,l){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=l,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,l=u.dependencies,i.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),i}function xh(i,l,u,f,y,x){var T=0;if(f=i,typeof i=="function")rp(i)&&(T=1);else if(typeof i=="string")T=a4(i,u,$e.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case he:return i=Br(31,u,l,y),i.elementType=he,i.lanes=x,i;case E:return is(u.children,y,x,l);case j:T=8,y|=24;break;case D:return i=Br(12,u,l,y|2),i.elementType=D,i.lanes=x,i;case ee:return i=Br(13,u,l,y),i.elementType=ee,i.lanes=x,i;case H:return i=Br(19,u,l,y),i.elementType=H,i.lanes=x,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case O:T=10;break e;case U:T=9;break e;case J:T=11;break e;case L:T=14;break e;case me:T=16,f=null;break e}T=29,u=Error(r(130,i===null?"null":typeof i,"")),f=null}return l=Br(T,u,l,y),l.elementType=i,l.type=f,l.lanes=x,l}function is(i,l,u,f){return i=Br(7,i,f,l),i.lanes=u,i}function ip(i,l,u){return i=Br(6,i,null,l),i.lanes=u,i}function Uy(i){var l=Br(18,null,null,0);return l.stateNode=i,l}function ap(i,l,u){return l=Br(4,i.children!==null?i.children:[],i.key,l),l.lanes=u,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}var Vy=new WeakMap;function Zr(i,l){if(typeof i=="object"&&i!==null){var u=Vy.get(i);return u!==void 0?u:(l={value:i,source:l,stack:mn(l)},Vy.set(i,l),l)}return{value:i,source:l,stack:mn(l)}}var Ws=[],Zs=0,vh=null,Au=0,Jr=[],ei=0,el=null,Hi=1,qi="";function xa(i,l){Ws[Zs++]=Au,Ws[Zs++]=vh,vh=i,Au=l}function Fy(i,l,u){Jr[ei++]=Hi,Jr[ei++]=qi,Jr[ei++]=el,el=i;var f=Hi;i=qi;var y=32-Se(f)-1;f&=~(1<<y),u+=1;var x=32-Se(l)+y;if(30<x){var T=y-y%5;x=(f&(1<<T)-1).toString(32),f>>=T,y-=T,Hi=1<<32-Se(l)+y|u<<y|f,qi=x+i}else Hi=1<<x|u<<y|f,qi=i}function lp(i){i.return!==null&&(xa(i,1),Fy(i,1,0))}function sp(i){for(;i===vh;)vh=Ws[--Zs],Ws[Zs]=null,Au=Ws[--Zs],Ws[Zs]=null;for(;i===el;)el=Jr[--ei],Jr[ei]=null,qi=Jr[--ei],Jr[ei]=null,Hi=Jr[--ei],Jr[ei]=null}function Ky(i,l){Jr[ei++]=Hi,Jr[ei++]=qi,Jr[ei++]=el,Hi=l.id,qi=l.overflow,el=i}var Zn=null,fn=null,jt=!1,tl=null,ti=!1,op=Error(r(519));function nl(i){var l=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Tu(Zr(l,i)),op}function Gy(i){var l=i.stateNode,u=i.type,f=i.memoizedProps;switch(l[an]=i,l[Cn]=f,u){case"dialog":Ct("cancel",l),Ct("close",l);break;case"iframe":case"object":case"embed":Ct("load",l);break;case"video":case"audio":for(u=0;u<$u.length;u++)Ct($u[u],l);break;case"source":Ct("error",l);break;case"img":case"image":case"link":Ct("error",l),Ct("load",l);break;case"details":Ct("toggle",l);break;case"input":Ct("invalid",l),Ds(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ct("invalid",l);break;case"textarea":Ct("invalid",l),Xl(l,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||l.textContent===""+u||f.suppressHydrationWarning===!0||ub(l.textContent,u)?(f.popover!=null&&(Ct("beforetoggle",l),Ct("toggle",l)),f.onScroll!=null&&Ct("scroll",l),f.onScrollEnd!=null&&Ct("scrollend",l),f.onClick!=null&&(l.onclick=Sr),l=!0):l=!1,l||nl(i,!0)}function Yy(i){for(Zn=i.return;Zn;)switch(Zn.tag){case 5:case 31:case 13:ti=!1;return;case 27:case 3:ti=!0;return;default:Zn=Zn.return}}function Js(i){if(i!==Zn)return!1;if(!jt)return Yy(i),jt=!0,!1;var l=i.tag,u;if((u=l!==3&&l!==27)&&((u=l===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||Tm(i.type,i.memoizedProps)),u=!u),u&&fn&&nl(i),Yy(i),l===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));fn=xb(i)}else if(l===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));fn=xb(i)}else l===27?(l=fn,gl(i.type)?(i=_m,_m=null,fn=i):fn=l):fn=Zn?ri(i.stateNode.nextSibling):null;return!0}function as(){fn=Zn=null,jt=!1}function up(){var i=tl;return i!==null&&(Nr===null?Nr=i:Nr.push.apply(Nr,i),tl=null),i}function Tu(i){tl===null?tl=[i]:tl.push(i)}var cp=ye(null),ls=null,va=null;function rl(i,l,u){B(cp,l._currentValue),l._currentValue=u}function ba(i){i._currentValue=cp.current,Ce(cp)}function hp(i,l,u){for(;i!==null;){var f=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),i===u)break;i=i.return}}function fp(i,l,u,f){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var x=y.dependencies;if(x!==null){var T=y.child;x=x.firstContext;e:for(;x!==null;){var _=x;x=y;for(var V=0;V<l.length;V++)if(_.context===l[V]){x.lanes|=u,_=x.alternate,_!==null&&(_.lanes|=u),hp(x.return,u,i),f||(T=null);break e}x=_.next}}else if(y.tag===18){if(T=y.return,T===null)throw Error(r(341));T.lanes|=u,x=T.alternate,x!==null&&(x.lanes|=u),hp(T,u,i),T=null}else T=y.child;if(T!==null)T.return=y;else for(T=y;T!==null;){if(T===i){T=null;break}if(y=T.sibling,y!==null){y.return=T.return,T=y;break}T=T.return}y=T}}function eo(i,l,u,f){i=null;for(var y=l,x=!1;y!==null;){if(!x){if((y.flags&524288)!==0)x=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var T=y.alternate;if(T===null)throw Error(r(387));if(T=T.memoizedProps,T!==null){var _=y.type;cr(y.pendingProps.value,T.value)||(i!==null?i.push(_):i=[_])}}else if(y===wt.current){if(T=y.alternate,T===null)throw Error(r(387));T.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(Ju):i=[Ju])}y=y.return}i!==null&&fp(l,i,u,f),l.flags|=262144}function bh(i){for(i=i.firstContext;i!==null;){if(!cr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ss(i){ls=i,va=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Jn(i){return $y(ls,i)}function kh(i,l){return ls===null&&ss(i),$y(i,l)}function $y(i,l){var u=l._currentValue;if(l={context:l,memoizedValue:u,next:null},va===null){if(i===null)throw Error(r(308));va=l,i.dependencies={lanes:0,firstContext:l},i.flags|=524288}else va=va.next=l;return u}var tA=typeof AbortController<"u"?AbortController:function(){var i=[],l=this.signal={aborted:!1,addEventListener:function(u,f){i.push(f)}};this.abort=function(){l.aborted=!0,i.forEach(function(u){return u()})}},nA=n.unstable_scheduleCallback,rA=n.unstable_NormalPriority,Dn={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dp(){return{controller:new tA,data:new Map,refCount:0}}function Nu(i){i.refCount--,i.refCount===0&&nA(rA,function(){i.controller.abort()})}var Eu=null,pp=0,to=0,no=null;function iA(i,l){if(Eu===null){var u=Eu=[];pp=0,to=ym(),no={status:"pending",value:void 0,then:function(f){u.push(f)}}}return pp++,l.then(Qy,Qy),l}function Qy(){if(--pp===0&&Eu!==null){no!==null&&(no.status="fulfilled");var i=Eu;Eu=null,to=0,no=null;for(var l=0;l<i.length;l++)(0,i[l])()}}function aA(i,l){var u=[],f={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return i.then(function(){f.status="fulfilled",f.value=l;for(var y=0;y<u.length;y++)(0,u[y])(l)},function(y){for(f.status="rejected",f.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),f}var Xy=X.S;X.S=function(i,l){Ov=Pt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&iA(i,l),Xy!==null&&Xy(i,l)};var os=ye(null);function mp(){var i=os.current;return i!==null?i:tn.pooledCache}function wh(i,l){l===null?B(os,os.current):B(os,l.pool)}function Wy(){var i=mp();return i===null?null:{parent:Dn._currentValue,pool:i}}var ro=Error(r(460)),gp=Error(r(474)),Sh=Error(r(542)),Ch={then:function(){}};function Zy(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Jy(i,l,u){switch(u=i[u],u===void 0?i.push(l):u!==l&&(l.then(Sr,Sr),l=u),l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,tx(i),i;default:if(typeof l.status=="string")l.then(Sr,Sr);else{if(i=tn,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=l,i.status="pending",i.then(function(f){if(l.status==="pending"){var y=l;y.status="fulfilled",y.value=f}},function(f){if(l.status==="pending"){var y=l;y.status="rejected",y.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,tx(i),i}throw cs=l,ro}}function us(i){try{var l=i._init;return l(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(cs=u,ro):u}}var cs=null;function ex(){if(cs===null)throw Error(r(459));var i=cs;return cs=null,i}function tx(i){if(i===ro||i===Sh)throw Error(r(483))}var io=null,Mu=0;function Ah(i){var l=Mu;return Mu+=1,io===null&&(io=[]),Jy(io,i,l)}function ju(i,l){l=l.props.ref,i.ref=l!==void 0?l:null}function Th(i,l){throw l.$$typeof===k?Error(r(525)):(i=Object.prototype.toString.call(l),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i)))}function nx(i){function l(ae,W){if(i){var ue=ae.deletions;ue===null?(ae.deletions=[W],ae.flags|=16):ue.push(W)}}function u(ae,W){if(!i)return null;for(;W!==null;)l(ae,W),W=W.sibling;return null}function f(ae){for(var W=new Map;ae!==null;)ae.key!==null?W.set(ae.key,ae):W.set(ae.index,ae),ae=ae.sibling;return W}function y(ae,W){return ae=ya(ae,W),ae.index=0,ae.sibling=null,ae}function x(ae,W,ue){return ae.index=ue,i?(ue=ae.alternate,ue!==null?(ue=ue.index,ue<W?(ae.flags|=67108866,W):ue):(ae.flags|=67108866,W)):(ae.flags|=1048576,W)}function T(ae){return i&&ae.alternate===null&&(ae.flags|=67108866),ae}function _(ae,W,ue,Ae){return W===null||W.tag!==6?(W=ip(ue,ae.mode,Ae),W.return=ae,W):(W=y(W,ue),W.return=ae,W)}function V(ae,W,ue,Ae){var st=ue.type;return st===E?we(ae,W,ue.props.children,Ae,ue.key):W!==null&&(W.elementType===st||typeof st=="object"&&st!==null&&st.$$typeof===me&&us(st)===W.type)?(W=y(W,ue.props),ju(W,ue),W.return=ae,W):(W=xh(ue.type,ue.key,ue.props,null,ae.mode,Ae),ju(W,ue),W.return=ae,W)}function ce(ae,W,ue,Ae){return W===null||W.tag!==4||W.stateNode.containerInfo!==ue.containerInfo||W.stateNode.implementation!==ue.implementation?(W=ap(ue,ae.mode,Ae),W.return=ae,W):(W=y(W,ue.children||[]),W.return=ae,W)}function we(ae,W,ue,Ae,st){return W===null||W.tag!==7?(W=is(ue,ae.mode,Ae,st),W.return=ae,W):(W=y(W,ue),W.return=ae,W)}function Me(ae,W,ue){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=ip(""+W,ae.mode,ue),W.return=ae,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case w:return ue=xh(W.type,W.key,W.props,null,ae.mode,ue),ju(ue,W),ue.return=ae,ue;case A:return W=ap(W,ae.mode,ue),W.return=ae,W;case me:return W=us(W),Me(ae,W,ue)}if(re(W)||ne(W))return W=is(W,ae.mode,ue,null),W.return=ae,W;if(typeof W.then=="function")return Me(ae,Ah(W),ue);if(W.$$typeof===O)return Me(ae,kh(ae,W),ue);Th(ae,W)}return null}function de(ae,W,ue,Ae){var st=W!==null?W.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return st!==null?null:_(ae,W,""+ue,Ae);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case w:return ue.key===st?V(ae,W,ue,Ae):null;case A:return ue.key===st?ce(ae,W,ue,Ae):null;case me:return ue=us(ue),de(ae,W,ue,Ae)}if(re(ue)||ne(ue))return st!==null?null:we(ae,W,ue,Ae,null);if(typeof ue.then=="function")return de(ae,W,Ah(ue),Ae);if(ue.$$typeof===O)return de(ae,W,kh(ae,ue),Ae);Th(ae,ue)}return null}function xe(ae,W,ue,Ae,st){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return ae=ae.get(ue)||null,_(W,ae,""+Ae,st);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case w:return ae=ae.get(Ae.key===null?ue:Ae.key)||null,V(W,ae,Ae,st);case A:return ae=ae.get(Ae.key===null?ue:Ae.key)||null,ce(W,ae,Ae,st);case me:return Ae=us(Ae),xe(ae,W,ue,Ae,st)}if(re(Ae)||ne(Ae))return ae=ae.get(ue)||null,we(W,ae,Ae,st,null);if(typeof Ae.then=="function")return xe(ae,W,ue,Ah(Ae),st);if(Ae.$$typeof===O)return xe(ae,W,ue,kh(W,Ae),st);Th(W,Ae)}return null}function et(ae,W,ue,Ae){for(var st=null,Lt=null,nt=W,xt=W=0,Nt=null;nt!==null&&xt<ue.length;xt++){nt.index>xt?(Nt=nt,nt=null):Nt=nt.sibling;var Bt=de(ae,nt,ue[xt],Ae);if(Bt===null){nt===null&&(nt=Nt);break}i&&nt&&Bt.alternate===null&&l(ae,nt),W=x(Bt,W,xt),Lt===null?st=Bt:Lt.sibling=Bt,Lt=Bt,nt=Nt}if(xt===ue.length)return u(ae,nt),jt&&xa(ae,xt),st;if(nt===null){for(;xt<ue.length;xt++)nt=Me(ae,ue[xt],Ae),nt!==null&&(W=x(nt,W,xt),Lt===null?st=nt:Lt.sibling=nt,Lt=nt);return jt&&xa(ae,xt),st}for(nt=f(nt);xt<ue.length;xt++)Nt=xe(nt,ae,xt,ue[xt],Ae),Nt!==null&&(i&&Nt.alternate!==null&&nt.delete(Nt.key===null?xt:Nt.key),W=x(Nt,W,xt),Lt===null?st=Nt:Lt.sibling=Nt,Lt=Nt);return i&&nt.forEach(function(kl){return l(ae,kl)}),jt&&xa(ae,xt),st}function ht(ae,W,ue,Ae){if(ue==null)throw Error(r(151));for(var st=null,Lt=null,nt=W,xt=W=0,Nt=null,Bt=ue.next();nt!==null&&!Bt.done;xt++,Bt=ue.next()){nt.index>xt?(Nt=nt,nt=null):Nt=nt.sibling;var kl=de(ae,nt,Bt.value,Ae);if(kl===null){nt===null&&(nt=Nt);break}i&&nt&&kl.alternate===null&&l(ae,nt),W=x(kl,W,xt),Lt===null?st=kl:Lt.sibling=kl,Lt=kl,nt=Nt}if(Bt.done)return u(ae,nt),jt&&xa(ae,xt),st;if(nt===null){for(;!Bt.done;xt++,Bt=ue.next())Bt=Me(ae,Bt.value,Ae),Bt!==null&&(W=x(Bt,W,xt),Lt===null?st=Bt:Lt.sibling=Bt,Lt=Bt);return jt&&xa(ae,xt),st}for(nt=f(nt);!Bt.done;xt++,Bt=ue.next())Bt=xe(nt,ae,xt,Bt.value,Ae),Bt!==null&&(i&&Bt.alternate!==null&&nt.delete(Bt.key===null?xt:Bt.key),W=x(Bt,W,xt),Lt===null?st=Bt:Lt.sibling=Bt,Lt=Bt);return i&&nt.forEach(function(g4){return l(ae,g4)}),jt&&xa(ae,xt),st}function Jt(ae,W,ue,Ae){if(typeof ue=="object"&&ue!==null&&ue.type===E&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case w:e:{for(var st=ue.key;W!==null;){if(W.key===st){if(st=ue.type,st===E){if(W.tag===7){u(ae,W.sibling),Ae=y(W,ue.props.children),Ae.return=ae,ae=Ae;break e}}else if(W.elementType===st||typeof st=="object"&&st!==null&&st.$$typeof===me&&us(st)===W.type){u(ae,W.sibling),Ae=y(W,ue.props),ju(Ae,ue),Ae.return=ae,ae=Ae;break e}u(ae,W);break}else l(ae,W);W=W.sibling}ue.type===E?(Ae=is(ue.props.children,ae.mode,Ae,ue.key),Ae.return=ae,ae=Ae):(Ae=xh(ue.type,ue.key,ue.props,null,ae.mode,Ae),ju(Ae,ue),Ae.return=ae,ae=Ae)}return T(ae);case A:e:{for(st=ue.key;W!==null;){if(W.key===st)if(W.tag===4&&W.stateNode.containerInfo===ue.containerInfo&&W.stateNode.implementation===ue.implementation){u(ae,W.sibling),Ae=y(W,ue.children||[]),Ae.return=ae,ae=Ae;break e}else{u(ae,W);break}else l(ae,W);W=W.sibling}Ae=ap(ue,ae.mode,Ae),Ae.return=ae,ae=Ae}return T(ae);case me:return ue=us(ue),Jt(ae,W,ue,Ae)}if(re(ue))return et(ae,W,ue,Ae);if(ne(ue)){if(st=ne(ue),typeof st!="function")throw Error(r(150));return ue=st.call(ue),ht(ae,W,ue,Ae)}if(typeof ue.then=="function")return Jt(ae,W,Ah(ue),Ae);if(ue.$$typeof===O)return Jt(ae,W,kh(ae,ue),Ae);Th(ae,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,W!==null&&W.tag===6?(u(ae,W.sibling),Ae=y(W,ue),Ae.return=ae,ae=Ae):(u(ae,W),Ae=ip(ue,ae.mode,Ae),Ae.return=ae,ae=Ae),T(ae)):u(ae,W)}return function(ae,W,ue,Ae){try{Mu=0;var st=Jt(ae,W,ue,Ae);return io=null,st}catch(nt){if(nt===ro||nt===Sh)throw nt;var Lt=Br(29,nt,null,ae.mode);return Lt.lanes=Ae,Lt.return=ae,Lt}}}var hs=nx(!0),rx=nx(!1),il=!1;function yp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xp(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function al(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function ll(i,l,u){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(qt&2)!==0){var y=f.pending;return y===null?l.next=l:(l.next=y.next,y.next=l),f.pending=l,l=Ja(i),Pi(i,null,u),l}return Xt(i,f,l,u),Ja(i)}function _u(i,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194048)!==0)){var f=l.lanes;f&=i.pendingLanes,u|=f,l.lanes=u,en(i,u)}}function vp(i,l){var u=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,x=null;if(u=u.firstBaseUpdate,u!==null){do{var T={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};x===null?y=x=T:x=x.next=T,u=u.next}while(u!==null);x===null?y=x=l:x=x.next=l}else y=x=l;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=l:i.next=l,u.lastBaseUpdate=l}var bp=!1;function Du(){if(bp){var i=no;if(i!==null)throw i}}function Ou(i,l,u,f){bp=!1;var y=i.updateQueue;il=!1;var x=y.firstBaseUpdate,T=y.lastBaseUpdate,_=y.shared.pending;if(_!==null){y.shared.pending=null;var V=_,ce=V.next;V.next=null,T===null?x=ce:T.next=ce,T=V;var we=i.alternate;we!==null&&(we=we.updateQueue,_=we.lastBaseUpdate,_!==T&&(_===null?we.firstBaseUpdate=ce:_.next=ce,we.lastBaseUpdate=V))}if(x!==null){var Me=y.baseState;T=0,we=ce=V=null,_=x;do{var de=_.lane&-536870913,xe=de!==_.lane;if(xe?(Tt&de)===de:(f&de)===de){de!==0&&de===to&&(bp=!0),we!==null&&(we=we.next={lane:0,tag:_.tag,payload:_.payload,callback:null,next:null});e:{var et=i,ht=_;de=l;var Jt=u;switch(ht.tag){case 1:if(et=ht.payload,typeof et=="function"){Me=et.call(Jt,Me,de);break e}Me=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=ht.payload,de=typeof et=="function"?et.call(Jt,Me,de):et,de==null)break e;Me=g({},Me,de);break e;case 2:il=!0}}de=_.callback,de!==null&&(i.flags|=64,xe&&(i.flags|=8192),xe=y.callbacks,xe===null?y.callbacks=[de]:xe.push(de))}else xe={lane:de,tag:_.tag,payload:_.payload,callback:_.callback,next:null},we===null?(ce=we=xe,V=Me):we=we.next=xe,T|=de;if(_=_.next,_===null){if(_=y.shared.pending,_===null)break;xe=_,_=xe.next,xe.next=null,y.lastBaseUpdate=xe,y.shared.pending=null}}while(!0);we===null&&(V=Me),y.baseState=V,y.firstBaseUpdate=ce,y.lastBaseUpdate=we,x===null&&(y.shared.lanes=0),hl|=T,i.lanes=T,i.memoizedState=Me}}function ix(i,l){if(typeof i!="function")throw Error(r(191,i));i.call(l)}function ax(i,l){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)ix(u[i],l)}var ao=ye(null),Nh=ye(0);function lx(i,l){i=Ma,B(Nh,i),B(ao,l),Ma=i|l.baseLanes}function kp(){B(Nh,Ma),B(ao,ao.current)}function wp(){Ma=Nh.current,Ce(ao),Ce(Nh)}var zr=ye(null),ni=null;function sl(i){var l=i.alternate;B(Tn,Tn.current&1),B(zr,i),ni===null&&(l===null||ao.current!==null||l.memoizedState!==null)&&(ni=i)}function Sp(i){B(Tn,Tn.current),B(zr,i),ni===null&&(ni=i)}function sx(i){i.tag===22?(B(Tn,Tn.current),B(zr,i),ni===null&&(ni=i)):ol()}function ol(){B(Tn,Tn.current),B(zr,zr.current)}function Ir(i){Ce(zr),ni===i&&(ni=null),Ce(Tn)}var Tn=ye(0);function Eh(i){for(var l=i;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||Mm(u)||jm(u)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ka=0,yt=null,Wt=null,On=null,Mh=!1,lo=!1,fs=!1,jh=0,Ru=0,so=null,lA=0;function bn(){throw Error(r(321))}function Cp(i,l){if(l===null)return!1;for(var u=0;u<l.length&&u<i.length;u++)if(!cr(i[u],l[u]))return!1;return!0}function Ap(i,l,u,f,y,x){return ka=x,yt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,X.H=i===null||i.memoizedState===null?Fx:Hp,fs=!1,x=u(f,y),fs=!1,lo&&(x=ux(l,u,f,y)),ox(i),x}function ox(i){X.H=zu;var l=Wt!==null&&Wt.next!==null;if(ka=0,On=Wt=yt=null,Mh=!1,Ru=0,so=null,l)throw Error(r(300));i===null||Rn||(i=i.dependencies,i!==null&&bh(i)&&(Rn=!0))}function ux(i,l,u,f){yt=i;var y=0;do{if(lo&&(so=null),Ru=0,lo=!1,25<=y)throw Error(r(301));if(y+=1,On=Wt=null,i.updateQueue!=null){var x=i.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}X.H=Kx,x=l(u,f)}while(lo);return x}function sA(){var i=X.H,l=i.useState()[0];return l=typeof l.then=="function"?Lu(l):l,i=i.useState()[0],(Wt!==null?Wt.memoizedState:null)!==i&&(yt.flags|=1024),l}function Tp(){var i=jh!==0;return jh=0,i}function Np(i,l,u){l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~u}function Ep(i){if(Mh){for(i=i.memoizedState;i!==null;){var l=i.queue;l!==null&&(l.pending=null),i=i.next}Mh=!1}ka=0,On=Wt=yt=null,lo=!1,Ru=jh=0,so=null}function xr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return On===null?yt.memoizedState=On=i:On=On.next=i,On}function Nn(){if(Wt===null){var i=yt.alternate;i=i!==null?i.memoizedState:null}else i=Wt.next;var l=On===null?yt.memoizedState:On.next;if(l!==null)On=l,Wt=i;else{if(i===null)throw yt.alternate===null?Error(r(467)):Error(r(310));Wt=i,i={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},On===null?yt.memoizedState=On=i:On=On.next=i}return On}function _h(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Lu(i){var l=Ru;return Ru+=1,so===null&&(so=[]),i=Jy(so,i,l),l=yt,(On===null?l.memoizedState:On.next)===null&&(l=l.alternate,X.H=l===null||l.memoizedState===null?Fx:Hp),i}function Dh(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Lu(i);if(i.$$typeof===O)return Jn(i)}throw Error(r(438,String(i)))}function Mp(i){var l=null,u=yt.updateQueue;if(u!==null&&(l=u.memoCache),l==null){var f=yt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(y){return y.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),u===null&&(u=_h(),yt.updateQueue=u),u.memoCache=l,u=l.data[l.index],u===void 0)for(u=l.data[l.index]=Array(i),f=0;f<i;f++)u[f]=I;return l.index++,u}function wa(i,l){return typeof l=="function"?l(i):l}function Oh(i){var l=Nn();return jp(l,Wt,i)}function jp(i,l,u){var f=i.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=u;var y=i.baseQueue,x=f.pending;if(x!==null){if(y!==null){var T=y.next;y.next=x.next,x.next=T}l.baseQueue=y=x,f.pending=null}if(x=i.baseState,y===null)i.memoizedState=x;else{l=y.next;var _=T=null,V=null,ce=l,we=!1;do{var Me=ce.lane&-536870913;if(Me!==ce.lane?(Tt&Me)===Me:(ka&Me)===Me){var de=ce.revertLane;if(de===0)V!==null&&(V=V.next={lane:0,revertLane:0,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),Me===to&&(we=!0);else if((ka&de)===de){ce=ce.next,de===to&&(we=!0);continue}else Me={lane:0,revertLane:ce.revertLane,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},V===null?(_=V=Me,T=x):V=V.next=Me,yt.lanes|=de,hl|=de;Me=ce.action,fs&&u(x,Me),x=ce.hasEagerState?ce.eagerState:u(x,Me)}else de={lane:Me,revertLane:ce.revertLane,gesture:ce.gesture,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},V===null?(_=V=de,T=x):V=V.next=de,yt.lanes|=Me,hl|=Me;ce=ce.next}while(ce!==null&&ce!==l);if(V===null?T=x:V.next=_,!cr(x,i.memoizedState)&&(Rn=!0,we&&(u=no,u!==null)))throw u;i.memoizedState=x,i.baseState=T,i.baseQueue=V,f.lastRenderedState=x}return y===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function _p(i){var l=Nn(),u=l.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var f=u.dispatch,y=u.pending,x=l.memoizedState;if(y!==null){u.pending=null;var T=y=y.next;do x=i(x,T.action),T=T.next;while(T!==y);cr(x,l.memoizedState)||(Rn=!0),l.memoizedState=x,l.baseQueue===null&&(l.baseState=x),u.lastRenderedState=x}return[x,f]}function cx(i,l,u){var f=yt,y=Nn(),x=jt;if(x){if(u===void 0)throw Error(r(407));u=u()}else u=l();var T=!cr((Wt||y).memoizedState,u);if(T&&(y.memoizedState=u,Rn=!0),y=y.queue,Rp(dx.bind(null,f,y,i),[i]),y.getSnapshot!==l||T||On!==null&&On.memoizedState.tag&1){if(f.flags|=2048,oo(9,{destroy:void 0},fx.bind(null,f,y,u,l),null),tn===null)throw Error(r(349));x||(ka&127)!==0||hx(f,l,u)}return u}function hx(i,l,u){i.flags|=16384,i={getSnapshot:l,value:u},l=yt.updateQueue,l===null?(l=_h(),yt.updateQueue=l,l.stores=[i]):(u=l.stores,u===null?l.stores=[i]:u.push(i))}function fx(i,l,u,f){l.value=u,l.getSnapshot=f,px(l)&&mx(i)}function dx(i,l,u){return u(function(){px(l)&&mx(i)})}function px(i){var l=i.getSnapshot;i=i.value;try{var u=l();return!cr(i,u)}catch{return!0}}function mx(i){var l=Vt(i,2);l!==null&&Er(l,i,2)}function Dp(i){var l=xr();if(typeof i=="function"){var u=i;if(i=u(),fs){De(!0);try{u()}finally{De(!1)}}}return l.memoizedState=l.baseState=i,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:i},l}function gx(i,l,u,f){return i.baseState=u,jp(i,Wt,typeof f=="function"?f:wa)}function oA(i,l,u,f,y){if(Bh(i))throw Error(r(485));if(i=l.action,i!==null){var x={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){x.listeners.push(T)}};X.T!==null?u(!0):x.isTransition=!1,f(x),u=l.pending,u===null?(x.next=l.pending=x,yx(l,x)):(x.next=u.next,l.pending=u.next=x)}}function yx(i,l){var u=l.action,f=l.payload,y=i.state;if(l.isTransition){var x=X.T,T={};X.T=T;try{var _=u(y,f),V=X.S;V!==null&&V(T,_),xx(i,l,_)}catch(ce){Op(i,l,ce)}finally{x!==null&&T.types!==null&&(x.types=T.types),X.T=x}}else try{x=u(y,f),xx(i,l,x)}catch(ce){Op(i,l,ce)}}function xx(i,l,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){vx(i,l,f)},function(f){return Op(i,l,f)}):vx(i,l,u)}function vx(i,l,u){l.status="fulfilled",l.value=u,bx(l),i.state=u,l=i.pending,l!==null&&(u=l.next,u===l?i.pending=null:(u=u.next,l.next=u,yx(i,u)))}function Op(i,l,u){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=u,bx(l),l=l.next;while(l!==f)}i.action=null}function bx(i){i=i.listeners;for(var l=0;l<i.length;l++)(0,i[l])()}function kx(i,l){return l}function wx(i,l){if(jt){var u=tn.formState;if(u!==null){e:{var f=yt;if(jt){if(fn){t:{for(var y=fn,x=ti;y.nodeType!==8;){if(!x){y=null;break t}if(y=ri(y.nextSibling),y===null){y=null;break t}}x=y.data,y=x==="F!"||x==="F"?y:null}if(y){fn=ri(y.nextSibling),f=y.data==="F!";break e}}nl(f)}f=!1}f&&(l=u[0])}}return u=xr(),u.memoizedState=u.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kx,lastRenderedState:l},u.queue=f,u=qx.bind(null,yt,f),f.dispatch=u,f=Dp(!1),x=Pp.bind(null,yt,!1,f.queue),f=xr(),y={state:l,dispatch:null,action:i,pending:null},f.queue=y,u=oA.bind(null,yt,y,x,u),y.dispatch=u,f.memoizedState=i,[l,u,!1]}function Sx(i){var l=Nn();return Cx(l,Wt,i)}function Cx(i,l,u){if(l=jp(i,l,kx)[0],i=Oh(wa)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var f=Lu(l)}catch(T){throw T===ro?Sh:T}else f=l;l=Nn();var y=l.queue,x=y.dispatch;return u!==l.memoizedState&&(yt.flags|=2048,oo(9,{destroy:void 0},uA.bind(null,y,u),null)),[f,x,i]}function uA(i,l){i.action=l}function Ax(i){var l=Nn(),u=Wt;if(u!==null)return Cx(l,u,i);Nn(),l=l.memoizedState,u=Nn();var f=u.queue.dispatch;return u.memoizedState=i,[l,f,!1]}function oo(i,l,u,f){return i={tag:i,create:u,deps:f,inst:l,next:null},l=yt.updateQueue,l===null&&(l=_h(),yt.updateQueue=l),u=l.lastEffect,u===null?l.lastEffect=i.next=i:(f=u.next,u.next=i,i.next=f,l.lastEffect=i),i}function Tx(){return Nn().memoizedState}function Rh(i,l,u,f){var y=xr();yt.flags|=i,y.memoizedState=oo(1|l,{destroy:void 0},u,f===void 0?null:f)}function Lh(i,l,u,f){var y=Nn();f=f===void 0?null:f;var x=y.memoizedState.inst;Wt!==null&&f!==null&&Cp(f,Wt.memoizedState.deps)?y.memoizedState=oo(l,x,u,f):(yt.flags|=i,y.memoizedState=oo(1|l,x,u,f))}function Nx(i,l){Rh(8390656,8,i,l)}function Rp(i,l){Lh(2048,8,i,l)}function cA(i){yt.flags|=4;var l=yt.updateQueue;if(l===null)l=_h(),yt.updateQueue=l,l.events=[i];else{var u=l.events;u===null?l.events=[i]:u.push(i)}}function Ex(i){var l=Nn().memoizedState;return cA({ref:l,nextImpl:i}),function(){if((qt&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}function Mx(i,l){return Lh(4,2,i,l)}function jx(i,l){return Lh(4,4,i,l)}function _x(i,l){if(typeof l=="function"){i=i();var u=l(i);return function(){typeof u=="function"?u():l(null)}}if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function Dx(i,l,u){u=u!=null?u.concat([i]):null,Lh(4,4,_x.bind(null,l,i),u)}function Lp(){}function Ox(i,l){var u=Nn();l=l===void 0?null:l;var f=u.memoizedState;return l!==null&&Cp(l,f[1])?f[0]:(u.memoizedState=[i,l],i)}function Rx(i,l){var u=Nn();l=l===void 0?null:l;var f=u.memoizedState;if(l!==null&&Cp(l,f[1]))return f[0];if(f=i(),fs){De(!0);try{i()}finally{De(!1)}}return u.memoizedState=[f,l],f}function Bp(i,l,u){return u===void 0||(ka&1073741824)!==0&&(Tt&261930)===0?i.memoizedState=l:(i.memoizedState=u,i=Lv(),yt.lanes|=i,hl|=i,u)}function Lx(i,l,u,f){return cr(u,l)?u:ao.current!==null?(i=Bp(i,u,f),cr(i,l)||(Rn=!0),i):(ka&42)===0||(ka&1073741824)!==0&&(Tt&261930)===0?(Rn=!0,i.memoizedState=u):(i=Lv(),yt.lanes|=i,hl|=i,l)}function Bx(i,l,u,f,y){var x=ve.p;ve.p=x!==0&&8>x?x:8;var T=X.T,_={};X.T=_,Pp(i,!1,l,u);try{var V=y(),ce=X.S;if(ce!==null&&ce(_,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var we=aA(V,f);Bu(i,l,we,qr(i))}else Bu(i,l,f,qr(i))}catch(Me){Bu(i,l,{then:function(){},status:"rejected",reason:Me},qr())}finally{ve.p=x,T!==null&&_.types!==null&&(T.types=_.types),X.T=T}}function hA(){}function zp(i,l,u,f){if(i.tag!==5)throw Error(r(476));var y=zx(i).queue;Bx(i,y,l,Te,u===null?hA:function(){return Ix(i),u(f)})}function zx(i){var l=i.memoizedState;if(l!==null)return l;l={memoizedState:Te,baseState:Te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:Te},next:null};var u={};return l.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:u},next:null},i.memoizedState=l,i=i.alternate,i!==null&&(i.memoizedState=l),l}function Ix(i){var l=zx(i);l.next===null&&(l=i.alternate.memoizedState),Bu(i,l.next.queue,{},qr())}function Ip(){return Jn(Ju)}function Px(){return Nn().memoizedState}function Hx(){return Nn().memoizedState}function fA(i){for(var l=i.return;l!==null;){switch(l.tag){case 24:case 3:var u=qr();i=al(u);var f=ll(l,i,u);f!==null&&(Er(f,l,u),_u(f,l,u)),l={cache:dp()},i.payload=l;return}l=l.return}}function dA(i,l,u){var f=qr();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Bh(i)?Ux(l,u):(u=hr(i,l,u,f),u!==null&&(Er(u,i,f),Vx(u,l,f)))}function qx(i,l,u){var f=qr();Bu(i,l,u,f)}function Bu(i,l,u,f){var y={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Bh(i))Ux(l,y);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=l.lastRenderedReducer,x!==null))try{var T=l.lastRenderedState,_=x(T,u);if(y.hasEagerState=!0,y.eagerState=_,cr(_,T))return Xt(i,l,y,0),tn===null&&gt(),!1}catch{}if(u=hr(i,l,y,f),u!==null)return Er(u,i,f),Vx(u,l,f),!0}return!1}function Pp(i,l,u,f){if(f={lane:2,revertLane:ym(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Bh(i)){if(l)throw Error(r(479))}else l=hr(i,u,f,2),l!==null&&Er(l,i,2)}function Bh(i){var l=i.alternate;return i===yt||l!==null&&l===yt}function Ux(i,l){lo=Mh=!0;var u=i.pending;u===null?l.next=l:(l.next=u.next,u.next=l),i.pending=l}function Vx(i,l,u){if((u&4194048)!==0){var f=l.lanes;f&=i.pendingLanes,u|=f,l.lanes=u,en(i,u)}}var zu={readContext:Jn,use:Dh,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useLayoutEffect:bn,useInsertionEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useSyncExternalStore:bn,useId:bn,useHostTransitionStatus:bn,useFormState:bn,useActionState:bn,useOptimistic:bn,useMemoCache:bn,useCacheRefresh:bn};zu.useEffectEvent=bn;var Fx={readContext:Jn,use:Dh,useCallback:function(i,l){return xr().memoizedState=[i,l===void 0?null:l],i},useContext:Jn,useEffect:Nx,useImperativeHandle:function(i,l,u){u=u!=null?u.concat([i]):null,Rh(4194308,4,_x.bind(null,l,i),u)},useLayoutEffect:function(i,l){return Rh(4194308,4,i,l)},useInsertionEffect:function(i,l){Rh(4,2,i,l)},useMemo:function(i,l){var u=xr();l=l===void 0?null:l;var f=i();if(fs){De(!0);try{i()}finally{De(!1)}}return u.memoizedState=[f,l],f},useReducer:function(i,l,u){var f=xr();if(u!==void 0){var y=u(l);if(fs){De(!0);try{u(l)}finally{De(!1)}}}else y=l;return f.memoizedState=f.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},f.queue=i,i=i.dispatch=dA.bind(null,yt,i),[f.memoizedState,i]},useRef:function(i){var l=xr();return i={current:i},l.memoizedState=i},useState:function(i){i=Dp(i);var l=i.queue,u=qx.bind(null,yt,l);return l.dispatch=u,[i.memoizedState,u]},useDebugValue:Lp,useDeferredValue:function(i,l){var u=xr();return Bp(u,i,l)},useTransition:function(){var i=Dp(!1);return i=Bx.bind(null,yt,i.queue,!0,!1),xr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,l,u){var f=yt,y=xr();if(jt){if(u===void 0)throw Error(r(407));u=u()}else{if(u=l(),tn===null)throw Error(r(349));(Tt&127)!==0||hx(f,l,u)}y.memoizedState=u;var x={value:u,getSnapshot:l};return y.queue=x,Nx(dx.bind(null,f,x,i),[i]),f.flags|=2048,oo(9,{destroy:void 0},fx.bind(null,f,x,u,l),null),u},useId:function(){var i=xr(),l=tn.identifierPrefix;if(jt){var u=qi,f=Hi;u=(f&~(1<<32-Se(f)-1)).toString(32)+u,l="_"+l+"R_"+u,u=jh++,0<u&&(l+="H"+u.toString(32)),l+="_"}else u=lA++,l="_"+l+"r_"+u.toString(32)+"_";return i.memoizedState=l},useHostTransitionStatus:Ip,useFormState:wx,useActionState:wx,useOptimistic:function(i){var l=xr();l.memoizedState=l.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=u,l=Pp.bind(null,yt,!0,u),u.dispatch=l,[i,l]},useMemoCache:Mp,useCacheRefresh:function(){return xr().memoizedState=fA.bind(null,yt)},useEffectEvent:function(i){var l=xr(),u={impl:i};return l.memoizedState=u,function(){if((qt&2)!==0)throw Error(r(440));return u.impl.apply(void 0,arguments)}}},Hp={readContext:Jn,use:Dh,useCallback:Ox,useContext:Jn,useEffect:Rp,useImperativeHandle:Dx,useInsertionEffect:Mx,useLayoutEffect:jx,useMemo:Rx,useReducer:Oh,useRef:Tx,useState:function(){return Oh(wa)},useDebugValue:Lp,useDeferredValue:function(i,l){var u=Nn();return Lx(u,Wt.memoizedState,i,l)},useTransition:function(){var i=Oh(wa)[0],l=Nn().memoizedState;return[typeof i=="boolean"?i:Lu(i),l]},useSyncExternalStore:cx,useId:Px,useHostTransitionStatus:Ip,useFormState:Sx,useActionState:Sx,useOptimistic:function(i,l){var u=Nn();return gx(u,Wt,i,l)},useMemoCache:Mp,useCacheRefresh:Hx};Hp.useEffectEvent=Ex;var Kx={readContext:Jn,use:Dh,useCallback:Ox,useContext:Jn,useEffect:Rp,useImperativeHandle:Dx,useInsertionEffect:Mx,useLayoutEffect:jx,useMemo:Rx,useReducer:_p,useRef:Tx,useState:function(){return _p(wa)},useDebugValue:Lp,useDeferredValue:function(i,l){var u=Nn();return Wt===null?Bp(u,i,l):Lx(u,Wt.memoizedState,i,l)},useTransition:function(){var i=_p(wa)[0],l=Nn().memoizedState;return[typeof i=="boolean"?i:Lu(i),l]},useSyncExternalStore:cx,useId:Px,useHostTransitionStatus:Ip,useFormState:Ax,useActionState:Ax,useOptimistic:function(i,l){var u=Nn();return Wt!==null?gx(u,Wt,i,l):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:Mp,useCacheRefresh:Hx};Kx.useEffectEvent=Ex;function qp(i,l,u,f){l=i.memoizedState,u=u(f,l),u=u==null?l:g({},l,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Up={enqueueSetState:function(i,l,u){i=i._reactInternals;var f=qr(),y=al(f);y.payload=l,u!=null&&(y.callback=u),l=ll(i,y,f),l!==null&&(Er(l,i,f),_u(l,i,f))},enqueueReplaceState:function(i,l,u){i=i._reactInternals;var f=qr(),y=al(f);y.tag=1,y.payload=l,u!=null&&(y.callback=u),l=ll(i,y,f),l!==null&&(Er(l,i,f),_u(l,i,f))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var u=qr(),f=al(u);f.tag=2,l!=null&&(f.callback=l),l=ll(i,f,u),l!==null&&(Er(l,i,u),_u(l,i,u))}};function Gx(i,l,u,f,y,x,T){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,x,T):l.prototype&&l.prototype.isPureReactComponent?!m(u,f)||!m(y,x):!0}function Yx(i,l,u,f){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,f),l.state!==i&&Up.enqueueReplaceState(l,l.state,null)}function ds(i,l){var u=l;if("ref"in l){u={};for(var f in l)f!=="ref"&&(u[f]=l[f])}if(i=i.defaultProps){u===l&&(u=g({},u));for(var y in i)u[y]===void 0&&(u[y]=i[y])}return u}function $x(i){We(i)}function Qx(i){console.error(i)}function Xx(i){We(i)}function zh(i,l){try{var u=i.onUncaughtError;u(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function Wx(i,l,u){try{var f=i.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Vp(i,l,u){return u=al(u),u.tag=3,u.payload={element:null},u.callback=function(){zh(i,l)},u}function Zx(i){return i=al(i),i.tag=3,i}function Jx(i,l,u,f){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var x=f.value;i.payload=function(){return y(x)},i.callback=function(){Wx(l,u,f)}}var T=u.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(i.callback=function(){Wx(l,u,f),typeof y!="function"&&(fl===null?fl=new Set([this]):fl.add(this));var _=f.stack;this.componentDidCatch(f.value,{componentStack:_!==null?_:""})})}function pA(i,l,u,f,y){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=u.alternate,l!==null&&eo(l,u,y,!0),u=zr.current,u!==null){switch(u.tag){case 31:case 13:return ni===null?Qh():u.alternate===null&&kn===0&&(kn=3),u.flags&=-257,u.flags|=65536,u.lanes=y,f===Ch?u.flags|=16384:(l=u.updateQueue,l===null?u.updateQueue=new Set([f]):l.add(f),pm(i,f,y)),!1;case 22:return u.flags|=65536,f===Ch?u.flags|=16384:(l=u.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=l):(u=l.retryQueue,u===null?l.retryQueue=new Set([f]):u.add(f)),pm(i,f,y)),!1}throw Error(r(435,u.tag))}return pm(i,f,y),Qh(),!1}if(jt)return l=zr.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=y,f!==op&&(i=Error(r(422),{cause:f}),Tu(Zr(i,u)))):(f!==op&&(l=Error(r(423),{cause:f}),Tu(Zr(l,u))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,f=Zr(f,u),y=Vp(i.stateNode,f,y),vp(i,y),kn!==4&&(kn=2)),!1;var x=Error(r(520),{cause:f});if(x=Zr(x,u),Ku===null?Ku=[x]:Ku.push(x),kn!==4&&(kn=2),l===null)return!0;f=Zr(f,u),u=l;do{switch(u.tag){case 3:return u.flags|=65536,i=y&-y,u.lanes|=i,i=Vp(u.stateNode,f,i),vp(u,i),!1;case 1:if(l=u.type,x=u.stateNode,(u.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(fl===null||!fl.has(x))))return u.flags|=65536,y&=-y,u.lanes|=y,y=Zx(y),Jx(y,i,u,f),vp(u,y),!1}u=u.return}while(u!==null);return!1}var Fp=Error(r(461)),Rn=!1;function er(i,l,u,f){l.child=i===null?rx(l,null,u,f):hs(l,i.child,u,f)}function ev(i,l,u,f,y){u=u.render;var x=l.ref;if("ref"in f){var T={};for(var _ in f)_!=="ref"&&(T[_]=f[_])}else T=f;return ss(l),f=Ap(i,l,u,T,x,y),_=Tp(),i!==null&&!Rn?(Np(i,l,y),Sa(i,l,y)):(jt&&_&&lp(l),l.flags|=1,er(i,l,f,y),l.child)}function tv(i,l,u,f,y){if(i===null){var x=u.type;return typeof x=="function"&&!rp(x)&&x.defaultProps===void 0&&u.compare===null?(l.tag=15,l.type=x,nv(i,l,x,f,y)):(i=xh(u.type,null,f,l,l.mode,y),i.ref=l.ref,i.return=l,l.child=i)}if(x=i.child,!Zp(i,y)){var T=x.memoizedProps;if(u=u.compare,u=u!==null?u:m,u(T,f)&&i.ref===l.ref)return Sa(i,l,y)}return l.flags|=1,i=ya(x,f),i.ref=l.ref,i.return=l,l.child=i}function nv(i,l,u,f,y){if(i!==null){var x=i.memoizedProps;if(m(x,f)&&i.ref===l.ref)if(Rn=!1,l.pendingProps=f=x,Zp(i,y))(i.flags&131072)!==0&&(Rn=!0);else return l.lanes=i.lanes,Sa(i,l,y)}return Kp(i,l,u,f,y)}function rv(i,l,u,f){var y=f.children,x=i!==null?i.memoizedState:null;if(i===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((l.flags&128)!==0){if(x=x!==null?x.baseLanes|u:u,i!==null){for(f=l.child=i.child,y=0;f!==null;)y=y|f.lanes|f.childLanes,f=f.sibling;f=y&~x}else f=0,l.child=null;return iv(i,l,x,u,f)}if((u&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},i!==null&&wh(l,x!==null?x.cachePool:null),x!==null?lx(l,x):kp(),sx(l);else return f=l.lanes=536870912,iv(i,l,x!==null?x.baseLanes|u:u,u,f)}else x!==null?(wh(l,x.cachePool),lx(l,x),ol(),l.memoizedState=null):(i!==null&&wh(l,null),kp(),ol());return er(i,l,y,u),l.child}function Iu(i,l){return i!==null&&i.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function iv(i,l,u,f,y){var x=mp();return x=x===null?null:{parent:Dn._currentValue,pool:x},l.memoizedState={baseLanes:u,cachePool:x},i!==null&&wh(l,null),kp(),sx(l),i!==null&&eo(i,l,f,!0),l.childLanes=y,null}function Ih(i,l){return l=Hh({mode:l.mode,children:l.children},i.mode),l.ref=i.ref,i.child=l,l.return=i,l}function av(i,l,u){return hs(l,i.child,null,u),i=Ih(l,l.pendingProps),i.flags|=2,Ir(l),l.memoizedState=null,i}function mA(i,l,u){var f=l.pendingProps,y=(l.flags&128)!==0;if(l.flags&=-129,i===null){if(jt){if(f.mode==="hidden")return i=Ih(l,f),l.lanes=536870912,Iu(null,i);if(Sp(l),(i=fn)?(i=yb(i,ti),i=i!==null&&i.data==="&"?i:null,i!==null&&(l.memoizedState={dehydrated:i,treeContext:el!==null?{id:Hi,overflow:qi}:null,retryLane:536870912,hydrationErrors:null},u=Uy(i),u.return=l,l.child=u,Zn=l,fn=null)):i=null,i===null)throw nl(l);return l.lanes=536870912,null}return Ih(l,f)}var x=i.memoizedState;if(x!==null){var T=x.dehydrated;if(Sp(l),y)if(l.flags&256)l.flags&=-257,l=av(i,l,u);else if(l.memoizedState!==null)l.child=i.child,l.flags|=128,l=null;else throw Error(r(558));else if(Rn||eo(i,l,u,!1),y=(u&i.childLanes)!==0,Rn||y){if(f=tn,f!==null&&(T=Sn(f,u),T!==0&&T!==x.retryLane))throw x.retryLane=T,Vt(i,T),Er(f,i,T),Fp;Qh(),l=av(i,l,u)}else i=x.treeContext,fn=ri(T.nextSibling),Zn=l,jt=!0,tl=null,ti=!1,i!==null&&Ky(l,i),l=Ih(l,f),l.flags|=4096;return l}return i=ya(i.child,{mode:f.mode,children:f.children}),i.ref=l.ref,l.child=i,i.return=l,i}function Ph(i,l){var u=l.ref;if(u===null)i!==null&&i.ref!==null&&(l.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(i===null||i.ref!==u)&&(l.flags|=4194816)}}function Kp(i,l,u,f,y){return ss(l),u=Ap(i,l,u,f,void 0,y),f=Tp(),i!==null&&!Rn?(Np(i,l,y),Sa(i,l,y)):(jt&&f&&lp(l),l.flags|=1,er(i,l,u,y),l.child)}function lv(i,l,u,f,y,x){return ss(l),l.updateQueue=null,u=ux(l,f,u,y),ox(i),f=Tp(),i!==null&&!Rn?(Np(i,l,x),Sa(i,l,x)):(jt&&f&&lp(l),l.flags|=1,er(i,l,u,x),l.child)}function sv(i,l,u,f,y){if(ss(l),l.stateNode===null){var x=Xs,T=u.contextType;typeof T=="object"&&T!==null&&(x=Jn(T)),x=new u(f,x),l.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Up,l.stateNode=x,x._reactInternals=l,x=l.stateNode,x.props=f,x.state=l.memoizedState,x.refs={},yp(l),T=u.contextType,x.context=typeof T=="object"&&T!==null?Jn(T):Xs,x.state=l.memoizedState,T=u.getDerivedStateFromProps,typeof T=="function"&&(qp(l,u,T,f),x.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(T=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),T!==x.state&&Up.enqueueReplaceState(x,x.state,null),Ou(l,f,x,y),Du(),x.state=l.memoizedState),typeof x.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(i===null){x=l.stateNode;var _=l.memoizedProps,V=ds(u,_);x.props=V;var ce=x.context,we=u.contextType;T=Xs,typeof we=="object"&&we!==null&&(T=Jn(we));var Me=u.getDerivedStateFromProps;we=typeof Me=="function"||typeof x.getSnapshotBeforeUpdate=="function",_=l.pendingProps!==_,we||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(_||ce!==T)&&Yx(l,x,f,T),il=!1;var de=l.memoizedState;x.state=de,Ou(l,f,x,y),Du(),ce=l.memoizedState,_||de!==ce||il?(typeof Me=="function"&&(qp(l,u,Me,f),ce=l.memoizedState),(V=il||Gx(l,u,V,f,de,ce,T))?(we||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(l.flags|=4194308)):(typeof x.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=ce),x.props=f,x.state=ce,x.context=T,f=V):(typeof x.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{x=l.stateNode,xp(i,l),T=l.memoizedProps,we=ds(u,T),x.props=we,Me=l.pendingProps,de=x.context,ce=u.contextType,V=Xs,typeof ce=="object"&&ce!==null&&(V=Jn(ce)),_=u.getDerivedStateFromProps,(ce=typeof _=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(T!==Me||de!==V)&&Yx(l,x,f,V),il=!1,de=l.memoizedState,x.state=de,Ou(l,f,x,y),Du();var xe=l.memoizedState;T!==Me||de!==xe||il||i!==null&&i.dependencies!==null&&bh(i.dependencies)?(typeof _=="function"&&(qp(l,u,_,f),xe=l.memoizedState),(we=il||Gx(l,u,we,f,de,xe,V)||i!==null&&i.dependencies!==null&&bh(i.dependencies))?(ce||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,xe,V),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,xe,V)),typeof x.componentDidUpdate=="function"&&(l.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof x.componentDidUpdate!="function"||T===i.memoizedProps&&de===i.memoizedState||(l.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&de===i.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=xe),x.props=f,x.state=xe,x.context=V,f=we):(typeof x.componentDidUpdate!="function"||T===i.memoizedProps&&de===i.memoizedState||(l.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&de===i.memoizedState||(l.flags|=1024),f=!1)}return x=f,Ph(i,l),f=(l.flags&128)!==0,x||f?(x=l.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:x.render(),l.flags|=1,i!==null&&f?(l.child=hs(l,i.child,null,y),l.child=hs(l,null,u,y)):er(i,l,u,y),l.memoizedState=x.state,i=l.child):i=Sa(i,l,y),i}function ov(i,l,u,f){return as(),l.flags|=256,er(i,l,u,f),l.child}var Gp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yp(i){return{baseLanes:i,cachePool:Wy()}}function $p(i,l,u){return i=i!==null?i.childLanes&~u:0,l&&(i|=Hr),i}function uv(i,l,u){var f=l.pendingProps,y=!1,x=(l.flags&128)!==0,T;if((T=x)||(T=i!==null&&i.memoizedState===null?!1:(Tn.current&2)!==0),T&&(y=!0,l.flags&=-129),T=(l.flags&32)!==0,l.flags&=-33,i===null){if(jt){if(y?sl(l):ol(),(i=fn)?(i=yb(i,ti),i=i!==null&&i.data!=="&"?i:null,i!==null&&(l.memoizedState={dehydrated:i,treeContext:el!==null?{id:Hi,overflow:qi}:null,retryLane:536870912,hydrationErrors:null},u=Uy(i),u.return=l,l.child=u,Zn=l,fn=null)):i=null,i===null)throw nl(l);return jm(i)?l.lanes=32:l.lanes=536870912,null}var _=f.children;return f=f.fallback,y?(ol(),y=l.mode,_=Hh({mode:"hidden",children:_},y),f=is(f,y,u,null),_.return=l,f.return=l,_.sibling=f,l.child=_,f=l.child,f.memoizedState=Yp(u),f.childLanes=$p(i,T,u),l.memoizedState=Gp,Iu(null,f)):(sl(l),Qp(l,_))}var V=i.memoizedState;if(V!==null&&(_=V.dehydrated,_!==null)){if(x)l.flags&256?(sl(l),l.flags&=-257,l=Xp(i,l,u)):l.memoizedState!==null?(ol(),l.child=i.child,l.flags|=128,l=null):(ol(),_=f.fallback,y=l.mode,f=Hh({mode:"visible",children:f.children},y),_=is(_,y,u,null),_.flags|=2,f.return=l,_.return=l,f.sibling=_,l.child=f,hs(l,i.child,null,u),f=l.child,f.memoizedState=Yp(u),f.childLanes=$p(i,T,u),l.memoizedState=Gp,l=Iu(null,f));else if(sl(l),jm(_)){if(T=_.nextSibling&&_.nextSibling.dataset,T)var ce=T.dgst;T=ce,f=Error(r(419)),f.stack="",f.digest=T,Tu({value:f,source:null,stack:null}),l=Xp(i,l,u)}else if(Rn||eo(i,l,u,!1),T=(u&i.childLanes)!==0,Rn||T){if(T=tn,T!==null&&(f=Sn(T,u),f!==0&&f!==V.retryLane))throw V.retryLane=f,Vt(i,f),Er(T,i,f),Fp;Mm(_)||Qh(),l=Xp(i,l,u)}else Mm(_)?(l.flags|=192,l.child=i.child,l=null):(i=V.treeContext,fn=ri(_.nextSibling),Zn=l,jt=!0,tl=null,ti=!1,i!==null&&Ky(l,i),l=Qp(l,f.children),l.flags|=4096);return l}return y?(ol(),_=f.fallback,y=l.mode,V=i.child,ce=V.sibling,f=ya(V,{mode:"hidden",children:f.children}),f.subtreeFlags=V.subtreeFlags&65011712,ce!==null?_=ya(ce,_):(_=is(_,y,u,null),_.flags|=2),_.return=l,f.return=l,f.sibling=_,l.child=f,Iu(null,f),f=l.child,_=i.child.memoizedState,_===null?_=Yp(u):(y=_.cachePool,y!==null?(V=Dn._currentValue,y=y.parent!==V?{parent:V,pool:V}:y):y=Wy(),_={baseLanes:_.baseLanes|u,cachePool:y}),f.memoizedState=_,f.childLanes=$p(i,T,u),l.memoizedState=Gp,Iu(i.child,f)):(sl(l),u=i.child,i=u.sibling,u=ya(u,{mode:"visible",children:f.children}),u.return=l,u.sibling=null,i!==null&&(T=l.deletions,T===null?(l.deletions=[i],l.flags|=16):T.push(i)),l.child=u,l.memoizedState=null,u)}function Qp(i,l){return l=Hh({mode:"visible",children:l},i.mode),l.return=i,i.child=l}function Hh(i,l){return i=Br(22,i,null,l),i.lanes=0,i}function Xp(i,l,u){return hs(l,i.child,null,u),i=Qp(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function cv(i,l,u){i.lanes|=l;var f=i.alternate;f!==null&&(f.lanes|=l),hp(i.return,l,u)}function Wp(i,l,u,f,y,x){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y,treeForkCount:x}:(T.isBackwards=l,T.rendering=null,T.renderingStartTime=0,T.last=f,T.tail=u,T.tailMode=y,T.treeForkCount=x)}function hv(i,l,u){var f=l.pendingProps,y=f.revealOrder,x=f.tail;f=f.children;var T=Tn.current,_=(T&2)!==0;if(_?(T=T&1|2,l.flags|=128):T&=1,B(Tn,T),er(i,l,f,u),f=jt?Au:0,!_&&i!==null&&(i.flags&128)!==0)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&cv(i,u,l);else if(i.tag===19)cv(i,u,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(u=l.child,y=null;u!==null;)i=u.alternate,i!==null&&Eh(i)===null&&(y=u),u=u.sibling;u=y,u===null?(y=l.child,l.child=null):(y=u.sibling,u.sibling=null),Wp(l,!1,y,u,x,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=l.child,l.child=null;y!==null;){if(i=y.alternate,i!==null&&Eh(i)===null){l.child=y;break}i=y.sibling,y.sibling=u,u=y,y=i}Wp(l,!0,u,null,x,f);break;case"together":Wp(l,!1,null,null,void 0,f);break;default:l.memoizedState=null}return l.child}function Sa(i,l,u){if(i!==null&&(l.dependencies=i.dependencies),hl|=l.lanes,(u&l.childLanes)===0)if(i!==null){if(eo(i,l,u,!1),(u&l.childLanes)===0)return null}else return null;if(i!==null&&l.child!==i.child)throw Error(r(153));if(l.child!==null){for(i=l.child,u=ya(i,i.pendingProps),l.child=u,u.return=l;i.sibling!==null;)i=i.sibling,u=u.sibling=ya(i,i.pendingProps),u.return=l;u.sibling=null}return l.child}function Zp(i,l){return(i.lanes&l)!==0?!0:(i=i.dependencies,!!(i!==null&&bh(i)))}function gA(i,l,u){switch(l.tag){case 3:ft(l,l.stateNode.containerInfo),rl(l,Dn,i.memoizedState.cache),as();break;case 27:case 5:Fe(l);break;case 4:ft(l,l.stateNode.containerInfo);break;case 10:rl(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Sp(l),null;break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(sl(l),l.flags|=128,null):(u&l.child.childLanes)!==0?uv(i,l,u):(sl(l),i=Sa(i,l,u),i!==null?i.sibling:null);sl(l);break;case 19:var y=(i.flags&128)!==0;if(f=(u&l.childLanes)!==0,f||(eo(i,l,u,!1),f=(u&l.childLanes)!==0),y){if(f)return hv(i,l,u);l.flags|=128}if(y=l.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),B(Tn,Tn.current),f)break;return null;case 22:return l.lanes=0,rv(i,l,u,l.pendingProps);case 24:rl(l,Dn,i.memoizedState.cache)}return Sa(i,l,u)}function fv(i,l,u){if(i!==null)if(i.memoizedProps!==l.pendingProps)Rn=!0;else{if(!Zp(i,u)&&(l.flags&128)===0)return Rn=!1,gA(i,l,u);Rn=(i.flags&131072)!==0}else Rn=!1,jt&&(l.flags&1048576)!==0&&Fy(l,Au,l.index);switch(l.lanes=0,l.tag){case 16:e:{var f=l.pendingProps;if(i=us(l.elementType),l.type=i,typeof i=="function")rp(i)?(f=ds(i,f),l.tag=1,l=sv(null,l,i,f,u)):(l.tag=0,l=Kp(null,l,i,f,u));else{if(i!=null){var y=i.$$typeof;if(y===J){l.tag=11,l=ev(null,l,i,f,u);break e}else if(y===L){l.tag=14,l=tv(null,l,i,f,u);break e}}throw l=ge(i)||i,Error(r(306,l,""))}}return l;case 0:return Kp(i,l,l.type,l.pendingProps,u);case 1:return f=l.type,y=ds(f,l.pendingProps),sv(i,l,f,y,u);case 3:e:{if(ft(l,l.stateNode.containerInfo),i===null)throw Error(r(387));f=l.pendingProps;var x=l.memoizedState;y=x.element,xp(i,l),Ou(l,f,null,u);var T=l.memoizedState;if(f=T.cache,rl(l,Dn,f),f!==x.cache&&fp(l,[Dn],u,!0),Du(),f=T.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:T.cache},l.updateQueue.baseState=x,l.memoizedState=x,l.flags&256){l=ov(i,l,f,u);break e}else if(f!==y){y=Zr(Error(r(424)),l),Tu(y),l=ov(i,l,f,u);break e}else for(i=l.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,fn=ri(i.firstChild),Zn=l,jt=!0,tl=null,ti=!0,u=rx(l,null,f,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(as(),f===y){l=Sa(i,l,u);break e}er(i,l,f,u)}l=l.child}return l;case 26:return Ph(i,l),i===null?(u=Sb(l.type,null,l.pendingProps,null))?l.memoizedState=u:jt||(u=l.type,i=l.pendingProps,f=nf(Qe.current).createElement(u),f[an]=l,f[Cn]=i,tr(f,u,i),An(f),l.stateNode=f):l.memoizedState=Sb(l.type,i.memoizedProps,l.pendingProps,i.memoizedState),null;case 27:return Fe(l),i===null&&jt&&(f=l.stateNode=bb(l.type,l.pendingProps,Qe.current),Zn=l,ti=!0,y=fn,gl(l.type)?(_m=y,fn=ri(f.firstChild)):fn=y),er(i,l,l.pendingProps.children,u),Ph(i,l),i===null&&(l.flags|=4194304),l.child;case 5:return i===null&&jt&&((y=f=fn)&&(f=GA(f,l.type,l.pendingProps,ti),f!==null?(l.stateNode=f,Zn=l,fn=ri(f.firstChild),ti=!1,y=!0):y=!1),y||nl(l)),Fe(l),y=l.type,x=l.pendingProps,T=i!==null?i.memoizedProps:null,f=x.children,Tm(y,x)?f=null:T!==null&&Tm(y,T)&&(l.flags|=32),l.memoizedState!==null&&(y=Ap(i,l,sA,null,null,u),Ju._currentValue=y),Ph(i,l),er(i,l,f,u),l.child;case 6:return i===null&&jt&&((i=u=fn)&&(u=YA(u,l.pendingProps,ti),u!==null?(l.stateNode=u,Zn=l,fn=null,i=!0):i=!1),i||nl(l)),null;case 13:return uv(i,l,u);case 4:return ft(l,l.stateNode.containerInfo),f=l.pendingProps,i===null?l.child=hs(l,null,f,u):er(i,l,f,u),l.child;case 11:return ev(i,l,l.type,l.pendingProps,u);case 7:return er(i,l,l.pendingProps,u),l.child;case 8:return er(i,l,l.pendingProps.children,u),l.child;case 12:return er(i,l,l.pendingProps.children,u),l.child;case 10:return f=l.pendingProps,rl(l,l.type,f.value),er(i,l,f.children,u),l.child;case 9:return y=l.type._context,f=l.pendingProps.children,ss(l),y=Jn(y),f=f(y),l.flags|=1,er(i,l,f,u),l.child;case 14:return tv(i,l,l.type,l.pendingProps,u);case 15:return nv(i,l,l.type,l.pendingProps,u);case 19:return hv(i,l,u);case 31:return mA(i,l,u);case 22:return rv(i,l,u,l.pendingProps);case 24:return ss(l),f=Jn(Dn),i===null?(y=mp(),y===null&&(y=tn,x=dp(),y.pooledCache=x,x.refCount++,x!==null&&(y.pooledCacheLanes|=u),y=x),l.memoizedState={parent:f,cache:y},yp(l),rl(l,Dn,y)):((i.lanes&u)!==0&&(xp(i,l),Ou(l,null,null,u),Du()),y=i.memoizedState,x=l.memoizedState,y.parent!==f?(y={parent:f,cache:f},l.memoizedState=y,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=y),rl(l,Dn,f)):(f=x.cache,rl(l,Dn,f),f!==y.cache&&fp(l,[Dn],u,!0))),er(i,l,l.pendingProps.children,u),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function Ca(i){i.flags|=4}function Jp(i,l,u,f,y){if((l=(i.mode&32)!==0)&&(l=!1),l){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(Pv())i.flags|=8192;else throw cs=Ch,gp}else i.flags&=-16777217}function dv(i,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Eb(l))if(Pv())i.flags|=8192;else throw cs=Ch,gp}function qh(i,l){l!==null&&(i.flags|=4),i.flags&16384&&(l=i.tag!==22?rh():536870912,i.lanes|=l,fo|=l)}function Pu(i,l){if(!jt)switch(i.tailMode){case"hidden":l=i.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function dn(i){var l=i.alternate!==null&&i.alternate.child===i.child,u=0,f=0;if(l)for(var y=i.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&65011712,f|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=f,i.childLanes=u,l}function yA(i,l,u){var f=l.pendingProps;switch(sp(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(l),null;case 1:return dn(l),null;case 3:return u=l.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),ba(Dn),Ot(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(Js(l)?Ca(l):i===null||i.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,up())),dn(l),null;case 26:var y=l.type,x=l.memoizedState;return i===null?(Ca(l),x!==null?(dn(l),dv(l,x)):(dn(l),Jp(l,y,null,f,u))):x?x!==i.memoizedState?(Ca(l),dn(l),dv(l,x)):(dn(l),l.flags&=-16777217):(i=i.memoizedProps,i!==f&&Ca(l),dn(l),Jp(l,y,i,f,u)),null;case 27:if(Yt(l),u=Qe.current,y=l.type,i!==null&&l.stateNode!=null)i.memoizedProps!==f&&Ca(l);else{if(!f){if(l.stateNode===null)throw Error(r(166));return dn(l),null}i=$e.current,Js(l)?Gy(l):(i=bb(y,f,u),l.stateNode=i,Ca(l))}return dn(l),null;case 5:if(Yt(l),y=l.type,i!==null&&l.stateNode!=null)i.memoizedProps!==f&&Ca(l);else{if(!f){if(l.stateNode===null)throw Error(r(166));return dn(l),null}if(x=$e.current,Js(l))Gy(l);else{var T=nf(Qe.current);switch(x){case 1:x=T.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:x=T.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":x=T.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":x=T.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":x=T.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof f.is=="string"?T.createElement("select",{is:f.is}):T.createElement("select"),f.multiple?x.multiple=!0:f.size&&(x.size=f.size);break;default:x=typeof f.is=="string"?T.createElement(y,{is:f.is}):T.createElement(y)}}x[an]=l,x[Cn]=f;e:for(T=l.child;T!==null;){if(T.tag===5||T.tag===6)x.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===l)break e;for(;T.sibling===null;){if(T.return===null||T.return===l)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}l.stateNode=x;e:switch(tr(x,y,f),y){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Ca(l)}}return dn(l),Jp(l,l.type,i===null?null:i.memoizedProps,l.pendingProps,u),null;case 6:if(i&&l.stateNode!=null)i.memoizedProps!==f&&Ca(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(r(166));if(i=Qe.current,Js(l)){if(i=l.stateNode,u=l.memoizedProps,f=null,y=Zn,y!==null)switch(y.tag){case 27:case 5:f=y.memoizedProps}i[an]=l,i=!!(i.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||ub(i.nodeValue,u)),i||nl(l,!0)}else i=nf(i).createTextNode(f),i[an]=l,l.stateNode=i}return dn(l),null;case 31:if(u=l.memoizedState,i===null||i.memoizedState!==null){if(f=Js(l),u!==null){if(i===null){if(!f)throw Error(r(318));if(i=l.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(557));i[an]=l}else as(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;dn(l),i=!1}else u=up(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return l.flags&256?(Ir(l),l):(Ir(l),null);if((l.flags&128)!==0)throw Error(r(558))}return dn(l),null;case 13:if(f=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=Js(l),f!==null&&f.dehydrated!==null){if(i===null){if(!y)throw Error(r(318));if(y=l.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[an]=l}else as(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;dn(l),y=!1}else y=up(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return l.flags&256?(Ir(l),l):(Ir(l),null)}return Ir(l),(l.flags&128)!==0?(l.lanes=u,l):(u=f!==null,i=i!==null&&i.memoizedState!==null,u&&(f=l.child,y=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(y=f.alternate.memoizedState.cachePool.pool),x=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==y&&(f.flags|=2048)),u!==i&&u&&(l.child.flags|=8192),qh(l,l.updateQueue),dn(l),null);case 4:return Ot(),i===null&&km(l.stateNode.containerInfo),dn(l),null;case 10:return ba(l.type),dn(l),null;case 19:if(Ce(Tn),f=l.memoizedState,f===null)return dn(l),null;if(y=(l.flags&128)!==0,x=f.rendering,x===null)if(y)Pu(f,!1);else{if(kn!==0||i!==null&&(i.flags&128)!==0)for(i=l.child;i!==null;){if(x=Eh(i),x!==null){for(l.flags|=128,Pu(f,!1),i=x.updateQueue,l.updateQueue=i,qh(l,i),l.subtreeFlags=0,i=u,u=l.child;u!==null;)qy(u,i),u=u.sibling;return B(Tn,Tn.current&1|2),jt&&xa(l,f.treeForkCount),l.child}i=i.sibling}f.tail!==null&&Pt()>Gh&&(l.flags|=128,y=!0,Pu(f,!1),l.lanes=4194304)}else{if(!y)if(i=Eh(x),i!==null){if(l.flags|=128,y=!0,i=i.updateQueue,l.updateQueue=i,qh(l,i),Pu(f,!0),f.tail===null&&f.tailMode==="hidden"&&!x.alternate&&!jt)return dn(l),null}else 2*Pt()-f.renderingStartTime>Gh&&u!==536870912&&(l.flags|=128,y=!0,Pu(f,!1),l.lanes=4194304);f.isBackwards?(x.sibling=l.child,l.child=x):(i=f.last,i!==null?i.sibling=x:l.child=x,f.last=x)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Pt(),i.sibling=null,u=Tn.current,B(Tn,y?u&1|2:u&1),jt&&xa(l,f.treeForkCount),i):(dn(l),null);case 22:case 23:return Ir(l),wp(),f=l.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(u&536870912)!==0&&(l.flags&128)===0&&(dn(l),l.subtreeFlags&6&&(l.flags|=8192)):dn(l),u=l.updateQueue,u!==null&&qh(l,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==u&&(l.flags|=2048),i!==null&&Ce(os),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),l.memoizedState.cache!==u&&(l.flags|=2048),ba(Dn),dn(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function xA(i,l){switch(sp(l),l.tag){case 1:return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return ba(Dn),Ot(),i=l.flags,(i&65536)!==0&&(i&128)===0?(l.flags=i&-65537|128,l):null;case 26:case 27:case 5:return Yt(l),null;case 31:if(l.memoizedState!==null){if(Ir(l),l.alternate===null)throw Error(r(340));as()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 13:if(Ir(l),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(r(340));as()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return Ce(Tn),null;case 4:return Ot(),null;case 10:return ba(l.type),null;case 22:case 23:return Ir(l),wp(),i!==null&&Ce(os),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 24:return ba(Dn),null;case 25:return null;default:return null}}function pv(i,l){switch(sp(l),l.tag){case 3:ba(Dn),Ot();break;case 26:case 27:case 5:Yt(l);break;case 4:Ot();break;case 31:l.memoizedState!==null&&Ir(l);break;case 13:Ir(l);break;case 19:Ce(Tn);break;case 10:ba(l.type);break;case 22:case 23:Ir(l),wp(),i!==null&&Ce(os);break;case 24:ba(Dn)}}function Hu(i,l){try{var u=l.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var y=f.next;u=y;do{if((u.tag&i)===i){f=void 0;var x=u.create,T=u.inst;f=x(),T.destroy=f}u=u.next}while(u!==y)}}catch(_){Kt(l,l.return,_)}}function ul(i,l,u){try{var f=l.updateQueue,y=f!==null?f.lastEffect:null;if(y!==null){var x=y.next;f=x;do{if((f.tag&i)===i){var T=f.inst,_=T.destroy;if(_!==void 0){T.destroy=void 0,y=l;var V=u,ce=_;try{ce()}catch(we){Kt(y,V,we)}}}f=f.next}while(f!==x)}}catch(we){Kt(l,l.return,we)}}function mv(i){var l=i.updateQueue;if(l!==null){var u=i.stateNode;try{ax(l,u)}catch(f){Kt(i,i.return,f)}}}function gv(i,l,u){u.props=ds(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(f){Kt(i,l,f)}}function qu(i,l){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof u=="function"?i.refCleanup=u(f):u.current=f}}catch(y){Kt(i,l,y)}}function Ui(i,l){var u=i.ref,f=i.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(y){Kt(i,l,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){Kt(i,l,y)}else u.current=null}function yv(i){var l=i.type,u=i.memoizedProps,f=i.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(y){Kt(i,i.return,y)}}function em(i,l,u){try{var f=i.stateNode;HA(f,i.type,u,l),f[Cn]=l}catch(y){Kt(i,i.return,y)}}function xv(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&gl(i.type)||i.tag===4}function tm(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||xv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&gl(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function nm(i,l,u){var f=i.tag;if(f===5||f===6)i=i.stateNode,l?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,l):(l=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,l.appendChild(i),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=Sr));else if(f!==4&&(f===27&&gl(i.type)&&(u=i.stateNode,l=null),i=i.child,i!==null))for(nm(i,l,u),i=i.sibling;i!==null;)nm(i,l,u),i=i.sibling}function Uh(i,l,u){var f=i.tag;if(f===5||f===6)i=i.stateNode,l?u.insertBefore(i,l):u.appendChild(i);else if(f!==4&&(f===27&&gl(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Uh(i,l,u),i=i.sibling;i!==null;)Uh(i,l,u),i=i.sibling}function vv(i){var l=i.stateNode,u=i.memoizedProps;try{for(var f=i.type,y=l.attributes;y.length;)l.removeAttributeNode(y[0]);tr(l,f,u),l[an]=i,l[Cn]=u}catch(x){Kt(i,i.return,x)}}var Aa=!1,Ln=!1,rm=!1,bv=typeof WeakSet=="function"?WeakSet:Set,$n=null;function vA(i,l){if(i=i.containerInfo,Cm=cf,i=N(i),M(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{u.nodeType,x.nodeType}catch{u=null;break e}var T=0,_=-1,V=-1,ce=0,we=0,Me=i,de=null;t:for(;;){for(var xe;Me!==u||y!==0&&Me.nodeType!==3||(_=T+y),Me!==x||f!==0&&Me.nodeType!==3||(V=T+f),Me.nodeType===3&&(T+=Me.nodeValue.length),(xe=Me.firstChild)!==null;)de=Me,Me=xe;for(;;){if(Me===i)break t;if(de===u&&++ce===y&&(_=T),de===x&&++we===f&&(V=T),(xe=Me.nextSibling)!==null)break;Me=de,de=Me.parentNode}Me=xe}u=_===-1||V===-1?null:{start:_,end:V}}else u=null}u=u||{start:0,end:0}}else u=null;for(Am={focusedElem:i,selectionRange:u},cf=!1,$n=l;$n!==null;)if(l=$n,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,$n=i;else for(;$n!==null;){switch(l=$n,x=l.alternate,i=l.flags,l.tag){case 0:if((i&4)!==0&&(i=l.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)y=i[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&x!==null){i=void 0,u=l,y=x.memoizedProps,x=x.memoizedState,f=u.stateNode;try{var et=ds(u.type,y);i=f.getSnapshotBeforeUpdate(et,x),f.__reactInternalSnapshotBeforeUpdate=i}catch(ht){Kt(u,u.return,ht)}}break;case 3:if((i&1024)!==0){if(i=l.stateNode.containerInfo,u=i.nodeType,u===9)Em(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Em(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=l.sibling,i!==null){i.return=l.return,$n=i;break}$n=l.return}}function kv(i,l,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:Na(i,u),f&4&&Hu(5,u);break;case 1:if(Na(i,u),f&4)if(i=u.stateNode,l===null)try{i.componentDidMount()}catch(T){Kt(u,u.return,T)}else{var y=ds(u.type,l.memoizedProps);l=l.memoizedState;try{i.componentDidUpdate(y,l,i.__reactInternalSnapshotBeforeUpdate)}catch(T){Kt(u,u.return,T)}}f&64&&mv(u),f&512&&qu(u,u.return);break;case 3:if(Na(i,u),f&64&&(i=u.updateQueue,i!==null)){if(l=null,u.child!==null)switch(u.child.tag){case 27:case 5:l=u.child.stateNode;break;case 1:l=u.child.stateNode}try{ax(i,l)}catch(T){Kt(u,u.return,T)}}break;case 27:l===null&&f&4&&vv(u);case 26:case 5:Na(i,u),l===null&&f&4&&yv(u),f&512&&qu(u,u.return);break;case 12:Na(i,u);break;case 31:Na(i,u),f&4&&Cv(i,u);break;case 13:Na(i,u),f&4&&Av(i,u),f&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=EA.bind(null,u),$A(i,u))));break;case 22:if(f=u.memoizedState!==null||Aa,!f){l=l!==null&&l.memoizedState!==null||Ln,y=Aa;var x=Ln;Aa=f,(Ln=l)&&!x?Ea(i,u,(u.subtreeFlags&8772)!==0):Na(i,u),Aa=y,Ln=x}break;case 30:break;default:Na(i,u)}}function wv(i){var l=i.alternate;l!==null&&(i.alternate=null,wv(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&js(l)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var gn=null,Cr=!1;function Ta(i,l,u){for(u=u.child;u!==null;)Sv(i,l,u),u=u.sibling}function Sv(i,l,u){if(He&&typeof He.onCommitFiberUnmount=="function")try{He.onCommitFiberUnmount(je,u)}catch{}switch(u.tag){case 26:Ln||Ui(u,l),Ta(i,l,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Ln||Ui(u,l);var f=gn,y=Cr;gl(u.type)&&(gn=u.stateNode,Cr=!1),Ta(i,l,u),Xu(u.stateNode),gn=f,Cr=y;break;case 5:Ln||Ui(u,l);case 6:if(f=gn,y=Cr,gn=null,Ta(i,l,u),gn=f,Cr=y,gn!==null)if(Cr)try{(gn.nodeType===9?gn.body:gn.nodeName==="HTML"?gn.ownerDocument.body:gn).removeChild(u.stateNode)}catch(x){Kt(u,l,x)}else try{gn.removeChild(u.stateNode)}catch(x){Kt(u,l,x)}break;case 18:gn!==null&&(Cr?(i=gn,mb(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),ko(i)):mb(gn,u.stateNode));break;case 4:f=gn,y=Cr,gn=u.stateNode.containerInfo,Cr=!0,Ta(i,l,u),gn=f,Cr=y;break;case 0:case 11:case 14:case 15:ul(2,u,l),Ln||ul(4,u,l),Ta(i,l,u);break;case 1:Ln||(Ui(u,l),f=u.stateNode,typeof f.componentWillUnmount=="function"&&gv(u,l,f)),Ta(i,l,u);break;case 21:Ta(i,l,u);break;case 22:Ln=(f=Ln)||u.memoizedState!==null,Ta(i,l,u),Ln=f;break;default:Ta(i,l,u)}}function Cv(i,l){if(l.memoizedState===null&&(i=l.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{ko(i)}catch(u){Kt(l,l.return,u)}}}function Av(i,l){if(l.memoizedState===null&&(i=l.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ko(i)}catch(u){Kt(l,l.return,u)}}function bA(i){switch(i.tag){case 31:case 13:case 19:var l=i.stateNode;return l===null&&(l=i.stateNode=new bv),l;case 22:return i=i.stateNode,l=i._retryCache,l===null&&(l=i._retryCache=new bv),l;default:throw Error(r(435,i.tag))}}function Vh(i,l){var u=bA(i);l.forEach(function(f){if(!u.has(f)){u.add(f);var y=MA.bind(null,i,f);f.then(y,y)}})}function Ar(i,l){var u=l.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f],x=i,T=l,_=T;e:for(;_!==null;){switch(_.tag){case 27:if(gl(_.type)){gn=_.stateNode,Cr=!1;break e}break;case 5:gn=_.stateNode,Cr=!1;break e;case 3:case 4:gn=_.stateNode.containerInfo,Cr=!0;break e}_=_.return}if(gn===null)throw Error(r(160));Sv(x,T,y),gn=null,Cr=!1,x=y.alternate,x!==null&&(x.return=null),y.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Tv(l,i),l=l.sibling}var bi=null;function Tv(i,l){var u=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Ar(l,i),Tr(i),f&4&&(ul(3,i,i.return),Hu(3,i),ul(5,i,i.return));break;case 1:Ar(l,i),Tr(i),f&512&&(Ln||u===null||Ui(u,u.return)),f&64&&Aa&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var y=bi;if(Ar(l,i),Tr(i),f&512&&(Ln||u===null||Ui(u,u.return)),f&4){var x=u!==null?u.memoizedState:null;if(f=i.memoizedState,u===null)if(f===null)if(i.stateNode===null){e:{f=i.type,u=i.memoizedProps,y=y.ownerDocument||y;t:switch(f){case"title":x=y.getElementsByTagName("title")[0],(!x||x[Or]||x[an]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=y.createElement(f),y.head.insertBefore(x,y.querySelector("head > title"))),tr(x,f,u),x[an]=i,An(x),f=x;break e;case"link":var T=Tb("link","href",y).get(f+(u.href||""));if(T){for(var _=0;_<T.length;_++)if(x=T[_],x.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&x.getAttribute("rel")===(u.rel==null?null:u.rel)&&x.getAttribute("title")===(u.title==null?null:u.title)&&x.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){T.splice(_,1);break t}}x=y.createElement(f),tr(x,f,u),y.head.appendChild(x);break;case"meta":if(T=Tb("meta","content",y).get(f+(u.content||""))){for(_=0;_<T.length;_++)if(x=T[_],x.getAttribute("content")===(u.content==null?null:""+u.content)&&x.getAttribute("name")===(u.name==null?null:u.name)&&x.getAttribute("property")===(u.property==null?null:u.property)&&x.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&x.getAttribute("charset")===(u.charSet==null?null:u.charSet)){T.splice(_,1);break t}}x=y.createElement(f),tr(x,f,u),y.head.appendChild(x);break;default:throw Error(r(468,f))}x[an]=i,An(x),f=x}i.stateNode=f}else Nb(y,i.type,i.stateNode);else i.stateNode=Ab(y,f,i.memoizedProps);else x!==f?(x===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):x.count--,f===null?Nb(y,i.type,i.stateNode):Ab(y,f,i.memoizedProps)):f===null&&i.stateNode!==null&&em(i,i.memoizedProps,u.memoizedProps)}break;case 27:Ar(l,i),Tr(i),f&512&&(Ln||u===null||Ui(u,u.return)),u!==null&&f&4&&em(i,i.memoizedProps,u.memoizedProps);break;case 5:if(Ar(l,i),Tr(i),f&512&&(Ln||u===null||Ui(u,u.return)),i.flags&32){y=i.stateNode;try{sa(y,"")}catch(et){Kt(i,i.return,et)}}f&4&&i.stateNode!=null&&(y=i.memoizedProps,em(i,y,u!==null?u.memoizedProps:y)),f&1024&&(rm=!0);break;case 6:if(Ar(l,i),Tr(i),f&4){if(i.stateNode===null)throw Error(r(162));f=i.memoizedProps,u=i.stateNode;try{u.nodeValue=f}catch(et){Kt(i,i.return,et)}}break;case 3:if(lf=null,y=bi,bi=rf(l.containerInfo),Ar(l,i),bi=y,Tr(i),f&4&&u!==null&&u.memoizedState.isDehydrated)try{ko(l.containerInfo)}catch(et){Kt(i,i.return,et)}rm&&(rm=!1,Nv(i));break;case 4:f=bi,bi=rf(i.stateNode.containerInfo),Ar(l,i),Tr(i),bi=f;break;case 12:Ar(l,i),Tr(i);break;case 31:Ar(l,i),Tr(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Vh(i,f)));break;case 13:Ar(l,i),Tr(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Kh=Pt()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Vh(i,f)));break;case 22:y=i.memoizedState!==null;var V=u!==null&&u.memoizedState!==null,ce=Aa,we=Ln;if(Aa=ce||y,Ln=we||V,Ar(l,i),Ln=we,Aa=ce,Tr(i),f&8192)e:for(l=i.stateNode,l._visibility=y?l._visibility&-2:l._visibility|1,y&&(u===null||V||Aa||Ln||ps(i)),u=null,l=i;;){if(l.tag===5||l.tag===26){if(u===null){V=u=l;try{if(x=V.stateNode,y)T=x.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{_=V.stateNode;var Me=V.memoizedProps.style,de=Me!=null&&Me.hasOwnProperty("display")?Me.display:null;_.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(et){Kt(V,V.return,et)}}}else if(l.tag===6){if(u===null){V=l;try{V.stateNode.nodeValue=y?"":V.memoizedProps}catch(et){Kt(V,V.return,et)}}}else if(l.tag===18){if(u===null){V=l;try{var xe=V.stateNode;y?gb(xe,!0):gb(V.stateNode,!1)}catch(et){Kt(V,V.return,et)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===i)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break e;for(;l.sibling===null;){if(l.return===null||l.return===i)break e;u===l&&(u=null),l=l.return}u===l&&(u=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=i.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,Vh(i,u))));break;case 19:Ar(l,i),Tr(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Vh(i,f)));break;case 30:break;case 21:break;default:Ar(l,i),Tr(i)}}function Tr(i){var l=i.flags;if(l&2){try{for(var u,f=i.return;f!==null;){if(xv(f)){u=f;break}f=f.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var y=u.stateNode,x=tm(i);Uh(i,x,y);break;case 5:var T=u.stateNode;u.flags&32&&(sa(T,""),u.flags&=-33);var _=tm(i);Uh(i,_,T);break;case 3:case 4:var V=u.stateNode.containerInfo,ce=tm(i);nm(i,ce,V);break;default:throw Error(r(161))}}catch(we){Kt(i,i.return,we)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function Nv(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var l=i;Nv(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),i=i.sibling}}function Na(i,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)kv(i,l.alternate,l),l=l.sibling}function ps(i){for(i=i.child;i!==null;){var l=i;switch(l.tag){case 0:case 11:case 14:case 15:ul(4,l,l.return),ps(l);break;case 1:Ui(l,l.return);var u=l.stateNode;typeof u.componentWillUnmount=="function"&&gv(l,l.return,u),ps(l);break;case 27:Xu(l.stateNode);case 26:case 5:Ui(l,l.return),ps(l);break;case 22:l.memoizedState===null&&ps(l);break;case 30:ps(l);break;default:ps(l)}i=i.sibling}}function Ea(i,l,u){for(u=u&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,y=i,x=l,T=x.flags;switch(x.tag){case 0:case 11:case 15:Ea(y,x,u),Hu(4,x);break;case 1:if(Ea(y,x,u),f=x,y=f.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(ce){Kt(f,f.return,ce)}if(f=x,y=f.updateQueue,y!==null){var _=f.stateNode;try{var V=y.shared.hiddenCallbacks;if(V!==null)for(y.shared.hiddenCallbacks=null,y=0;y<V.length;y++)ix(V[y],_)}catch(ce){Kt(f,f.return,ce)}}u&&T&64&&mv(x),qu(x,x.return);break;case 27:vv(x);case 26:case 5:Ea(y,x,u),u&&f===null&&T&4&&yv(x),qu(x,x.return);break;case 12:Ea(y,x,u);break;case 31:Ea(y,x,u),u&&T&4&&Cv(y,x);break;case 13:Ea(y,x,u),u&&T&4&&Av(y,x);break;case 22:x.memoizedState===null&&Ea(y,x,u),qu(x,x.return);break;case 30:break;default:Ea(y,x,u)}l=l.sibling}}function im(i,l){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(i=l.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&Nu(u))}function am(i,l){i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&Nu(i))}function ki(i,l,u,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Ev(i,l,u,f),l=l.sibling}function Ev(i,l,u,f){var y=l.flags;switch(l.tag){case 0:case 11:case 15:ki(i,l,u,f),y&2048&&Hu(9,l);break;case 1:ki(i,l,u,f);break;case 3:ki(i,l,u,f),y&2048&&(i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&Nu(i)));break;case 12:if(y&2048){ki(i,l,u,f),i=l.stateNode;try{var x=l.memoizedProps,T=x.id,_=x.onPostCommit;typeof _=="function"&&_(T,l.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(V){Kt(l,l.return,V)}}else ki(i,l,u,f);break;case 31:ki(i,l,u,f);break;case 13:ki(i,l,u,f);break;case 23:break;case 22:x=l.stateNode,T=l.alternate,l.memoizedState!==null?x._visibility&2?ki(i,l,u,f):Uu(i,l):x._visibility&2?ki(i,l,u,f):(x._visibility|=2,uo(i,l,u,f,(l.subtreeFlags&10256)!==0||!1)),y&2048&&im(T,l);break;case 24:ki(i,l,u,f),y&2048&&am(l.alternate,l);break;default:ki(i,l,u,f)}}function uo(i,l,u,f,y){for(y=y&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var x=i,T=l,_=u,V=f,ce=T.flags;switch(T.tag){case 0:case 11:case 15:uo(x,T,_,V,y),Hu(8,T);break;case 23:break;case 22:var we=T.stateNode;T.memoizedState!==null?we._visibility&2?uo(x,T,_,V,y):Uu(x,T):(we._visibility|=2,uo(x,T,_,V,y)),y&&ce&2048&&im(T.alternate,T);break;case 24:uo(x,T,_,V,y),y&&ce&2048&&am(T.alternate,T);break;default:uo(x,T,_,V,y)}l=l.sibling}}function Uu(i,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var u=i,f=l,y=f.flags;switch(f.tag){case 22:Uu(u,f),y&2048&&im(f.alternate,f);break;case 24:Uu(u,f),y&2048&&am(f.alternate,f);break;default:Uu(u,f)}l=l.sibling}}var Vu=8192;function co(i,l,u){if(i.subtreeFlags&Vu)for(i=i.child;i!==null;)Mv(i,l,u),i=i.sibling}function Mv(i,l,u){switch(i.tag){case 26:co(i,l,u),i.flags&Vu&&i.memoizedState!==null&&l4(u,bi,i.memoizedState,i.memoizedProps);break;case 5:co(i,l,u);break;case 3:case 4:var f=bi;bi=rf(i.stateNode.containerInfo),co(i,l,u),bi=f;break;case 22:i.memoizedState===null&&(f=i.alternate,f!==null&&f.memoizedState!==null?(f=Vu,Vu=16777216,co(i,l,u),Vu=f):co(i,l,u));break;default:co(i,l,u)}}function jv(i){var l=i.alternate;if(l!==null&&(i=l.child,i!==null)){l.child=null;do l=i.sibling,i.sibling=null,i=l;while(i!==null)}}function Fu(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var u=0;u<l.length;u++){var f=l[u];$n=f,Dv(f,i)}jv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)_v(i),i=i.sibling}function _v(i){switch(i.tag){case 0:case 11:case 15:Fu(i),i.flags&2048&&ul(9,i,i.return);break;case 3:Fu(i);break;case 12:Fu(i);break;case 22:var l=i.stateNode;i.memoizedState!==null&&l._visibility&2&&(i.return===null||i.return.tag!==13)?(l._visibility&=-3,Fh(i)):Fu(i);break;default:Fu(i)}}function Fh(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var u=0;u<l.length;u++){var f=l[u];$n=f,Dv(f,i)}jv(i)}for(i=i.child;i!==null;){switch(l=i,l.tag){case 0:case 11:case 15:ul(8,l,l.return),Fh(l);break;case 22:u=l.stateNode,u._visibility&2&&(u._visibility&=-3,Fh(l));break;default:Fh(l)}i=i.sibling}}function Dv(i,l){for(;$n!==null;){var u=$n;switch(u.tag){case 0:case 11:case 15:ul(8,u,l);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Nu(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,$n=f;else e:for(u=i;$n!==null;){f=$n;var y=f.sibling,x=f.return;if(wv(f),f===u){$n=null;break e}if(y!==null){y.return=x,$n=y;break e}$n=x}}}var kA={getCacheForType:function(i){var l=Jn(Dn),u=l.data.get(i);return u===void 0&&(u=i(),l.data.set(i,u)),u},cacheSignal:function(){return Jn(Dn).controller.signal}},wA=typeof WeakMap=="function"?WeakMap:Map,qt=0,tn=null,St=null,Tt=0,Ft=0,Pr=null,cl=!1,ho=!1,lm=!1,Ma=0,kn=0,hl=0,ms=0,sm=0,Hr=0,fo=0,Ku=null,Nr=null,om=!1,Kh=0,Ov=0,Gh=1/0,Yh=null,fl=null,Hn=0,dl=null,po=null,ja=0,um=0,cm=null,Rv=null,Gu=0,hm=null;function qr(){return(qt&2)!==0&&Tt!==0?Tt&-Tt:X.T!==null?ym():Vl()}function Lv(){if(Hr===0)if((Tt&536870912)===0||jt){var i=Ha;Ha<<=1,(Ha&3932160)===0&&(Ha=262144),Hr=i}else Hr=536870912;return i=zr.current,i!==null&&(i.flags|=32),Hr}function Er(i,l,u){(i===tn&&(Ft===2||Ft===9)||i.cancelPendingCommit!==null)&&(mo(i,0),pl(i,Tt,Hr,!1)),Yr(i,u),((qt&2)===0||i!==tn)&&(i===tn&&((qt&2)===0&&(ms|=u),kn===4&&pl(i,Tt,Hr,!1)),Vi(i))}function Bv(i,l,u){if((qt&6)!==0)throw Error(r(327));var f=!u&&(l&127)===0&&(l&i.expiredLanes)===0||ia(i,l),y=f?AA(i,l):dm(i,l,!0),x=f;do{if(y===0){ho&&!f&&pl(i,l,0,!1);break}else{if(u=i.current.alternate,x&&!SA(u)){y=dm(i,l,!1),x=!1;continue}if(y===2){if(x=l,i.errorRecoveryDisabledLanes&x)var T=0;else T=i.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){l=T;e:{var _=i;y=Ku;var V=_.current.memoizedState.isDehydrated;if(V&&(mo(_,T).flags|=256),T=dm(_,T,!1),T!==2){if(lm&&!V){_.errorRecoveryDisabledLanes|=x,ms|=x,y=4;break e}x=Nr,Nr=y,x!==null&&(Nr===null?Nr=x:Nr.push.apply(Nr,x))}y=T}if(x=!1,y!==2)continue}}if(y===1){mo(i,0),pl(i,l,0,!0);break}e:{switch(f=i,x=y,x){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:pl(f,l,Hr,!cl);break e;case 2:Nr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(y=Kh+300-Pt(),10<y)){if(pl(f,l,Hr,!cl),ql(f,0,!0)!==0)break e;ja=l,f.timeoutHandle=db(zv.bind(null,f,u,Nr,Yh,om,l,Hr,ms,fo,cl,x,"Throttled",-0,0),y);break e}zv(f,u,Nr,Yh,om,l,Hr,ms,fo,cl,x,null,-0,0)}}break}while(!0);Vi(i)}function zv(i,l,u,f,y,x,T,_,V,ce,we,Me,de,xe){if(i.timeoutHandle=-1,Me=l.subtreeFlags,Me&8192||(Me&16785408)===16785408){Me={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Sr},Mv(l,x,Me);var et=(x&62914560)===x?Kh-Pt():(x&4194048)===x?Ov-Pt():0;if(et=s4(Me,et),et!==null){ja=x,i.cancelPendingCommit=et(Kv.bind(null,i,l,x,u,f,y,T,_,V,we,Me,null,de,xe)),pl(i,x,T,!ce);return}}Kv(i,l,x,u,f,y,T,_,V)}function SA(i){for(var l=i;;){var u=l.tag;if((u===0||u===11||u===15)&&l.flags&16384&&(u=l.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var y=u[f],x=y.getSnapshot;y=y.value;try{if(!cr(x(),y))return!1}catch{return!1}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function pl(i,l,u,f){l&=~sm,l&=~ms,i.suspendedLanes|=l,i.pingedLanes&=~l,f&&(i.warmLanes|=l),f=i.expirationTimes;for(var y=l;0<y;){var x=31-Se(y),T=1<<x;f[x]=-1,y&=~T}u!==0&&Ul(i,u,l)}function $h(){return(qt&6)===0?(Yu(0),!1):!0}function fm(){if(St!==null){if(Ft===0)var i=St.return;else i=St,va=ls=null,Ep(i),io=null,Mu=0,i=St;for(;i!==null;)pv(i.alternate,i),i=i.return;St=null}}function mo(i,l){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,VA(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),ja=0,fm(),tn=i,St=u=ya(i.current,null),Tt=l,Ft=0,Pr=null,cl=!1,ho=ia(i,l),lm=!1,fo=Hr=sm=ms=hl=kn=0,Nr=Ku=null,om=!1,(l&8)!==0&&(l|=l&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=l;0<f;){var y=31-Se(f),x=1<<y;l|=i[y],f&=~x}return Ma=l,gt(),u}function Iv(i,l){yt=null,X.H=zu,l===ro||l===Sh?(l=ex(),Ft=3):l===gp?(l=ex(),Ft=4):Ft=l===Fp?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Pr=l,St===null&&(kn=1,zh(i,Zr(l,i.current)))}function Pv(){var i=zr.current;return i===null?!0:(Tt&4194048)===Tt?ni===null:(Tt&62914560)===Tt||(Tt&536870912)!==0?i===ni:!1}function Hv(){var i=X.H;return X.H=zu,i===null?zu:i}function qv(){var i=X.A;return X.A=kA,i}function Qh(){kn=4,cl||(Tt&4194048)!==Tt&&zr.current!==null||(ho=!0),(hl&134217727)===0&&(ms&134217727)===0||tn===null||pl(tn,Tt,Hr,!1)}function dm(i,l,u){var f=qt;qt|=2;var y=Hv(),x=qv();(tn!==i||Tt!==l)&&(Yh=null,mo(i,l)),l=!1;var T=kn;e:do try{if(Ft!==0&&St!==null){var _=St,V=Pr;switch(Ft){case 8:fm(),T=6;break e;case 3:case 2:case 9:case 6:zr.current===null&&(l=!0);var ce=Ft;if(Ft=0,Pr=null,go(i,_,V,ce),u&&ho){T=0;break e}break;default:ce=Ft,Ft=0,Pr=null,go(i,_,V,ce)}}CA(),T=kn;break}catch(we){Iv(i,we)}while(!0);return l&&i.shellSuspendCounter++,va=ls=null,qt=f,X.H=y,X.A=x,St===null&&(tn=null,Tt=0,gt()),T}function CA(){for(;St!==null;)Uv(St)}function AA(i,l){var u=qt;qt|=2;var f=Hv(),y=qv();tn!==i||Tt!==l?(Yh=null,Gh=Pt()+500,mo(i,l)):ho=ia(i,l);e:do try{if(Ft!==0&&St!==null){l=St;var x=Pr;t:switch(Ft){case 1:Ft=0,Pr=null,go(i,l,x,1);break;case 2:case 9:if(Zy(x)){Ft=0,Pr=null,Vv(l);break}l=function(){Ft!==2&&Ft!==9||tn!==i||(Ft=7),Vi(i)},x.then(l,l);break e;case 3:Ft=7;break e;case 4:Ft=5;break e;case 7:Zy(x)?(Ft=0,Pr=null,Vv(l)):(Ft=0,Pr=null,go(i,l,x,7));break;case 5:var T=null;switch(St.tag){case 26:T=St.memoizedState;case 5:case 27:var _=St;if(T?Eb(T):_.stateNode.complete){Ft=0,Pr=null;var V=_.sibling;if(V!==null)St=V;else{var ce=_.return;ce!==null?(St=ce,Xh(ce)):St=null}break t}}Ft=0,Pr=null,go(i,l,x,5);break;case 6:Ft=0,Pr=null,go(i,l,x,6);break;case 8:fm(),kn=6;break e;default:throw Error(r(462))}}TA();break}catch(we){Iv(i,we)}while(!0);return va=ls=null,X.H=f,X.A=y,qt=u,St!==null?0:(tn=null,Tt=0,gt(),kn)}function TA(){for(;St!==null&&!Rt();)Uv(St)}function Uv(i){var l=fv(i.alternate,i,Ma);i.memoizedProps=i.pendingProps,l===null?Xh(i):St=l}function Vv(i){var l=i,u=l.alternate;switch(l.tag){case 15:case 0:l=lv(u,l,l.pendingProps,l.type,void 0,Tt);break;case 11:l=lv(u,l,l.pendingProps,l.type.render,l.ref,Tt);break;case 5:Ep(l);default:pv(u,l),l=St=qy(l,Ma),l=fv(u,l,Ma)}i.memoizedProps=i.pendingProps,l===null?Xh(i):St=l}function go(i,l,u,f){va=ls=null,Ep(l),io=null,Mu=0;var y=l.return;try{if(pA(i,y,l,u,Tt)){kn=1,zh(i,Zr(u,i.current)),St=null;return}}catch(x){if(y!==null)throw St=y,x;kn=1,zh(i,Zr(u,i.current)),St=null;return}l.flags&32768?(jt||f===1?i=!0:ho||(Tt&536870912)!==0?i=!1:(cl=i=!0,(f===2||f===9||f===3||f===6)&&(f=zr.current,f!==null&&f.tag===13&&(f.flags|=16384))),Fv(l,i)):Xh(l)}function Xh(i){var l=i;do{if((l.flags&32768)!==0){Fv(l,cl);return}i=l.return;var u=yA(l.alternate,l,Ma);if(u!==null){St=u;return}if(l=l.sibling,l!==null){St=l;return}St=l=i}while(l!==null);kn===0&&(kn=5)}function Fv(i,l){do{var u=xA(i.alternate,i);if(u!==null){u.flags&=32767,St=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!l&&(i=i.sibling,i!==null)){St=i;return}St=i=u}while(i!==null);kn=6,St=null}function Kv(i,l,u,f,y,x,T,_,V){i.cancelPendingCommit=null;do Wh();while(Hn!==0);if((qt&6)!==0)throw Error(r(327));if(l!==null){if(l===i.current)throw Error(r(177));if(x=l.lanes|l.childLanes,x|=at,ru(i,u,x,T,_,V),i===tn&&(St=tn=null,Tt=0),po=l,dl=i,ja=u,um=x,cm=y,Rv=f,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,jA(Ke,function(){return Xv(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||f){f=X.T,X.T=null,y=ve.p,ve.p=2,T=qt,qt|=4;try{vA(i,l,u)}finally{qt=T,ve.p=y,X.T=f}}Hn=1,Gv(),Yv(),$v()}}function Gv(){if(Hn===1){Hn=0;var i=dl,l=po,u=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||u){u=X.T,X.T=null;var f=ve.p;ve.p=2;var y=qt;qt|=4;try{Tv(l,i);var x=Am,T=N(i.containerInfo),_=x.focusedElem,V=x.selectionRange;if(T!==_&&_&&_.ownerDocument&&C(_.ownerDocument.documentElement,_)){if(V!==null&&M(_)){var ce=V.start,we=V.end;if(we===void 0&&(we=ce),"selectionStart"in _)_.selectionStart=ce,_.selectionEnd=Math.min(we,_.value.length);else{var Me=_.ownerDocument||document,de=Me&&Me.defaultView||window;if(de.getSelection){var xe=de.getSelection(),et=_.textContent.length,ht=Math.min(V.start,et),Jt=V.end===void 0?ht:Math.min(V.end,et);!xe.extend&&ht>Jt&&(T=Jt,Jt=ht,ht=T);var ae=S(_,ht),W=S(_,Jt);if(ae&&W&&(xe.rangeCount!==1||xe.anchorNode!==ae.node||xe.anchorOffset!==ae.offset||xe.focusNode!==W.node||xe.focusOffset!==W.offset)){var ue=Me.createRange();ue.setStart(ae.node,ae.offset),xe.removeAllRanges(),ht>Jt?(xe.addRange(ue),xe.extend(W.node,W.offset)):(ue.setEnd(W.node,W.offset),xe.addRange(ue))}}}}for(Me=[],xe=_;xe=xe.parentNode;)xe.nodeType===1&&Me.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<Me.length;_++){var Ae=Me[_];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}cf=!!Cm,Am=Cm=null}finally{qt=y,ve.p=f,X.T=u}}i.current=l,Hn=2}}function Yv(){if(Hn===2){Hn=0;var i=dl,l=po,u=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||u){u=X.T,X.T=null;var f=ve.p;ve.p=2;var y=qt;qt|=4;try{kv(i,l.alternate,l)}finally{qt=y,ve.p=f,X.T=u}}Hn=3}}function $v(){if(Hn===4||Hn===3){Hn=0,$t();var i=dl,l=po,u=ja,f=Rv;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Hn=5:(Hn=0,po=dl=null,Qv(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(fl=null),qa(u),l=l.stateNode,He&&typeof He.onCommitFiberRoot=="function")try{He.onCommitFiberRoot(je,l,void 0,(l.current.flags&128)===128)}catch{}if(f!==null){l=X.T,y=ve.p,ve.p=2,X.T=null;try{for(var x=i.onRecoverableError,T=0;T<f.length;T++){var _=f[T];x(_.value,{componentStack:_.stack})}}finally{X.T=l,ve.p=y}}(ja&3)!==0&&Wh(),Vi(i),y=i.pendingLanes,(u&261930)!==0&&(y&42)!==0?i===hm?Gu++:(Gu=0,hm=i):Gu=0,Yu(0)}}function Qv(i,l){(i.pooledCacheLanes&=l)===0&&(l=i.pooledCache,l!=null&&(i.pooledCache=null,Nu(l)))}function Wh(){return Gv(),Yv(),$v(),Xv()}function Xv(){if(Hn!==5)return!1;var i=dl,l=um;um=0;var u=qa(ja),f=X.T,y=ve.p;try{ve.p=32>u?32:u,X.T=null,u=cm,cm=null;var x=dl,T=ja;if(Hn=0,po=dl=null,ja=0,(qt&6)!==0)throw Error(r(331));var _=qt;if(qt|=4,_v(x.current),Ev(x,x.current,T,u),qt=_,Yu(0,!1),He&&typeof He.onPostCommitFiberRoot=="function")try{He.onPostCommitFiberRoot(je,x)}catch{}return!0}finally{ve.p=y,X.T=f,Qv(i,l)}}function Wv(i,l,u){l=Zr(u,l),l=Vp(i.stateNode,l,2),i=ll(i,l,2),i!==null&&(Yr(i,2),Vi(i))}function Kt(i,l,u){if(i.tag===3)Wv(i,i,u);else for(;l!==null;){if(l.tag===3){Wv(l,i,u);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(fl===null||!fl.has(f))){i=Zr(u,i),u=Zx(2),f=ll(l,u,2),f!==null&&(Jx(u,f,l,i),Yr(f,2),Vi(f));break}}l=l.return}}function pm(i,l,u){var f=i.pingCache;if(f===null){f=i.pingCache=new wA;var y=new Set;f.set(l,y)}else y=f.get(l),y===void 0&&(y=new Set,f.set(l,y));y.has(u)||(lm=!0,y.add(u),i=NA.bind(null,i,l,u),l.then(i,i))}function NA(i,l,u){var f=i.pingCache;f!==null&&f.delete(l),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,tn===i&&(Tt&u)===u&&(kn===4||kn===3&&(Tt&62914560)===Tt&&300>Pt()-Kh?(qt&2)===0&&mo(i,0):sm|=u,fo===Tt&&(fo=0)),Vi(i)}function Zv(i,l){l===0&&(l=rh()),i=Vt(i,l),i!==null&&(Yr(i,l),Vi(i))}function EA(i){var l=i.memoizedState,u=0;l!==null&&(u=l.retryLane),Zv(i,u)}function MA(i,l){var u=0;switch(i.tag){case 31:case 13:var f=i.stateNode,y=i.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(l),Zv(i,u)}function jA(i,l){return Fn(i,l)}var Zh=null,yo=null,mm=!1,Jh=!1,gm=!1,ml=0;function Vi(i){i!==yo&&i.next===null&&(yo===null?Zh=yo=i:yo=yo.next=i),Jh=!0,mm||(mm=!0,DA())}function Yu(i,l){if(!gm&&Jh){gm=!0;do for(var u=!1,f=Zh;f!==null;){if(i!==0){var y=f.pendingLanes;if(y===0)var x=0;else{var T=f.suspendedLanes,_=f.pingedLanes;x=(1<<31-Se(42|i)+1)-1,x&=y&~(T&~_),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(u=!0,nb(f,x))}else x=Tt,x=ql(f,f===tn?x:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(x&3)===0||ia(f,x)||(u=!0,nb(f,x));f=f.next}while(u);gm=!1}}function _A(){Jv()}function Jv(){Jh=mm=!1;var i=0;ml!==0&&UA()&&(i=ml);for(var l=Pt(),u=null,f=Zh;f!==null;){var y=f.next,x=eb(f,l);x===0?(f.next=null,u===null?Zh=y:u.next=y,y===null&&(yo=u)):(u=f,(i!==0||(x&3)!==0)&&(Jh=!0)),f=y}Hn!==0&&Hn!==5||Yu(i),ml!==0&&(ml=0)}function eb(i,l){for(var u=i.suspendedLanes,f=i.pingedLanes,y=i.expirationTimes,x=i.pendingLanes&-62914561;0<x;){var T=31-Se(x),_=1<<T,V=y[T];V===-1?((_&u)===0||(_&f)!==0)&&(y[T]=$d(_,l)):V<=l&&(i.expiredLanes|=_),x&=~_}if(l=tn,u=Tt,u=ql(i,i===l?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,u===0||i===l&&(Ft===2||Ft===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&Pe(f),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||ia(i,u)){if(l=u&-u,l===i.callbackPriority)return l;switch(f!==null&&Pe(f),qa(u)){case 2:case 8:u=be;break;case 32:u=Ke;break;case 268435456:u=it;break;default:u=Ke}return f=tb.bind(null,i),u=Fn(u,f),i.callbackPriority=l,i.callbackNode=u,l}return f!==null&&f!==null&&Pe(f),i.callbackPriority=2,i.callbackNode=null,2}function tb(i,l){if(Hn!==0&&Hn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Wh()&&i.callbackNode!==u)return null;var f=Tt;return f=ql(i,i===tn?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(Bv(i,f,l),eb(i,Pt()),i.callbackNode!=null&&i.callbackNode===u?tb.bind(null,i):null)}function nb(i,l){if(Wh())return null;Bv(i,l,!0)}function DA(){FA(function(){(qt&6)!==0?Fn(ie,_A):Jv()})}function ym(){if(ml===0){var i=to;i===0&&(i=Ve,Ve<<=1,(Ve&261888)===0&&(Ve=256)),ml=i}return ml}function rb(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:vi(""+i)}function ib(i,l){var u=l.ownerDocument.createElement("input");return u.name=l.name,u.value=l.value,i.id&&u.setAttribute("form",i.id),l.parentNode.insertBefore(u,l),i=new FormData(i),u.parentNode.removeChild(u),i}function OA(i,l,u,f,y){if(l==="submit"&&u&&u.stateNode===y){var x=rb((y[Cn]||null).action),T=f.submitter;T&&(l=(l=T[Cn]||null)?rb(l.formAction):T.getAttribute("formAction"),l!==null&&(x=l,T=null));var _=new Ls("action","action",null,f,y);i.push({event:_,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(ml!==0){var V=T?ib(y,T):new FormData(y);zp(u,{pending:!0,data:V,method:y.method,action:x},null,V)}}else typeof x=="function"&&(_.preventDefault(),V=T?ib(y,T):new FormData(y),zp(u,{pending:!0,data:V,method:y.method,action:x},x,V))},currentTarget:y}]})}}for(var xm=0;xm<Ye.length;xm++){var vm=Ye[xm],RA=vm.toLowerCase(),LA=vm[0].toUpperCase()+vm.slice(1);Re(RA,"on"+LA)}Re(fe,"onAnimationEnd"),Re(se,"onAnimationIteration"),Re(ke,"onAnimationStart"),Re("dblclick","onDoubleClick"),Re("focusin","onFocus"),Re("focusout","onBlur"),Re(_e,"onTransitionRun"),Re(qe,"onTransitionStart"),Re(Ue,"onTransitionCancel"),Re(Oe,"onTransitionEnd"),Ri("onMouseEnter",["mouseout","mouseover"]),Ri("onMouseLeave",["mouseout","mouseover"]),Ri("onPointerEnter",["pointerout","pointerover"]),Ri("onPointerLeave",["pointerout","pointerover"]),yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),yi("onBeforeInput",["compositionend","keypress","textInput","paste"]),yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($u));function ab(i,l){l=(l&4)!==0;for(var u=0;u<i.length;u++){var f=i[u],y=f.event;f=f.listeners;e:{var x=void 0;if(l)for(var T=f.length-1;0<=T;T--){var _=f[T],V=_.instance,ce=_.currentTarget;if(_=_.listener,V!==x&&y.isPropagationStopped())break e;x=_,y.currentTarget=ce;try{x(y)}catch(we){We(we)}y.currentTarget=null,x=V}else for(T=0;T<f.length;T++){if(_=f[T],V=_.instance,ce=_.currentTarget,_=_.listener,V!==x&&y.isPropagationStopped())break e;x=_,y.currentTarget=ce;try{x(y)}catch(we){We(we)}y.currentTarget=null,x=V}}}}function Ct(i,l){var u=l[Ua];u===void 0&&(u=l[Ua]=new Set);var f=i+"__bubble";u.has(f)||(lb(l,i,2,!1),u.add(f))}function bm(i,l,u){var f=0;l&&(f|=4),lb(u,i,f,l)}var ef="_reactListening"+Math.random().toString(36).slice(2);function km(i){if(!i[ef]){i[ef]=!0,aa.forEach(function(u){u!=="selectionchange"&&(BA.has(u)||bm(u,!1,i),bm(u,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[ef]||(l[ef]=!0,bm("selectionchange",!1,l))}}function lb(i,l,u,f){switch(Lb(l)){case 2:var y=c4;break;case 8:y=h4;break;default:y=Bm}u=y.bind(null,l,u,i),y=void 0,!hu||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(y=!0),f?y!==void 0?i.addEventListener(l,u,{capture:!0,passive:y}):i.addEventListener(l,u,!0):y!==void 0?i.addEventListener(l,u,{passive:y}):i.addEventListener(l,u,!1)}function wm(i,l,u,f,y){var x=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var _=f.stateNode.containerInfo;if(_===y)break;if(T===4)for(T=f.return;T!==null;){var V=T.tag;if((V===3||V===4)&&T.stateNode.containerInfo===y)return;T=T.return}for(;_!==null;){if(T=Oi(_),T===null)return;if(V=T.tag,V===5||V===6||V===26||V===27){f=x=T;continue e}_=_.parentNode}}f=f.return}Fa(function(){var ce=x,we=Os(u),Me=[];e:{var de=Xe.get(i);if(de!==void 0){var xe=Ls,et=i;switch(i){case"keypress":if(Ya(u)===0)break e;case"keydown":case"keyup":xe=Us;break;case"focusin":et="focus",xe=$a;break;case"focusout":et="blur",xe=$a;break;case"beforeblur":case"afterblur":xe=$a;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=Is;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=sh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=xu;break;case fe:case se:case ke:xe=oh;break;case Oe:xe=vu;break;case"scroll":case"scrollend":xe=Bs;break;case"wheel":xe=Fs;break;case"copy":case"cut":case"paste":xe=Qa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=yu;break;case"toggle":case"beforetoggle":xe=hh}var ht=(l&4)!==0,Jt=!ht&&(i==="scroll"||i==="scrollend"),ae=ht?de!==null?de+"Capture":null:de;ht=[];for(var W=ce,ue;W!==null;){var Ae=W;if(ue=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||ue===null||ae===null||(Ae=ca(W,ae),Ae!=null&&ht.push(Qu(W,Ae,ue))),Jt)break;W=W.return}0<ht.length&&(de=new xe(de,et,null,u,we),Me.push({event:de,listeners:ht}))}}if((l&7)===0){e:{if(de=i==="mouseover"||i==="pointerover",xe=i==="mouseout"||i==="pointerout",de&&u!==Qr&&(et=u.relatedTarget||u.fromElement)&&(Oi(et)||et[gr]))break e;if((xe||de)&&(de=we.window===we?we:(de=we.ownerDocument)?de.defaultView||de.parentWindow:window,xe?(et=u.relatedTarget||u.toElement,xe=ce,et=et?Oi(et):null,et!==null&&(Jt=s(et),ht=et.tag,et!==Jt||ht!==5&&ht!==27&&ht!==6)&&(et=null)):(xe=null,et=ce),xe!==et)){if(ht=Is,Ae="onMouseLeave",ae="onMouseEnter",W="mouse",(i==="pointerout"||i==="pointerover")&&(ht=yu,Ae="onPointerLeave",ae="onPointerEnter",W="pointer"),Jt=xe==null?de:Rr(xe),ue=et==null?de:Rr(et),de=new ht(Ae,W+"leave",xe,u,we),de.target=Jt,de.relatedTarget=ue,Ae=null,Oi(we)===ce&&(ht=new ht(ae,W+"enter",et,u,we),ht.target=ue,ht.relatedTarget=Jt,Ae=ht),Jt=Ae,xe&&et)t:{for(ht=zA,ae=xe,W=et,ue=0,Ae=ae;Ae;Ae=ht(Ae))ue++;Ae=0;for(var st=W;st;st=ht(st))Ae++;for(;0<ue-Ae;)ae=ht(ae),ue--;for(;0<Ae-ue;)W=ht(W),Ae--;for(;ue--;){if(ae===W||W!==null&&ae===W.alternate){ht=ae;break t}ae=ht(ae),W=ht(W)}ht=null}else ht=null;xe!==null&&sb(Me,de,xe,ht,!1),et!==null&&Jt!==null&&sb(Me,Jt,et,ht,!0)}}e:{if(de=ce?Rr(ce):window,xe=de.nodeName&&de.nodeName.toLowerCase(),xe==="select"||xe==="input"&&de.type==="file")var Lt=rs;else if(Ys(de))if(Wr)Lt=Za;else{Lt=ga;var nt=yh}else xe=de.nodeName,!xe||xe.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ce&&cu(ce.elementType)&&(Lt=rs):Lt=Cu;if(Lt&&(Lt=Lt(i,ce))){Su(Me,Lt,u,we);break e}nt&&nt(i,de,ce),i==="focusout"&&ce&&de.type==="number"&&ce.memoizedProps.value!=null&&Ql(de,"number",de.value)}switch(nt=ce?Rr(ce):window,i){case"focusin":(Ys(nt)||nt.contentEditable==="true")&&(P=nt,K=ce,le=null);break;case"focusout":le=K=P=null;break;case"mousedown":G=!0;break;case"contextmenu":case"mouseup":case"dragend":G=!1,F(Me,u,we);break;case"selectionchange":if(R)break;case"keydown":case"keyup":F(Me,u,we)}var xt;if(ts)e:{switch(i){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else pa?wu(i,u)&&(Nt="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Nt="onCompositionStart");Nt&&(Ks&&u.locale!=="ko"&&(pa||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&pa&&(xt=Ga()):(Xr=we,Rs="value"in Xr?Xr.value:Xr.textContent,pa=!0)),nt=tf(ce,Nt),0<nt.length&&(Nt=new qs(Nt,i,null,u,we),Me.push({event:Nt,listeners:nt}),xt?Nt.data=xt:(xt=dh(u),xt!==null&&(Nt.data=xt)))),(xt=ep?ph(i,u):tp(i,u))&&(Nt=tf(ce,"onBeforeInput"),0<Nt.length&&(nt=new qs("onBeforeInput","beforeinput",null,u,we),Me.push({event:nt,listeners:Nt}),nt.data=xt)),OA(Me,i,ce,u,we)}ab(Me,l)})}function Qu(i,l,u){return{instance:i,listener:l,currentTarget:u}}function tf(i,l){for(var u=l+"Capture",f=[];i!==null;){var y=i,x=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||x===null||(y=ca(i,u),y!=null&&f.unshift(Qu(i,y,x)),y=ca(i,l),y!=null&&f.push(Qu(i,y,x))),i.tag===3)return f;i=i.return}return[]}function zA(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function sb(i,l,u,f,y){for(var x=l._reactName,T=[];u!==null&&u!==f;){var _=u,V=_.alternate,ce=_.stateNode;if(_=_.tag,V!==null&&V===f)break;_!==5&&_!==26&&_!==27||ce===null||(V=ce,y?(ce=ca(u,x),ce!=null&&T.unshift(Qu(u,ce,V))):y||(ce=ca(u,x),ce!=null&&T.push(Qu(u,ce,V)))),u=u.return}T.length!==0&&i.push({event:l,listeners:T})}var IA=/\r\n?/g,PA=/\u0000|\uFFFD/g;function ob(i){return(typeof i=="string"?i:""+i).replace(IA,`
`).replace(PA,"")}function ub(i,l){return l=ob(l),ob(i)===l}function Zt(i,l,u,f,y,x){switch(u){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||sa(i,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&sa(i,""+f);break;case"className":Yl(i,"class",f);break;case"tabIndex":Yl(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Yl(i,u,f);break;case"style":uu(i,f,x);break;case"data":if(l!=="object"){Yl(i,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||u!=="href")){i.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(u);break}f=vi(""+f),i.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(u==="formAction"?(l!=="input"&&Zt(i,l,"name",y.name,y,null),Zt(i,l,"formEncType",y.formEncType,y,null),Zt(i,l,"formMethod",y.formMethod,y,null),Zt(i,l,"formTarget",y.formTarget,y,null)):(Zt(i,l,"encType",y.encType,y,null),Zt(i,l,"method",y.method,y,null),Zt(i,l,"target",y.target,y,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(u);break}f=vi(""+f),i.setAttribute(u,f);break;case"onClick":f!=null&&(i.onclick=Sr);break;case"onScroll":f!=null&&Ct("scroll",i);break;case"onScrollEnd":f!=null&&Ct("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}u=vi(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,""+f):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":f===!0?i.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,f):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(u,f):i.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(u):i.setAttribute(u,f);break;case"popover":Ct("beforetoggle",i),Ct("toggle",i),bt(i,"popover",f);break;case"xlinkActuate":$r(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":$r(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":$r(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":$r(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":$r(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":$r(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":$r(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":$r(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":$r(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":bt(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Wd.get(u)||u,bt(i,u,f))}}function Sm(i,l,u,f,y,x){switch(u){case"style":uu(i,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"children":typeof f=="string"?sa(i,f):(typeof f=="number"||typeof f=="bigint")&&sa(i,""+f);break;case"onScroll":f!=null&&Ct("scroll",i);break;case"onScrollEnd":f!=null&&Ct("scrollend",i);break;case"onClick":f!=null&&(i.onclick=Sr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kl.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),l=u.slice(2,y?u.length-7:void 0),x=i[Cn]||null,x=x!=null?x[u]:null,typeof x=="function"&&i.removeEventListener(l,x,y),typeof f=="function")){typeof x!="function"&&x!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(l,f,y);break e}u in i?i[u]=f:f===!0?i.setAttribute(u,""):bt(i,u,f)}}}function tr(i,l,u){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ct("error",i),Ct("load",i);var f=!1,y=!1,x;for(x in u)if(u.hasOwnProperty(x)){var T=u[x];if(T!=null)switch(x){case"src":f=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Zt(i,l,x,T,u,null)}}y&&Zt(i,l,"srcSet",u.srcSet,u,null),f&&Zt(i,l,"src",u.src,u,null);return;case"input":Ct("invalid",i);var _=x=T=y=null,V=null,ce=null;for(f in u)if(u.hasOwnProperty(f)){var we=u[f];if(we!=null)switch(f){case"name":y=we;break;case"type":T=we;break;case"checked":V=we;break;case"defaultChecked":ce=we;break;case"value":x=we;break;case"defaultValue":_=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(r(137,l));break;default:Zt(i,l,f,we,u,null)}}Ds(i,x,_,V,ce,T,y,!1);return;case"select":Ct("invalid",i),f=T=x=null;for(y in u)if(u.hasOwnProperty(y)&&(_=u[y],_!=null))switch(y){case"value":x=_;break;case"defaultValue":T=_;break;case"multiple":f=_;default:Zt(i,l,y,_,u,null)}l=x,u=T,i.multiple=!!f,l!=null?xi(i,!!f,l,!1):u!=null&&xi(i,!!f,u,!0);return;case"textarea":Ct("invalid",i),x=y=f=null;for(T in u)if(u.hasOwnProperty(T)&&(_=u[T],_!=null))switch(T){case"value":f=_;break;case"defaultValue":y=_;break;case"children":x=_;break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(r(91));break;default:Zt(i,l,T,_,u,null)}Xl(i,f,y,x);return;case"option":for(V in u)u.hasOwnProperty(V)&&(f=u[V],f!=null)&&(V==="selected"?i.selected=f&&typeof f!="function"&&typeof f!="symbol":Zt(i,l,V,f,u,null));return;case"dialog":Ct("beforetoggle",i),Ct("toggle",i),Ct("cancel",i),Ct("close",i);break;case"iframe":case"object":Ct("load",i);break;case"video":case"audio":for(f=0;f<$u.length;f++)Ct($u[f],i);break;case"image":Ct("error",i),Ct("load",i);break;case"details":Ct("toggle",i);break;case"embed":case"source":case"link":Ct("error",i),Ct("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in u)if(u.hasOwnProperty(ce)&&(f=u[ce],f!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:Zt(i,l,ce,f,u,null)}return;default:if(cu(l)){for(we in u)u.hasOwnProperty(we)&&(f=u[we],f!==void 0&&Sm(i,l,we,f,u,void 0));return}}for(_ in u)u.hasOwnProperty(_)&&(f=u[_],f!=null&&Zt(i,l,_,f,u,null))}function HA(i,l,u,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,x=null,T=null,_=null,V=null,ce=null,we=null;for(xe in u){var Me=u[xe];if(u.hasOwnProperty(xe)&&Me!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":V=Me;default:f.hasOwnProperty(xe)||Zt(i,l,xe,null,f,Me)}}for(var de in f){var xe=f[de];if(Me=u[de],f.hasOwnProperty(de)&&(xe!=null||Me!=null))switch(de){case"type":x=xe;break;case"name":y=xe;break;case"checked":ce=xe;break;case"defaultChecked":we=xe;break;case"value":T=xe;break;case"defaultValue":_=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(137,l));break;default:xe!==Me&&Zt(i,l,de,xe,f,Me)}}Li(i,T,_,V,ce,we,x,y);return;case"select":xe=T=_=de=null;for(x in u)if(V=u[x],u.hasOwnProperty(x)&&V!=null)switch(x){case"value":break;case"multiple":xe=V;default:f.hasOwnProperty(x)||Zt(i,l,x,null,f,V)}for(y in f)if(x=f[y],V=u[y],f.hasOwnProperty(y)&&(x!=null||V!=null))switch(y){case"value":de=x;break;case"defaultValue":_=x;break;case"multiple":T=x;default:x!==V&&Zt(i,l,y,x,f,V)}l=_,u=T,f=xe,de!=null?xi(i,!!u,de,!1):!!f!=!!u&&(l!=null?xi(i,!!u,l,!0):xi(i,!!u,u?[]:"",!1));return;case"textarea":xe=de=null;for(_ in u)if(y=u[_],u.hasOwnProperty(_)&&y!=null&&!f.hasOwnProperty(_))switch(_){case"value":break;case"children":break;default:Zt(i,l,_,null,f,y)}for(T in f)if(y=f[T],x=u[T],f.hasOwnProperty(T)&&(y!=null||x!=null))switch(T){case"value":de=y;break;case"defaultValue":xe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==x&&Zt(i,l,T,y,f,x)}ou(i,de,xe);return;case"option":for(var et in u)de=u[et],u.hasOwnProperty(et)&&de!=null&&!f.hasOwnProperty(et)&&(et==="selected"?i.selected=!1:Zt(i,l,et,null,f,de));for(V in f)de=f[V],xe=u[V],f.hasOwnProperty(V)&&de!==xe&&(de!=null||xe!=null)&&(V==="selected"?i.selected=de&&typeof de!="function"&&typeof de!="symbol":Zt(i,l,V,de,f,xe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ht in u)de=u[ht],u.hasOwnProperty(ht)&&de!=null&&!f.hasOwnProperty(ht)&&Zt(i,l,ht,null,f,de);for(ce in f)if(de=f[ce],xe=u[ce],f.hasOwnProperty(ce)&&de!==xe&&(de!=null||xe!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,l));break;default:Zt(i,l,ce,de,f,xe)}return;default:if(cu(l)){for(var Jt in u)de=u[Jt],u.hasOwnProperty(Jt)&&de!==void 0&&!f.hasOwnProperty(Jt)&&Sm(i,l,Jt,void 0,f,de);for(we in f)de=f[we],xe=u[we],!f.hasOwnProperty(we)||de===xe||de===void 0&&xe===void 0||Sm(i,l,we,de,f,xe);return}}for(var ae in u)de=u[ae],u.hasOwnProperty(ae)&&de!=null&&!f.hasOwnProperty(ae)&&Zt(i,l,ae,null,f,de);for(Me in f)de=f[Me],xe=u[Me],!f.hasOwnProperty(Me)||de===xe||de==null&&xe==null||Zt(i,l,Me,de,f,xe)}function cb(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function qA(){if(typeof performance.getEntriesByType=="function"){for(var i=0,l=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var y=u[f],x=y.transferSize,T=y.initiatorType,_=y.duration;if(x&&_&&cb(T)){for(T=0,_=y.responseEnd,f+=1;f<u.length;f++){var V=u[f],ce=V.startTime;if(ce>_)break;var we=V.transferSize,Me=V.initiatorType;we&&cb(Me)&&(V=V.responseEnd,T+=we*(V<_?1:(_-ce)/(V-ce)))}if(--f,l+=8*(x+T)/(y.duration/1e3),i++,10<i)break}}if(0<i)return l/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var Cm=null,Am=null;function nf(i){return i.nodeType===9?i:i.ownerDocument}function hb(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fb(i,l){if(i===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&l==="foreignObject"?0:i}function Tm(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Nm=null;function UA(){var i=window.event;return i&&i.type==="popstate"?i===Nm?!1:(Nm=i,!0):(Nm=null,!1)}var db=typeof setTimeout=="function"?setTimeout:void 0,VA=typeof clearTimeout=="function"?clearTimeout:void 0,pb=typeof Promise=="function"?Promise:void 0,FA=typeof queueMicrotask=="function"?queueMicrotask:typeof pb<"u"?function(i){return pb.resolve(null).then(i).catch(KA)}:db;function KA(i){setTimeout(function(){throw i})}function gl(i){return i==="head"}function mb(i,l){var u=l,f=0;do{var y=u.nextSibling;if(i.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(f===0){i.removeChild(y),ko(l);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")Xu(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,Xu(u);for(var x=u.firstChild;x;){var T=x.nextSibling,_=x.nodeName;x[Or]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&x.rel.toLowerCase()==="stylesheet"||u.removeChild(x),x=T}}else u==="body"&&Xu(i.ownerDocument.body);u=y}while(u);ko(l)}function gb(i,l){var u=i;i=0;do{var f=u.nextSibling;if(u.nodeType===1?l?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(l?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=f}while(u)}function Em(i){var l=i.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var u=l;switch(l=l.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Em(u),js(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function GA(i,l,u,f){for(;i.nodeType===1;){var y=u;if(i.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[Or])switch(l){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(x=i.getAttribute("rel"),x==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(x!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(x=i.getAttribute("src"),(x!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&x&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(l==="input"&&i.type==="hidden"){var x=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===x)return i}else return i;if(i=ri(i.nextSibling),i===null)break}return null}function YA(i,l,u){if(l==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=ri(i.nextSibling),i===null))return null;return i}function yb(i,l){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=ri(i.nextSibling),i===null))return null;return i}function Mm(i){return i.data==="$?"||i.data==="$~"}function jm(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function $A(i,l){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=l;else if(i.data!=="$?"||u.readyState!=="loading")l();else{var f=function(){l(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function ri(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return i}var _m=null;function xb(i){i=i.nextSibling;for(var l=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(l===0)return ri(i.nextSibling);l--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||l++}i=i.nextSibling}return null}function vb(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(l===0)return i;l--}else u!=="/$"&&u!=="/&"||l++}i=i.previousSibling}return null}function bb(i,l,u){switch(l=nf(u),i){case"html":if(i=l.documentElement,!i)throw Error(r(452));return i;case"head":if(i=l.head,!i)throw Error(r(453));return i;case"body":if(i=l.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function Xu(i){for(var l=i.attributes;l.length;)i.removeAttributeNode(l[0]);js(i)}var ii=new Map,kb=new Set;function rf(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var _a=ve.d;ve.d={f:QA,r:XA,D:WA,C:ZA,L:JA,m:e4,X:n4,S:t4,M:r4};function QA(){var i=_a.f(),l=$h();return i||l}function XA(i){var l=Qt(i);l!==null&&l.tag===5&&l.type==="form"?Ix(l):_a.r(i)}var xo=typeof document>"u"?null:document;function wb(i,l,u){var f=xo;if(f&&typeof l=="string"&&l){var y=Kn(l);y='link[rel="'+i+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),kb.has(y)||(kb.add(y),i={rel:i,crossOrigin:u,href:l},f.querySelector(y)===null&&(l=f.createElement("link"),tr(l,"link",i),An(l),f.head.appendChild(l)))}}function WA(i){_a.D(i),wb("dns-prefetch",i,null)}function ZA(i,l){_a.C(i,l),wb("preconnect",i,l)}function JA(i,l,u){_a.L(i,l,u);var f=xo;if(f&&i&&l){var y='link[rel="preload"][as="'+Kn(l)+'"]';l==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+Kn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+Kn(u.imageSizes)+'"]')):y+='[href="'+Kn(i)+'"]';var x=y;switch(l){case"style":x=vo(i);break;case"script":x=bo(i)}ii.has(x)||(i=g({rel:"preload",href:l==="image"&&u&&u.imageSrcSet?void 0:i,as:l},u),ii.set(x,i),f.querySelector(y)!==null||l==="style"&&f.querySelector(Wu(x))||l==="script"&&f.querySelector(Zu(x))||(l=f.createElement("link"),tr(l,"link",i),An(l),f.head.appendChild(l)))}}function e4(i,l){_a.m(i,l);var u=xo;if(u&&i){var f=l&&typeof l.as=="string"?l.as:"script",y='link[rel="modulepreload"][as="'+Kn(f)+'"][href="'+Kn(i)+'"]',x=y;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=bo(i)}if(!ii.has(x)&&(i=g({rel:"modulepreload",href:i},l),ii.set(x,i),u.querySelector(y)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Zu(x)))return}f=u.createElement("link"),tr(f,"link",i),An(f),u.head.appendChild(f)}}}function t4(i,l,u){_a.S(i,l,u);var f=xo;if(f&&i){var y=or(f).hoistableStyles,x=vo(i);l=l||"default";var T=y.get(x);if(!T){var _={loading:0,preload:null};if(T=f.querySelector(Wu(x)))_.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":l},u),(u=ii.get(x))&&Dm(i,u);var V=T=f.createElement("link");An(V),tr(V,"link",i),V._p=new Promise(function(ce,we){V.onload=ce,V.onerror=we}),V.addEventListener("load",function(){_.loading|=1}),V.addEventListener("error",function(){_.loading|=2}),_.loading|=4,af(T,l,f)}T={type:"stylesheet",instance:T,count:1,state:_},y.set(x,T)}}}function n4(i,l){_a.X(i,l);var u=xo;if(u&&i){var f=or(u).hoistableScripts,y=bo(i),x=f.get(y);x||(x=u.querySelector(Zu(y)),x||(i=g({src:i,async:!0},l),(l=ii.get(y))&&Om(i,l),x=u.createElement("script"),An(x),tr(x,"link",i),u.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(y,x))}}function r4(i,l){_a.M(i,l);var u=xo;if(u&&i){var f=or(u).hoistableScripts,y=bo(i),x=f.get(y);x||(x=u.querySelector(Zu(y)),x||(i=g({src:i,async:!0,type:"module"},l),(l=ii.get(y))&&Om(i,l),x=u.createElement("script"),An(x),tr(x,"link",i),u.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(y,x))}}function Sb(i,l,u,f){var y=(y=Qe.current)?rf(y):null;if(!y)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(l=vo(u.href),u=or(y).hoistableStyles,f=u.get(l),f||(f={type:"style",instance:null,count:0,state:null},u.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=vo(u.href);var x=or(y).hoistableStyles,T=x.get(i);if(T||(y=y.ownerDocument||y,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(i,T),(x=y.querySelector(Wu(i)))&&!x._p&&(T.instance=x,T.state.loading=5),ii.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},ii.set(i,u),x||i4(y,i,u,T.state))),l&&f===null)throw Error(r(528,""));return T}if(l&&f!==null)throw Error(r(529,""));return null;case"script":return l=u.async,u=u.src,typeof u=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=bo(u),u=or(y).hoistableScripts,f=u.get(l),f||(f={type:"script",instance:null,count:0,state:null},u.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function vo(i){return'href="'+Kn(i)+'"'}function Wu(i){return'link[rel="stylesheet"]['+i+"]"}function Cb(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function i4(i,l,u,f){i.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=i.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),tr(l,"link",u),An(l),i.head.appendChild(l))}function bo(i){return'[src="'+Kn(i)+'"]'}function Zu(i){return"script[async]"+i}function Ab(i,l,u){if(l.count++,l.instance===null)switch(l.type){case"style":var f=i.querySelector('style[data-href~="'+Kn(u.href)+'"]');if(f)return l.instance=f,An(f),f;var y=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),An(f),tr(f,"style",y),af(f,u.precedence,i),l.instance=f;case"stylesheet":y=vo(u.href);var x=i.querySelector(Wu(y));if(x)return l.state.loading|=4,l.instance=x,An(x),x;f=Cb(u),(y=ii.get(y))&&Dm(f,y),x=(i.ownerDocument||i).createElement("link"),An(x);var T=x;return T._p=new Promise(function(_,V){T.onload=_,T.onerror=V}),tr(x,"link",f),l.state.loading|=4,af(x,u.precedence,i),l.instance=x;case"script":return x=bo(u.src),(y=i.querySelector(Zu(x)))?(l.instance=y,An(y),y):(f=u,(y=ii.get(x))&&(f=g({},u),Om(f,y)),i=i.ownerDocument||i,y=i.createElement("script"),An(y),tr(y,"link",f),i.head.appendChild(y),l.instance=y);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,af(f,u.precedence,i));return l.instance}function af(i,l,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=f.length?f[f.length-1]:null,x=y,T=0;T<f.length;T++){var _=f[T];if(_.dataset.precedence===l)x=_;else if(x!==y)break}x?x.parentNode.insertBefore(i,x.nextSibling):(l=u.nodeType===9?u.head:u,l.insertBefore(i,l.firstChild))}function Dm(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.title==null&&(i.title=l.title)}function Om(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.integrity==null&&(i.integrity=l.integrity)}var lf=null;function Tb(i,l,u){if(lf===null){var f=new Map,y=lf=new Map;y.set(u,f)}else y=lf,f=y.get(u),f||(f=new Map,y.set(u,f));if(f.has(i))return f;for(f.set(i,null),u=u.getElementsByTagName(i),y=0;y<u.length;y++){var x=u[y];if(!(x[Or]||x[an]||i==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var T=x.getAttribute(l)||"";T=i+T;var _=f.get(T);_?_.push(x):f.set(T,[x])}}return f}function Nb(i,l,u){i=i.ownerDocument||i,i.head.insertBefore(u,l==="title"?i.querySelector("head > title"):null)}function a4(i,l,u){if(u===1||l.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(i=l.disabled,typeof l.precedence=="string"&&i==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Eb(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function l4(i,l,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=vo(f.href),x=l.querySelector(Wu(y));if(x){l=x._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(i.count++,i=sf.bind(i),l.then(i,i)),u.state.loading|=4,u.instance=x,An(x);return}x=l.ownerDocument||l,f=Cb(f),(y=ii.get(y))&&Dm(f,y),x=x.createElement("link"),An(x);var T=x;T._p=new Promise(function(_,V){T.onload=_,T.onerror=V}),tr(x,"link",f),u.instance=x}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,l),(l=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=sf.bind(i),l.addEventListener("load",u),l.addEventListener("error",u))}}var Rm=0;function s4(i,l){return i.stylesheets&&i.count===0&&uf(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var f=setTimeout(function(){if(i.stylesheets&&uf(i,i.stylesheets),i.unsuspend){var x=i.unsuspend;i.unsuspend=null,x()}},6e4+l);0<i.imgBytes&&Rm===0&&(Rm=62500*qA());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&uf(i,i.stylesheets),i.unsuspend)){var x=i.unsuspend;i.unsuspend=null,x()}},(i.imgBytes>Rm?50:800)+l);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(f),clearTimeout(y)}}:null}function sf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)uf(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var of=null;function uf(i,l){i.stylesheets=null,i.unsuspend!==null&&(i.count++,of=new Map,l.forEach(o4,i),of=null,sf.call(i))}function o4(i,l){if(!(l.state.loading&4)){var u=of.get(i);if(u)var f=u.get(null);else{u=new Map,of.set(i,u);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<y.length;x++){var T=y[x];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(u.set(T.dataset.precedence,T),f=T)}f&&u.set(null,f)}y=l.instance,T=y.getAttribute("data-precedence"),x=u.get(T)||f,x===f&&u.set(null,y),u.set(T,y),this.count++,f=sf.bind(this),y.addEventListener("load",f),y.addEventListener("error",f),x?x.parentNode.insertBefore(y,x.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),l.state.loading|=4}}var Ju={$$typeof:O,Provider:null,Consumer:null,_currentValue:Te,_currentValue2:Te,_threadCount:0};function u4(i,l,u,f,y,x,T,_,V){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ji(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ji(0),this.hiddenUpdates=ji(null),this.identifierPrefix=f,this.onUncaughtError=y,this.onCaughtError=x,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=V,this.incompleteTransitions=new Map}function Mb(i,l,u,f,y,x,T,_,V,ce,we,Me){return i=new u4(i,l,u,T,V,ce,we,Me,_),l=1,x===!0&&(l|=24),x=Br(3,null,null,l),i.current=x,x.stateNode=i,l=dp(),l.refCount++,i.pooledCache=l,l.refCount++,x.memoizedState={element:f,isDehydrated:u,cache:l},yp(x),i}function jb(i){return i?(i=Xs,i):Xs}function _b(i,l,u,f,y,x){y=jb(y),f.context===null?f.context=y:f.pendingContext=y,f=al(l),f.payload={element:u},x=x===void 0?null:x,x!==null&&(f.callback=x),u=ll(i,f,l),u!==null&&(Er(u,i,l),_u(u,i,l))}function Db(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<l?u:l}}function Lm(i,l){Db(i,l),(i=i.alternate)&&Db(i,l)}function Ob(i){if(i.tag===13||i.tag===31){var l=Vt(i,67108864);l!==null&&Er(l,i,67108864),Lm(i,67108864)}}function Rb(i){if(i.tag===13||i.tag===31){var l=qr();l=iu(l);var u=Vt(i,l);u!==null&&Er(u,i,l),Lm(i,l)}}var cf=!0;function c4(i,l,u,f){var y=X.T;X.T=null;var x=ve.p;try{ve.p=2,Bm(i,l,u,f)}finally{ve.p=x,X.T=y}}function h4(i,l,u,f){var y=X.T;X.T=null;var x=ve.p;try{ve.p=8,Bm(i,l,u,f)}finally{ve.p=x,X.T=y}}function Bm(i,l,u,f){if(cf){var y=zm(f);if(y===null)wm(i,l,f,hf,u),Bb(i,f);else if(d4(y,i,l,u,f))f.stopPropagation();else if(Bb(i,f),l&4&&-1<f4.indexOf(i)){for(;y!==null;){var x=Qt(y);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var T=gi(x.pendingLanes);if(T!==0){var _=x;for(_.pendingLanes|=2,_.entangledLanes|=2;T;){var V=1<<31-Se(T);_.entanglements[1]|=V,T&=~V}Vi(x),(qt&6)===0&&(Gh=Pt()+500,Yu(0))}}break;case 31:case 13:_=Vt(x,2),_!==null&&Er(_,x,2),$h(),Lm(x,2)}if(x=zm(f),x===null&&wm(i,l,f,hf,u),x===y)break;y=x}y!==null&&f.stopPropagation()}else wm(i,l,f,null,u)}}function zm(i){return i=Os(i),Im(i)}var hf=null;function Im(i){if(hf=null,i=Oi(i),i!==null){var l=s(i);if(l===null)i=null;else{var u=l.tag;if(u===13){if(i=o(l),i!==null)return i;i=null}else if(u===31){if(i=c(l),i!==null)return i;i=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null)}}return hf=i,null}function Lb(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(yn()){case ie:return 2;case be:return 8;case Ke:case tt:return 32;case it:return 268435456;default:return 32}default:return 32}}var Pm=!1,yl=null,xl=null,vl=null,ec=new Map,tc=new Map,bl=[],f4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Bb(i,l){switch(i){case"focusin":case"focusout":yl=null;break;case"dragenter":case"dragleave":xl=null;break;case"mouseover":case"mouseout":vl=null;break;case"pointerover":case"pointerout":ec.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":tc.delete(l.pointerId)}}function nc(i,l,u,f,y,x){return i===null||i.nativeEvent!==x?(i={blockedOn:l,domEventName:u,eventSystemFlags:f,nativeEvent:x,targetContainers:[y]},l!==null&&(l=Qt(l),l!==null&&Ob(l)),i):(i.eventSystemFlags|=f,l=i.targetContainers,y!==null&&l.indexOf(y)===-1&&l.push(y),i)}function d4(i,l,u,f,y){switch(l){case"focusin":return yl=nc(yl,i,l,u,f,y),!0;case"dragenter":return xl=nc(xl,i,l,u,f,y),!0;case"mouseover":return vl=nc(vl,i,l,u,f,y),!0;case"pointerover":var x=y.pointerId;return ec.set(x,nc(ec.get(x)||null,i,l,u,f,y)),!0;case"gotpointercapture":return x=y.pointerId,tc.set(x,nc(tc.get(x)||null,i,l,u,f,y)),!0}return!1}function zb(i){var l=Oi(i.target);if(l!==null){var u=s(l);if(u!==null){if(l=u.tag,l===13){if(l=o(u),l!==null){i.blockedOn=l,Fl(i.priority,function(){Rb(u)});return}}else if(l===31){if(l=c(u),l!==null){i.blockedOn=l,Fl(i.priority,function(){Rb(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ff(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var u=zm(i.nativeEvent);if(u===null){u=i.nativeEvent;var f=new u.constructor(u.type,u);Qr=f,u.target.dispatchEvent(f),Qr=null}else return l=Qt(u),l!==null&&Ob(l),i.blockedOn=u,!1;l.shift()}return!0}function Ib(i,l,u){ff(i)&&u.delete(l)}function p4(){Pm=!1,yl!==null&&ff(yl)&&(yl=null),xl!==null&&ff(xl)&&(xl=null),vl!==null&&ff(vl)&&(vl=null),ec.forEach(Ib),tc.forEach(Ib)}function df(i,l){i.blockedOn===l&&(i.blockedOn=null,Pm||(Pm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,p4)))}var pf=null;function Pb(i){pf!==i&&(pf=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){pf===i&&(pf=null);for(var l=0;l<i.length;l+=3){var u=i[l],f=i[l+1],y=i[l+2];if(typeof f!="function"){if(Im(f||u)===null)continue;break}var x=Qt(u);x!==null&&(i.splice(l,3),l-=3,zp(x,{pending:!0,data:y,method:u.method,action:f},f,y))}}))}function ko(i){function l(V){return df(V,i)}yl!==null&&df(yl,i),xl!==null&&df(xl,i),vl!==null&&df(vl,i),ec.forEach(l),tc.forEach(l);for(var u=0;u<bl.length;u++){var f=bl[u];f.blockedOn===i&&(f.blockedOn=null)}for(;0<bl.length&&(u=bl[0],u.blockedOn===null);)zb(u),u.blockedOn===null&&bl.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var y=u[f],x=u[f+1],T=y[Cn]||null;if(typeof x=="function")T||Pb(u);else if(T){var _=null;if(x&&x.hasAttribute("formAction")){if(y=x,T=x[Cn]||null)_=T.formAction;else if(Im(y)!==null)continue}else _=T.action;typeof _=="function"?u[f+1]=_:(u.splice(f,3),f-=3),Pb(u)}}}function Hb(){function i(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(T){return y=T})},focusReset:"manual",scroll:"manual"})}function l(){y!==null&&(y(),y=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),y!==null&&(y(),y=null)}}}function Hm(i){this._internalRoot=i}mf.prototype.render=Hm.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(r(409));var u=l.current,f=qr();_b(u,f,i,l,null,null)},mf.prototype.unmount=Hm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;_b(i.current,2,null,i,null,null),$h(),l[gr]=null}};function mf(i){this._internalRoot=i}mf.prototype.unstable_scheduleHydration=function(i){if(i){var l=Vl();i={blockedOn:null,target:i,priority:l};for(var u=0;u<bl.length&&l!==0&&l<bl[u].priority;u++);bl.splice(u,0,i),u===0&&zb(i)}};var qb=e.version;if(qb!=="19.2.4")throw Error(r(527,qb,"19.2.4"));ve.findDOMNode=function(i){var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=d(l),i=i!==null?p(i):null,i=i===null?null:i.stateNode,i};var m4={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gf.isDisabled&&gf.supportsFiber)try{je=gf.inject(m4),He=gf}catch{}}return ic.createRoot=function(i,l){if(!a(i))throw Error(r(299));var u=!1,f="",y=$x,x=Qx,T=Xx;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(x=l.onCaughtError),l.onRecoverableError!==void 0&&(T=l.onRecoverableError)),l=Mb(i,1,!1,null,null,u,f,null,y,x,T,Hb),i[gr]=l.current,km(i),new Hm(l)},ic.hydrateRoot=function(i,l,u){if(!a(i))throw Error(r(299));var f=!1,y="",x=$x,T=Qx,_=Xx,V=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(x=u.onUncaughtError),u.onCaughtError!==void 0&&(T=u.onCaughtError),u.onRecoverableError!==void 0&&(_=u.onRecoverableError),u.formState!==void 0&&(V=u.formState)),l=Mb(i,1,!0,l,u??null,f,y,V,x,T,_,Hb),l.context=jb(null),u=l.current,f=qr(),f=iu(f),y=al(f),y.callback=null,ll(u,y,f),u=f,l.current.lanes=u,Yr(l,u),Vi(l),i[gr]=l.current,km(i),new mf(l)},ic.version="19.2.4",ic}var Yb;function S4(){if(Yb)return Um.exports;Yb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Um.exports=w4(),Um.exports}var C4=S4();z.createContext(null);var Uf={exports:{}},A4=Uf.exports,$b;function T4(){return $b||($b=1,(function(n,e){((t,r)=>{n.exports=r()})(A4,function(){var t=function(m,v){return(t=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(S,C){S.__proto__=C}:function(S,C){for(var N in C)Object.prototype.hasOwnProperty.call(C,N)&&(S[N]=C[N])}))(m,v)},r=function(){return(r=Object.assign||function(m){for(var v,S=1,C=arguments.length;S<C;S++)for(var N in v=arguments[S])Object.prototype.hasOwnProperty.call(v,N)&&(m[N]=v[N]);return m}).apply(this,arguments)};function a(m,v,S){for(var C,N=0,M=v.length;N<M;N++)!C&&N in v||((C=C||Array.prototype.slice.call(v,0,N))[N]=v[N]);return m.concat(C||Array.prototype.slice.call(v))}var s=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:y4,o=Object.keys,c=Array.isArray;function h(m,v){return typeof v=="object"&&o(v).forEach(function(S){m[S]=v[S]}),m}typeof Promise>"u"||s.Promise||(s.Promise=Promise);var d=Object.getPrototypeOf,p={}.hasOwnProperty;function g(m,v){return p.call(m,v)}function k(m,v){typeof v=="function"&&(v=v(d(m))),(typeof Reflect>"u"?o:Reflect.ownKeys)(v).forEach(function(S){A(m,S,v[S])})}var w=Object.defineProperty;function A(m,v,S,C){w(m,v,h(S&&g(S,"get")&&typeof S.get=="function"?{get:S.get,set:S.set,configurable:!0}:{value:S,configurable:!0,writable:!0},C))}function E(m){return{from:function(v){return m.prototype=Object.create(v.prototype),A(m.prototype,"constructor",m),{extend:k.bind(null,m.prototype)}}}}var j=Object.getOwnPropertyDescriptor,D=[].slice;function U(m,v,S){return D.call(m,v,S)}function O(m,v){return v(m)}function J(m){if(!m)throw new Error("Assertion Failed")}function ee(m){s.setImmediate?setImmediate(m):setTimeout(m,0)}function H(m,v){if(typeof v=="string"&&g(m,v))return m[v];if(!v)return m;if(typeof v!="string"){for(var S=[],C=0,N=v.length;C<N;++C){var M=H(m,v[C]);S.push(M)}return S}var R,P=v.indexOf(".");return P===-1||(R=m[v.substr(0,P)])==null?void 0:H(R,v.substr(P+1))}function L(m,v,S){if(m&&v!==void 0&&!("isFrozen"in Object&&Object.isFrozen(m)))if(typeof v!="string"&&"length"in v){J(typeof S!="string"&&"length"in S);for(var C=0,N=v.length;C<N;++C)L(m,v[C],S[C])}else{var M,R,P=v.indexOf(".");P!==-1?(M=v.substr(0,P),(P=v.substr(P+1))===""?S===void 0?c(m)&&!isNaN(parseInt(M))?m.splice(M,1):delete m[M]:m[M]=S:L(R=(R=m[M])&&g(m,M)?R:m[M]={},P,S)):S===void 0?c(m)&&!isNaN(parseInt(v))?m.splice(v,1):delete m[v]:m[v]=S}}function me(m){var v,S={};for(v in m)g(m,v)&&(S[v]=m[v]);return S}var he=[].concat;function I(m){return he.apply([],m)}var Ce="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(I([8,16,32,64].map(function(m){return["Int","Uint","Float"].map(function(v){return v+m+"Array"})}))).filter(function(m){return s[m]}),te=new Set(Ce.map(function(m){return s[m]})),ne=null;function pe(m){return ne=new WeakMap,m=(function v(S){if(!S||typeof S!="object")return S;var C=ne.get(S);if(C)return C;if(c(S)){C=[],ne.set(S,C);for(var N=0,M=S.length;N<M;++N)C.push(v(S[N]))}else if(te.has(S.constructor))C=S;else{var R,P=d(S);for(R in C=P===Object.prototype?{}:Object.create(P),ne.set(S,C),S)g(S,R)&&(C[R]=v(S[R]))}return C})(m),ne=null,m}var ge={}.toString;function re(m){return ge.call(m).slice(8,-1)}var X=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ve=typeof X=="symbol"?function(m){var v;return m!=null&&(v=m[X])&&v.apply(m)}:function(){return null};function Te(m,v){v=m.indexOf(v),0<=v&&m.splice(v,1)}var Ee={};function q(m){var v,S,C,N;if(arguments.length===1){if(c(m))return m.slice();if(this===Ee&&typeof m=="string")return[m];if(N=ve(m))for(S=[];!(C=N.next()).done;)S.push(C.value);else{if(m==null)return[m];if(typeof(v=m.length)!="number")return[m];for(S=new Array(v);v--;)S[v]=m[v]}}else for(v=arguments.length,S=new Array(v);v--;)S[v]=arguments[v];return S}var ye=typeof Symbol<"u"?function(m){return m[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Ce=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ie=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ce),B={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function $e(m,v){this.name=m,this.message=v}function rt(m,v){return m+". Errors: "+Object.keys(v).map(function(S){return v[S].toString()}).filter(function(S,C,N){return N.indexOf(S)===C}).join(`
`)}function Qe(m,v,S,C){this.failures=v,this.failedKeys=C,this.successCount=S,this.message=rt(m,v)}function wt(m,v){this.name="BulkError",this.failures=Object.keys(v).map(function(S){return v[S]}),this.failuresByPos=v,this.message=rt(m,this.failures)}E($e).from(Error).extend({toString:function(){return this.name+": "+this.message}}),E(Qe).from($e),E(wt).from($e);var ft=ie.reduce(function(m,v){return m[v]=v+"Error",m},{}),Ot=$e,Fe=ie.reduce(function(m,v){var S=v+"Error";function C(N,M){this.name=S,N?typeof N=="string"?(this.message="".concat(N).concat(M?`
 `+M:""),this.inner=M||null):typeof N=="object"&&(this.message="".concat(N.name," ").concat(N.message),this.inner=N):(this.message=B[v]||S,this.inner=null)}return E(C).from(Ot),m[v]=C,m},{}),Yt=(Fe.Syntax=SyntaxError,Fe.Type=TypeError,Fe.Range=RangeError,Ce.reduce(function(m,v){return m[v+"Error"]=Fe[v],m},{}));Ce=ie.reduce(function(m,v){return["Syntax","Type","Range"].indexOf(v)===-1&&(m[v+"Error"]=Fe[v]),m},{});function dt(){}function wn(m){return m}function vn(m,v){return m==null||m===wn?v:function(S){return v(m(S))}}function un(m,v){return function(){m.apply(this,arguments),v.apply(this,arguments)}}function Pn(m,v){return m===dt?v:function(){var S=m.apply(this,arguments),C=(S!==void 0&&(arguments[0]=S),this.onsuccess),N=this.onerror,M=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return C&&(this.onsuccess=this.onsuccess?un(C,this.onsuccess):C),N&&(this.onerror=this.onerror?un(N,this.onerror):N),M!==void 0?M:S}}function Qn(m,v){return m===dt?v:function(){m.apply(this,arguments);var S=this.onsuccess,C=this.onerror;this.onsuccess=this.onerror=null,v.apply(this,arguments),S&&(this.onsuccess=this.onsuccess?un(S,this.onsuccess):S),C&&(this.onerror=this.onerror?un(C,this.onerror):C)}}function mn(m,v){return m===dt?v:function(N){var C=m.apply(this,arguments),N=(h(N,C),this.onsuccess),M=this.onerror,R=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return N&&(this.onsuccess=this.onsuccess?un(N,this.onsuccess):N),M&&(this.onerror=this.onerror?un(M,this.onerror):M),C===void 0?R===void 0?void 0:R:h(C,R)}}function Xn(m,v){return m===dt?v:function(){return v.apply(this,arguments)!==!1&&m.apply(this,arguments)}}function Fn(m,v){return m===dt?v:function(){var S=m.apply(this,arguments);if(S&&typeof S.then=="function"){for(var C=this,N=arguments.length,M=new Array(N);N--;)M[N]=arguments[N];return S.then(function(){return v.apply(C,M)})}return v.apply(this,arguments)}}Ce.ModifyError=Qe,Ce.DexieError=$e,Ce.BulkError=wt;var Pe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Rt(m){Pe=m}var $t={},Pt=100,yn=typeof Promise>"u"?[]:(ie=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[yn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),d(yn),ie]:[ie,d(ie),ie]),ie=yn[0],ma=yn[1],ma=ma&&ma.then,be=ie&&ie.constructor,Ke=!!yn[2],tt=function(m,v){ot.push([m,v]),Ne&&(queueMicrotask(rh),Ne=!1)},it=!0,Ne=!0,Be=[],je=[],He=wn,De={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:dt,pgp:!1,env:{},finalize:dt},Se=De,ot=[],mt=0,mi=[];function Ve(m){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var v=this._PSD=Se;if(typeof m!="function"){if(m!==$t)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&gi(this,this._value)}else this._state=null,this._value=null,++v.ref,(function S(C,N){try{N(function(M){if(C._state===null){if(M===C)throw new TypeError("A promise cannot be resolved with itself.");var R=C._lib&&ji();M&&typeof M.then=="function"?S(C,function(P,K){M instanceof Ve?M._then(P,K):M.then(P,K)}):(C._state=!0,C._value=M,ql(C)),R&&Yr()}},gi.bind(null,C))}catch(M){gi(C,M)}})(this,m)}var Ha={get:function(){var m=Se,v=Fl;function S(C,N){var M=this,R=!m.global&&(m!==Se||v!==Fl),P=R&&!gr(),K=new Ve(function(le,G){ia(M,new Hl(js(C,m,R,P),js(N,m,R,P),le,G,m))});return this._consoleTask&&(K._consoleTask=this._consoleTask),K}return S.prototype=$t,S},set:function(m){A(this,"then",m&&m.prototype===$t?Ha:{get:function(){return m},set:Ha.set})}};function Hl(m,v,S,C,N){this.onFulfilled=typeof m=="function"?m:null,this.onRejected=typeof v=="function"?v:null,this.resolve=S,this.reject=C,this.psd=N}function gi(m,v){var S,C;je.push(v),m._state===null&&(S=m._lib&&ji(),v=He(v),m._state=!1,m._value=v,C=m,Be.some(function(N){return N._value===C._value})||Be.push(C),ql(m),S)&&Yr()}function ql(m){var v=m._listeners;m._listeners=[];for(var S=0,C=v.length;S<C;++S)ia(m,v[S]);var N=m._PSD;--N.ref||N.finalize(),mt===0&&(++mt,tt(function(){--mt==0&&ru()},[]))}function ia(m,v){if(m._state===null)m._listeners.push(v);else{var S=m._state?v.onFulfilled:v.onRejected;if(S===null)return(m._state?v.resolve:v.reject)(m._value);++v.psd.ref,++mt,tt($d,[S,m,v])}}function $d(m,v,S){try{var C,N=v._value;!v._state&&je.length&&(je=[]),C=Pe&&v._consoleTask?v._consoleTask.run(function(){return m(N)}):m(N),v._state||je.indexOf(N)!==-1||(M=>{for(var R=Be.length;R;)if(Be[--R]._value===M._value)return Be.splice(R,1)})(v),S.resolve(C)}catch(M){S.reject(M)}finally{--mt==0&&ru(),--S.psd.ref||S.psd.finalize()}}function rh(){Or(De,function(){ji()&&Yr()})}function ji(){var m=it;return Ne=it=!1,m}function Yr(){var m,v,S;do for(;0<ot.length;)for(m=ot,ot=[],S=m.length,v=0;v<S;++v){var C=m[v];C[0].apply(null,C[1])}while(0<ot.length);Ne=it=!0}function ru(){for(var m=Be,v=(Be=[],m.forEach(function(C){C._PSD.onunhandled.call(null,C._value,C)}),mi.slice(0)),S=v.length;S;)v[--S]()}function Ul(m){return new Ve($t,!1,m)}function en(m,v){var S=Se;return function(){var C=ji(),N=Se;try{return Di(S,!0),m.apply(this,arguments)}catch(M){v&&v(M)}finally{Di(N,!1),C&&Yr()}}}k(Ve.prototype,{then:Ha,_then:function(m,v){ia(this,new Hl(null,null,m,v,Se))},catch:function(m){var v,S;return arguments.length===1?this.then(null,m):(v=m,S=arguments[1],typeof v=="function"?this.then(null,function(C){return(C instanceof v?S:Ul)(C)}):this.then(null,function(C){return(C&&C.name===v?S:Ul)(C)}))},finally:function(m){return this.then(function(v){return Ve.resolve(m()).then(function(){return v})},function(v){return Ve.resolve(m()).then(function(){return Ul(v)})})},timeout:function(m,v){var S=this;return m<1/0?new Ve(function(C,N){var M=setTimeout(function(){return N(new Fe.Timeout(v))},m);S.then(C,N).finally(clearTimeout.bind(null,M))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&A(Ve.prototype,Symbol.toStringTag,"Dexie.Promise"),De.env=au(),k(Ve,{all:function(){var m=q.apply(null,arguments).map(Ua);return new Ve(function(v,S){m.length===0&&v([]);var C=m.length;m.forEach(function(N,M){return Ve.resolve(N).then(function(R){m[M]=R,--C||v(m)},S)})})},resolve:function(m){return m instanceof Ve?m:m&&typeof m.then=="function"?new Ve(function(v,S){m.then(v,S)}):new Ve($t,!0,m)},reject:Ul,race:function(){var m=q.apply(null,arguments).map(Ua);return new Ve(function(v,S){m.map(function(C){return Ve.resolve(C).then(v,S)})})},PSD:{get:function(){return Se},set:function(m){return Se=m}},totalEchoes:{get:function(){return Fl}},newPSD:an,usePSD:Or,scheduler:{get:function(){return tt},set:function(m){tt=m}},rejectionMapper:{get:function(){return He},set:function(m){He=m}},follow:function(m,v){return new Ve(function(S,C){return an(function(N,M){var R=Se;R.unhandleds=[],R.onunhandled=M,R.finalize=un(function(){var P,K=this;P=function(){K.unhandleds.length===0?N():M(K.unhandleds[0])},mi.push(function le(){P(),mi.splice(mi.indexOf(le),1)}),++mt,tt(function(){--mt==0&&ru()},[])},R.finalize),m()},v,S,C)})}}),be&&(be.allSettled&&A(Ve,"allSettled",function(){var m=q.apply(null,arguments).map(Ua);return new Ve(function(v){m.length===0&&v([]);var S=m.length,C=new Array(S);m.forEach(function(N,M){return Ve.resolve(N).then(function(R){return C[M]={status:"fulfilled",value:R}},function(R){return C[M]={status:"rejected",reason:R}}).then(function(){return--S||v(C)})})})}),be.any&&typeof AggregateError<"u"&&A(Ve,"any",function(){var m=q.apply(null,arguments).map(Ua);return new Ve(function(v,S){m.length===0&&S(new AggregateError([]));var C=m.length,N=new Array(C);m.forEach(function(M,R){return Ve.resolve(M).then(function(P){return v(P)},function(P){N[R]=P,--C||S(new AggregateError(N))})})})}),be.withResolvers)&&(Ve.withResolvers=be.withResolvers);var Sn={awaits:0,echoes:0,id:0},iu=0,qa=[],Vl=0,Fl=0,_i=0;function an(m,R,S,C){var N=Se,M=Object.create(N),R=(M.parent=N,M.ref=0,M.global=!1,M.id=++_i,De.env,M.env=Ke?{Promise:Ve,PromiseProp:{value:Ve,configurable:!0,writable:!0},all:Ve.all,race:Ve.race,allSettled:Ve.allSettled,any:Ve.any,resolve:Ve.resolve,reject:Ve.reject}:{},R&&h(M,R),++N.ref,M.finalize=function(){--this.parent.ref||this.parent.finalize()},Or(M,m,S,C));return M.ref===0&&M.finalize(),R}function Cn(){return Sn.id||(Sn.id=++iu),++Sn.awaits,Sn.echoes+=Pt,Sn.id}function gr(){return!!Sn.awaits&&(--Sn.awaits==0&&(Sn.id=0),Sn.echoes=Sn.awaits*Pt,!0)}function Ua(m){return Sn.echoes&&m&&m.constructor===be?(Cn(),m.then(function(v){return gr(),v},function(v){return gr(),Qt(v)})):m}function Qd(){var m=qa[qa.length-1];qa.pop(),Di(m,!1)}function Di(m,v){var S,C,N=Se;(v?!Sn.echoes||Vl++&&m===Se:!Vl||--Vl&&m===Se)||queueMicrotask(v?function(M){++Fl,Sn.echoes&&--Sn.echoes!=0||(Sn.echoes=Sn.awaits=Sn.id=0),qa.push(Se),Di(M,!0)}.bind(null,m):Qd),m!==Se&&(Se=m,N===De&&(De.env=au()),Ke)&&(S=De.env.Promise,C=m.env,N.global||m.global)&&(Object.defineProperty(s,"Promise",C.PromiseProp),S.all=C.all,S.race=C.race,S.resolve=C.resolve,S.reject=C.reject,C.allSettled&&(S.allSettled=C.allSettled),C.any)&&(S.any=C.any)}function au(){var m=s.Promise;return Ke?{Promise:m,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:m.all,race:m.race,allSettled:m.allSettled,any:m.any,resolve:m.resolve,reject:m.reject}:{}}function Or(m,v,S,C,N){var M=Se;try{return Di(m,!0),v(S,C,N)}finally{Di(M,!1)}}function js(m,v,S,C){return typeof m!="function"?m:function(){var N=Se;S&&Cn(),Di(v,!0);try{return m.apply(this,arguments)}finally{Di(N,!1),C&&queueMicrotask(gr)}}}function Oi(m){Promise===be&&Sn.echoes===0?Vl===0?m():enqueueNativeMicroTask(m):setTimeout(m,0)}(""+ma).indexOf("[native code]")===-1&&(Cn=gr=dt);var Qt=Ve.reject,Rr="",or="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",An="String expected.",aa=[],Kl="__dbnames",yi="readonly",Ri="readwrite";function la(m,v){return m?v?function(){return m.apply(this,arguments)&&v.apply(this,arguments)}:m:v}var lu={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Gl(m){return typeof m!="string"||/\./.test(m)?function(v){return v}:function(v){return v[m]===void 0&&m in v&&delete(v=pe(v))[m],v}}function ih(){throw Fe.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function bt(m,v){try{var S=Yl(m),C=Yl(v);if(S!==C)return S==="Array"?1:C==="Array"?-1:S==="binary"?1:C==="binary"?-1:S==="string"?1:C==="string"?-1:S==="Date"?1:C!=="Date"?NaN:-1;switch(S){case"number":case"Date":case"string":return v<m?1:m<v?-1:0;case"binary":for(var N=$r(m),M=$r(v),R=N.length,P=M.length,K=R<P?R:P,le=0;le<K;++le)if(N[le]!==M[le])return N[le]<M[le]?-1:1;return R===P?0:R<P?-1:1;case"Array":for(var G=m,F=v,Q=G.length,Z=F.length,Y=Q<Z?Q:Z,$=0;$<Y;++$){var oe=bt(G[$],F[$]);if(oe!==0)return oe}return Q===Z?0:Q<Z?-1:1}}catch{}return NaN}function Yl(m){var v=typeof m;return v=="object"&&(ArrayBuffer.isView(m)||(v=re(m))==="ArrayBuffer")?"binary":v}function $r(m){return m instanceof Uint8Array?m:ArrayBuffer.isView(m)?new Uint8Array(m.buffer,m.byteOffset,m.byteLength):new Uint8Array(m)}function Wn(m,v,S){var C=m.schema.yProps;return C?(v&&0<S.numFailures&&(v=v.filter(function(N,M){return!S.failures[M]})),Promise.all(C.map(function(N){return N=N.updatesTable,v?m.db.table(N).where("k").anyOf(v).delete():m.db.table(N).clear()})).then(function(){return S})):S}ah.prototype.execute=function(m){var v=this["@@propmod"];if(v.add!==void 0){var S=v.add;if(c(S))return a(a([],c(m)?m:[],!0),S).sort();if(typeof S=="number")return(Number(m)||0)+S;if(typeof S=="bigint")try{return BigInt(m)+S}catch{return BigInt(0)+S}throw new TypeError("Invalid term ".concat(S))}if(v.remove!==void 0){var C=v.remove;if(c(C))return c(m)?m.filter(function(N){return!C.includes(N)}).sort():[];if(typeof C=="number")return Number(m)-C;if(typeof C=="bigint")try{return BigInt(m)-C}catch{return BigInt(0)-C}throw new TypeError("Invalid subtrahend ".concat(C))}return S=(S=v.replacePrefix)==null?void 0:S[0],S&&typeof m=="string"&&m.startsWith(S)?v.replacePrefix[1]+m.substring(S.length):m};var Va=ah;function ah(m){this["@@propmod"]=m}function _s(m,v){for(var S=o(v),C=S.length,N=!1,M=0;M<C;++M){var R=S[M],P=v[R],K=H(m,R);P instanceof Va?(L(m,R,P.execute(K)),N=!0):K!==P&&(L(m,R,P),N=!0)}return N}Ht.prototype._trans=function(m,v,S){var C=this._tx||Se.trans,N=this.name,M=Pe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(m==="readonly"?"read":"write"," ").concat(this.name));function R(le,G,F){if(F.schema[N])return v(F.idbtrans,F);throw new Fe.NotFound("Table "+N+" not part of transaction")}var P=ji();try{var K=C&&C.db._novip===this.db._novip?C===Se.trans?C._promise(m,R,S):an(function(){return C._promise(m,R,S)},{trans:C,transless:Se.transless||Se}):(function le(G,F,Q,Z){if(G.idbdb&&(G._state.openComplete||Se.letThrough||G._vip)){var Y=G._createTransaction(F,Q,G._dbSchema);try{Y.create(),G._state.PR1398_maxLoop=3}catch($){return $.name===ft.InvalidState&&G.isOpen()&&0<--G._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),G.close({disableAutoOpen:!1}),G.open().then(function(){return le(G,F,Q,Z)})):Qt($)}return Y._promise(F,function($,oe){return an(function(){return Se.trans=Y,Z($,oe,Y)})}).then(function($){if(F==="readwrite")try{Y.idbtrans.commit()}catch{}return F==="readonly"?$:Y._completion.then(function(){return $})})}if(G._state.openComplete)return Qt(new Fe.DatabaseClosed(G._state.dbOpenError));if(!G._state.isBeingOpened){if(!G._state.autoOpen)return Qt(new Fe.DatabaseClosed);G.open().catch(dt)}return G._state.dbReadyPromise.then(function(){return le(G,F,Q,Z)})})(this.db,m,[this.name],R);return M&&(K._consoleTask=M,K=K.catch(function(le){return console.trace(le),Qt(le)})),K}finally{P&&Yr()}},Ht.prototype.get=function(m,v){var S=this;return m&&m.constructor===Object?this.where(m).first(v):m==null?Qt(new Fe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(C){return S.core.get({trans:C,key:m}).then(function(N){return S.hook.reading.fire(N)})}).then(v)},Ht.prototype.where=function(m){if(typeof m=="string")return new this.db.WhereClause(this,m);if(c(m))return new this.db.WhereClause(this,"[".concat(m.join("+"),"]"));var v=o(m);if(v.length===1)return this.where(v[0]).equals(m[v[0]]);var S=this.schema.indexes.concat(this.schema.primKey).filter(function(P){if(P.compound&&v.every(function(le){return 0<=P.keyPath.indexOf(le)})){for(var K=0;K<v.length;++K)if(v.indexOf(P.keyPath[K])===-1)return!1;return!0}return!1}).sort(function(P,K){return P.keyPath.length-K.keyPath.length})[0];if(S&&this.db._maxKey!==Rr)return R=S.keyPath.slice(0,v.length),this.where(R).equals(R.map(function(P){return m[P]}));!S&&Pe&&console.warn("The query ".concat(JSON.stringify(m)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(v.join("+"),"]"));var C=this.schema.idxByName;function N(P,K){return bt(P,K)===0}var R=v.reduce(function(G,K){var le=G[0],G=G[1],F=C[K],Q=m[K];return[le||F,le||!F?la(G,F&&F.multi?function(Z){return Z=H(Z,K),c(Z)&&Z.some(function(Y){return N(Q,Y)})}:function(Z){return N(Q,H(Z,K))}):G]},[null,null]),M=R[0],R=R[1];return M?this.where(M.name).equals(m[M.keyPath]).filter(R):S?this.filter(R):this.where(v).equals("")},Ht.prototype.filter=function(m){return this.toCollection().and(m)},Ht.prototype.count=function(m){return this.toCollection().count(m)},Ht.prototype.offset=function(m){return this.toCollection().offset(m)},Ht.prototype.limit=function(m){return this.toCollection().limit(m)},Ht.prototype.each=function(m){return this.toCollection().each(m)},Ht.prototype.toArray=function(m){return this.toCollection().toArray(m)},Ht.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ht.prototype.orderBy=function(m){return new this.db.Collection(new this.db.WhereClause(this,c(m)?"[".concat(m.join("+"),"]"):m))},Ht.prototype.reverse=function(){return this.toCollection().reverse()},Ht.prototype.mapToClass=function(m){for(var v=this.db,S=this.name,C=((this.schema.mappedClass=m).prototype instanceof ih&&(m=(R=>{var P=G,K=R;if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");function le(){this.constructor=P}function G(){return R!==null&&R.apply(this,arguments)||this}return t(P,K),P.prototype=K===null?Object.create(K):(le.prototype=K.prototype,new le),Object.defineProperty(G.prototype,"db",{get:function(){return v},enumerable:!1,configurable:!0}),G.prototype.table=function(){return S},G})(m)),new Set),N=m.prototype;N;N=d(N))Object.getOwnPropertyNames(N).forEach(function(R){return C.add(R)});function M(R){if(!R)return R;var P,K=Object.create(m.prototype);for(P in R)if(!C.has(P))try{K[P]=R[P]}catch{}return K}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=M,this.hook("reading",M),m},Ht.prototype.defineClass=function(){return this.mapToClass(function(m){h(this,m)})},Ht.prototype.add=function(m,v){var S=this,C=this.schema.primKey,N=C.auto,M=C.keyPath,R=m;return M&&N&&(R=Gl(M)(m)),this._trans("readwrite",function(P){return S.core.mutate({trans:P,type:"add",keys:v!=null?[v]:null,values:[R]})}).then(function(P){return P.numFailures?Ve.reject(P.failures[0]):P.lastResult}).then(function(P){if(M)try{L(m,M,P)}catch{}return P})},Ht.prototype.upsert=function(m,v){var S=this,C=this.schema.primKey.keyPath;return this._trans("readwrite",function(N){return S.core.get({trans:N,key:m}).then(function(M){var R=M??{};return _s(R,v),C&&L(R,C,m),S.core.mutate({trans:N,type:"put",values:[R],keys:[m],upsert:!0,updates:{keys:[m],changeSpecs:[v]}}).then(function(P){return P.numFailures?Ve.reject(P.failures[0]):!!M})})})},Ht.prototype.update=function(m,v){return typeof m!="object"||c(m)?this.where(":id").equals(m).modify(v):(m=H(m,this.schema.primKey.keyPath))===void 0?Qt(new Fe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(m).modify(v)},Ht.prototype.put=function(m,v){var S=this,C=this.schema.primKey,N=C.auto,M=C.keyPath,R=m;return M&&N&&(R=Gl(M)(m)),this._trans("readwrite",function(P){return S.core.mutate({trans:P,type:"put",values:[R],keys:v!=null?[v]:null})}).then(function(P){return P.numFailures?Ve.reject(P.failures[0]):P.lastResult}).then(function(P){if(M)try{L(m,M,P)}catch{}return P})},Ht.prototype.delete=function(m){var v=this;return this._trans("readwrite",function(S){return v.core.mutate({trans:S,type:"delete",keys:[m]}).then(function(C){return Wn(v,[m],C)}).then(function(C){return C.numFailures?Ve.reject(C.failures[0]):void 0})})},Ht.prototype.clear=function(){var m=this;return this._trans("readwrite",function(v){return m.core.mutate({trans:v,type:"deleteRange",range:lu}).then(function(S){return Wn(m,null,S)})}).then(function(v){return v.numFailures?Ve.reject(v.failures[0]):void 0})},Ht.prototype.bulkGet=function(m){var v=this;return this._trans("readonly",function(S){return v.core.getMany({keys:m,trans:S}).then(function(C){return C.map(function(N){return v.hook.reading.fire(N)})})})},Ht.prototype.bulkAdd=function(m,v,S){var C=this,N=Array.isArray(v)?v:void 0,M=(S=S||(N?void 0:v))?S.allKeys:void 0;return this._trans("readwrite",function(R){var P=C.schema.primKey,le=P.auto,P=P.keyPath;if(P&&N)throw new Fe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(N&&N.length!==m.length)throw new Fe.InvalidArgument("Arguments objects and keys must have the same length");var K=m.length,le=P&&le?m.map(Gl(P)):m;return C.core.mutate({trans:R,type:"add",keys:N,values:le,wantResults:M}).then(function(G){var F=G.numFailures,Q=G.failures;if(F===0)return M?G.results:G.lastResult;throw new wt("".concat(C.name,".bulkAdd(): ").concat(F," of ").concat(K," operations failed"),Q)})})},Ht.prototype.bulkPut=function(m,v,S){var C=this,N=Array.isArray(v)?v:void 0,M=(S=S||(N?void 0:v))?S.allKeys:void 0;return this._trans("readwrite",function(R){var P=C.schema.primKey,le=P.auto,P=P.keyPath;if(P&&N)throw new Fe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(N&&N.length!==m.length)throw new Fe.InvalidArgument("Arguments objects and keys must have the same length");var K=m.length,le=P&&le?m.map(Gl(P)):m;return C.core.mutate({trans:R,type:"put",keys:N,values:le,wantResults:M}).then(function(G){var F=G.numFailures,Q=G.failures;if(F===0)return M?G.results:G.lastResult;throw new wt("".concat(C.name,".bulkPut(): ").concat(F," of ").concat(K," operations failed"),Q)})})},Ht.prototype.bulkUpdate=function(m){var v=this,S=this.core,C=m.map(function(R){return R.key}),N=m.map(function(R){return R.changes}),M=[];return this._trans("readwrite",function(R){return S.getMany({trans:R,keys:C,cache:"clone"}).then(function(P){var K=[],le=[],G=(m.forEach(function(F,Q){var Z=F.key,Y=F.changes,$=P[Q];if($){for(var oe=0,fe=Object.keys(Y);oe<fe.length;oe++){var se=fe[oe],ke=Y[se];if(se===v.schema.primKey.keyPath){if(bt(ke,Z)!==0)throw new Fe.Constraint("Cannot update primary key in bulkUpdate()")}else L($,se,ke)}M.push(Q),K.push(Z),le.push($)}}),K.length);return S.mutate({trans:R,type:"put",keys:K,values:le,updates:{keys:C,changeSpecs:N}}).then(function(F){var Q=F.numFailures,Z=F.failures;if(Q===0)return G;for(var Y=0,$=Object.keys(Z);Y<$.length;Y++){var oe,fe=$[Y],se=M[Number(fe)];se!=null&&(oe=Z[fe],delete Z[fe],Z[se]=oe)}throw new wt("".concat(v.name,".bulkUpdate(): ").concat(Q," of ").concat(G," operations failed"),Z)})})})},Ht.prototype.bulkDelete=function(m){var v=this,S=m.length;return this._trans("readwrite",function(C){return v.core.mutate({trans:C,type:"delete",keys:m}).then(function(N){return Wn(v,m,N)})}).then(function(C){var N=C.numFailures,M=C.failures;if(N===0)return C.lastResult;throw new wt("".concat(v.name,".bulkDelete(): ").concat(N," of ").concat(S," operations failed"),M)})};var su=Ht;function Ht(){}function $l(m){function v(R,P){if(P){for(var K=arguments.length,le=new Array(K-1);--K;)le[K-1]=arguments[K];return S[R].subscribe.apply(null,le),m}if(typeof R=="string")return S[R]}var S={};v.addEventType=M;for(var C=1,N=arguments.length;C<N;++C)M(arguments[C]);return v;function M(R,P,K){var le,G;if(typeof R!="object")return P=P||Xn,G={subscribers:[],fire:K=K||dt,subscribe:function(F){G.subscribers.indexOf(F)===-1&&(G.subscribers.push(F),G.fire=P(G.fire,F))},unsubscribe:function(F){G.subscribers=G.subscribers.filter(function(Q){return Q!==F}),G.fire=G.subscribers.reduce(P,K)}},S[R]=v[R]=G;o(le=R).forEach(function(F){var Q=le[F];if(c(Q))M(F,le[F][0],le[F][1]);else{if(Q!=="asap")throw new Fe.InvalidArgument("Invalid event config");var Z=M(F,wn,function(){for(var Y=arguments.length,$=new Array(Y);Y--;)$[Y]=arguments[Y];Z.subscribers.forEach(function(oe){ee(function(){oe.apply(null,$)})})})}})}}function Kn(m,v){return E(v).from({prototype:m}),v}function Li(m,v){return!(m.filter||m.algorithm||m.or)&&(v?m.justLimit:!m.replayFilter)}function Ds(m,v){m.filter=la(m.filter,v)}function Ql(m,v,S){var C=m.replayFilter;m.replayFilter=C?function(){return la(C(),v())}:v,m.justLimit=S&&!C}function xi(m,v){if(m.isPrimKey)return v.primaryKey;var S=v.getIndexByKeyPath(m.index);if(S)return S;throw new Fe.Schema("KeyPath "+m.index+" on object store "+v.name+" is not indexed")}function ou(m,v,S){var C=xi(m,v.schema);return v.openCursor({trans:S,values:!m.keysOnly,reverse:m.dir==="prev",unique:!!m.unique,query:{index:C,range:m.range}})}function Xl(m,v,S,C){var N,M,R=m.replayFilter?la(m.filter,m.replayFilter()):m.filter;return m.or?(N={},M=function(P,K,le){var G,F;R&&!R(K,le,function(Q){return K.stop(Q)},function(Q){return K.fail(Q)})||((F=""+(G=K.primaryKey))=="[object ArrayBuffer]"&&(F=""+new Uint8Array(G)),g(N,F))||(N[F]=!0,v(P,K,le))},Promise.all([m.or._iterate(M,S),sa(ou(m,C,S),m.algorithm,M,!m.keysOnly&&m.valueMapper)])):sa(ou(m,C,S),la(m.algorithm,R),v,!m.keysOnly&&m.valueMapper)}function sa(m,v,S,C){var N=en(C?function(M,R,P){return S(C(M),R,P)}:S);return m.then(function(M){if(M)return M.start(function(){var R=function(){return M.continue()};v&&!v(M,function(P){return R=P},function(P){M.stop(P),R=dt},function(P){M.fail(P),R=dt})||N(M.value,M,function(P){return R=P}),R()})})}Mt.prototype._read=function(m,v){var S=this._ctx;return S.error?S.table._trans(null,Qt.bind(null,S.error)):S.table._trans("readonly",m).then(v)},Mt.prototype._write=function(m){var v=this._ctx;return v.error?v.table._trans(null,Qt.bind(null,v.error)):v.table._trans("readwrite",m,"locked")},Mt.prototype._addAlgorithm=function(m){var v=this._ctx;v.algorithm=la(v.algorithm,m)},Mt.prototype._iterate=function(m,v){return Xl(this._ctx,m,v,this._ctx.table.core)},Mt.prototype.clone=function(m){var v=Object.create(this.constructor.prototype),S=Object.create(this._ctx);return m&&h(S,m),v._ctx=S,v},Mt.prototype.raw=function(){return this._ctx.valueMapper=null,this},Mt.prototype.each=function(m){var v=this._ctx;return this._read(function(S){return Xl(v,m,S,v.table.core)})},Mt.prototype.count=function(m){var v=this;return this._read(function(S){var C,N=v._ctx,M=N.table.core;return Li(N,!0)?M.count({trans:S,query:{index:xi(N,M.schema),range:N.range}}).then(function(R){return Math.min(R,N.limit)}):(C=0,Xl(N,function(){return++C,!1},S,M).then(function(){return C}))}).then(m)},Mt.prototype.sortBy=function(m,v){var S=m.split(".").reverse(),C=S[0],N=S.length-1;function M(K,le){return le?M(K[S[le]],le-1):K[C]}var R=this._ctx.dir==="next"?1:-1;function P(K,le){return bt(M(K,N),M(le,N))*R}return this.toArray(function(K){return K.sort(P)}).then(v)},Mt.prototype.toArray=function(m){var v=this;return this._read(function(S){var C,N,M,R=v._ctx;return R.dir==="next"&&Li(R,!0)&&0<R.limit?(C=R.valueMapper,N=xi(R,R.table.core.schema),R.table.core.query({trans:S,limit:R.limit,values:!0,query:{index:N,range:R.range}}).then(function(P){return P=P.result,C?P.map(C):P})):(M=[],Xl(R,function(P){return M.push(P)},S,R.table.core).then(function(){return M}))},m)},Mt.prototype.offset=function(m){var v=this._ctx;return m<=0||(v.offset+=m,Li(v)?Ql(v,function(){var S=m;return function(C,N){return S===0||(S===1?--S:N(function(){C.advance(S),S=0}),!1)}}):Ql(v,function(){var S=m;return function(){return--S<0}})),this},Mt.prototype.limit=function(m){return this._ctx.limit=Math.min(this._ctx.limit,m),Ql(this._ctx,function(){var v=m;return function(S,C,N){return--v<=0&&C(N),0<=v}},!0),this},Mt.prototype.until=function(m,v){return Ds(this._ctx,function(S,C,N){return!m(S.value)||(C(N),v)}),this},Mt.prototype.first=function(m){return this.limit(1).toArray(function(v){return v[0]}).then(m)},Mt.prototype.last=function(m){return this.reverse().first(m)},Mt.prototype.filter=function(m){var v;return Ds(this._ctx,function(S){return m(S.value)}),(v=this._ctx).isMatch=la(v.isMatch,m),this},Mt.prototype.and=function(m){return this.filter(m)},Mt.prototype.or=function(m){return new this.db.WhereClause(this._ctx.table,m,this)},Mt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Mt.prototype.desc=function(){return this.reverse()},Mt.prototype.eachKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(S,C){m(C.key,C)})},Mt.prototype.eachUniqueKey=function(m){return this._ctx.unique="unique",this.eachKey(m)},Mt.prototype.eachPrimaryKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(S,C){m(C.primaryKey,C)})},Mt.prototype.keys=function(m){var v=this._ctx,S=(v.keysOnly=!v.isMatch,[]);return this.each(function(C,N){S.push(N.key)}).then(function(){return S}).then(m)},Mt.prototype.primaryKeys=function(m){var v=this._ctx;if(v.dir==="next"&&Li(v,!0)&&0<v.limit)return this._read(function(C){var N=xi(v,v.table.core.schema);return v.table.core.query({trans:C,values:!1,limit:v.limit,query:{index:N,range:v.range}})}).then(function(C){return C.result}).then(m);v.keysOnly=!v.isMatch;var S=[];return this.each(function(C,N){S.push(N.primaryKey)}).then(function(){return S}).then(m)},Mt.prototype.uniqueKeys=function(m){return this._ctx.unique="unique",this.keys(m)},Mt.prototype.firstKey=function(m){return this.limit(1).keys(function(v){return v[0]}).then(m)},Mt.prototype.lastKey=function(m){return this.reverse().firstKey(m)},Mt.prototype.distinct=function(){var m,v=this._ctx,v=v.index&&v.table.schema.idxByName[v.index];return v&&v.multi&&(m={},Ds(this._ctx,function(C){var C=C.primaryKey.toString(),N=g(m,C);return m[C]=!0,!N})),this},Mt.prototype.modify=function(m){var v=this,S=this._ctx;return this._write(function(C){function N($,oe){var fe=oe.failures;Q+=$-oe.numFailures;for(var se=0,ke=o(fe);se<ke.length;se++){var _e=ke[se];F.push(fe[_e])}}var M=typeof m=="function"?m:function($){return _s($,m)},R=S.table.core,G=R.schema.primaryKey,P=G.outbound,K=G.extractKey,le=200,G=v.db._options.modifyChunkSize,F=(G&&(le=typeof G=="object"?G[R.name]||G["*"]||200:G),[]),Q=0,Z=[],Y=m===uu;return v.clone().primaryKeys().then(function($){function oe(se){var ke=Math.min(le,$.length-se),_e=$.slice(se,se+ke);return(Y?Promise.resolve([]):R.getMany({trans:C,keys:_e,cache:"immutable"})).then(function(qe){var Ue=[],Oe=[],Xe=P?[]:null,Ye=Y?_e:[];if(!Y)for(var Re=0;Re<ke;++Re){var We=qe[Re],pt={value:pe(We),primKey:$[se+Re]};M.call(pt,pt.value,pt)!==!1&&(pt.value==null?Ye.push($[se+Re]):P||bt(K(We),K(pt.value))===0?(Oe.push(pt.value),P&&Xe.push($[se+Re])):(Ye.push($[se+Re]),Ue.push(pt.value)))}return Promise.resolve(0<Ue.length&&R.mutate({trans:C,type:"add",values:Ue}).then(function(kt){for(var at in kt.failures)Ye.splice(parseInt(at),1);N(Ue.length,kt)})).then(function(){return(0<Oe.length||fe&&typeof m=="object")&&R.mutate({trans:C,type:"put",keys:Xe,values:Oe,criteria:fe,changeSpec:typeof m!="function"&&m,isAdditionalChunk:0<se}).then(function(kt){return N(Oe.length,kt)})}).then(function(){return(0<Ye.length||fe&&Y)&&R.mutate({trans:C,type:"delete",keys:Ye,criteria:fe,isAdditionalChunk:0<se}).then(function(kt){return Wn(S.table,Ye,kt)}).then(function(kt){return N(Ye.length,kt)})}).then(function(){return $.length>se+ke&&oe(se+le)})})}var fe=Li(S)&&S.limit===1/0&&(typeof m!="function"||Y)&&{index:S.index,range:S.range};return oe(0).then(function(){if(0<F.length)throw new Qe("Error modifying one or more objects",F,Q,Z);return $.length})})})},Mt.prototype.delete=function(){var m=this._ctx,v=m.range;return!Li(m)||m.table.schema.yProps||!m.isPrimKey&&v.type!==3?this.modify(uu):this._write(function(S){var C=m.table.core.schema.primaryKey,N=v;return m.table.core.count({trans:S,query:{index:C,range:N}}).then(function(M){return m.table.core.mutate({trans:S,type:"deleteRange",range:N}).then(function(K){var P=K.failures,K=K.numFailures;if(K)throw new Qe("Could not delete some values",Object.keys(P).map(function(le){return P[le]}),M-K);return M-K})})})};var Xd=Mt;function Mt(){}var uu=function(m,v){return v.value=null};function cu(m,v){return m<v?-1:m===v?0:1}function Wd(m,v){return v<m?-1:m===v?0:1}function yr(m,v,S){return m=m instanceof oa?new m.Collection(m):m,m._ctx.error=new(S||TypeError)(v),m}function vi(m){return new m.Collection(m,function(){return Os("")}).limit(0)}function Sr(Z,v,S,C){var N,M,R,P,K,le,G,F=S.length;if(!S.every(function($){return typeof $=="string"}))return yr(Z,An);function Q($){N=$==="next"?function(fe){return fe.toUpperCase()}:function(fe){return fe.toLowerCase()},M=$==="next"?function(fe){return fe.toLowerCase()}:function(fe){return fe.toUpperCase()},R=$==="next"?cu:Wd;var oe=S.map(function(fe){return{lower:M(fe),upper:N(fe)}}).sort(function(fe,se){return R(fe.lower,se.lower)});P=oe.map(function(fe){return fe.upper}),K=oe.map(function(fe){return fe.lower}),G=(le=$)==="next"?"":C}Q("next");var Z=new Z.Collection(Z,function(){return Qr(P[0],K[F-1]+C)}),Y=(Z._ondirectionchange=function($){Q($)},0);return Z._addAlgorithm(function($,oe,fe){var se=$.key;if(typeof se=="string"){var ke=M(se);if(v(ke,K,Y))return!0;for(var _e=null,qe=Y;qe<F;++qe){var Ue=((Oe,Xe,Ye,Re,We,pt)=>{for(var kt=Math.min(Oe.length,Re.length),at=-1,gt=0;gt<kt;++gt){var Xt=Xe[gt];if(Xt!==Re[gt])return We(Oe[gt],Ye[gt])<0?Oe.substr(0,gt)+Ye[gt]+Ye.substr(gt+1):We(Oe[gt],Re[gt])<0?Oe.substr(0,gt)+Re[gt]+Ye.substr(gt+1):0<=at?Oe.substr(0,at)+Xe[at]+Ye.substr(at+1):null;We(Oe[gt],Xt)<0&&(at=gt)}return kt<Re.length&&pt==="next"?Oe+Ye.substr(Oe.length):kt<Oe.length&&pt==="prev"?Oe.substr(0,Ye.length):at<0?null:Oe.substr(0,at)+Re[at]+Ye.substr(at+1)})(se,ke,P[qe],K[qe],R,le);Ue===null&&_e===null?Y=qe+1:(_e===null||0<R(_e,Ue))&&(_e=Ue)}oe(_e!==null?function(){$.continue(_e+G)}:fe)}return!1}),Z}function Qr(m,v,S,C){return{type:2,lower:m,upper:v,lowerOpen:S,upperOpen:C}}function Os(m){return{type:1,lower:m,upper:m}}Object.defineProperty(cn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),cn.prototype.between=function(m,v,S,C){S=S!==!1,C=C===!0;try{return 0<this._cmp(m,v)||this._cmp(m,v)===0&&(S||C)&&(!S||!C)?vi(this):new this.Collection(this,function(){return Qr(m,v,!S,!C)})}catch{return yr(this,or)}},cn.prototype.equals=function(m){return m==null?yr(this,or):new this.Collection(this,function(){return Os(m)})},cn.prototype.above=function(m){return m==null?yr(this,or):new this.Collection(this,function(){return Qr(m,void 0,!0)})},cn.prototype.aboveOrEqual=function(m){return m==null?yr(this,or):new this.Collection(this,function(){return Qr(m,void 0,!1)})},cn.prototype.below=function(m){return m==null?yr(this,or):new this.Collection(this,function(){return Qr(void 0,m,!1,!0)})},cn.prototype.belowOrEqual=function(m){return m==null?yr(this,or):new this.Collection(this,function(){return Qr(void 0,m)})},cn.prototype.startsWith=function(m){return typeof m!="string"?yr(this,An):this.between(m,m+Rr,!0,!0)},cn.prototype.startsWithIgnoreCase=function(m){return m===""?this.startsWith(m):Sr(this,function(v,S){return v.indexOf(S[0])===0},[m],Rr)},cn.prototype.equalsIgnoreCase=function(m){return Sr(this,function(v,S){return v===S[0]},[m],"")},cn.prototype.anyOfIgnoreCase=function(){var m=q.apply(Ee,arguments);return m.length===0?vi(this):Sr(this,function(v,S){return S.indexOf(v)!==-1},m,"")},cn.prototype.startsWithAnyOfIgnoreCase=function(){var m=q.apply(Ee,arguments);return m.length===0?vi(this):Sr(this,function(v,S){return S.some(function(C){return v.indexOf(C)===0})},m,Rr)},cn.prototype.anyOf=function(){var m,v,S=this,C=q.apply(Ee,arguments),N=this._cmp;try{C.sort(N)}catch{return yr(this,or)}return C.length===0?vi(this):((m=new this.Collection(this,function(){return Qr(C[0],C[C.length-1])}))._ondirectionchange=function(M){N=M==="next"?S._ascending:S._descending,C.sort(N)},v=0,m._addAlgorithm(function(M,R,P){for(var K=M.key;0<N(K,C[v]);)if(++v===C.length)return R(P),!1;return N(K,C[v])===0||(R(function(){M.continue(C[v])}),!1)}),m)},cn.prototype.notEqual=function(m){return this.inAnyRange([[-1/0,m],[m,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},cn.prototype.noneOf=function(){var m=q.apply(Ee,arguments);if(m.length===0)return new this.Collection(this);try{m.sort(this._ascending)}catch{return yr(this,or)}var v=m.reduce(function(S,C){return S?S.concat([[S[S.length-1][1],C]]):[[-1/0,C]]},null);return v.push([m[m.length-1],this.db._maxKey]),this.inAnyRange(v,{includeLowers:!1,includeUppers:!1})},cn.prototype.inAnyRange=function(m,fe){var S=this,C=this._cmp,N=this._ascending,M=this._descending,R=this._min,P=this._max;if(m.length===0)return vi(this);if(!m.every(function(se){return se[0]!==void 0&&se[1]!==void 0&&N(se[0],se[1])<=0}))return yr(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Fe.InvalidArgument);var K=!fe||fe.includeLowers!==!1,le=fe&&fe.includeUppers===!0,G,F=N;function Q(se,ke){return F(se[0],ke[0])}try{(G=m.reduce(function(se,ke){for(var _e=0,qe=se.length;_e<qe;++_e){var Ue=se[_e];if(C(ke[0],Ue[1])<0&&0<C(ke[1],Ue[0])){Ue[0]=R(Ue[0],ke[0]),Ue[1]=P(Ue[1],ke[1]);break}}return _e===qe&&se.push(ke),se},[])).sort(Q)}catch{return yr(this,or)}var Z=0,Y=le?function(se){return 0<N(se,G[Z][1])}:function(se){return 0<=N(se,G[Z][1])},$=K?function(se){return 0<M(se,G[Z][0])}:function(se){return 0<=M(se,G[Z][0])},oe=Y,fe=new this.Collection(this,function(){return Qr(G[0][0],G[G.length-1][1],!K,!le)});return fe._ondirectionchange=function(se){F=se==="next"?(oe=Y,N):(oe=$,M),G.sort(Q)},fe._addAlgorithm(function(se,ke,_e){for(var qe,Ue=se.key;oe(Ue);)if(++Z===G.length)return ke(_e),!1;return!Y(qe=Ue)&&!$(qe)||(S._cmp(Ue,G[Z][1])===0||S._cmp(Ue,G[Z][0])===0||ke(function(){F===N?se.continue(G[Z][0]):se.continue(G[Z][1])}),!1)}),fe},cn.prototype.startsWithAnyOf=function(){var m=q.apply(Ee,arguments);return m.every(function(v){return typeof v=="string"})?m.length===0?vi(this):this.inAnyRange(m.map(function(v){return[v,v+Rr]})):yr(this,"startsWithAnyOf() only works with strings")};var oa=cn;function cn(){}function Lr(m){return en(function(v){return ua(v),m(v.target.error),!1})}function ua(m){m.stopPropagation&&m.stopPropagation(),m.preventDefault&&m.preventDefault()}var Fa="storagemutated",ca="x-storagemutated-1",Gn=$l(null,Fa),hu=(ur.prototype._lock=function(){return J(!Se.global),++this._reculock,this._reculock!==1||Se.global||(Se.lockOwnerFor=this),this},ur.prototype._unlock=function(){if(J(!Se.global),--this._reculock==0)for(Se.global||(Se.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var m=this._blockedFuncs.shift();try{Or(m[1],m[0])}catch{}}return this},ur.prototype._locked=function(){return this._reculock&&Se.lockOwnerFor!==this},ur.prototype.create=function(m){var v=this;if(this.mode){var S=this.db.idbdb,C=this.db._state.dbOpenError;if(J(!this.idbtrans),!m&&!S)switch(C&&C.name){case"DatabaseClosedError":throw new Fe.DatabaseClosed(C);case"MissingAPIError":throw new Fe.MissingAPI(C.message,C);default:throw new Fe.OpenFailed(C)}if(!this.active)throw new Fe.TransactionInactive;J(this._completion._state===null),(m=this.idbtrans=m||(this.db.core||S).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=en(function(N){ua(N),v._reject(m.error)}),m.onabort=en(function(N){ua(N),v.active&&v._reject(new Fe.Abort(m.error)),v.active=!1,v.on("abort").fire(N)}),m.oncomplete=en(function(){v.active=!1,v._resolve(),"mutatedParts"in m&&Gn.storagemutated.fire(m.mutatedParts)})}return this},ur.prototype._promise=function(m,v,S){var C,N=this;return m==="readwrite"&&this.mode!=="readwrite"?Qt(new Fe.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ve(function(M,R){N._blockedFuncs.push([function(){N._promise(m,v,S).then(M,R)},Se])}):S?an(function(){var M=new Ve(function(R,P){N._lock();var K=v(R,P,N);K&&K.then&&K.then(R,P)});return M.finally(function(){return N._unlock()}),M._lib=!0,M}):((C=new Ve(function(M,R){var P=v(M,R,N);P&&P.then&&P.then(M,R)}))._lib=!0,C):Qt(new Fe.TransactionInactive)},ur.prototype._root=function(){return this.parent?this.parent._root():this},ur.prototype.waitFor=function(m){var v,S=this._root(),C=Ve.resolve(m),N=(S._waitingFor?S._waitingFor=S._waitingFor.then(function(){return C}):(S._waitingFor=C,S._waitingQueue=[],v=S.idbtrans.objectStore(S.storeNames[0]),(function M(){for(++S._spinCount;S._waitingQueue.length;)S._waitingQueue.shift()();S._waitingFor&&(v.get(-1/0).onsuccess=M)})()),S._waitingFor);return new Ve(function(M,R){C.then(function(P){return S._waitingQueue.push(en(M.bind(null,P)))},function(P){return S._waitingQueue.push(en(R.bind(null,P)))}).finally(function(){S._waitingFor===N&&(S._waitingFor=null)})})},ur.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Fe.Abort))},ur.prototype.table=function(m){var v=this._memoizedTables||(this._memoizedTables={});if(g(v,m))return v[m];var S=this.schema[m];if(S)return(S=new this.db.Table(m,S,this)).core=this.db.core.table(m),v[m]=S;throw new Fe.NotFound("Table "+m+" not part of transaction")},ur);function ur(){}function Xr(m,v,S,C,N,M,R,P){return{name:m,keyPath:v,unique:S,multi:C,auto:N,compound:M,src:(S&&!R?"&":"")+(C?"*":"")+(N?"++":"")+Rs(v),type:P}}function Rs(m){return typeof m=="string"?m:m?"["+[].join.call(m,"+")+"]":""}function Ka(m,v,S){return{name:m,primKey:v,indexes:S,mappedClass:null,idxByName:(C=function(N){return[N.name,N]},S.reduce(function(N,M,R){return M=C(M,R),M&&(N[M[0]]=M[1]),N},{}))};var C}var Ga=function(m){try{return m.only([[]]),Ga=function(){return[[]]},[[]]}catch{return Ga=function(){return Rr},Rr}};function Ya(m){return m==null?function(){}:typeof m=="string"?(v=m).split(".").length===1?function(S){return S[v]}:function(S){return H(S,v)}:function(S){return H(S,m)};var v}function Wl(m){return[].slice.call(m)}var lh=0;function _n(m){return m==null?":id":typeof m=="string"?m:"[".concat(m.join("+"),"]")}function ha(m,v,K){function C(Y){if(Y.type===3)return null;if(Y.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var F=Y.lower,Q=Y.upper,Z=Y.lowerOpen,Y=Y.upperOpen;return F===void 0?Q===void 0?null:v.upperBound(Q,!!Y):Q===void 0?v.lowerBound(F,!!Z):v.bound(F,Q,!!Z,!!Y)}function N(G){var F,Q=G.name;return{name:Q,schema:G,mutate:function(Z){var Y=Z.trans,$=Z.type,oe=Z.keys,fe=Z.values,se=Z.range;return new Promise(function(ke,_e){ke=en(ke);var qe=Y.objectStore(Q),Ue=qe.keyPath==null,Oe=$==="put"||$==="add";if(!Oe&&$!=="delete"&&$!=="deleteRange")throw new Error("Invalid operation type: "+$);var Xe,Ye=(oe||fe||{length:1}).length;if(oe&&fe&&oe.length!==fe.length)throw new Error("Given keys array must have same length as given values array.");if(Ye===0)return ke({numFailures:0,failures:{},results:[],lastResult:void 0});function Re(Vt){++kt,ua(Vt)}var We=[],pt=[],kt=0;if($==="deleteRange"){if(se.type===4)return ke({numFailures:kt,failures:pt,results:[],lastResult:void 0});se.type===3?We.push(Xe=qe.clear()):We.push(Xe=qe.delete(C(se)))}else{var Ue=Oe?Ue?[fe,oe]:[fe,null]:[oe,null],at=Ue[0],gt=Ue[1];if(Oe)for(var Xt=0;Xt<Ye;++Xt)We.push(Xe=gt&&gt[Xt]!==void 0?qe[$](at[Xt],gt[Xt]):qe[$](at[Xt])),Xe.onerror=Re;else for(Xt=0;Xt<Ye;++Xt)We.push(Xe=qe[$](at[Xt])),Xe.onerror=Re}function hr(Vt){Vt=Vt.target.result,We.forEach(function(Pi,Ja){return Pi.error!=null&&(pt[Ja]=Pi.error)}),ke({numFailures:kt,failures:pt,results:$==="delete"?oe:We.map(function(Pi){return Pi.result}),lastResult:Vt})}Xe.onerror=function(Vt){Re(Vt),hr(Vt)},Xe.onsuccess=hr})},getMany:function(Z){var Y=Z.trans,$=Z.keys;return new Promise(function(oe,fe){oe=en(oe);for(var se,ke=Y.objectStore(Q),_e=$.length,qe=new Array(_e),Ue=0,Oe=0,Xe=function(We){We=We.target,qe[We._pos]=We.result,++Oe===Ue&&oe(qe)},Ye=Lr(fe),Re=0;Re<_e;++Re)$[Re]!=null&&((se=ke.get($[Re]))._pos=Re,se.onsuccess=Xe,se.onerror=Ye,++Ue);Ue===0&&oe(qe)})},get:function(Z){var Y=Z.trans,$=Z.key;return new Promise(function(oe,fe){oe=en(oe);var se=Y.objectStore(Q).get($);se.onsuccess=function(ke){return oe(ke.target.result)},se.onerror=Lr(fe)})},query:(F=P,function(Z){return new Promise(function(Y,$){Y=en(Y);var oe,fe,se,Oe=Z.trans,ke=Z.values,_e=Z.limit,Ue=Z.query,qe=_e===1/0?void 0:_e,Xe=Ue.index,Ue=Ue.range,Oe=Oe.objectStore(Q),Oe=Xe.isPrimaryKey?Oe:Oe.index(Xe.name),Xe=C(Ue);if(_e===0)return Y({result:[]});F?((Ue=ke?Oe.getAll(Xe,qe):Oe.getAllKeys(Xe,qe)).onsuccess=function(Ye){return Y({result:Ye.target.result})},Ue.onerror=Lr($)):(oe=0,fe=!ke&&"openKeyCursor"in Oe?Oe.openKeyCursor(Xe):Oe.openCursor(Xe),se=[],fe.onsuccess=function(Ye){var Re=fe.result;return!Re||(se.push(ke?Re.value:Re.primaryKey),++oe===_e)?Y({result:se}):void Re.continue()},fe.onerror=Lr($))})}),openCursor:function(Z){var Y=Z.trans,$=Z.values,oe=Z.query,fe=Z.reverse,se=Z.unique;return new Promise(function(ke,_e){ke=en(ke);var Oe=oe.index,qe=oe.range,Ue=Y.objectStore(Q),Ue=Oe.isPrimaryKey?Ue:Ue.index(Oe.name),Oe=fe?se?"prevunique":"prev":se?"nextunique":"next",Xe=!$&&"openKeyCursor"in Ue?Ue.openKeyCursor(C(qe),Oe):Ue.openCursor(C(qe),Oe);Xe.onerror=Lr(_e),Xe.onsuccess=en(function(Ye){var Re,We,pt,kt,at=Xe.result;at?(at.___id=++lh,at.done=!1,Re=at.continue.bind(at),We=(We=at.continuePrimaryKey)&&We.bind(at),pt=at.advance.bind(at),kt=function(){throw new Error("Cursor not stopped")},at.trans=Y,at.stop=at.continue=at.continuePrimaryKey=at.advance=function(){throw new Error("Cursor not started")},at.fail=en(_e),at.next=function(){var gt=this,Xt=1;return this.start(function(){return Xt--?gt.continue():gt.stop()}).then(function(){return gt})},at.start=function(gt){function Xt(){if(Xe.result)try{gt()}catch(Vt){at.fail(Vt)}else at.done=!0,at.start=function(){throw new Error("Cursor behind last entry")},at.stop()}var hr=new Promise(function(Vt,Pi){Vt=en(Vt),Xe.onerror=Lr(Pi),at.fail=Pi,at.stop=function(Ja){at.stop=at.continue=at.continuePrimaryKey=at.advance=kt,Vt(Ja)}});return Xe.onsuccess=en(function(Vt){Xe.onsuccess=Xt,Xt()}),at.continue=Re,at.continuePrimaryKey=We,at.advance=pt,Xt(),hr},ke(at)):ke(null)},_e)})},count:function(Z){var Y=Z.query,$=Z.trans,oe=Y.index,fe=Y.range;return new Promise(function(se,ke){var _e=$.objectStore(Q),_e=oe.isPrimaryKey?_e:_e.index(oe.name),qe=C(fe),qe=qe?_e.count(qe):_e.count();qe.onsuccess=en(function(Ue){return se(Ue.target.result)}),qe.onerror=Lr(ke)})}}}M=K,R=Wl((K=m).objectStoreNames);var M,K={schema:{name:K.name,tables:R.map(function(G){return M.objectStore(G)}).map(function(G){var F=G.keyPath,Q=G.autoIncrement,Y=c(F),Z={},Y={name:G.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:F==null,compound:Y,keyPath:F,autoIncrement:Q,unique:!0,extractKey:Ya(F)},indexes:Wl(G.indexNames).map(function($){return G.index($)}).map(function(se){var ke=se.name,oe=se.unique,fe=se.multiEntry,se=se.keyPath,ke={name:ke,compound:c(se),keyPath:se,unique:oe,multiEntry:fe,extractKey:Ya(se)};return Z[_n(se)]=ke}),getIndexByKeyPath:function($){return Z[_n($)]}};return Z[":id"]=Y.primaryKey,F!=null&&(Z[_n(F)]=Y.primaryKey),Y})},hasGetAll:0<R.length&&"getAll"in M.objectStore(R[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},R=K.schema,P=K.hasGetAll,K=R.tables.map(N),le={};return K.forEach(function(G){return le[G.name]=G}),{stack:"dbcore",transaction:m.transaction.bind(m),table:function(G){if(le[G])return le[G];throw new Error("Table '".concat(G,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ga(v),schema:R}}function Ls(m,v,S,C){return S=S.IDBKeyRange,v=ha(v,S,C),{dbcore:m.dbcore.reduce(function(N,M){return M=M.create,r(r({},N),M(N))},v)}}function Bi(m,v){var S=v.db,S=Ls(m._middlewares,S,m._deps,v);m.core=S.dbcore,m.tables.forEach(function(C){var N=C.name;m.core.schema.tables.some(function(M){return M.name===N})&&(C.core=m.core.table(N),m[N]instanceof m.Table)&&(m[N].core=C.core)})}function Bs(m,v,S,C){S.forEach(function(N){var M=C[N];v.forEach(function(R){var P=(function K(le,G){return j(le,G)||(le=d(le))&&K(le,G)})(R,N);(!P||"value"in P&&P.value===void 0)&&(R===m.Transaction.prototype||R instanceof m.Transaction?A(R,N,{get:function(){return this.table(N)},set:function(K){w(this,N,{value:K,writable:!0,configurable:!0,enumerable:!0})}}):R[N]=new m.Table(N,M))})})}function Zl(m,v){v.forEach(function(S){for(var C in S)S[C]instanceof m.Table&&delete S[C]})}function fu(m,v){return m._cfg.version-v._cfg.version}function Jl(m,v,S,C){var N=m._dbSchema,M=(S.objectStoreNames.contains("$meta")&&!N.$meta&&(N.$meta=Ka("$meta",oh("")[0],[]),m._storeNames.push("$meta")),m._createTransaction("readwrite",m._storeNames,N)),R=(M.create(S),M._completion.catch(C),M._reject.bind(M)),P=Se.transless||Se;an(function(){if(Se.trans=M,Se.transless=P,v!==0)return Bi(m,S),le=v,((K=M).storeNames.includes("$meta")?K.table("$meta").get("version").then(function(G){return G??le}):Ve.resolve(le)).then(function(oe){var F=m,Q=oe,Z=M,Y=S,$=[],oe=F._versions,fe=F._dbSchema=$a(0,F.idbdb,Y);return(oe=oe.filter(function(se){return se._cfg.version>=Q})).length===0?Ve.resolve():(oe.forEach(function(se){$.push(function(){var ke,_e,qe,Ue=fe,Oe=se._cfg.dbschema,Xe=(Hs(F,Ue,Y),Hs(F,Oe,Y),fe=F._dbSchema=Oe,Is(Ue,Oe)),Ye=(Xe.add.forEach(function(Re){du(Y,Re[0],Re[1].primKey,Re[1].indexes)}),Xe.change.forEach(function(Re){if(Re.recreate)throw new Fe.Upgrade("Not yet support for changing primary key");var We=Y.objectStore(Re.name);Re.add.forEach(function(pt){return Ps(We,pt)}),Re.change.forEach(function(pt){We.deleteIndex(pt.name),Ps(We,pt)}),Re.del.forEach(function(pt){return We.deleteIndex(pt)})}),se._cfg.contentUpgrade);if(Ye&&se._cfg.version>Q)return Bi(F,Y),Z._memoizedTables={},ke=me(Oe),Xe.del.forEach(function(Re){ke[Re]=Ue[Re]}),Zl(F,[F.Transaction.prototype]),Bs(F,[F.Transaction.prototype],o(ke),ke),Z.schema=ke,(_e=ye(Ye))&&Cn(),Oe=Ve.follow(function(){var Re;(qe=Ye(Z))&&_e&&(Re=gr.bind(null,null),qe.then(Re,Re))}),qe&&typeof qe.then=="function"?Ve.resolve(qe):Oe.then(function(){return qe})}),$.push(function(ke){var _e,qe,Ue=se._cfg.dbschema;_e=Ue,qe=ke,[].slice.call(qe.db.objectStoreNames).forEach(function(Oe){return _e[Oe]==null&&qe.db.deleteObjectStore(Oe)}),Zl(F,[F.Transaction.prototype]),Bs(F,[F.Transaction.prototype],F._storeNames,F._dbSchema),Z.schema=F._dbSchema}),$.push(function(ke){F.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(F.idbdb.version/10)===se._cfg.version?(F.idbdb.deleteObjectStore("$meta"),delete F._dbSchema.$meta,F._storeNames=F._storeNames.filter(function(_e){return _e!=="$meta"})):ke.objectStore("$meta").put(se._cfg.version,"version"))})}),(function se(){return $.length?Ve.resolve($.shift()(Z.idbtrans)).then(se):Ve.resolve()})().then(function(){sh(fe,Y)}))}).catch(R);var K,le;o(N).forEach(function(G){du(S,G,N[G].primKey,N[G].indexes)}),Bi(m,S),Ve.follow(function(){return m.on.populate.fire(M)}).catch(R)})}function zs(m,v){sh(m._dbSchema,v),v.db.version%10!=0||v.objectStoreNames.contains("$meta")||v.db.createObjectStore("$meta").add(Math.ceil(v.db.version/10-1),"version");var S=$a(0,m.idbdb,v);Hs(m,m._dbSchema,v);for(var C=0,N=Is(S,m._dbSchema).change;C<N.length;C++){var M=(R=>{if(R.change.length||R.recreate)return console.warn("Unable to patch indexes of table ".concat(R.name," because it has changes on the type of index or primary key.")),{value:void 0};var P=v.objectStore(R.name);R.add.forEach(function(K){Pe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(R.name,".").concat(K.src)),Ps(P,K)})})(N[C]);if(typeof M=="object")return M.value}}function Is(m,v){var S,C={del:[],add:[],change:[]};for(S in m)v[S]||C.del.push(S);for(S in v){var N=m[S],M=v[S];if(N){var R={name:S,def:M,recreate:!1,del:[],add:[],change:[]};if(""+(N.primKey.keyPath||"")!=""+(M.primKey.keyPath||"")||N.primKey.auto!==M.primKey.auto)R.recreate=!0,C.change.push(R);else{var P=N.idxByName,K=M.idxByName,le=void 0;for(le in P)K[le]||R.del.push(le);for(le in K){var G=P[le],F=K[le];G?G.src!==F.src&&R.change.push(F):R.add.push(F)}(0<R.del.length||0<R.add.length||0<R.change.length)&&C.change.push(R)}}else C.add.push([S,M])}return C}function du(m,v,S,C){var N=m.db.createObjectStore(v,S.keyPath?{keyPath:S.keyPath,autoIncrement:S.auto}:{autoIncrement:S.auto});C.forEach(function(M){return Ps(N,M)})}function sh(m,v){o(m).forEach(function(S){v.db.objectStoreNames.contains(S)||(Pe&&console.debug("Dexie: Creating missing table",S),du(v,S,m[S].primKey,m[S].indexes))})}function Ps(m,v){m.createIndex(v.name,v.keyPath,{unique:v.unique,multiEntry:v.multi})}function $a(m,v,S){var C={};return U(v.objectStoreNames,0).forEach(function(N){for(var M=S.objectStore(N),R=Xr(Rs(le=M.keyPath),le||"",!0,!1,!!M.autoIncrement,le&&typeof le!="string",!0),P=[],K=0;K<M.indexNames.length;++K){var G=M.index(M.indexNames[K]),le=G.keyPath,G=Xr(G.name,le,!!G.unique,!!G.multiEntry,!1,le&&typeof le!="string",!1);P.push(G)}C[N]=Ka(N,R,P)}),C}function Hs(m,v,S){for(var C=S.db.objectStoreNames,N=0;N<C.length;++N){var M=C[N],R=S.objectStore(M);m._hasGetAll="getAll"in R;for(var P=0;P<R.indexNames.length;++P){var K,le=R.indexNames[P],G=R.index(le).keyPath,G=typeof G=="string"?G:"["+U(G).join("+")+"]";v[M]&&(K=v[M].idxByName[G])&&(K.name=le,delete v[M].idxByName[G],v[M].idxByName[le]=K)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(m._hasGetAll=!1)}function oh(m){return m.split(",").map(function(v,S){var N=v.split(":"),C=(C=N[1])==null?void 0:C.trim(),N=(v=N[0].trim()).replace(/([&*]|\+\+)/g,""),M=/^\[/.test(N)?N.match(/^\[(.*)\]$/)[1].split("+"):N;return Xr(N,M||null,/\&/.test(v),/\*/.test(v),/\+\+/.test(v),c(M),S===0,C)})}Qa.prototype._createTableSchema=Ka,Qa.prototype._parseIndexSyntax=oh,Qa.prototype._parseStoresSpec=function(m,v){var S=this;o(m).forEach(function(C){if(m[C]!==null){var N=S._parseIndexSyntax(m[C]),M=N.shift();if(!M)throw new Fe.Schema("Invalid schema for table "+C+": "+m[C]);if(M.unique=!0,M.multi)throw new Fe.Schema("Primary key cannot be multiEntry*");N.forEach(function(R){if(R.auto)throw new Fe.Schema("Only primary key can be marked as autoIncrement (++)");if(!R.keyPath)throw new Fe.Schema("Index must have a name and cannot be an empty string")}),M=S._createTableSchema(C,M,N),v[C]=M}})},Qa.prototype.stores=function(S){var v=this.db,S=(this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,S):S,v._versions),C={},N={};return S.forEach(function(M){h(C,M._cfg.storesSource),N=M._cfg.dbschema={},M._parseStoresSpec(C,N)}),v._dbSchema=N,Zl(v,[v._allTables,v,v.Transaction.prototype]),Bs(v,[v._allTables,v,v.Transaction.prototype,this._cfg.tables],o(N),N),v._storeNames=o(N),this},Qa.prototype.upgrade=function(m){return this._cfg.contentUpgrade=Fn(this._cfg.contentUpgrade||dt,m),this};var Zd=Qa;function Qa(){}function pu(m,v){var S=m._dbNamesDB;return S||(S=m._dbNamesDB=new Wr(Kl,{addons:[],indexedDB:m,IDBKeyRange:v})).version(1).stores({dbnames:"name"}),S.table("dbnames")}function qs(m){return m&&typeof m.databases=="function"}function mu(m){return an(function(){return Se.letThrough=!0,m()})}function gu(m){return!("from"in m)}var Yn=function(m,v){var S;if(!this)return S=new Yn,m&&"d"in m&&h(S,m),S;h(this,arguments.length?{d:1,from:m,to:1<arguments.length?v:m}:{d:0})};function es(m,v,S){var C=bt(v,S);if(!isNaN(C)){if(0<C)throw RangeError();if(gu(m))return h(m,{from:v,to:S,d:1});var C=m.l,N=m.r;if(bt(S,m.from)<0)return C?es(C,v,S):m.l={from:v,to:S,d:1,l:null,r:null},ch(m);if(0<bt(v,m.to))return N?es(N,v,S):m.r={from:v,to:S,d:1,l:null,r:null},ch(m);bt(v,m.from)<0&&(m.from=v,m.l=null,m.d=N?N.d+1:1),0<bt(S,m.to)&&(m.to=S,m.r=null,m.d=m.l?m.l.d+1:1),v=!m.r,C&&!m.l&&fa(m,C),N&&v&&fa(m,N)}}function fa(m,v){gu(v)||(function S(C,N){var M=N.from,R=N.l,P=N.r;es(C,M,N.to),R&&S(C,R),P&&S(C,P)})(m,v)}function uh(m,v){var S=Us(v),C=S.next();if(!C.done)for(var N=C.value,M=Us(m),R=M.next(N.from),P=R.value;!C.done&&!R.done;){if(bt(P.from,N.to)<=0&&0<=bt(P.to,N.from))return!0;bt(N.from,P.from)<0?N=(C=S.next(P.from)).value:P=(R=M.next(N.from)).value}return!1}function Us(m){var v=gu(m)?null:{s:0,n:m};return{next:function(S){for(var C=0<arguments.length;v;)switch(v.s){case 0:if(v.s=1,C)for(;v.n.l&&bt(S,v.n.from)<0;)v={up:v,n:v.n.l,s:1};else for(;v.n.l;)v={up:v,n:v.n.l,s:1};case 1:if(v.s=2,!C||bt(S,v.n.to)<=0)return{value:v.n,done:!1};case 2:if(v.n.r){v.s=3,v={up:v,n:v.n.r,s:0};continue}case 3:v=v.up}return{done:!0}}}}function ch(m){var v,S,C,N=(((N=m.r)==null?void 0:N.d)||0)-(((N=m.l)==null?void 0:N.d)||0),N=1<N?"r":N<-1?"l":"";N&&(v=N=="r"?"l":"r",S=r({},m),C=m[N],m.from=C.from,m.to=C.to,m[N]=C[N],S[N]=C[v],(m[v]=S).d=yu(S)),m.d=yu(m)}function yu(S){var v=S.r,S=S.l;return(v?S?Math.max(v.d,S.d):v.d:S?S.d:0)+1}function Vs(m,v){return o(v).forEach(function(S){m[S]?fa(m[S],v[S]):m[S]=(function C(N){var M,R,P={};for(M in N)g(N,M)&&(R=N[M],P[M]=!R||typeof R!="object"||te.has(R.constructor)?R:C(R));return P})(v[S])}),m}function xu(m,v){return m.all||v.all||Object.keys(m).some(function(S){return v[S]&&uh(v[S],m[S])})}k(Yn.prototype,((ie={add:function(m){return fa(this,m),this},addKey:function(m){return es(this,m,m),this},addKeys:function(m){var v=this;return m.forEach(function(S){return es(v,S,S)}),this},hasKey:function(m){var v=Us(this).next(m).value;return v&&bt(v.from,m)<=0&&0<=bt(v.to,m)}})[X]=function(){return Us(this)},ie));var da={},vu={},bu=!1;function Fs(m){Vs(vu,m),bu||(bu=!0,setTimeout(function(){bu=!1,ku(vu,!(vu={}))},0))}function ku(m,v){v===void 0&&(v=!1);var S=new Set;if(m.all)for(var C=0,N=Object.values(da);C<N.length;C++)hh(P=N[C],m,S,v);else for(var M in m){var R,P,M=/^idb\:\/\/(.*)\/(.*)\//.exec(M);M&&(R=M[1],M=M[2],P=da["idb://".concat(R,"/").concat(M)])&&hh(P,m,S,v)}S.forEach(function(K){return K()})}function hh(m,v,S,C){for(var N=[],M=0,R=Object.entries(m.queries.query);M<R.length;M++){for(var P=R[M],K=P[0],le=[],G=0,F=P[1];G<F.length;G++){var Q=F[G];xu(v,Q.obsSet)?Q.subscribers.forEach(function(oe){return S.add(oe)}):C&&le.push(Q)}C&&N.push([K,le])}if(C)for(var Z=0,Y=N;Z<Y.length;Z++){var $=Y[Z],K=$[0],le=$[1];m.queries.query[K]=le}}function Jd(m){var v=m._state,S=m._deps.indexedDB;if(v.isBeingOpened||m.idbdb)return v.dbReadyPromise.then(function(){return v.dbOpenError?Qt(v.dbOpenError):m});v.isBeingOpened=!0,v.dbOpenError=null,v.openComplete=!1;var C=v.openCanceller,N=Math.round(10*m.verno),M=!1;function R(){if(v.openCanceller!==C)throw new Fe.DatabaseClosed("db.open() was cancelled")}function P(){return new Ve(function(Q,Z){if(R(),!S)throw new Fe.MissingAPI;var Y=m.name,$=v.autoSchema||!N?S.open(Y):S.open(Y,N);if(!$)throw new Fe.MissingAPI;$.onerror=Lr(Z),$.onblocked=en(m._fireOnBlocked),$.onupgradeneeded=en(function(oe){var fe;G=$.transaction,v.autoSchema&&!m._options.allowEmptyDB?($.onerror=ua,G.abort(),$.result.close(),(fe=S.deleteDatabase(Y)).onsuccess=fe.onerror=en(function(){Z(new Fe.NoSuchDatabase("Database ".concat(Y," doesnt exist")))})):(G.onerror=Lr(Z),fe=oe.oldVersion>Math.pow(2,62)?0:oe.oldVersion,F=fe<1,m.idbdb=$.result,M&&zs(m,G),Jl(m,fe/10,G,Z))},Z),$.onsuccess=en(function(){G=null;var oe,fe,se,ke,_e,qe,Ue=m.idbdb=$.result,Oe=U(Ue.objectStoreNames);if(0<Oe.length)try{var Xe=Ue.transaction((_e=Oe).length===1?_e[0]:_e,"readonly");if(v.autoSchema)qe=Ue,ke=Xe,(se=m).verno=qe.version/10,ke=se._dbSchema=$a(0,qe,ke),se._storeNames=U(qe.objectStoreNames,0),Bs(se,[se._allTables],o(ke),ke);else if(Hs(m,m._dbSchema,Xe),fe=Xe,((fe=Is($a(0,(oe=m).idbdb,fe),oe._dbSchema)).add.length||fe.change.some(function(Ye){return Ye.add.length||Ye.change.length}))&&!M)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Ue.close(),N=Ue.version+1,M=!0,Q(P());Bi(m,Xe)}catch{}aa.push(m),Ue.onversionchange=en(function(Ye){v.vcFired=!0,m.on("versionchange").fire(Ye)}),Ue.onclose=en(function(){m.close({disableAutoOpen:!1})}),F&&(Oe=m._deps,_e=Y,qs(qe=Oe.indexedDB)||_e===Kl||pu(qe,Oe.IDBKeyRange).put({name:_e}).catch(dt)),Q()},Z)}).catch(function(Q){switch(Q?.name){case"UnknownError":if(0<v.PR1398_maxLoop)return v.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),P();break;case"VersionError":if(0<N)return N=0,P()}return Ve.reject(Q)})}var K,le=v.dbReadyResolve,G=null,F=!1;return Ve.race([C,(typeof navigator>"u"?Ve.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Q){function Z(){return indexedDB.databases().finally(Q)}K=setInterval(Z,100),Z()}).finally(function(){return clearInterval(K)}):Promise.resolve()).then(P)]).then(function(){return R(),v.onReadyBeingFired=[],Ve.resolve(mu(function(){return m.on.ready.fire(m.vip)})).then(function Q(){var Z;if(0<v.onReadyBeingFired.length)return Z=v.onReadyBeingFired.reduce(Fn,dt),v.onReadyBeingFired=[],Ve.resolve(mu(function(){return Z(m.vip)})).then(Q)})}).finally(function(){v.openCanceller===C&&(v.onReadyBeingFired=null,v.isBeingOpened=!1)}).catch(function(Q){v.dbOpenError=Q;try{G&&G.abort()}catch{}return C===v.openCanceller&&m._close(),Qt(Q)}).finally(function(){v.openComplete=!0,le()}).then(function(){var Q;return F&&(Q={},m.tables.forEach(function(Z){Z.schema.indexes.forEach(function(Y){Y.name&&(Q["idb://".concat(m.name,"/").concat(Z.name,"/").concat(Y.name)]=new Yn(-1/0,[[[]]]))}),Q["idb://".concat(m.name,"/").concat(Z.name,"/")]=Q["idb://".concat(m.name,"/").concat(Z.name,"/:dels")]=new Yn(-1/0,[[[]]])}),Gn(Fa).fire(Q),ku(Q,!0)),m})}function ts(m){function v(M){return m.next(M)}var S=N(v),C=N(function(M){return m.throw(M)});function N(M){return function(P){var P=M(P),K=P.value;return P.done?K:K&&typeof K.then=="function"?K.then(S,C):c(K)?Promise.all(K).then(S,C):S(K)}}return N(v)()}function zi(m,v,S){for(var C=c(m)?m.slice():[m],N=0;N<S;++N)C.push(v);return C}var ep={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(m){return r(r({},m),{table:function(C){var S=m.table(C),C=S.schema,N={},M=[];function R(Q,Z,Y){var se=_n(Q),$=N[se]=N[se]||[],oe=Q==null?0:typeof Q=="string"?1:Q.length,fe=0<Z,se=r(r({},Y),{name:fe?"".concat(se,"(virtual-from:").concat(Y.name,")"):Y.name,lowLevelIndex:Y,isVirtual:fe,keyTail:Z,keyLength:oe,extractKey:Ya(Q),unique:!fe&&Y.unique});return $.push(se),se.isPrimaryKey||M.push(se),1<oe&&R(oe===2?Q[0]:Q.slice(0,oe-1),Z+1,Y),$.sort(function(ke,_e){return ke.keyTail-_e.keyTail}),se}var P=R(C.primaryKey.keyPath,0,C.primaryKey);N[":id"]=[P];for(var K=0,le=C.indexes;K<le.length;K++){var G=le[K];R(G.keyPath,0,G)}function F(Q){var Z,Y=Q.query.index;return Y.isVirtual?r(r({},Q),{query:{index:Y.lowLevelIndex,range:(Z=Q.query.range,Y=Y.keyTail,{type:Z.type===1?2:Z.type,lower:zi(Z.lower,Z.lowerOpen?m.MAX_KEY:m.MIN_KEY,Y),lowerOpen:!0,upper:zi(Z.upper,Z.upperOpen?m.MIN_KEY:m.MAX_KEY,Y),upperOpen:!0})}}):Q}return r(r({},S),{schema:r(r({},C),{primaryKey:P,indexes:M,getIndexByKeyPath:function(Q){return(Q=N[_n(Q)])&&Q[0]}}),count:function(Q){return S.count(F(Q))},query:function(Q){return S.query(F(Q))},openCursor:function(Q){var Z=Q.query.index,Y=Z.keyTail,$=Z.keyLength;return Z.isVirtual?S.openCursor(F(Q)).then(function(fe){return fe&&oe(fe)}):S.openCursor(Q);function oe(fe){return Object.create(fe,{continue:{value:function(se){se!=null?fe.continue(zi(se,Q.reverse?m.MAX_KEY:m.MIN_KEY,Y)):Q.unique?fe.continue(fe.key.slice(0,$).concat(Q.reverse?m.MIN_KEY:m.MAX_KEY,Y)):fe.continue()}},continuePrimaryKey:{value:function(se,ke){fe.continuePrimaryKey(zi(se,m.MAX_KEY,Y),ke)}},primaryKey:{get:function(){return fe.primaryKey}},key:{get:function(){var se=fe.key;return $===1?se[0]:se.slice(0,$)}},value:{get:function(){return fe.value}}})}}})}})}};function Ks(m,v,S,C){return S=S||{},C=C||"",o(m).forEach(function(N){var M,R,P;g(v,N)?(M=m[N],R=v[N],typeof M=="object"&&typeof R=="object"&&M&&R?(P=re(M))!==re(R)?S[C+N]=v[N]:P==="Object"?Ks(M,R,S,C+N+"."):M!==R&&(S[C+N]=v[N]):M!==R&&(S[C+N]=v[N])):S[C+N]=void 0}),o(v).forEach(function(N){g(m,N)||(S[C+N]=v[N])}),S}function Gs(m,v){return v.type==="delete"?v.keys:v.keys||v.values.map(m.extractKey)}var fh={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(m){return r(r({},m),{table:function(v){var S=m.table(v),C=S.schema.primaryKey;return r(r({},S),{mutate:function(N){var M=Se.trans,R=M.table(v).hook,P=R.deleting,K=R.creating,le=R.updating;switch(N.type){case"add":if(K.fire===dt)break;return M._promise("readwrite",function(){return G(N)},!0);case"put":if(K.fire===dt&&le.fire===dt)break;return M._promise("readwrite",function(){return G(N)},!0);case"delete":if(P.fire===dt)break;return M._promise("readwrite",function(){return G(N)},!0);case"deleteRange":if(P.fire===dt)break;return M._promise("readwrite",function(){return(function F(Q,Z,Y){return S.query({trans:Q,values:!1,query:{index:C,range:Z},limit:Y}).then(function($){var oe=$.result;return G({type:"delete",keys:oe,trans:Q}).then(function(fe){return 0<fe.numFailures?Promise.reject(fe.failures[0]):oe.length<Y?{failures:[],numFailures:0,lastResult:void 0}:F(Q,r(r({},Z),{lower:oe[oe.length-1],lowerOpen:!0}),Y)})})})(N.trans,N.range,1e4)},!0)}return S.mutate(N);function G(F){var Q,Z,Y,$=Se.trans,oe=F.keys||Gs(C,F);if(oe)return(F=F.type==="add"||F.type==="put"?r(r({},F),{keys:oe}):r({},F)).type!=="delete"&&(F.values=a([],F.values)),F.keys&&(F.keys=a([],F.keys)),Q=S,Y=oe,((Z=F).type==="add"?Promise.resolve([]):Q.getMany({trans:Z.trans,keys:Y,cache:"immutable"})).then(function(fe){var se=oe.map(function(ke,_e){var qe,Ue,Oe,Xe=fe[_e],Ye={onerror:null,onsuccess:null};return F.type==="delete"?P.fire.call(Ye,ke,Xe,$):F.type==="add"||Xe===void 0?(qe=K.fire.call(Ye,ke,F.values[_e],$),ke==null&&qe!=null&&(F.keys[_e]=ke=qe,C.outbound||L(F.values[_e],C.keyPath,ke))):(qe=Ks(Xe,F.values[_e]),(Ue=le.fire.call(Ye,qe,ke,Xe,$))&&(Oe=F.values[_e],Object.keys(Ue).forEach(function(Re){g(Oe,Re)?Oe[Re]=Ue[Re]:L(Oe,Re,Ue[Re])}))),Ye});return S.mutate(F).then(function(ke){for(var _e=ke.failures,qe=ke.results,Ue=ke.numFailures,ke=ke.lastResult,Oe=0;Oe<oe.length;++Oe){var Xe=(qe||oe)[Oe],Ye=se[Oe];Xe==null?Ye.onerror&&Ye.onerror(_e[Oe]):Ye.onsuccess&&Ye.onsuccess(F.type==="put"&&fe[Oe]?F.values[Oe]:Xe)}return{failures:_e,results:qe,numFailures:Ue,lastResult:ke}}).catch(function(ke){return se.forEach(function(_e){return _e.onerror&&_e.onerror(ke)}),Promise.reject(ke)})});throw new Error("Keys missing")}}})}})}};function wu(m,v,S){try{if(!v||v.keys.length<m.length)return null;for(var C=[],N=0,M=0;N<v.keys.length&&M<m.length;++N)bt(v.keys[N],m[M])===0&&(C.push(S?pe(v.values[N]):v.values[N]),++M);return C.length===m.length?C:null}catch{return null}}var dh={stack:"dbcore",level:-1,create:function(m){return{table:function(v){var S=m.table(v);return r(r({},S),{getMany:function(C){var N;return C.cache?(N=wu(C.keys,C.trans._cache,C.cache==="clone"))?Ve.resolve(N):S.getMany(C).then(function(M){return C.trans._cache={keys:C.keys,values:C.cache==="clone"?pe(M):M},M}):S.getMany(C)},mutate:function(C){return C.type!=="add"&&(C.trans._cache=null),S.mutate(C)}})}}}};function pa(m,v){return m.trans.mode==="readonly"&&!!m.subscr&&!m.trans.explicit&&m.trans.db._options.cache!=="disabled"&&!v.schema.primaryKey.outbound}function ph(m,v){switch(m){case"query":return v.values&&!v.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var tp={stack:"dbcore",level:0,name:"Observability",create:function(m){var v=m.schema.name,S=new Yn(m.MIN_KEY,m.MAX_KEY);return r(r({},m),{transaction:function(C,N,M){if(Se.subscr&&N!=="readonly")throw new Fe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Se.querier));return m.transaction(C,N,M)},table:function(C){function N(oe){var $,oe=oe.query;return[$=oe.index,new Yn(($=(oe=oe.range).lower)!=null?$:m.MIN_KEY,($=oe.upper)!=null?$:m.MAX_KEY)]}var M=m.table(C),R=M.schema,P=R.primaryKey,K=R.indexes,le=P.extractKey,G=P.outbound,F=P.autoIncrement&&K.filter(function(Y){return Y.compound&&Y.keyPath.includes(P.keyPath)}),Q=r(r({},M),{mutate:function(Y){function $(We){return We="idb://".concat(v,"/").concat(C,"/").concat(We),_e[We]||(_e[We]=new Yn)}var oe,fe,se,ke=Y.trans,_e=Y.mutatedParts||(Y.mutatedParts={}),qe=$(""),Ue=$(":dels"),Oe=Y.type,Ye=Y.type==="deleteRange"?[Y.range]:Y.type==="delete"?[Y.keys]:Y.values.length<50?[Gs(P,Y).filter(function(We){return We}),Y.values]:[],Xe=Ye[0],Ye=Ye[1],Re=Y.trans._cache;return c(Xe)?(qe.addKeys(Xe),(Oe=Oe==="delete"||Xe.length===Ye.length?wu(Xe,Re):null)||Ue.addKeys(Xe),(Oe||Ye)&&(oe=$,fe=Oe,se=Ye,R.indexes.forEach(function(We){var pt=oe(We.name||"");function kt(gt){return gt!=null?We.extractKey(gt):null}function at(gt){We.multiEntry&&c(gt)?gt.forEach(function(Xt){return pt.addKey(Xt)}):pt.addKey(gt)}(fe||se).forEach(function(gt,Vt){var hr=fe&&kt(fe[Vt]),Vt=se&&kt(se[Vt]);bt(hr,Vt)!==0&&(hr!=null&&at(hr),Vt!=null)&&at(Vt)})}))):Xe?(Ye={from:(Re=Xe.lower)!=null?Re:m.MIN_KEY,to:(Oe=Xe.upper)!=null?Oe:m.MAX_KEY},Ue.add(Ye),qe.add(Ye)):(qe.add(S),Ue.add(S),R.indexes.forEach(function(We){return $(We.name).add(S)})),M.mutate(Y).then(function(We){return!Xe||Y.type!=="add"&&Y.type!=="put"||(qe.addKeys(We.results),F&&F.forEach(function(pt){for(var kt=Y.values.map(function(hr){return pt.extractKey(hr)}),at=pt.keyPath.findIndex(function(hr){return hr===P.keyPath}),gt=0,Xt=We.results.length;gt<Xt;++gt)kt[gt][at]=We.results[gt];$(pt.name).addKeys(kt)})),ke.mutatedParts=Vs(ke.mutatedParts||{},_e),We})}}),Z={get:function(Y){return[P,new Yn(Y.key)]},getMany:function(Y){return[P,new Yn().addKeys(Y.keys)]},count:N,query:N,openCursor:N};return o(Z).forEach(function(Y){Q[Y]=function($){var oe=Se.subscr,fe=!!oe,se=pa(Se,M)&&ph(Y,$)?$.obsSet={}:oe;if(fe){var ke,oe=function(Ye){return Ye="idb://".concat(v,"/").concat(C,"/").concat(Ye),se[Ye]||(se[Ye]=new Yn)},_e=oe(""),qe=oe(":dels"),fe=Z[Y]($),Ue=fe[0],fe=fe[1];if((Y==="query"&&Ue.isPrimaryKey&&!$.values?qe:oe(Ue.name||"")).add(fe),!Ue.isPrimaryKey){if(Y!=="count")return ke=Y==="query"&&G&&$.values&&M.query(r(r({},$),{values:!1})),M[Y].apply(this,arguments).then(function(Ye){if(Y==="query"){if(G&&$.values)return ke.then(function(kt){return kt=kt.result,_e.addKeys(kt),Ye});var Re=$.values?Ye.result.map(le):Ye.result;($.values?_e:qe).addKeys(Re)}else{var We,pt;if(Y==="openCursor")return pt=$.values,(We=Ye)&&Object.create(We,{key:{get:function(){return qe.addKey(We.primaryKey),We.key}},primaryKey:{get:function(){var kt=We.primaryKey;return qe.addKey(kt),kt}},value:{get:function(){return pt&&_e.addKey(We.primaryKey),We.value}}})}return Ye});qe.add(S)}}return M[Y].apply(this,arguments)}}),Q}})}};function mh(m,v,S){var C;return S.numFailures===0?v:v.type==="deleteRange"||(C=v.keys?v.keys.length:"values"in v&&v.values?v.values.length:1,S.numFailures===C)?null:(C=r({},v),c(C.keys)&&(C.keys=C.keys.filter(function(N,M){return!(M in S.failures)})),"values"in C&&c(C.values)&&(C.values=C.values.filter(function(N,M){return!(M in S.failures)})),C)}function Ys(m,v){return S=m,((C=v).lower===void 0||(C.lowerOpen?0<bt(S,C.lower):0<=bt(S,C.lower)))&&(S=m,(C=v).upper===void 0||(C.upperOpen?bt(S,C.upper)<0:bt(S,C.upper)<=0));var S,C}function Su(m,v,S,C,N,M){var R,P,K,le,G,F;return!S||S.length===0||(R=v.query.index,P=R.multiEntry,K=v.query.range,le=C.schema.primaryKey.extractKey,G=R.extractKey,F=(R.lowLevelIndex||R).extractKey,(C=S.reduce(function(Q,Z){var Y=Q,$=[];if(Z.type==="add"||Z.type==="put")for(var oe=new Yn,fe=Z.values.length-1;0<=fe;--fe){var se,ke=Z.values[fe],_e=le(ke);!oe.hasKey(_e)&&(se=G(ke),P&&c(se)?se.some(function(Ye){return Ys(Ye,K)}):Ys(se,K))&&(oe.addKey(_e),$.push(ke))}switch(Z.type){case"add":var qe=new Yn().addKeys(v.values?Q.map(function(Re){return le(Re)}):Q),Y=Q.concat(v.values?$.filter(function(Re){return Re=le(Re),!qe.hasKey(Re)&&(qe.addKey(Re),!0)}):$.map(function(Re){return le(Re)}).filter(function(Re){return!qe.hasKey(Re)&&(qe.addKey(Re),!0)}));break;case"put":var Ue=new Yn().addKeys(Z.values.map(function(Re){return le(Re)}));Y=Q.filter(function(Re){return!Ue.hasKey(v.values?le(Re):Re)}).concat(v.values?$:$.map(function(Re){return le(Re)}));break;case"delete":var Oe=new Yn().addKeys(Z.keys);Y=Q.filter(function(Re){return!Oe.hasKey(v.values?le(Re):Re)});break;case"deleteRange":var Xe=Z.range;Y=Q.filter(function(Re){return!Ys(le(Re),Xe)})}return Y},m))===m)?m:(C.sort(function(Q,Z){return bt(F(Q),F(Z))||bt(le(Q),le(Z))}),v.limit&&v.limit<1/0&&(C.length>v.limit?C.length=v.limit:m.length===v.limit&&C.length<v.limit&&(N.dirty=!0)),M?Object.freeze(C):C)}function Xa(m,v){return bt(m.lower,v.lower)===0&&bt(m.upper,v.upper)===0&&!!m.lowerOpen==!!v.lowerOpen&&!!m.upperOpen==!!v.upperOpen}function ns(m,v){return((S,C,N,M)=>{if(S===void 0)return C!==void 0?-1:0;if(C===void 0)return 1;if((S=bt(S,C))===0){if(N&&M)return 0;if(N)return 1;if(M)return-1}return S})(m.lower,v.lower,m.lowerOpen,v.lowerOpen)<=0&&0<=((S,C,N,M)=>{if(S===void 0)return C!==void 0?1:0;if(C===void 0)return-1;if((S=bt(S,C))===0){if(N&&M)return 0;if(N)return-1;if(M)return 1}return S})(m.upper,v.upper,m.upperOpen,v.upperOpen)}function np(m,v,S,C){m.subscribers.add(S),C.addEventListener("abort",function(){var N,M;m.subscribers.delete(S),m.subscribers.size===0&&(N=m,M=v,setTimeout(function(){N.subscribers.size===0&&Te(M,N)},3e3))})}var $s={stack:"dbcore",level:0,name:"Cache",create:function(m){var v=m.schema.name;return r(r({},m),{transaction:function(S,C,N){var M,R,P=m.transaction(S,C,N);return C==="readwrite"&&(N=(M=new AbortController).signal,P.addEventListener("abort",(R=function(K){return function(){if(M.abort(),C==="readwrite"){for(var le=new Set,G=0,F=S;G<F.length;G++){var Q=F[G],Z=da["idb://".concat(v,"/").concat(Q)];if(Z){var Y=m.table(Q),$=Z.optimisticOps.filter(function(We){return We.trans===P});if(P._explicit&&K&&P.mutatedParts)for(var oe=0,fe=Object.values(Z.queries.query);oe<fe.length;oe++)for(var se=0,ke=(Ue=fe[oe]).slice();se<ke.length;se++)xu((Oe=ke[se]).obsSet,P.mutatedParts)&&(Te(Ue,Oe),Oe.subscribers.forEach(function(We){return le.add(We)}));else if(0<$.length){Z.optimisticOps=Z.optimisticOps.filter(function(We){return We.trans!==P});for(var _e=0,qe=Object.values(Z.queries.query);_e<qe.length;_e++)for(var Ue,Oe,Xe,Ye=0,Re=(Ue=qe[_e]).slice();Ye<Re.length;Ye++)(Oe=Re[Ye]).res!=null&&P.mutatedParts&&(K&&!Oe.dirty?(Xe=Object.isFrozen(Oe.res),Xe=Su(Oe.res,Oe.req,$,Y,Oe,Xe),Oe.dirty?(Te(Ue,Oe),Oe.subscribers.forEach(function(We){return le.add(We)})):Xe!==Oe.res&&(Oe.res=Xe,Oe.promise=Ve.resolve({result:Xe}))):(Oe.dirty&&Te(Ue,Oe),Oe.subscribers.forEach(function(We){return le.add(We)})))}}}le.forEach(function(We){return We()})}}})(!1),{signal:N}),P.addEventListener("error",R(!1),{signal:N}),P.addEventListener("complete",R(!0),{signal:N})),P},table:function(S){var C=m.table(S),N=C.schema.primaryKey;return r(r({},C),{mutate:function(M){var R,P=Se.trans;return!N.outbound&&P.db._options.cache!=="disabled"&&!P.explicit&&P.idbtrans.mode==="readwrite"&&(R=da["idb://".concat(v,"/").concat(S)])?(P=C.mutate(M),M.type!=="add"&&M.type!=="put"||!(50<=M.values.length||Gs(N,M).some(function(K){return K==null}))?(R.optimisticOps.push(M),M.mutatedParts&&Fs(M.mutatedParts),P.then(function(K){0<K.numFailures&&(Te(R.optimisticOps,M),(K=mh(0,M,K))&&R.optimisticOps.push(K),M.mutatedParts)&&Fs(M.mutatedParts)}),P.catch(function(){Te(R.optimisticOps,M),M.mutatedParts&&Fs(M.mutatedParts)})):P.then(function(K){var le=mh(0,r(r({},M),{values:M.values.map(function(G,F){var Q;return K.failures[F]?G:(L(Q=(Q=N.keyPath)!=null&&Q.includes(".")?pe(G):r({},G),N.keyPath,K.results[F]),Q)})}),K);R.optimisticOps.push(le),queueMicrotask(function(){return M.mutatedParts&&Fs(M.mutatedParts)})}),P):C.mutate(M)},query:function(M){var R,P,K,le,G,F,Q;return pa(Se,C)&&ph("query",M)?(R=((K=Se.trans)==null?void 0:K.db._options.cache)==="immutable",P=(K=Se).requery,K=K.signal,F=((Z,Y,$,oe)=>{var fe=da["idb://".concat(Z,"/").concat(Y)];if(!fe)return[];if(!(Z=fe.queries[$]))return[null,!1,fe,null];var se=Z[(oe.query?oe.query.index.name:null)||""];if(!se)return[null,!1,fe,null];switch($){case"query":var ke=se.find(function(_e){return _e.req.limit===oe.limit&&_e.req.values===oe.values&&Xa(_e.req.query.range,oe.query.range)});return ke?[ke,!0,fe,se]:[se.find(function(_e){return("limit"in _e.req?_e.req.limit:1/0)>=oe.limit&&(!oe.values||_e.req.values)&&ns(_e.req.query.range,oe.query.range)}),!1,fe,se];case"count":return ke=se.find(function(_e){return Xa(_e.req.query.range,oe.query.range)}),[ke,!!ke,fe,se]}})(v,S,"query",M),Q=F[0],le=F[2],G=F[3],Q&&F[1]?Q.obsSet=M.obsSet:(F=C.query(M).then(function(Z){var Y=Z.result;if(Q&&(Q.res=Y),R){for(var $=0,oe=Y.length;$<oe;++$)Object.freeze(Y[$]);Object.freeze(Y)}else Z.result=pe(Y);return Z}).catch(function(Z){return G&&Q&&Te(G,Q),Promise.reject(Z)}),Q={obsSet:M.obsSet,promise:F,subscribers:new Set,type:"query",req:M,dirty:!1},G?G.push(Q):(G=[Q],(le=le||(da["idb://".concat(v,"/").concat(S)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[M.query.index.name||""]=G)),np(Q,G,P,K),Q.promise.then(function(Z){return{result:Su(Z.result,M,le?.optimisticOps,C,Q,R)}})):C.query(M)}})}})}};function rs(m,v){return new Proxy(m,{get:function(S,C,N){return C==="db"?v:Reflect.get(S,C,N)}})}hn.prototype.version=function(m){if(isNaN(m)||m<.1)throw new Fe.Type("Given version is not a positive number");if(m=Math.round(10*m)/10,this.idbdb||this._state.isBeingOpened)throw new Fe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,m);var v=this._versions,S=v.filter(function(C){return C._cfg.version===m})[0];return S||(S=new this.Version(m),v.push(S),v.sort(fu),S.stores({}),this._state.autoSchema=!1),S},hn.prototype._whenReady=function(m){var v=this;return this.idbdb&&(this._state.openComplete||Se.letThrough||this._vip)?m():new Ve(function(S,C){if(v._state.openComplete)return C(new Fe.DatabaseClosed(v._state.dbOpenError));if(!v._state.isBeingOpened){if(!v._state.autoOpen)return void C(new Fe.DatabaseClosed);v.open().catch(dt)}v._state.dbReadyPromise.then(S,C)}).then(m)},hn.prototype.use=function(N){var v=N.stack,S=N.create,C=N.level,N=N.name,M=(N&&this.unuse({stack:v,name:N}),this._middlewares[v]||(this._middlewares[v]=[]));return M.push({stack:v,create:S,level:C??10,name:N}),M.sort(function(R,P){return R.level-P.level}),this},hn.prototype.unuse=function(m){var v=m.stack,S=m.name,C=m.create;return v&&this._middlewares[v]&&(this._middlewares[v]=this._middlewares[v].filter(function(N){return C?N.create!==C:!!S&&N.name!==S})),this},hn.prototype.open=function(){var m=this;return Or(De,function(){return Jd(m)})},hn.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var m=this._state,v=aa.indexOf(this);if(0<=v&&aa.splice(v,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}m.isBeingOpened||(m.dbReadyPromise=new Ve(function(S){m.dbReadyResolve=S}),m.openCanceller=new Ve(function(S,C){m.cancelOpen=C}))},hn.prototype.close=function(v){var v=(v===void 0?{disableAutoOpen:!0}:v).disableAutoOpen,S=this._state;v?(S.isBeingOpened&&S.cancelOpen(new Fe.DatabaseClosed),this._close(),S.autoOpen=!1,S.dbOpenError=new Fe.DatabaseClosed):(this._close(),S.autoOpen=this._options.autoOpen||S.isBeingOpened,S.openComplete=!1,S.dbOpenError=null)},hn.prototype.delete=function(m){var v=this,S=(m===void 0&&(m={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),C=this._state;return new Ve(function(N,M){function R(){v.close(m);var P=v._deps.indexedDB.deleteDatabase(v.name);P.onsuccess=en(function(){var K,le,G;K=v._deps,le=v.name,qs(G=K.indexedDB)||le===Kl||pu(G,K.IDBKeyRange).delete(le).catch(dt),N()}),P.onerror=Lr(M),P.onblocked=v._fireOnBlocked}if(S)throw new Fe.InvalidArgument("Invalid closeOptions argument to db.delete()");C.isBeingOpened?C.dbReadyPromise.then(R):R()})},hn.prototype.backendDB=function(){return this.idbdb},hn.prototype.isOpen=function(){return this.idbdb!==null},hn.prototype.hasBeenClosed=function(){var m=this._state.dbOpenError;return m&&m.name==="DatabaseClosed"},hn.prototype.hasFailed=function(){return this._state.dbOpenError!==null},hn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(hn.prototype,"tables",{get:function(){var m=this;return o(this._allTables).map(function(v){return m._allTables[v]})},enumerable:!1,configurable:!0}),hn.prototype.transaction=function(){var m=function(v,S,C){var N=arguments.length;if(N<2)throw new Fe.InvalidArgument("Too few arguments");for(var M=new Array(N-1);--N;)M[N-1]=arguments[N];return C=M.pop(),[v,I(M),C]}.apply(this,arguments);return this._transaction.apply(this,m)},hn.prototype._transaction=function(m,v,S){var C,N,M=this,R=Se.trans,P=(R&&R.db===this&&m.indexOf("!")===-1||(R=null),m.indexOf("?")!==-1);m=m.replace("!","").replace("?","");try{if(N=v.map(function(le){if(le=le instanceof M.Table?le.name:le,typeof le!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return le}),m=="r"||m===yi)C=yi;else{if(m!="rw"&&m!=Ri)throw new Fe.InvalidArgument("Invalid transaction mode: "+m);C=Ri}if(R){if(R.mode===yi&&C===Ri){if(!P)throw new Fe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");R=null}R&&N.forEach(function(le){if(R&&R.storeNames.indexOf(le)===-1){if(!P)throw new Fe.SubTransaction("Table "+le+" not included in parent transaction.");R=null}}),P&&R&&!R.active&&(R=null)}}catch(le){return R?R._promise(null,function(G,F){F(le)}):Qt(le)}var K=function le(G,F,Q,Z,Y){return Ve.resolve().then(function(){var se=Se.transless||Se,$=G._createTransaction(F,Q,G._dbSchema,Z),se=($.explicit=!0,{trans:$,transless:se});if(Z)$.idbtrans=Z.idbtrans;else try{$.create(),$.idbtrans._explicit=!0,G._state.PR1398_maxLoop=3}catch(ke){return ke.name===ft.InvalidState&&G.isOpen()&&0<--G._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),G.close({disableAutoOpen:!1}),G.open().then(function(){return le(G,F,Q,null,Y)})):Qt(ke)}var oe,fe=ye(Y),se=(fe&&Cn(),Ve.follow(function(){var ke;(oe=Y.call($,$))&&(fe?(ke=gr.bind(null,null),oe.then(ke,ke)):typeof oe.next=="function"&&typeof oe.throw=="function"&&(oe=ts(oe)))},se));return(oe&&typeof oe.then=="function"?Ve.resolve(oe).then(function(ke){return $.active?ke:Qt(new Fe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):se.then(function(){return oe})).then(function(ke){return Z&&$._resolve(),$._completion.then(function(){return ke})}).catch(function(ke){return $._reject(ke),Qt(ke)})})}.bind(null,this,C,N,R,S);return R?R._promise(C,K,"lock"):Se.trans?Or(Se.transless,function(){return M._whenReady(K)}):this._whenReady(K)},hn.prototype.table=function(m){if(g(this._allTables,m))return this._allTables[m];throw new Fe.InvalidTable("Table ".concat(m," does not exist"))};var Wr=hn;function hn(m,v){var S,C,N,M,R,P=this,K=(this._middlewares={},this.verno=0,hn.dependencies),K=(this._options=v=r({addons:hn.addons,autoOpen:!0,indexedDB:K.indexedDB,IDBKeyRange:K.IDBKeyRange,cache:"cloned"},v),this._deps={indexedDB:v.indexedDB,IDBKeyRange:v.IDBKeyRange},v.addons),le=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:dt,dbReadyPromise:null,cancelOpen:dt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:v.autoOpen}),G=(le.dbReadyPromise=new Ve(function(F){le.dbReadyResolve=F}),le.openCanceller=new Ve(function(F,Q){le.cancelOpen=Q}),this._state=le,this.name=m,this.on=$l(this,"populate","blocked","versionchange","close",{ready:[Fn,dt]}),this.once=function(F,Q){var Z=function(){for(var Y=[],$=0;$<arguments.length;$++)Y[$]=arguments[$];P.on(F).unsubscribe(Z),Q.apply(P,Y)};return P.on(F,Z)},this.on.ready.subscribe=O(this.on.ready.subscribe,function(F){return function(Q,Z){hn.vip(function(){var Y,$=P._state;$.openComplete?($.dbOpenError||Ve.resolve().then(Q),Z&&F(Q)):$.onReadyBeingFired?($.onReadyBeingFired.push(Q),Z&&F(Q)):(F(Q),Y=P,Z||F(function oe(){Y.on.ready.unsubscribe(Q),Y.on.ready.unsubscribe(oe)}))})}}),this.Collection=(S=this,Kn(Xd.prototype,function(oe,$){this.db=S;var Z=lu,Y=null;if($)try{Z=$()}catch(se){Y=se}var $=oe._ctx,oe=$.table,fe=oe.hook.reading.fire;this._ctx={table:oe,index:$.index,isPrimKey:!$.index||oe.schema.primKey.keyPath&&$.index===oe.schema.primKey.name,range:Z,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:Y,or:$.or,valueMapper:fe!==wn?fe:null}})),this.Table=(C=this,Kn(su.prototype,function(F,Q,Z){this.db=C,this._tx=Z,this.name=F,this.schema=Q,this.hook=C._allTables[F]?C._allTables[F].hook:$l(null,{creating:[Pn,dt],reading:[vn,wn],updating:[mn,dt],deleting:[Qn,dt]})})),this.Transaction=(N=this,Kn(hu.prototype,function(F,Q,Z,Y,$){var oe=this;F!=="readonly"&&Q.forEach(function(fe){fe=(fe=Z[fe])==null?void 0:fe.yProps,fe&&(Q=Q.concat(fe.map(function(se){return se.updatesTable})))}),this.db=N,this.mode=F,this.storeNames=Q,this.schema=Z,this.chromeTransactionDurability=Y,this.idbtrans=null,this.on=$l(this,"complete","error","abort"),this.parent=$||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ve(function(fe,se){oe._resolve=fe,oe._reject=se}),this._completion.then(function(){oe.active=!1,oe.on.complete.fire()},function(fe){var se=oe.active;return oe.active=!1,oe.on.error.fire(fe),oe.parent?oe.parent._reject(fe):se&&oe.idbtrans&&oe.idbtrans.abort(),Qt(fe)})})),this.Version=(M=this,Kn(Zd.prototype,function(F){this.db=M,this._cfg={version:F,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(R=this,Kn(oa.prototype,function(F,Q,Z){if(this.db=R,this._ctx={table:F,index:Q===":id"?null:Q,or:Z},this._cmp=this._ascending=bt,this._descending=function(Y,$){return bt($,Y)},this._max=function(Y,$){return 0<bt(Y,$)?Y:$},this._min=function(Y,$){return bt(Y,$)<0?Y:$},this._IDBKeyRange=R._deps.IDBKeyRange,!this._IDBKeyRange)throw new Fe.MissingAPI})),this.on("versionchange",function(F){0<F.newVersion?console.warn("Another connection wants to upgrade database '".concat(P.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(P.name,"'. Closing db now to resume the delete request.")),P.close({disableAutoOpen:!1})}),this.on("blocked",function(F){!F.newVersion||F.newVersion<F.oldVersion?console.warn("Dexie.delete('".concat(P.name,"') was blocked")):console.warn("Upgrade '".concat(P.name,"' blocked by other connection holding version ").concat(F.oldVersion/10))}),this._maxKey=Ga(v.IDBKeyRange),this._createTransaction=function(F,Q,Z,Y){return new P.Transaction(F,Q,Z,P._options.chromeTransactionDurability,Y)},this._fireOnBlocked=function(F){P.on("blocked").fire(F),aa.filter(function(Q){return Q.name===P.name&&Q!==P&&!Q._state.vcFired}).map(function(Q){return Q.on("versionchange").fire(F)})},this.use(dh),this.use($s),this.use(tp),this.use(ep),this.use(fh),new Proxy(this,{get:function(F,Q,Z){var Y;return Q==="_vip"||(Q==="table"?function($){return rs(P.table($),G)}:(Y=Reflect.get(F,Q,Z))instanceof su?rs(Y,G):Q==="tables"?Y.map(function($){return rs($,G)}):Q==="_createTransaction"?function(){return rs(Y.apply(this,arguments),G)}:Y)}}));this.vip=G,K.forEach(function(F){return F(P)})}var Wa,ma=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",gh=(Qs.prototype.subscribe=function(m,v,S){return this._subscribe(m&&typeof m!="function"?m:{next:m,error:v,complete:S})},Qs.prototype[ma]=function(){return this},Qs);function Qs(m){this._subscribe=m}try{Wa={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch{Wa={indexedDB:null,IDBKeyRange:null}}function yh(m){var v,S=!1,C=new gh(function(N){var M=ye(m),R,P=!1,K={},le={},G={get closed(){return P},unsubscribe:function(){P||(P=!0,R&&R.abort(),F&&Gn.storagemutated.unsubscribe(Z))}},F=(N.start&&N.start(G),!1),Q=function(){return Oi(Y)},Z=function($){Vs(K,$),xu(le,K)&&Q()},Y=function(){var $,oe,fe;!P&&Wa.indexedDB&&(K={},$={},R&&R.abort(),R=new AbortController,fe=(se=>{var ke=ji();try{M&&Cn();var _e=an(m,se);return _e=M?_e.finally(gr):_e}finally{ke&&Yr()}})(oe={subscr:$,signal:R.signal,requery:Q,querier:m,trans:null}),Promise.resolve(fe).then(function(se){S=!0,v=se,P||oe.signal.aborted||(K={},(ke=>{for(var _e in ke)if(g(ke,_e))return;return 1})(le=$)||F||(Gn(Fa,Z),F=!0),Oi(function(){return!P&&N.next&&N.next(se)}))},function(se){S=!1,["DatabaseClosedError","AbortError"].includes(se?.name)||P||Oi(function(){P||N.error&&N.error(se)})}))};return setTimeout(Q,0),G});return C.hasValue=function(){return S},C.getValue=function(){return v},C}var ga=Wr;function Cu(m){var v=Ii;try{Ii=!0,Gn.storagemutated.fire(m),ku(m,!0)}finally{Ii=v}}k(ga,r(r({},Ce),{delete:function(m){return new ga(m,{addons:[]}).delete()},exists:function(m){return new ga(m,{addons:[]}).open().then(function(v){return v.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(m){try{return v=ga.dependencies,S=v.indexedDB,v=v.IDBKeyRange,(qs(S)?Promise.resolve(S.databases()).then(function(C){return C.map(function(N){return N.name}).filter(function(N){return N!==Kl})}):pu(S,v).toCollection().primaryKeys()).then(m)}catch{return Qt(new Fe.MissingAPI)}var v,S},defineClass:function(){return function(m){h(this,m)}},ignoreTransaction:function(m){return Se.trans?Or(Se.transless,m):m()},vip:mu,async:function(m){return function(){try{var v=ts(m.apply(this,arguments));return v&&typeof v.then=="function"?v:Ve.resolve(v)}catch(S){return Qt(S)}}},spawn:function(m,v,S){try{var C=ts(m.apply(S,v||[]));return C&&typeof C.then=="function"?C:Ve.resolve(C)}catch(N){return Qt(N)}},currentTransaction:{get:function(){return Se.trans||null}},waitFor:function(m,v){return m=Ve.resolve(typeof m=="function"?ga.ignoreTransaction(m):m).timeout(v||6e4),Se.trans?Se.trans.waitFor(m):m},Promise:Ve,debug:{get:function(){return Pe},set:function(m){Rt(m)}},derive:E,extend:h,props:k,override:O,Events:$l,on:Gn,liveQuery:yh,extendObservabilitySet:Vs,getByKeyPath:H,setByKeyPath:L,delByKeyPath:function(m,v){typeof v=="string"?L(m,v,void 0):"length"in v&&[].map.call(v,function(S){L(m,S,void 0)})},shallowClone:me,deepClone:pe,getObjectDiff:Ks,cmp:bt,asap:ee,minKey:-1/0,addons:[],connections:aa,errnames:ft,dependencies:Wa,cache:da,semVer:"4.3.0",version:"4.3.0".split(".").map(function(m){return parseInt(m)}).reduce(function(m,v,S){return m+v/Math.pow(10,2*S)})})),ga.maxKey=Ga(ga.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Gn(Fa,function(m){Ii||(m=new CustomEvent(ca,{detail:m}),Ii=!0,dispatchEvent(m),Ii=!1)}),addEventListener(ca,function(m){m=m.detail,Ii||Cu(m)}));var Za,Ii=!1,cr=function(){};return typeof BroadcastChannel<"u"&&((cr=function(){(Za=new BroadcastChannel(ca)).onmessage=function(m){return m.data&&Cu(m.data)}})(),typeof Za.unref=="function"&&Za.unref(),Gn(Fa,function(m){Ii||Za.postMessage(m)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(m){if(!Wr.disableBfCache&&m.persisted){Pe&&console.debug("Dexie: handling persisted pagehide"),Za?.close();for(var v=0,S=aa;v<S.length;v++)S[v].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(m){!Wr.disableBfCache&&m.persisted&&(Pe&&console.debug("Dexie: handling persisted pageshow"),cr(),Cu({all:new Yn(-1/0,[[]])}))})),Ve.rejectionMapper=function(m,v){return!m||m instanceof $e||m instanceof TypeError||m instanceof SyntaxError||!m.name||!Yt[m.name]?m:(v=new Yt[m.name](v||m.message,m),"stack"in m&&A(v,"stack",{get:function(){return this.inner.stack}}),v)},Rt(Pe),r(Wr,Object.freeze({__proto__:null,Dexie:Wr,Entity:ih,PropModification:Va,RangeSet:Yn,add:function(m){return new Va({add:m})},cmp:bt,default:Wr,liveQuery:yh,mergeRanges:fa,rangesOverlap:uh,remove:function(m){return new Va({remove:m})},replacePrefix:function(m,v){return new Va({replacePrefix:[m,v]})}}),{default:Wr}),Wr})})(Uf)),Uf.exports}var N4=T4();const Og=Ed(N4),Qb=Symbol.for("Dexie"),Wf=globalThis[Qb]||(globalThis[Qb]=Og);if(Og.semVer!==Wf.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Og.semVer} and ${Wf.semVer}`);const{liveQuery:gB,mergeRanges:yB,rangesOverlap:xB,RangeSet:vB,cmp:bB,Entity:kB,PropModification:wB,replacePrefix:SB,add:CB,remove:AB,DexieYProvider:TB}=Wf,ws=[{id:"image",label:"Image",icon:"Image",description:"Character avatar image"},{id:"name",label:"Name",icon:"Type",description:"Character name"},{id:"description",label:"Description",icon:"FileText",description:"Character description"},{id:"first_mes",label:"First Message",icon:"MessageCircle",description:"First greeting message"},{id:"alternate_greetings",label:"Greetings",icon:"Greeting",description:"Alternate greetings"},{id:"mes_example",label:"Examples",icon:"MessagesSquare",description:"Message examples"},{id:"scenario",label:"Scenario",icon:"Map",description:"Roleplay scenario"},{id:"physical_description",label:"Appearance",icon:"Eye",description:"Physical description"},{id:"personality",label:"Personality",icon:"User",description:"Personality traits"},{id:"system_prompt",label:"System",icon:"Terminal",description:"System prompt"},{id:"post_history_instructions",label:"Post-History",icon:"History",description:"Post-history instructions"},{id:"lorebook",label:"Lorebook",icon:"Book",description:"Character lore entries"},{id:"creator",label:"Creator",icon:"UserCircle",description:"Character creator name"},{id:"creator_notes",label:"Creator Notes",icon:"NotebookPen",description:"Notes from the creator (supports CSS)"},{id:"tags",label:"Tags",icon:"Tags",description:"Character tags (comma-separated)"},{id:"character_version",label:"Version",icon:"Tag",description:"Character version identifier"},{id:"extensions",label:"Extensions",icon:"Puzzle",description:"Extension data"},{id:"avatar",label:"Avatar URL",icon:"Link",description:"Character avatar URL (CharHub, etc.)"}],fw={ui:{theme:"system",editorFontSize:16,sidebarWidth:280},version:1},nr=[];for(let n=0;n<256;++n)nr.push((n+256).toString(16).slice(1));function E4(n,e=0){return(nr[n[e+0]]+nr[n[e+1]]+nr[n[e+2]]+nr[n[e+3]]+"-"+nr[n[e+4]]+nr[n[e+5]]+"-"+nr[n[e+6]]+nr[n[e+7]]+"-"+nr[n[e+8]]+nr[n[e+9]]+"-"+nr[n[e+10]]+nr[n[e+11]]+nr[n[e+12]]+nr[n[e+13]]+nr[n[e+14]]+nr[n[e+15]]).toLowerCase()}let Km;const M4=new Uint8Array(16);function j4(){if(!Km){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Km=crypto.getRandomValues.bind(crypto)}return Km(M4)}const _4=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Xb={randomUUID:_4};function D4(n,e,t){n=n||{};const r=n.random??n.rng?.()??j4();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,E4(r)}function yf(n,e,t){return Xb.randomUUID&&!n?Xb.randomUUID():D4(n)}class O4 extends Wf{characters;snapshots;settings;constructor(){super("character-vault-db"),this.version(1).stores({characters:"id, name, updatedAt, createdAt",settings:"id"}),this.version(2).stores({characters:"id, name, updatedAt, createdAt",settings:"id",snapshots:"id, characterId, createdAt, [characterId+createdAt]"})}async getAllCharacters(){return this.characters.orderBy("updatedAt").reverse().toArray()}async getCharacter(e){return this.characters.get(e)}async searchCharacters(e){const t=e.toLowerCase();return this.characters.filter(r=>r.name.toLowerCase().includes(t)).toArray()}async createCharacter(e){const t=new Date().toISOString(),a={id:yf(),name:e.name,imageData:e.imageData||"",data:{spec:{name:e.name,description:e.data?.spec?.description||"",personality:e.data?.spec?.personality||"",scenario:e.data?.spec?.scenario||"",first_mes:e.data?.spec?.first_mes||"",mes_example:e.data?.spec?.mes_example||"",system_prompt:e.data?.spec?.system_prompt||"",post_history_instructions:e.data?.spec?.post_history_instructions||"",alternate_greetings:e.data?.spec?.alternate_greetings||[],physical_description:e.data?.spec?.physical_description||"",avatar:e.data?.spec?.avatar,creator_notes:e.data?.spec?.creator_notes,creator:e.data?.spec?.creator,character_version:e.data?.spec?.character_version,tags:e.data?.spec?.tags},characterBook:e.data?.characterBook,extensions:e.data?.extensions||{}},version:1,createdAt:t,updatedAt:t,lastOpenedAt:t};return await this.characters.add(a),a}async updateCharacter(e,t){const r=await this.characters.get(e);if(!r)throw new Error(`Character with ID "${e}" not found`);const a=new Date().toISOString(),s={...r,name:t.name??r.name,imageData:t.imageData??r.imageData,data:{spec:{...r.data.spec,...t.data?.spec},characterBook:t.data?.characterBook??r.data.characterBook,extensions:t.data?.extensions??r.data.extensions},updatedAt:a};return await this.characters.put(s),s}async updateSpecField(e,t,r){const a=await this.characters.get(e);if(!a)throw new Error(`Character with ID "${e}" not found`);const s=new Date().toISOString(),o={...a,name:t==="name"&&typeof r=="string"?r:a.name,data:{...a.data,spec:{...a.data.spec,[t]:r}},updatedAt:s};return await this.characters.put(o),o}async updateCharacterImage(e,t){return this.updateCharacter(e,{imageData:t})}async deleteCharacter(e){await this.transaction("rw",this.characters,this.snapshots,async()=>{await this.characters.delete(e),await this.snapshots.where("characterId").equals(e).delete()})}async duplicateCharacter(e,t){const r=await this.characters.get(e);if(!r)throw new Error(`Character with ID "${e}" not found`);const a=new Date().toISOString(),s=yf(),o={...r,id:s,name:t,data:{...r.data,spec:{...r.data.spec,name:t}},createdAt:a,updatedAt:a,lastOpenedAt:a};return await this.characters.add(o),o}async updateLastOpened(e){const t=new Date().toISOString();await this.characters.update(e,{lastOpenedAt:t})}async getSettings(){const e=await this.settings.get("app-settings");if(!e){const t={...fw,id:"app-settings"};return await this.settings.add(t),t}return e}async updateSettings(e){const t=await this.getSettings(),r={...t,...e,ui:{...t.ui,...e.ui}};return await this.settings.put(r),r}async importCharacter(e){const t=new Date().toISOString(),a={id:yf(),name:e.name||"Imported Character",imageData:e.imageData||"",data:{spec:{name:e.data?.spec?.name||e.name||"Imported Character",description:e.data?.spec?.description||"",personality:e.data?.spec?.personality||"",scenario:e.data?.spec?.scenario||"",first_mes:e.data?.spec?.first_mes||"",mes_example:e.data?.spec?.mes_example||"",system_prompt:e.data?.spec?.system_prompt||"",post_history_instructions:e.data?.spec?.post_history_instructions||"",alternate_greetings:e.data?.spec?.alternate_greetings||[],physical_description:e.data?.spec?.physical_description||"",avatar:e.data?.spec?.avatar,creator_notes:e.data?.spec?.creator_notes,creator:e.data?.spec?.creator,character_version:e.data?.spec?.character_version,tags:e.data?.spec?.tags},characterBook:e.data?.characterBook,extensions:e.data?.extensions||{}},version:1,createdAt:t,updatedAt:t,lastOpenedAt:t};return await this.characters.add(a),a}async createSnapshot(e){if((await this.getLatestSnapshot(e.characterId))?.payloadHash===e.payloadHash)return null;const r={id:yf(),characterId:e.characterId,source:e.source,createdAt:new Date().toISOString(),payload:e.payload,payloadHash:e.payloadHash};return await this.transaction("rw",this.snapshots,async()=>{await this.snapshots.add(r),await this.pruneSnapshotsForCharacter(e.characterId,25)}),r}async getSnapshotsForCharacter(e){return(await this.snapshots.where("characterId").equals(e).sortBy("createdAt")).reverse()}async getLatestSnapshot(e){return(await this.snapshots.where("characterId").equals(e).sortBy("createdAt")).at(-1)}async deleteSnapshot(e){await this.snapshots.delete(e)}async pruneSnapshotsForCharacter(e,t){const r=await this.snapshots.where("characterId").equals(e).sortBy("createdAt");if(r.length<=t)return;const a=r.slice(0,r.length-t);await Promise.all(a.map(s=>this.snapshots.delete(s.id)))}}const zt=new O4,R4={open:"Open",auto:"Auto",manual:"Manual",rollback:"Rollback"},L4={open:"Baseline",auto:"Idle snapshot",manual:"Manual snapshot",rollback:"After restore"},B4=["image","name","description","personality","scenario","first_mes","mes_example","system_prompt","post_history_instructions","alternate_greetings","physical_description","lorebook","creator","creator_notes","tags","character_version","extensions","avatar"];function vc(n){return n==null?JSON.stringify(n):Array.isArray(n)?`[${n.map(e=>vc(e)).join(",")}]`:typeof n=="object"?`{${Object.entries(n).filter(([,t])=>t!==void 0).sort(([t],[r])=>t.localeCompare(r)).map(([t,r])=>`${JSON.stringify(t)}:${vc(r)}`).join(",")}}`:JSON.stringify(n)}function ac(n){return n===void 0?n:JSON.parse(JSON.stringify(n))}function z4(n){return n==="image"?"Image":n==="lorebook"?"Lorebook":n==="extensions"?"Extensions":ws.find(e=>e.id===n)?.label??n}function Wb(n,e){switch(e){case"image":return n.imageData;case"lorebook":return n.data.characterBook??null;case"extensions":return n.data.extensions??{};default:return n.data.spec[e]}}class I4{buildPayload(e){return{name:e.name,imageData:e.imageData,data:ac(e.data)}}buildPayloadHash(e){return vc(e)}async createSnapshot(e,t){const r=this.buildPayload(e),a=this.buildPayloadHash(r);return zt.createSnapshot({characterId:e.id,source:t,payload:r,payloadHash:a})}async listSnapshots(e){return[...await zt.getSnapshotsForCharacter(e)].sort((r,a)=>a.createdAt.localeCompare(r.createdAt))}diffSnapshotAgainstCharacter(e,t){const r=this.buildPayload(t);return B4.map(a=>{const s=Wb(e.payload,a),o=Wb(r,a);return{section:a,label:z4(a),changed:vc(s)!==vc(o),snapshotValue:s,currentValue:o}})}restoreWholeCharacter(e,t){return{name:t.payload.name,imageData:t.payload.imageData,data:ac(t.payload.data)}}restoreSection(e,t,r){switch(r){case"image":return{kind:"image",value:t.payload.imageData};case"lorebook":return{kind:"character",input:{data:{...e.data,characterBook:ac(t.payload.data.characterBook)}}};case"extensions":return{kind:"character",input:{data:{...e.data,extensions:ac(t.payload.data.extensions??{})}}};default:{const a=t.payload.data.spec[r];return{kind:"spec",field:r,value:Array.isArray(a)?ac(a):String(a??"")}}}}formatSnapshotSource(e){return R4[e]}describeSnapshotSource(e){return L4[e]}}const Tl=new I4;function P4(){const[n,e]=z.useState([]),[t,r]=z.useState(null),[a,s]=z.useState(!0),[o,c]=z.useState(null),[h,d]=z.useState(null),p=z.useRef(new Map);z.useEffect(()=>{async function H(){try{s(!0);const[L,me]=await Promise.all([zt.getAllCharacters(),zt.getSettings()]);e(L),d(me)}catch(L){c(L instanceof Error?L:new Error("Failed to load characters"))}finally{s(!1)}}H()},[]);const g=z.useCallback(async()=>{try{const H=await zt.getAllCharacters();e(H)}catch(H){c(H instanceof Error?H:new Error("Failed to refresh characters"))}},[]),k=z.useCallback(async H=>{const L=await zt.createCharacter(H);return e(me=>[L,...me]),r(L),h&&(await zt.updateSettings({lastActiveCharacterId:L.id}),d({...h,lastActiveCharacterId:L.id})),L},[h]),w=z.useCallback(async H=>{try{const L=await zt.getCharacter(H);L&&(await zt.updateLastOpened(H),await Tl.createSnapshot(L,"open").catch(me=>{console.error("Failed to create baseline snapshot:",me)}),r(L),h&&(await zt.updateSettings({lastActiveCharacterId:H}),d({...h,lastActiveCharacterId:H})),await g())}catch(L){c(L instanceof Error?L:new Error("Failed to open character"))}},[h,g]),A=z.useCallback(()=>{r(null),h&&(zt.updateSettings({lastActiveCharacterId:void 0}),d({...h,lastActiveCharacterId:void 0}))},[h]),E=z.useCallback(async H=>{try{await zt.deleteCharacter(H),e(L=>L.filter(me=>me.id!==H)),t?.id===H&&(r(null),h&&(await zt.updateSettings({lastActiveCharacterId:void 0}),d({...h,lastActiveCharacterId:void 0})))}catch(L){throw c(L instanceof Error?L:new Error("Failed to delete character")),L}},[t,h]),j=z.useCallback(async(H,L)=>{try{const me=await zt.updateCharacter(H,L);return e(he=>he.map(I=>I.id===H?me:I)),t?.id===H&&r(me),me}catch(me){throw c(me instanceof Error?me:new Error("Failed to update character")),me}},[t]),D=z.useCallback(async(H,L,me)=>{const he=`${H}:${String(L)}`,I=(p.current.get(he)??0)+1;p.current.set(he,I);try{const te=await zt.updateSpecField(H,L,me);return p.current.get(he)!==I||(e(ne=>ne.map(pe=>pe.id===H?te:pe)),r(ne=>ne?.id===H?te:ne)),te}catch(te){throw p.current.get(he)!==I||c(te instanceof Error?te:new Error("Failed to update spec field")),te}},[]),U=z.useCallback(async(H,L)=>{try{const me=await zt.duplicateCharacter(H,L);return e(he=>[me,...he]),me}catch(me){throw c(me instanceof Error?me:new Error("Failed to duplicate character")),me}},[]),O=z.useCallback(async H=>{try{const L=await zt.updateSettings(H);d(L)}catch(L){throw c(L instanceof Error?L:new Error("Failed to update settings")),L}},[]);return[{characters:n,currentCharacter:t,isLoading:a,error:o,settings:h},{createCharacter:k,openCharacter:w,closeCharacter:A,deleteCharacter:E,updateCharacter:j,duplicateCharacter:U,refreshCharacters:g,updateSpecField:D,updateSettings:O}]}const dw=z.createContext(null);function H4({children:n}){const[e,t]=P4(),r={currentCharacter:e.currentCharacter,isCharacterOpen:e.currentCharacter!==null,createCharacter:t.createCharacter,openCharacter:t.openCharacter,closeCharacter:t.closeCharacter,deleteCharacter:t.deleteCharacter,updateCharacter:t.updateCharacter,duplicateCharacter:t.duplicateCharacter,updateSpecField:t.updateSpecField,characters:e.characters,refreshCharacters:t.refreshCharacters,settings:e.settings,updateSettings:t.updateSettings,isLoading:e.isLoading,error:e.error};return b.jsx(dw.Provider,{value:r,children:n})}function Gc(){const n=z.useContext(dw);if(!n)throw new Error("useCharacterContext must be used within a CharacterProvider");return n}const Bn={ai:{baseUrl:"https://nano-gpt.com/api/v1",apiKey:"",modelId:"",availableModels:[],enableStreaming:!1,enableReasoning:!1,showReasoning:!1},sampler:{temperature:.7,minP:.05,topK:40,repetitionPenalty:1.1,topP:1,contextLength:4096,maxTokens:2048},samplerPresets:[{id:"preset-creative",name:"Creative",settings:{temperature:.9,minP:.05,topK:50,repetitionPenalty:1.05,topP:.95,contextLength:4096,maxTokens:2048}},{id:"preset-balanced",name:"Balanced",settings:{temperature:.7,minP:.05,topK:40,repetitionPenalty:1.1,topP:1,contextLength:4096,maxTokens:2048}},{id:"preset-factual",name:"Factual",settings:{temperature:.3,minP:.1,topK:20,repetitionPenalty:1.2,topP:.5,contextLength:4096,maxTokens:1024}}],prompts:{expand:`Please expand and elaborate on the following text, adding more detail and depth while maintaining the same style and tone:

"""
\${text}
"""

Provide only the expanded text without any additional commentary.`,rewrite:`Please rewrite the following text to improve clarity, flow, and impact while preserving the original meaning:

"""
\${text}
"""

Provide only the rewritten text without any additional commentary.`,instruct:`Please apply the following instruction to the text below:

Instruction: \${instruction}

Text:
"""
\${text}
"""

Provide only the modified text without any additional commentary.`,shorten:`Please shorten and condense the following text, making it more concise while preserving the key meaning and essential details:

"""
\${text}
"""

Provide only the shortened text without any additional commentary.`,lengthen:`Please lengthen the following text by adding more detail, depth, and elaboration while maintaining the same style and tone:

"""
\${text}
"""

Provide only the lengthened text without any additional commentary.`,vivid:`Please rewrite the following text to make it more vivid and descriptive, adding sensory details, imagery, and evocative language:

"""
\${text}
"""

Provide only the enhanced text without any additional commentary.`,emotion:`Please rewrite the following text to add more emotional depth, feeling, and character voice while preserving the original meaning:

"""
\${text}
"""

Provide only the enhanced text without any additional commentary.`,grammar:`Please fix any grammar, spelling, and punctuation errors in the following text while preserving the original meaning and style:

"""
\${text}
"""

Provide only the corrected text without any additional commentary.`}},pw=z.createContext(null);class q4{async getSettings(){const e=await zt.getSettings();if(!e){const t={id:"app-settings",ui:{theme:"system",editorFontSize:16,sidebarWidth:280},version:1};return await zt.settings.add(t),t}return e}async saveSettings(e){await zt.settings.put(e)}async getAISettings(){const e=await this.getSettings();return{...Bn.ai,...e.ai}}async saveAISettings(e){const r={...await this.getSettings(),ai:{...Bn.ai,...e}};await zt.settings.put(r)}async getSamplerSettings(){const e=await this.getSettings();return{...Bn.sampler,...e.sampler}}async saveSamplerSettings(e){const r={...await this.getSettings(),sampler:{...Bn.sampler,...e}};await zt.settings.put(r)}async getContextSectionIds(){return(await this.getSettings()).contextSectionIds||[]}async saveContextSectionIds(e){const r={...await this.getSettings(),contextSectionIds:e};await zt.settings.put(r)}async addContextSection(e){const t=await this.getSettings(),r=t.contextSectionIds||[];if(!r.includes(e)){const a={...t,contextSectionIds:[...r,e]};await zt.settings.put(a)}}async removeContextSection(e){const t=await this.getSettings(),r=t.contextSectionIds||[],a={...t,contextSectionIds:r.filter(s=>s!==e)};await zt.settings.put(a)}async getPromptSettings(){const e=await this.getSettings();return{...Bn.prompts,...e.prompts}}async savePromptSettings(e){const r={...await this.getSettings(),prompts:{...Bn.prompts,...e}};await zt.settings.put(r)}async saveAllAISettings(e,t,r){const s={...await this.getSettings(),ai:{...Bn.ai,...e},sampler:{...Bn.sampler,...t},prompts:{...Bn.prompts,...r}};await zt.settings.put(s)}async applySamplerPreset(e){const r=Bn.samplerPresets.find(a=>a.id===e);if(!r)throw new Error(`Preset with ID "${e}" not found`);await this.saveSamplerSettings(r.settings)}async resetToDefaults(){const e={...fw,id:"app-settings",ai:Bn.ai,sampler:Bn.sampler,prompts:Bn.prompts,contextSectionIds:[]};return await zt.settings.put(e),e}async clearAISettings(){const e=await this.getSettings(),t={...e,ai:Bn.ai,sampler:e.sampler??Bn.sampler,prompts:e.prompts??Bn.prompts};await zt.settings.put(t)}}const rr=new q4,Zb=500,U4=3e4;function V4({children:n}){const{currentCharacter:e,updateCharacter:t,updateSpecField:r}=Gc(),a=e?.id??null,[s,o]=z.useState("name"),[c,h]=z.useState(!1),[d,p]=z.useState("saved"),[g,k]=z.useState(16),[w,A]=z.useState(""),[E,j]=z.useState([]),[D,U]=z.useState([]),[O,J]=z.useState(Bn.ai),[ee,H]=z.useState(Bn.sampler),[L,me]=z.useState(Bn.prompts),[he,I]=z.useState(!1),[te,ne]=z.useState([]),[pe,ge]=z.useState(!1),re=z.useRef(new Map),X=z.useRef(new Map),ve=z.useRef(new Map),Te=z.useRef(new Map),Ee=z.useRef(new Map),q=z.useRef(new Map),ye=z.useRef(new Map),Ce=z.useRef(new Map),B=z.useRef(null),$e=z.useRef(null),rt=z.useRef(null),Qe=z.useCallback(()=>{B.current!==null&&(window.clearTimeout(B.current),B.current=null)},[]),wt=z.useCallback(async()=>{if(!a){ne([]);return}ge(!0);try{const Ne=await Tl.listSnapshots(a);ne(Ne)}catch(Ne){console.error("Failed to load snapshots:",Ne)}finally{ge(!1)}},[a]),ft=z.useCallback(async(Ne,Be)=>{try{const je=await Tl.createSnapshot(Ne,Be);return await wt(),je}catch(je){return console.error(`Failed to create ${Be} snapshot:`,je),null}},[wt]),Ot=z.useCallback(Ne=>{$e.current=Ne,Qe(),B.current=window.setTimeout(()=>{const Be=$e.current;$e.current=null,B.current=null,Be&&ft(Be,"auto")},U4)},[Qe,ft]),Fe=z.useCallback(async(Ne,Be)=>{const je=ye.current.get(Ne);if(!je)return null;const He=(Ee.current.get(Ne)??0)+1;Ee.current.set(Ne,He);try{const De=await t(Be,je),Se=Ce.current.get(Ne);return ye.current.delete(Ne),Ce.current.delete(Ne),Ee.current.get(Ne)===He&&(h(!1),p("saved"),Ot(De)),Se?.resolve.forEach(ot=>ot(De)),De}catch(De){const Se=Ce.current.get(Ne);throw ye.current.delete(Ne),Ce.current.delete(Ne),Ee.current.get(Ne)===He&&p("error"),Se?.reject.forEach(ot=>ot(De)),De}},[Ot,t]),Yt=z.useCallback(async(Ne,Be,je)=>{const He=ve.current.get(Ne);if(He===void 0)return null;const De=(re.current.get(Ne)??0)+1;re.current.set(Ne,De);try{const Se=await r(Be,je,He),ot=Te.current.get(Ne);return ve.current.delete(Ne),Te.current.delete(Ne),re.current.get(Ne)===De&&(h(!1),p("saved"),Ot(Se)),ot?.resolve.forEach(mt=>mt(Se)),Se}catch(Se){const ot=Te.current.get(Ne);throw ve.current.delete(Ne),Te.current.delete(Ne),re.current.get(Ne)===De&&(console.error("Failed to save spec field:",Se),p("error")),ot?.reject.forEach(mt=>mt(Se)),Se}},[Ot,r]),dt=z.useCallback(async()=>{if(!e)return null;const Ne=e.id,Be=[],je=`${Ne}:updateCharacter`;q.current.has(je)&&(window.clearTimeout(q.current.get(je)),q.current.delete(je),Be.push(Fe(je,Ne)));for(const[De,Se]of X.current.entries()){if(!De.startsWith(`${Ne}:`))continue;window.clearTimeout(Se),X.current.delete(De);const ot=De.slice(Ne.length+1);Be.push(Yt(De,Ne,ot))}return Be.length===0?e:(await Promise.all(Be)).filter(De=>De!==null).at(-1)??e},[Fe,Yt,e]),wn=Ci.useMemo(()=>{const Ne=["image","extensions"].includes(s)||D.includes(s)?[]:[s];return[...new Set([...Ne,...E])].filter(Be=>!D.includes(Be))},[s,E,D]),vn=z.useCallback(async()=>{try{const[Ne,Be,je,He]=await Promise.all([rr.getAISettings(),rr.getSamplerSettings(),rr.getPromptSettings(),rr.getSettings()]);J(Ne),H(Be),me(je),k(He.ui.editorFontSize)}catch(Ne){console.error("Failed to load settings:",Ne)}},[]);z.useEffect(()=>{const Ne=setTimeout(()=>{vn()},0);return()=>clearTimeout(Ne)},[vn]),z.useEffect(()=>{document.documentElement.style.setProperty("--editor-font-size",`${g}px`)},[g]),z.useEffect(()=>{if(!e||!a){rt.current=null,ne([]),I(!1),$e.current=null,Qe();return}rt.current!==a&&(rt.current=a,$e.current=null,Qe(),wt())},[Qe,e,a,wt]),z.useEffect(()=>()=>{Qe()},[Qe]);const un=z.useRef(s);z.useEffect(()=>{if(un.current!==s){un.current=s;const Ne=setTimeout(()=>{U([])},0);return()=>clearTimeout(Ne)}},[s]);const Pn=z.useCallback(async Ne=>{if(!e)throw new Error("No character is currently open");const Be=e.id,je=`${Be}:updateCharacter`;h(!0),p("saving");const He=ye.current.get(je),De={...He,...Ne,data:Ne.data??He?.data};return ye.current.set(je,De),q.current.has(je)&&window.clearTimeout(q.current.get(je)),new Promise((Se,ot)=>{const mt=Ce.current.get(je)??{resolve:[],reject:[]};mt.resolve.push(Se),mt.reject.push(ot),Ce.current.set(je,mt);const mi=window.setTimeout(async()=>{q.current.delete(je);try{await Fe(je,Be)}catch{}},Zb);q.current.set(je,mi)})},[Fe,e]),Qn=z.useCallback(async(Ne,Be)=>{if(!e)throw new Error("No character is currently open");const je=`${e.id}:${String(Ne)}`,He=e.id;return ve.current.set(je,Be),h(!0),p("saving"),X.current.has(je)&&window.clearTimeout(X.current.get(je)),new Promise((De,Se)=>{const ot=Te.current.get(je)??{resolve:[],reject:[]};ot.resolve.push(De),ot.reject.push(Se),Te.current.set(je,ot);const mt=window.setTimeout(async()=>{X.current.delete(je);try{await Yt(je,He,Ne)}catch{}},Zb);X.current.set(je,mt)})},[Yt,e]),mn=z.useCallback(async Ne=>{k(Ne),document.documentElement.style.setProperty("--editor-font-size",`${Ne}px`);try{const Be=await rr.getSettings();await rr.saveSettings({...Be,ui:{...Be.ui,editorFontSize:Ne}})}catch(Be){console.error("Failed to save font size:",Be)}},[]),Xn=z.useCallback(Ne=>{j(Be=>{const He=(typeof Ne=="function"?Ne(Be):Ne).filter(De=>De!==s);return rr.saveContextSectionIds(He),He})},[s]),Fn=z.useCallback(Ne=>{U(Be=>Be.filter(je=>je!==Ne)),j(Be=>{if(Be.includes(Ne))return Be;const je=[...Be,Ne];return rr.addContextSection(Ne),je})},[]),Pe=z.useCallback(Ne=>{U(Be=>[...new Set([...Be,Ne])]),j(Be=>{const je=Be.filter(He=>He!==Ne);return rr.removeContextSection(Ne),je})},[]),Rt=z.useCallback(Ne=>{J(Be=>{const je={...Be,...Ne};return rr.saveAISettings(je),je})},[]),$t=z.useCallback(Ne=>{H(Be=>{const je={...Be,...Ne};return rr.saveSamplerSettings(je),je})},[]),Pt=z.useCallback(Ne=>{me(Be=>{const je={...Be,...Ne};return rr.savePromptSettings(je),je})},[]),yn=z.useCallback(async()=>{if(!e)return"skipped";const Ne=await dt();return Qe(),$e.current=null,await ft(Ne??e,"manual")?"created":"skipped"},[Qe,ft,e,dt]),ie=z.useCallback(Ne=>{if(!e)return[];const Be=te.find(je=>je.id===Ne);return Be?Tl.diffSnapshotAgainstCharacter(Be,e):[]},[e,te]),be=z.useCallback(async(Ne,Be)=>{if(!e)return;const je=te.find(He=>He.id===Ne);if(je){Qe(),$e.current=null,p("saving");try{let He;if(Be==="whole"){const De=Tl.restoreWholeCharacter(e,je);He=await t(e.id,De)}else{const De=Tl.restoreSection(e,je,s);if(!De){p("saved");return}De.kind==="image"?He=await t(e.id,{imageData:De.value}):De.kind==="spec"?He=await r(e.id,De.field,De.value):He=await t(e.id,De.input)}h(!1),p("saved"),await ft(He,"rollback")}catch(He){console.error("Failed to restore snapshot:",He),p("error")}}},[s,Qe,ft,e,te,t,r]),Ke=z.useCallback(Ne=>e?Ne.map(Be=>{const je=e.data.spec;switch(Be){case"name":return`Character Name: ${je.name}`;case"description":return`Description:
${je.description}`;case"personality":return`Personality:
${je.personality}`;case"scenario":return`Scenario:
${je.scenario}`;case"first_mes":return`First Message:
${je.first_mes}`;case"mes_example":return`Message Examples:
${je.mes_example}`;case"system_prompt":return`System Prompt:
${je.system_prompt}`;case"post_history_instructions":return`Post-History Instructions:
${je.post_history_instructions}`;case"alternate_greetings":return`Alternate Greetings:
${je.alternate_greetings.join(`
---
`)}`;case"physical_description":return`Physical Description:
${je.physical_description}`;case"avatar":return je.avatar?`Avatar URL: ${je.avatar}`:"";case"creator_notes":return je.creator_notes?`Creator Notes:
${je.creator_notes}`:"";case"creator":return je.creator?`Creator: ${je.creator}`:"";case"character_version":return je.character_version?`Version: ${je.character_version}`:"";case"tags":return je.tags?.length?`Tags: ${je.tags.join(", ")}`:"";case"lorebook":{const He=e.data.characterBook;if(!He||He.entries.length===0)return"";const De=He.entries.filter(ot=>ot.enabled);if(De.length===0)return"";let Se=`Lorebook: ${He.name||"Character Lore"}
`;return He.description&&(Se+=`${He.description}
`),Se+=`
`,De.forEach(ot=>{Se+=`[Entry ${ot.id}]`,ot.name&&(Se+=` ${ot.name}`),Se+=`
`,Se+=`Keys: ${ot.keys.join(", ")}
`,ot.comment&&(Se+=`Note: ${ot.comment}
`),Se+=`${ot.content}

`}),Se.trim()}default:return""}}).filter(Be=>Be.length>0):[],[e]),tt=z.useCallback((Ne,Be,je)=>{if(!e||!s)return;const He=e.data.spec;let De;switch(s){case"name":De=He.name;break;case"description":De=He.description;break;case"personality":De=He.personality;break;case"scenario":De=He.scenario;break;case"first_mes":De=He.first_mes;break;case"mes_example":De=He.mes_example;break;case"system_prompt":De=He.system_prompt;break;case"post_history_instructions":De=He.post_history_instructions;break;case"alternate_greetings":De=He.alternate_greetings.join(`
---
`);break;case"physical_description":De=He.physical_description;break;case"avatar":De=He.avatar||"";break;case"creator_notes":De=He.creator_notes||"";break;case"creator":De=He.creator||"";break;case"character_version":De=He.character_version||"";break;case"tags":De=He.tags?.join(", ")||"";break;default:return}const Se=je??w;let ot;switch(Be){case"expand":case"rewrite":case"instruct":if(Se){const mt=De.indexOf(Se);if(mt!==-1)ot=De.substring(0,mt)+Ne+De.substring(mt+Se.length);else{const mi=Se.trim(),Ve=De.indexOf(mi);Ve!==-1?ot=De.substring(0,Ve)+Ne+De.substring(Ve+mi.length):(console.warn("AI operation: Selected text not found in content, appending instead"),ot=De+`

`+Ne)}}else ot=De+`

`+Ne;break;case"ask":ot=De+`

`+Ne;break;default:ot=De}s==="alternate_greetings"?Qn(s,ot.split(`
---
`).filter(mt=>mt.trim())):s==="tags"?Qn(s,ot.split(",").map(mt=>mt.trim()).filter(mt=>mt)):Qn(s,ot),A("")},[e,s,w,Qn]),it={currentCharacter:e,activeSection:s,isDirty:c,saveStatus:d,fontSize:g,selectedText:w,contextSectionIds:wn,userAddedContextIds:E,aiConfig:O,samplerSettings:ee,promptSettings:L,isHistoryOpen:he,snapshots:te,isSnapshotsLoading:pe,setActiveSection:o,updateCharacter:Pn,updateSpecField:Qn,setFontSize:mn,setSelectedText:A,setContextSectionIds:Xn,addContextSection:Fn,removeContextSection:Pe,updateAIConfig:Rt,updateSamplerSettings:$t,updatePromptSettings:Pt,setIsHistoryOpen:I,createManualSnapshot:yn,refreshSnapshots:wt,restoreSnapshot:be,getSnapshotDiff:ie,handleAIOperation:tt,getContextContent:Ke,reloadSettings:vn};return b.jsx(pw.Provider,{value:it,children:n})}function Wo(){const n=z.useContext(pw);if(!n)throw new Error("useCharacterEditorContext must be used within a CharacterEditorProvider");return n}var F4=hw();const mw=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();const K4=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const G4=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());const Jb=n=>{const e=G4(n);return e.charAt(0).toUpperCase()+e.slice(1)};var Y4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const $4=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const Q4=z.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:s,iconNode:o,...c},h)=>z.createElement("svg",{ref:h,...Y4,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:mw("lucide",a),...!s&&!$4(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,p])=>z.createElement(d,p)),...Array.isArray(s)?s:[s]]));const Ze=(n,e)=>{const t=z.forwardRef(({className:r,...a},s)=>z.createElement(Q4,{ref:s,iconNode:e,className:mw(`lucide-${K4(Jb(n))}`,`lucide-${n}`,r),...a}));return t.displayName=Jb(n),t};const X4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],W4=Ze("arrow-left",X4);const Z4=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Zf=Ze("book-open",Z4);const J4=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],q0=Ze("book",J4);const eT=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],gw=Ze("brain",eT);const tT=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],e1=Ze("camera",tT);const nT=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],U0=Ze("check",nT);const rT=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],La=Ze("chevron-down",rT);const iT=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],aT=Ze("chevron-left",iT);const lT=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],sT=Ze("chevron-right",lT);const oT=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Po=Ze("chevron-up",oT);const uT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Wi=Ze("circle-alert",uT);const cT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],hT=Ze("circle-question-mark",cT);const fT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],dT=Ze("circle-user",fT);const pT=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],mT=Ze("clock-3",pT);const gT=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],yT=Ze("clock",gT);const xT=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],V0=Ze("copy",xT);const vT=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],yw=Ze("download",vT);const bT=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],kT=Ze("eye",bT);const wT=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Eo=Ze("file-text",wT);const ST=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],CT=Ze("funnel",ST);const AT=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],TT=Ze("hash",AT);const NT=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],F0=Ze("history",NT);const ET=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],K0=Ze("image",ET);const MT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],jT=Ze("info",MT);const _T=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],DT=Ze("key",_T);const OT=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],RT=Ze("layers",OT);const LT=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],BT=Ze("link",LT);const zT=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],bc=Ze("loader-circle",zT);const IT=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],PT=Ze("map",IT);const HT=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Rg=Ze("message-circle",HT);const qT=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Do=Ze("message-square",qT);const UT=[["path",{d:"M16 10a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 14.286V4a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z",key:"1n2ejm"}],["path",{d:"M20 9a2 2 0 0 1 2 2v10.286a.71.71 0 0 1-1.212.502l-2.202-2.202A2 2 0 0 0 17.172 19H10a2 2 0 0 1-2-2v-1",key:"1qfcsi"}]],VT=Ze("messages-square",UT);const FT=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],KT=Ze("moon",FT);const GT=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],YT=Ze("notebook-pen",GT);const $T=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],QT=Ze("palette",$T);const XT=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],WT=Ze("panel-left",XT);const ZT=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}]],JT=Ze("panel-right",ZT);const eN=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],t1=Ze("pen-tool",eN);const tN=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],nN=Ze("percent",tN);const rN=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],iN=Ze("play",rN);const aN=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Zo=Ze("plus",aN);const lN=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],sN=Ze("puzzle",lN);const oN=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],xw=Ze("refresh-cw",oN);const uN=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],cN=Ze("repeat",uN);const hN=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Lg=Ze("rocket",hN);const fN=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],vw=Ze("rotate-ccw",fN);const dN=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],bw=Ze("save",dN);const pN=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],mN=Ze("scroll-text",pN);const gN=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Jf=Ze("search",gN);const yN=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],xN=Ze("server",yN);const vN=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],bN=Ze("settings-2",vN);const kN=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],wN=Ze("settings",kN);const SN=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],CN=Ze("shield",SN);const AN=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],kw=Ze("sliders-vertical",AN);const TN=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ba=Ze("sparkles",TN);const NN=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],EN=Ze("square",NN);const MN=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],jN=Ze("sun",MN);const _N=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],DN=Ze("tag",_N);const ON=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],RN=Ze("tags",ON);const LN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ww=Ze("target",LN);const BN=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],zN=Ze("terminal",BN);const IN=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],PN=Ze("thermometer",IN);const HN=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_l=Ze("trash-2",HN);const qN=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Sw=Ze("type",qN);const UN=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Rc=Ze("upload",UN);const VN=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],G0=Ze("user",VN);const FN=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Bg=Ze("users",FN);const KN=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Cw=Ze("wand-sparkles",KN);const GN=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],za=Ze("x",GN);const YN=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],$N=Ze("zap",YN);let zg=[],Aw=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?Aw:zg).push(t=t+n[e])})();function QN(n){if(n<768)return!1;for(let e=0,t=zg.length;;){let r=e+t>>1;if(n<zg[r])t=r;else if(n>=Aw[r])e=r+1;else return!0;if(e==t)return!1}}function n1(n){return n>=127462&&n<=127487}const r1=8205;function XN(n,e,t=!0,r=!0){return(t?Tw:WN)(n,e,r)}function Tw(n,e,t){if(e==n.length)return e;e&&Nw(n.charCodeAt(e))&&Ew(n.charCodeAt(e-1))&&e--;let r=Gm(n,e);for(e+=i1(r);e<n.length;){let a=Gm(n,e);if(r==r1||a==r1||t&&QN(a))e+=i1(a),r=a;else if(n1(a)){let s=0,o=e-2;for(;o>=0&&n1(Gm(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function WN(n,e,t){for(;e>0;){let r=Tw(n,e-2,t);if(r<e)return r;e--}return 0}function Gm(n,e){let t=n.charCodeAt(e);if(!Ew(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return Nw(r)?(t-55296<<10)+(r-56320)+65536:t}function Nw(n){return n>=56320&&n<57344}function Ew(n){return n>=55296&&n<56320}function i1(n){return n<65536?1:2}class It{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){[e,t]=Ho(this,e,t);let a=[];return this.decompose(0,e,a,2),r.length&&r.decompose(0,r.length,a,3),this.decompose(t,this.length,a,1),Qi.from(a,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Ho(this,e,t);let r=[];return this.decompose(e,t,r,0),Qi.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),a=new kc(this),s=new kc(e);for(let o=t,c=t;;){if(a.next(o),s.next(o),o=0,a.lineBreak!=s.lineBreak||a.done!=s.done||a.value!=s.value)return!1;if(c+=a.value.length,a.done||c>=r)return!0}}iter(e=1){return new kc(this,e)}iterRange(e,t=this.length){return new Mw(this,e,t)}iterLines(e,t){let r;if(e==null)r=this.iter();else{t==null&&(t=this.lines+1);let a=this.line(e).from;r=this.iterRange(a,Math.max(a,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new jw(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?It.empty:e.length<=32?new Mn(e):Qi.from(Mn.split(e,[]))}}class Mn extends It{constructor(e,t=ZN(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,r,a){for(let s=0;;s++){let o=this.text[s],c=a+o.length;if((t?r:c)>=e)return new JN(a,c,r,o);a=c+1,r++}}decompose(e,t,r,a){let s=e<=0&&t>=this.length?this:new Mn(a1(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(a&1){let o=r.pop(),c=Vf(s.text,o.text.slice(),0,s.length);if(c.length<=32)r.push(new Mn(c,o.length+s.length));else{let h=c.length>>1;r.push(new Mn(c.slice(0,h)),new Mn(c.slice(h)))}}else r.push(s)}replace(e,t,r){if(!(r instanceof Mn))return super.replace(e,t,r);[e,t]=Ho(this,e,t);let a=Vf(this.text,Vf(r.text,a1(this.text,0,e)),t),s=this.length+r.length-(t-e);return a.length<=32?new Mn(a,s):Qi.from(Mn.split(a,[]),s)}sliceString(e,t=this.length,r=`
`){[e,t]=Ho(this,e,t);let a="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let c=this.text[o],h=s+c.length;s>e&&o&&(a+=r),e<h&&t>s&&(a+=c.slice(Math.max(0,e-s),t-s)),s=h+1}return a}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],a=-1;for(let s of e)r.push(s),a+=s.length+1,r.length==32&&(t.push(new Mn(r,a)),r=[],a=-1);return a>-1&&t.push(new Mn(r,a)),t}}class Qi extends It{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let r of e)this.lines+=r.lines}lineInner(e,t,r,a){for(let s=0;;s++){let o=this.children[s],c=a+o.length,h=r+o.lines-1;if((t?h:c)>=e)return o.lineInner(e,t,r,a);a=c+1,r=h+1}}decompose(e,t,r,a){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let c=this.children[s],h=o+c.length;if(e<=h&&t>=o){let d=a&((o<=e?1:0)|(h>=t?2:0));o>=e&&h<=t&&!d?r.push(c):c.decompose(e-o,t-o,r,d)}o=h+1}}replace(e,t,r){if([e,t]=Ho(this,e,t),r.lines<this.lines)for(let a=0,s=0;a<this.children.length;a++){let o=this.children[a],c=s+o.length;if(e>=s&&t<=c){let h=o.replace(e-s,t-s,r),d=this.lines-o.lines+h.lines;if(h.lines<d>>4&&h.lines>d>>6){let p=this.children.slice();return p[a]=h,new Qi(p,this.length-(t-e)+r.length)}return super.replace(s,c,h)}s=c+1}return super.replace(e,t,r)}sliceString(e,t=this.length,r=`
`){[e,t]=Ho(this,e,t);let a="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let c=this.children[s],h=o+c.length;o>e&&s&&(a+=r),e<h&&t>o&&(a+=c.sliceString(e-o,t-o,r)),o=h+1}return a}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Qi))return 0;let r=0,[a,s,o,c]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;a+=t,s+=t){if(a==o||s==c)return r;let h=this.children[a],d=e.children[s];if(h!=d)return r+h.scanIdentical(d,t);r+=h.length+1}}static from(e,t=e.reduce((r,a)=>r+a.length+1,-1)){let r=0;for(let w of e)r+=w.lines;if(r<32){let w=[];for(let A of e)A.flatten(w);return new Mn(w,t)}let a=Math.max(32,r>>5),s=a<<1,o=a>>1,c=[],h=0,d=-1,p=[];function g(w){let A;if(w.lines>s&&w instanceof Qi)for(let E of w.children)g(E);else w.lines>o&&(h>o||!h)?(k(),c.push(w)):w instanceof Mn&&h&&(A=p[p.length-1])instanceof Mn&&w.lines+A.lines<=32?(h+=w.lines,d+=w.length+1,p[p.length-1]=new Mn(A.text.concat(w.text),A.length+1+w.length)):(h+w.lines>a&&k(),h+=w.lines,d+=w.length+1,p.push(w))}function k(){h!=0&&(c.push(p.length==1?p[0]:Qi.from(p,d)),d=-1,h=p.length=0)}for(let w of e)g(w);return k(),c.length==1?c[0]:new Qi(c,t)}}It.empty=new Mn([""],0);function ZN(n){let e=-1;for(let t of n)e+=t.length+1;return e}function Vf(n,e,t=0,r=1e9){for(let a=0,s=0,o=!0;s<n.length&&a<=r;s++){let c=n[s],h=a+c.length;h>=t&&(h>r&&(c=c.slice(0,r-a)),a<t&&(c=c.slice(t-a)),o?(e[e.length-1]+=c,o=!1):e.push(c)),a=h+1}return e}function a1(n,e,t){return Vf(n,[""],e,t)}class kc{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Mn?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,a=this.nodes[r],s=this.offsets[r],o=s>>1,c=a instanceof Mn?a.text.length:a.children.length;if(o==(t>0?c:0)){if(r==0)return this.done=!0,this.value="",this;t>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[r]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(a instanceof Mn){let h=a.text[o+(t<0?-1:0)];if(this.offsets[r]+=t,h.length>Math.max(0,e))return this.value=e==0?h:t>0?h.slice(e):h.slice(0,h.length-e),this;e-=h.length}else{let h=a.children[o+(t<0?-1:0)];e>h.length?(e-=h.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(h),this.offsets.push(t>0?1:(h instanceof Mn?h.text.length:h.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class Mw{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new kc(e,t>r?-1:1),this.pos=t>r?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let r=t<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:a}=this.cursor.next(e);return this.pos+=(a.length+e)*t,this.value=a.length<=r?a:t<0?a.slice(a.length-r):a.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class jw{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:r,value:a}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=a,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(It.prototype[Symbol.iterator]=function(){return this.iter()},kc.prototype[Symbol.iterator]=Mw.prototype[Symbol.iterator]=jw.prototype[Symbol.iterator]=function(){return this});class JN{constructor(e,t,r,a){this.from=e,this.to=t,this.number=r,this.text=a}get length(){return this.to-this.from}}function Ho(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function Un(n,e,t=!0,r=!0){return XN(n,e,t,r)}function eE(n){return n>=56320&&n<57344}function tE(n){return n>=55296&&n<56320}function _w(n,e){let t=n.charCodeAt(e);if(!tE(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return eE(r)?(t-55296<<10)+(r-56320)+65536:t}function nE(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Dw(n){return n<65536?1:2}const Ig=/\r\n?|\n/;var Kr=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(Kr||(Kr={}));class ta{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,r=0,a=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(r,a,s),a+=s):a+=o,r+=s}}iterChangedRanges(e,t=!1){Pg(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let r=this.sections[t++],a=this.sections[t++];a<0?e.push(r,a):e.push(a,r)}return new ta(e)}composeDesc(e){return this.empty?e:e.empty?this:Ow(this,e)}mapDesc(e,t=!1){return e.empty?this:Hg(this,e,t)}mapPos(e,t=-1,r=Kr.Simple){let a=0,s=0;for(let o=0;o<this.sections.length;){let c=this.sections[o++],h=this.sections[o++],d=a+c;if(h<0){if(d>e)return s+(e-a);s+=c}else{if(r!=Kr.Simple&&d>=e&&(r==Kr.TrackDel&&a<e&&d>e||r==Kr.TrackBefore&&a<e||r==Kr.TrackAfter&&d>e))return null;if(d>e||d==e&&t<0&&!c)return e==a||t<0?s:s+h;s+=h}a=d}if(e>a)throw new RangeError(`Position ${e} is out of range for changeset of length ${a}`);return s}touchesRange(e,t=e){for(let r=0,a=0;r<this.sections.length&&a<=t;){let s=this.sections[r++],o=this.sections[r++],c=a+s;if(o>=0&&a<=t&&c>=e)return a<e&&c>t?"cover":!0;a=c}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let r=this.sections[t++],a=this.sections[t++];e+=(e?" ":"")+r+(a>=0?":"+a:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ta(e)}static create(e){return new ta(e)}}class qn extends ta{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Pg(this,(t,r,a,s,o)=>e=e.replace(a,a+(r-t),o),!1),e}mapDesc(e,t=!1){return Hg(this,e,t,!0)}invert(e){let t=this.sections.slice(),r=[];for(let a=0,s=0;a<t.length;a+=2){let o=t[a],c=t[a+1];if(c>=0){t[a]=c,t[a+1]=o;let h=a>>1;for(;r.length<h;)r.push(It.empty);r.push(o?e.slice(s,s+o):It.empty)}s+=o}return new qn(t,r)}compose(e){return this.empty?e:e.empty?this:Ow(this,e,!0)}map(e,t=!1){return e.empty?this:Hg(this,e,t,!0)}iterChanges(e,t=!1){Pg(this,e,t)}get desc(){return ta.create(this.sections)}filter(e){let t=[],r=[],a=[],s=new Lc(this);e:for(let o=0,c=0;;){let h=o==e.length?1e9:e[o++];for(;c<h||c==h&&s.len==0;){if(s.done)break e;let p=Math.min(s.len,h-c);fr(a,p,-1);let g=s.ins==-1?-1:s.off==0?s.ins:0;fr(t,p,g),g>0&&El(r,t,s.text),s.forward(p),c+=p}let d=e[o++];for(;c<d;){if(s.done)break e;let p=Math.min(s.len,d-c);fr(t,p,-1),fr(a,p,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(p),c+=p}}return{changes:new qn(t,r),filtered:ta.create(a)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t],a=this.sections[t+1];a<0?e.push(r):a==0?e.push([r]):e.push([r].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,r){let a=[],s=[],o=0,c=null;function h(p=!1){if(!p&&!a.length)return;o<t&&fr(a,t-o,-1);let g=new qn(a,s);c=c?c.compose(g.map(c)):g,a=[],s=[],o=0}function d(p){if(Array.isArray(p))for(let g of p)d(g);else if(p instanceof qn){if(p.length!=t)throw new RangeError(`Mismatched change set length (got ${p.length}, expected ${t})`);h(),c=c?c.compose(p.map(c)):p}else{let{from:g,to:k=g,insert:w}=p;if(g>k||g<0||k>t)throw new RangeError(`Invalid change range ${g} to ${k} (in doc of length ${t})`);let A=w?typeof w=="string"?It.of(w.split(r||Ig)):w:It.empty,E=A.length;if(g==k&&E==0)return;g<o&&h(),g>o&&fr(a,g-o,-1),fr(a,k-g,E),El(s,a,A),o=k}}return d(e),h(!c),c}static empty(e){return new qn(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],r=[];for(let a=0;a<e.length;a++){let s=e[a];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,c)=>c&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;r.length<a;)r.push(It.empty);r[a]=It.of(s.slice(1)),t.push(s[0],r[a].length)}}}return new qn(t,r)}static createSet(e,t){return new qn(e,t)}}function fr(n,e,t,r=!1){if(e==0&&t<=0)return;let a=n.length-2;a>=0&&t<=0&&t==n[a+1]?n[a]+=e:a>=0&&e==0&&n[a]==0?n[a+1]+=t:r?(n[a]+=e,n[a+1]+=t):n.push(e,t)}function El(n,e,t){if(t.length==0)return;let r=e.length-2>>1;if(r<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<r;)n.push(It.empty);n.push(t)}}function Pg(n,e,t){let r=n.inserted;for(let a=0,s=0,o=0;o<n.sections.length;){let c=n.sections[o++],h=n.sections[o++];if(h<0)a+=c,s+=c;else{let d=a,p=s,g=It.empty;for(;d+=c,p+=h,h&&r&&(g=g.append(r[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)c=n.sections[o++],h=n.sections[o++];e(a,d,s,p,g),a=d,s=p}}}function Hg(n,e,t,r=!1){let a=[],s=r?[]:null,o=new Lc(n),c=new Lc(e);for(let h=-1;;){if(o.done&&c.len||c.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&c.ins==-1){let d=Math.min(o.len,c.len);fr(a,d,-1),o.forward(d),c.forward(d)}else if(c.ins>=0&&(o.ins<0||h==o.i||o.off==0&&(c.len<o.len||c.len==o.len&&!t))){let d=c.len;for(fr(a,c.ins,-1);d;){let p=Math.min(o.len,d);o.ins>=0&&h<o.i&&o.len<=p&&(fr(a,0,o.ins),s&&El(s,a,o.text),h=o.i),o.forward(p),d-=p}c.next()}else if(o.ins>=0){let d=0,p=o.len;for(;p;)if(c.ins==-1){let g=Math.min(p,c.len);d+=g,p-=g,c.forward(g)}else if(c.ins==0&&c.len<p)p-=c.len,c.next();else break;fr(a,d,h<o.i?o.ins:0),s&&h<o.i&&El(s,a,o.text),h=o.i,o.forward(o.len-p)}else{if(o.done&&c.done)return s?qn.createSet(a,s):ta.create(a);throw new Error("Mismatched change set lengths")}}}function Ow(n,e,t=!1){let r=[],a=t?[]:null,s=new Lc(n),o=new Lc(e);for(let c=!1;;){if(s.done&&o.done)return a?qn.createSet(r,a):ta.create(r);if(s.ins==0)fr(r,s.len,0,c),s.next();else if(o.len==0&&!o.done)fr(r,0,o.ins,c),a&&El(a,r,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let h=Math.min(s.len2,o.len),d=r.length;if(s.ins==-1){let p=o.ins==-1?-1:o.off?0:o.ins;fr(r,h,p,c),a&&p&&El(a,r,o.text)}else o.ins==-1?(fr(r,s.off?0:s.len,h,c),a&&El(a,r,s.textBit(h))):(fr(r,s.off?0:s.len,o.off?0:o.ins,c),a&&!o.off&&El(a,r,o.text));c=(s.ins>h||o.ins>=0&&o.len>h)&&(c||r.length>d),s.forward2(h),o.forward(h)}}}}class Lc{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?It.empty:e[t]}textBit(e){let{inserted:t}=this.set,r=this.i-2>>1;return r>=t.length&&!e?It.empty:t[r].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class bs{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let r,a;return this.empty?r=a=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),a=e.mapPos(this.to,-1)),r==this.from&&a==this.to?this:new bs(r,a,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return Le.range(e,t);let r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return Le.range(this.anchor,r)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Le.range(e.anchor,e.head)}static create(e,t,r){return new bs(e,t,r)}}class Le{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:Le.create(this.ranges.map(r=>r.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Le([this.main],0)}addRange(e,t=!0){return Le.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let r=this.ranges.slice();return r[t]=e,Le.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Le(e.ranges.map(t=>bs.fromJSON(t)),e.main)}static single(e,t=e){return new Le([Le.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,a=0;a<e.length;a++){let s=e[a];if(s.empty?s.from<=r:s.from<r)return Le.normalized(e.slice(),t);r=s.to}return new Le(e,t)}static cursor(e,t=0,r,a){return bs.create(e,e,(t==0?0:t<0?8:16)|(r==null?7:Math.min(6,r))|(a??16777215)<<6)}static range(e,t,r,a){let s=(r??16777215)<<6|(a==null?7:Math.min(6,a));return t<e?bs.create(t,e,48|s):bs.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let r=e[t];e.sort((a,s)=>a.from-s.from),t=e.indexOf(r);for(let a=1;a<e.length;a++){let s=e[a],o=e[a-1];if(s.empty?s.from<=o.to:s.from<o.to){let c=o.from,h=Math.max(s.to,o.to);a<=t&&t--,e.splice(--a,2,s.anchor>s.head?Le.range(h,c):Le.range(c,h))}}return new Le(e,t)}}function Rw(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Y0=0;class ct{constructor(e,t,r,a,s){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=a,this.id=Y0++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new ct(e.combine||(t=>t),e.compareInput||((t,r)=>t===r),e.compare||(e.combine?(t,r)=>t===r:$0),!!e.static,e.enables)}of(e){return new Ff([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ff(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ff(e,this,2,t)}from(e,t){return t||(t=r=>r),this.compute([e],r=>t(r.field(e)))}}function $0(n,e){return n==e||n.length==e.length&&n.every((t,r)=>t===e[r])}class Ff{constructor(e,t,r,a){this.dependencies=e,this.facet=t,this.type=r,this.value=a,this.id=Y0++}dynamicSlot(e){var t;let r=this.value,a=this.facet.compareInput,s=this.id,o=e[s]>>1,c=this.type==2,h=!1,d=!1,p=[];for(let g of this.dependencies)g=="doc"?h=!0:g=="selection"?d=!0:(((t=e[g.id])!==null&&t!==void 0?t:1)&1)==0&&p.push(e[g.id]);return{create(g){return g.values[o]=r(g),1},update(g,k){if(h&&k.docChanged||d&&(k.docChanged||k.selection)||qg(g,p)){let w=r(g);if(c?!l1(w,g.values[o],a):!a(w,g.values[o]))return g.values[o]=w,1}return 0},reconfigure:(g,k)=>{let w,A=k.config.address[s];if(A!=null){let E=td(k,A);if(this.dependencies.every(j=>j instanceof ct?k.facet(j)===g.facet(j):j instanceof Ni?k.field(j,!1)==g.field(j,!1):!0)||(c?l1(w=r(g),E,a):a(w=r(g),E)))return g.values[o]=E,0}else w=r(g);return g.values[o]=w,1}}}}function l1(n,e,t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function qg(n,e){let t=!1;for(let r of e)wc(n,r)&1&&(t=!0);return t}function rE(n,e,t){let r=t.map(h=>n[h.id]),a=t.map(h=>h.type),s=r.filter(h=>!(h&1)),o=n[e.id]>>1;function c(h){let d=[];for(let p=0;p<r.length;p++){let g=td(h,r[p]);if(a[p]==2)for(let k of g)d.push(k);else d.push(g)}return e.combine(d)}return{create(h){for(let d of r)wc(h,d);return h.values[o]=c(h),1},update(h,d){if(!qg(h,s))return 0;let p=c(h);return e.compare(p,h.values[o])?0:(h.values[o]=p,1)},reconfigure(h,d){let p=qg(h,r),g=d.config.facets[e.id],k=d.facet(e);if(g&&!p&&$0(t,g))return h.values[o]=k,0;let w=c(h);return e.compare(w,k)?(h.values[o]=k,0):(h.values[o]=w,1)}}}const xf=ct.define({static:!0});class Ni{constructor(e,t,r,a,s){this.id=e,this.createF=t,this.updateF=r,this.compareF=a,this.spec=s,this.provides=void 0}static define(e){let t=new Ni(Y0++,e.create,e.update,e.compare||((r,a)=>r===a),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(xf).find(r=>r.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:r=>(r.values[t]=this.create(r),1),update:(r,a)=>{let s=r.values[t],o=this.updateF(s,a);return this.compareF(s,o)?0:(r.values[t]=o,1)},reconfigure:(r,a)=>{let s=r.facet(xf),o=a.facet(xf),c;return(c=s.find(h=>h.field==this))&&c!=o.find(h=>h.field==this)?(r.values[t]=c.create(r),1):a.config.address[this.id]!=null?(r.values[t]=a.field(this),0):(r.values[t]=this.create(r),1)}}}init(e){return[this,xf.of({field:this,create:e})]}get extension(){return this}}const vs={lowest:4,low:3,default:2,high:1,highest:0};function lc(n){return e=>new Lw(e,n)}const Yc={highest:lc(vs.highest),high:lc(vs.high),default:lc(vs.default),low:lc(vs.low),lowest:lc(vs.lowest)};class Lw{constructor(e,t){this.inner=e,this.prec=t}}class Md{of(e){return new Ug(this,e)}reconfigure(e){return Md.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Ug{constructor(e,t){this.compartment=e,this.inner=t}}class ed{constructor(e,t,r,a,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=a,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,r){let a=[],s=Object.create(null),o=new Map;for(let k of iE(e,t,o))k instanceof Ni?a.push(k):(s[k.facet.id]||(s[k.facet.id]=[])).push(k);let c=Object.create(null),h=[],d=[];for(let k of a)c[k.id]=d.length<<1,d.push(w=>k.slot(w));let p=r?.config.facets;for(let k in s){let w=s[k],A=w[0].facet,E=p&&p[k]||[];if(w.every(j=>j.type==0))if(c[A.id]=h.length<<1|1,$0(E,w))h.push(r.facet(A));else{let j=A.combine(w.map(D=>D.value));h.push(r&&A.compare(j,r.facet(A))?r.facet(A):j)}else{for(let j of w)j.type==0?(c[j.id]=h.length<<1|1,h.push(j.value)):(c[j.id]=d.length<<1,d.push(D=>j.dynamicSlot(D)));c[A.id]=d.length<<1,d.push(j=>rE(j,A,w))}}let g=d.map(k=>k(c));return new ed(e,o,g,c,h,s)}}function iE(n,e,t){let r=[[],[],[],[],[]],a=new Map;function s(o,c){let h=a.get(o);if(h!=null){if(h<=c)return;let d=r[h].indexOf(o);d>-1&&r[h].splice(d,1),o instanceof Ug&&t.delete(o.compartment)}if(a.set(o,c),Array.isArray(o))for(let d of o)s(d,c);else if(o instanceof Ug){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let d=e.get(o.compartment)||o.inner;t.set(o.compartment,d),s(d,c)}else if(o instanceof Lw)s(o.inner,o.prec);else if(o instanceof Ni)r[c].push(o),o.provides&&s(o.provides,c);else if(o instanceof Ff)r[c].push(o),o.facet.extensions&&s(o.facet.extensions,vs.default);else{let d=o.extension;if(!d)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(d,c)}}return s(n,vs.default),r.reduce((o,c)=>o.concat(c))}function wc(n,e){if(e&1)return 2;let t=e>>1,r=n.status[t];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;n.status[t]=4;let a=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|a}function td(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const Bw=ct.define(),Vg=ct.define({combine:n=>n.some(e=>e),static:!0}),zw=ct.define({combine:n=>n.length?n[0]:void 0,static:!0}),Iw=ct.define(),Pw=ct.define(),Hw=ct.define(),qw=ct.define({combine:n=>n.length?n[0]:!1});class zl{constructor(e,t){this.type=e,this.value=t}static define(){return new aE}}class aE{of(e){return new zl(this,e)}}class lE{constructor(e){this.map=e}of(e){return new on(this,e)}}class on{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new on(this.type,t)}is(e){return this.type==e}static define(e={}){return new lE(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let r=[];for(let a of e){let s=a.map(t);s&&r.push(s)}return r}}on.reconfigure=on.define();on.appendConfig=on.define();class Vn{constructor(e,t,r,a,s,o){this.startState=e,this.changes=t,this.selection=r,this.effects=a,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,r&&Rw(r,t.newLength),s.some(c=>c.type==Vn.time)||(this.annotations=s.concat(Vn.time.of(Date.now())))}static create(e,t,r,a,s,o){return new Vn(e,t,r,a,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Vn.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Vn.time=zl.define();Vn.userEvent=zl.define();Vn.addToHistory=zl.define();Vn.remote=zl.define();function sE(n,e){let t=[];for(let r=0,a=0;;){let s,o;if(r<n.length&&(a==e.length||e[a]>=n[r]))s=n[r++],o=n[r++];else if(a<e.length)s=e[a++],o=e[a++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function Uw(n,e,t){var r;let a,s,o;return t?(a=e.changes,s=qn.empty(e.changes.length),o=n.changes.compose(e.changes)):(a=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(a)),{changes:o,selection:e.selection?e.selection.map(s):(r=n.selection)===null||r===void 0?void 0:r.map(a),effects:on.mapEffects(n.effects,a).concat(on.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function Fg(n,e,t){let r=e.selection,a=Oo(e.annotations);return e.userEvent&&(a=a.concat(Vn.userEvent.of(e.userEvent))),{changes:e.changes instanceof qn?e.changes:qn.of(e.changes||[],t,n.facet(zw)),selection:r&&(r instanceof Le?r:Le.single(r.anchor,r.head)),effects:Oo(e.effects),annotations:a,scrollIntoView:!!e.scrollIntoView}}function Vw(n,e,t){let r=Fg(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;r=Uw(r,Fg(n,e[s],o?r.changes.newLength:n.doc.length),o)}let a=Vn.create(n,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return uE(t?oE(a):a)}function oE(n){let e=n.startState,t=!0;for(let a of e.facet(Iw)){let s=a(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:sE(t,s))}if(t!==!0){let a,s;if(t===!1)s=n.changes.invertedDesc,a=qn.empty(e.doc.length);else{let o=n.changes.filter(t);a=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=Vn.create(e,a,n.selection&&n.selection.map(s),on.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let r=e.facet(Pw);for(let a=r.length-1;a>=0;a--){let s=r[a](n);s instanceof Vn?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Vn?n=s[0]:n=Vw(e,Oo(s),!1)}return n}function uE(n){let e=n.startState,t=e.facet(Hw),r=n;for(let a=t.length-1;a>=0;a--){let s=t[a](n);s&&Object.keys(s).length&&(r=Uw(r,Fg(e,s,n.changes.newLength),!0))}return r==n?n:Vn.create(e,n.changes,n.selection,r.effects,r.annotations,r.scrollIntoView)}const cE=[];function Oo(n){return n==null?cE:Array.isArray(n)?n:[n]}var lr=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(lr||(lr={}));const hE=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Kg;try{Kg=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function fE(n){if(Kg)return Kg.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||hE.test(t)))return!0}return!1}function dE(n){return e=>{if(!/\S/.test(e))return lr.Space;if(fE(e))return lr.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return lr.Word;return lr.Other}}class Ut{constructor(e,t,r,a,s,o){this.config=e,this.doc=t,this.selection=r,this.values=a,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let c=0;c<this.config.dynamicSlots.length;c++)wc(this,c<<1);this.computeSlot=null}field(e,t=!0){let r=this.config.address[e.id];if(r==null){if(t)throw new RangeError("Field is not present in this state");return}return wc(this,r),td(this,r)}update(...e){return Vw(this,e,!0)}applyTransaction(e){let t=this.config,{base:r,compartments:a}=t;for(let c of e.effects)c.is(Md.reconfigure)?(t&&(a=new Map,t.compartments.forEach((h,d)=>a.set(d,h)),t=null),a.set(c.value.compartment,c.value.extension)):c.is(on.reconfigure)?(t=null,r=c.value):c.is(on.appendConfig)&&(t=null,r=Oo(r).concat(c.value));let s;t?s=e.startState.values.slice():(t=ed.resolve(r,a,this),s=new Ut(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(h,d)=>d.reconfigure(h,this),null).values);let o=e.startState.facet(Vg)?e.newSelection:e.newSelection.asSingle();new Ut(t,e.newDoc,o,s,(c,h)=>h.update(c,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:Le.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,r=e(t.ranges[0]),a=this.changes(r.changes),s=[r.range],o=Oo(r.effects);for(let c=1;c<t.ranges.length;c++){let h=e(t.ranges[c]),d=this.changes(h.changes),p=d.map(a);for(let k=0;k<c;k++)s[k]=s[k].map(p);let g=a.mapDesc(d,!0);s.push(h.range.map(g)),a=a.compose(p),o=on.mapEffects(o,p).concat(on.mapEffects(Oo(h.effects),g))}return{changes:a,selection:Le.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof qn?e:qn.of(e,this.doc.length,this.facet(Ut.lineSeparator))}toText(e){return It.of(e.split(this.facet(Ut.lineSeparator)||Ig))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(wc(this,t),td(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let a=e[r];a instanceof Ni&&this.config.address[a.id]!=null&&(t[r]=a.spec.toJSON(this.field(e[r]),this))}return t}static fromJSON(e,t={},r){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let a=[];if(r){for(let s in r)if(Object.prototype.hasOwnProperty.call(e,s)){let o=r[s],c=e[s];a.push(o.init(h=>o.spec.fromJSON(c,h)))}}return Ut.create({doc:e.doc,selection:Le.fromJSON(e.selection),extensions:t.extensions?a.concat([t.extensions]):a})}static create(e={}){let t=ed.resolve(e.extensions||[],new Map),r=e.doc instanceof It?e.doc:It.of((e.doc||"").split(t.staticFacet(Ut.lineSeparator)||Ig)),a=e.selection?e.selection instanceof Le?e.selection:Le.single(e.selection.anchor,e.selection.head):Le.single(0);return Rw(a,r.length),t.staticFacet(Vg)||(a=a.asSingle()),new Ut(t,r,a,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Ut.tabSize)}get lineBreak(){return this.facet(Ut.lineSeparator)||`
`}get readOnly(){return this.facet(qw)}phrase(e,...t){for(let r of this.facet(Ut.phrases))if(Object.prototype.hasOwnProperty.call(r,e)){e=r[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(r,a)=>{if(a=="$")return"$";let s=+(a||1);return!s||s>t.length?r:t[s-1]})),e}languageDataAt(e,t,r=-1){let a=[];for(let s of this.facet(Bw))for(let o of s(this,t,r))Object.prototype.hasOwnProperty.call(o,e)&&a.push(o[e]);return a}charCategorizer(e){let t=this.languageDataAt("wordChars",e);return dE(t.length?t[0]:"")}wordAt(e){let{text:t,from:r,length:a}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-r,c=e-r;for(;o>0;){let h=Un(t,o,!1);if(s(t.slice(h,o))!=lr.Word)break;o=h}for(;c<a;){let h=Un(t,c);if(s(t.slice(c,h))!=lr.Word)break;c=h}return o==c?null:Le.range(o+r,c+r)}}Ut.allowMultipleSelections=Vg;Ut.tabSize=ct.define({combine:n=>n.length?n[0]:4});Ut.lineSeparator=zw;Ut.readOnly=qw;Ut.phrases=ct.define({compare(n,e){let t=Object.keys(n),r=Object.keys(e);return t.length==r.length&&t.every(a=>n[a]==e[a])}});Ut.languageData=Bw;Ut.changeFilter=Iw;Ut.transactionFilter=Pw;Ut.transactionExtender=Hw;Md.reconfigure=on.define();function Q0(n,e,t={}){let r={};for(let a of n)for(let s of Object.keys(a)){let o=a[s],c=r[s];if(c===void 0)r[s]=o;else if(!(c===o||o===void 0))if(Object.hasOwnProperty.call(t,s))r[s]=t[s](c,o);else throw new Error("Config merge conflict for field "+s)}for(let a in e)r[a]===void 0&&(r[a]=e[a]);return r}class Cs{eq(e){return this==e}range(e,t=e){return Gg.create(e,t,this)}}Cs.prototype.startSide=Cs.prototype.endSide=0;Cs.prototype.point=!1;Cs.prototype.mapMode=Kr.TrackDel;function X0(n,e){return n==e||n.constructor==e.constructor&&n.eq(e)}let Gg=class Fw{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new Fw(e,t,r)}};function Yg(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class W0{constructor(e,t,r,a){this.from=e,this.to=t,this.value=r,this.maxPoint=a}get length(){return this.to[this.to.length-1]}findIndex(e,t,r,a=0){let s=r?this.to:this.from;for(let o=a,c=s.length;;){if(o==c)return o;let h=o+c>>1,d=s[h]-e||(r?this.value[h].endSide:this.value[h].startSide)-t;if(h==o)return d>=0?o:c;d>=0?c=h:o=h+1}}between(e,t,r,a){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(r,1e9,!1,s);s<o;s++)if(a(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let r=[],a=[],s=[],o=-1,c=-1;for(let h=0;h<this.value.length;h++){let d=this.value[h],p=this.from[h]+e,g=this.to[h]+e,k,w;if(p==g){let A=t.mapPos(p,d.startSide,d.mapMode);if(A==null||(k=w=A,d.startSide!=d.endSide&&(w=t.mapPos(p,d.endSide),w<k)))continue}else if(k=t.mapPos(p,d.startSide),w=t.mapPos(g,d.endSide),k>w||k==w&&d.startSide>0&&d.endSide<=0)continue;(w-k||d.endSide-d.startSide)<0||(o<0&&(o=k),d.point&&(c=Math.max(c,w-k)),r.push(d),a.push(k-o),s.push(w-o))}return{mapped:r.length?new W0(a,s,r,c):null,pos:o}}}class Gt{constructor(e,t,r,a){this.chunkPos=e,this.chunk=t,this.nextLayer=r,this.maxPoint=a}static create(e,t,r,a){return new Gt(e,t,r,a)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:r=!1,filterFrom:a=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(r&&(t=t.slice().sort(Yg)),this.isEmpty)return t.length?Gt.of(t):this;let c=new Kw(this,null,-1).goto(0),h=0,d=[],p=new qo;for(;c.value||h<t.length;)if(h<t.length&&(c.from-t[h].from||c.startSide-t[h].value.startSide)>=0){let g=t[h++];p.addInner(g.from,g.to,g.value)||d.push(g)}else c.rangeIndex==1&&c.chunkIndex<this.chunk.length&&(h==t.length||this.chunkEnd(c.chunkIndex)<t[h].from)&&(!o||a>this.chunkEnd(c.chunkIndex)||s<this.chunkPos[c.chunkIndex])&&p.addChunk(this.chunkPos[c.chunkIndex],this.chunk[c.chunkIndex])?c.nextChunk():((!o||a>c.to||s<c.from||o(c.from,c.to,c.value))&&(p.addInner(c.from,c.to,c.value)||d.push(Gg.create(c.from,c.to,c.value))),c.next());return p.finishInner(this.nextLayer.isEmpty&&!d.length?Gt.empty:this.nextLayer.update({add:d,filter:o,filterFrom:a,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],r=[],a=-1;for(let o=0;o<this.chunk.length;o++){let c=this.chunkPos[o],h=this.chunk[o],d=e.touchesRange(c,c+h.length);if(d===!1)a=Math.max(a,h.maxPoint),t.push(h),r.push(e.mapPos(c));else if(d===!0){let{mapped:p,pos:g}=h.map(c,e);p&&(a=Math.max(a,p.maxPoint),t.push(p),r.push(g))}}let s=this.nextLayer.map(e);return t.length==0?s:new Gt(r,t,s||Gt.empty,a)}between(e,t,r){if(!this.isEmpty){for(let a=0;a<this.chunk.length;a++){let s=this.chunkPos[a],o=this.chunk[a];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,r)===!1)return}this.nextLayer.between(e,t,r)}}iter(e=0){return Bc.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Bc.from(e).goto(t)}static compare(e,t,r,a,s=-1){let o=e.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=s),c=t.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=s),h=s1(o,c,r),d=new sc(o,h,s),p=new sc(c,h,s);r.iterGaps((g,k,w)=>o1(d,g,p,k,w,a)),r.empty&&r.length==0&&o1(d,0,p,0,0,a)}static eq(e,t,r=0,a){a==null&&(a=999999999);let s=e.filter(p=>!p.isEmpty&&t.indexOf(p)<0),o=t.filter(p=>!p.isEmpty&&e.indexOf(p)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let c=s1(s,o),h=new sc(s,c,0).goto(r),d=new sc(o,c,0).goto(r);for(;;){if(h.to!=d.to||!$g(h.active,d.active)||h.point&&(!d.point||!X0(h.point,d.point)))return!1;if(h.to>a)return!0;h.next(),d.next()}}static spans(e,t,r,a,s=-1){let o=new sc(e,null,s).goto(t),c=t,h=o.openStart;for(;;){let d=Math.min(o.to,r);if(o.point){let p=o.activeForPoint(o.to),g=o.pointFrom<t?p.length+1:o.point.startSide<0?p.length:Math.min(p.length,h);a.point(c,d,o.point,p,g,o.pointRank),h=Math.min(o.openEnd(d),p.length)}else d>c&&(a.span(c,d,o.active,h),h=o.openEnd(d));if(o.to>r)return h+(o.point&&o.to>r?1:0);c=o.to,o.next()}}static of(e,t=!1){let r=new qo;for(let a of e instanceof Gg?[e]:t?pE(e):e)r.add(a.from,a.to,a.value);return r.finish()}static join(e){if(!e.length)return Gt.empty;let t=e[e.length-1];for(let r=e.length-2;r>=0;r--)for(let a=e[r];a!=Gt.empty;a=a.nextLayer)t=new Gt(a.chunkPos,a.chunk,t,Math.max(a.maxPoint,t.maxPoint));return t}}Gt.empty=new Gt([],[],null,-1);function pE(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let r=n[t];if(Yg(e,r)>0)return n.slice().sort(Yg);e=r}return n}Gt.empty.nextLayer=Gt.empty;class qo{finishChunk(e){this.chunks.push(new W0(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new qo)).add(e,t,r)}addInner(e,t,r){let a=e-this.lastTo||r.startSide-this.last.endSide;if(a<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return a<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(Gt.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=Gt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function s1(n,e,t){let r=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&r.set(s.chunk[o],s.chunkPos[o]);let a=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let c=r.get(s.chunk[o]);c!=null&&(t?t.mapPos(c):c)==s.chunkPos[o]&&!t?.touchesRange(c,c+s.chunk[o].length)&&a.add(s.chunk[o])}return a}class Kw{constructor(e,t,r,a=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=a}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){let a=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(a)||this.layer.chunkEnd(this.chunkIndex)<e||a.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let a=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!r||this.rangeIndex<a)&&this.setRangeIndex(a)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],r=e+t.from[this.rangeIndex];if(this.from=r,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Bc{constructor(e){this.heap=e}static from(e,t=null,r=-1){let a=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&a.push(new Kw(o,t,r,s));return a.length==1?a[0]:new Bc(a)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let r of this.heap)r.goto(e,t);for(let r=this.heap.length>>1;r>=0;r--)Ym(this.heap,r);return this.next(),this}forward(e,t){for(let r of this.heap)r.forward(e,t);for(let r=this.heap.length>>1;r>=0;r--)Ym(this.heap,r);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Ym(this.heap,0)}}}function Ym(n,e){for(let t=n[e];;){let r=(e<<1)+1;if(r>=n.length)break;let a=n[r];if(r+1<n.length&&a.compare(n[r+1])>=0&&(a=n[r+1],r++),t.compare(a)<0)break;n[r]=t,n[e]=a,e=r}}class sc{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Bc.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){vf(this.active,e),vf(this.activeTo,e),vf(this.activeRank,e),this.minActive=u1(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:a,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||a-this.activeTo[t])>0;)t++;bf(this.active,t,r),bf(this.activeTo,t,a),bf(this.activeRank,t,s),e&&bf(e,t,this.cursor.from),this.minActive=u1(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let a=this.minActive;if(a>-1&&(this.activeTo[a]-this.cursor.from||this.active[a].endSide-this.cursor.startSide)<0){if(this.activeTo[a]>e){this.to=this.activeTo[a],this.endSide=this.active[a].endSide;break}this.removeActive(a),r&&vf(r,a)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(r),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let a=r.length-1;a>=0&&r[a]<e;a--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&t.push(this.active[r]);return t.reverse()}openEnd(e){let t=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)t++;return t}}function o1(n,e,t,r,a,s){n.goto(e),t.goto(r);let o=r+a,c=r,h=r-e,d=!!s.boundChange;for(let p=!1;;){let g=n.to+h-t.to,k=g||n.endSide-t.endSide,w=k<0?n.to+h:t.to,A=Math.min(w,o);if(n.point||t.point?(n.point&&t.point&&X0(n.point,t.point)&&$g(n.activeForPoint(n.to),t.activeForPoint(t.to))||s.comparePoint(c,A,n.point,t.point),p=!1):(p&&s.boundChange(c),A>c&&!$g(n.active,t.active)&&s.compareRange(c,A,n.active,t.active),d&&A<o&&(g||n.openEnd(w)!=t.openEnd(w))&&(p=!0)),w>o)break;c=w,k<=0&&n.next(),k>=0&&t.next()}}function $g(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!X0(n[t],e[t]))return!1;return!0}function vf(n,e){for(let t=e,r=n.length-1;t<r;t++)n[t]=n[t+1];n.pop()}function bf(n,e,t){for(let r=n.length-1;r>=e;r--)n[r+1]=n[r];n[e]=t}function u1(n,e){let t=-1,r=1e9;for(let a=0;a<e.length;a++)(e[a]-r||n[a].endSide-n[t].endSide)<0&&(t=a,r=e[a]);return t}function jd(n,e,t=n.length){let r=0;for(let a=0;a<t&&a<n.length;)n.charCodeAt(a)==9?(r+=e-r%e,a++):(r++,a=Un(n,a));return r}function mE(n,e,t,r){for(let a=0,s=0;;){if(s>=e)return a;if(a==n.length)break;s+=n.charCodeAt(a)==9?t-s%t:1,a=Un(n,a)}return n.length}const Qg="",c1=typeof Symbol>"u"?"__"+Qg:Symbol.for(Qg),Xg=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),h1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Dl{constructor(e,t){this.rules=[];let{finish:r}=t||{};function a(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,c,h,d){let p=[],g=/^@(\w+)\b/.exec(o[0]),k=g&&g[1]=="keyframes";if(g&&c==null)return h.push(o[0]+";");for(let w in c){let A=c[w];if(/&/.test(w))s(w.split(/,\s*/).map(E=>o.map(j=>E.replace(/&/,j))).reduce((E,j)=>E.concat(j)),A,h);else if(A&&typeof A=="object"){if(!g)throw new RangeError("The value of a property ("+w+") should be a primitive value.");s(a(w),A,p,k)}else A!=null&&p.push(w.replace(/_.*/,"").replace(/[A-Z]/g,E=>"-"+E.toLowerCase())+": "+A+";")}(p.length||k)&&h.push((r&&!g&&!d?o.map(r):o).join(", ")+" {"+p.join(" ")+"}")}for(let o in e)s(a(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=h1[c1]||1;return h1[c1]=e+1,Qg+e.toString(36)}static mount(e,t,r){let a=e[Xg],s=r&&r.nonce;a?s&&a.setNonce(s):a=new gE(e,s),a.mount(Array.isArray(t)?t:[t],e)}}let f1=new Map;class gE{constructor(e,t){let r=e.ownerDocument||e,a=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&a.CSSStyleSheet){let s=f1.get(r);if(s)return e[Xg]=s;this.sheet=new a.CSSStyleSheet,f1.set(r,this)}else this.styleTag=r.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[Xg]=this}mount(e,t){let r=this.sheet,a=0,s=0;for(let o=0;o<e.length;o++){let c=e[o],h=this.modules.indexOf(c);if(h<s&&h>-1&&(this.modules.splice(h,1),s--,h=-1),h==-1){if(this.modules.splice(s++,0,c),r)for(let d=0;d<c.rules.length;d++)r.insertRule(c.rules[d],a++)}else{for(;s<h;)a+=this.modules[s++].rules.length;a+=c.rules.length,s++}}if(r)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let h=0;h<this.modules.length;h++)o+=this.modules[h].getRules()+`
`;this.styleTag.textContent=o;let c=t.head||t;this.styleTag.parentNode!=c&&c.insertBefore(this.styleTag,c.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Ol={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},zc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},yE=typeof navigator<"u"&&/Mac/.test(navigator.platform),xE=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ar=0;ar<10;ar++)Ol[48+ar]=Ol[96+ar]=String(ar);for(var ar=1;ar<=24;ar++)Ol[ar+111]="F"+ar;for(var ar=65;ar<=90;ar++)Ol[ar]=String.fromCharCode(ar+32),zc[ar]=String.fromCharCode(ar);for(var $m in Ol)zc.hasOwnProperty($m)||(zc[$m]=Ol[$m]);function vE(n){var e=yE&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||xE&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?zc:Ol)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function ai(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=t[r];typeof a=="string"?n.setAttribute(r,a):a!=null&&(n[r]=a)}e++}for(;e<arguments.length;e++)Gw(n,arguments[e]);return n}function Gw(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)Gw(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}let vr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Wg=typeof document<"u"?document:{documentElement:{style:{}}};const Zg=/Edge\/(\d+)/.exec(vr.userAgent),Yw=/MSIE \d/.test(vr.userAgent),Jg=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(vr.userAgent),_d=!!(Yw||Jg||Zg),d1=!_d&&/gecko\/(\d+)/i.test(vr.userAgent),Qm=!_d&&/Chrome\/(\d+)/.exec(vr.userAgent),bE="webkitFontSmoothing"in Wg.documentElement.style,e0=!_d&&/Apple Computer/.test(vr.vendor),p1=e0&&(/Mobile\/\w+/.test(vr.userAgent)||vr.maxTouchPoints>2);var Je={mac:p1||/Mac/.test(vr.platform),windows:/Win/.test(vr.platform),linux:/Linux|X11/.test(vr.platform),ie:_d,ie_version:Yw?Wg.documentMode||6:Jg?+Jg[1]:Zg?+Zg[1]:0,gecko:d1,gecko_version:d1?+(/Firefox\/(\d+)/.exec(vr.userAgent)||[0,0])[1]:0,chrome:!!Qm,chrome_version:Qm?+Qm[1]:0,ios:p1,android:/Android\b/.test(vr.userAgent),webkit_version:bE?+(/\bAppleWebKit\/(\d+)/.exec(vr.userAgent)||[0,0])[1]:0,safari:e0,safari_version:e0?+(/\bVersion\/(\d+(\.\d+)?)/.exec(vr.userAgent)||[0,0])[1]:0,tabSize:Wg.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function Z0(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const nd=Object.create(null);function J0(n,e,t){if(n==e)return!0;n||(n=nd),e||(e=nd);let r=Object.keys(n),a=Object.keys(e);if(r.length-0!=a.length-0)return!1;for(let s of r)if(s!=t&&(a.indexOf(s)==-1||n[s]!==e[s]))return!1;return!0}function kE(n,e){for(let t=n.attributes.length-1;t>=0;t--){let r=n.attributes[t].name;e[r]==null&&n.removeAttribute(r)}for(let t in e){let r=e[t];t=="style"?n.style.cssText=r:n.getAttribute(t)!=r&&n.setAttribute(t,r)}}function m1(n,e,t){let r=!1;if(e)for(let a in e)t&&a in t||(r=!0,a=="style"?n.style.cssText="":n.removeAttribute(a));if(t)for(let a in t)e&&e[a]==t[a]||(r=!0,a=="style"?n.style.cssText=t[a]:n.setAttribute(a,t[a]));return r}function wE(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let r=n.attributes[t];e[r.name]=r.value}return e}class Dd{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var kr=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(kr||(kr={}));class pn extends Cs{constructor(e,t,r,a){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=a}get heightRelevant(){return!1}static mark(e){return new $c(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new As(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,a;if(e.isBlockGap)r=-5e8,a=4e8;else{let{start:s,end:o}=$w(e,t);r=(s?t?-3e8:-1:5e8)-1,a=(o?t?2e8:1:-6e8)+1}return new As(e,r,a,t,e.widget||null,!0)}static line(e){return new Qc(e)}static set(e,t=!1){return Gt.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}pn.none=Gt.empty;class $c extends pn{constructor(e){let{start:t,end:r}=$w(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?Z0(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||nd}eq(e){return this==e||e instanceof $c&&this.tagName==e.tagName&&J0(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}$c.prototype.point=!1;class Qc extends pn{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Qc&&this.spec.class==e.spec.class&&J0(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Qc.prototype.mapMode=Kr.TrackBefore;Qc.prototype.point=!0;class As extends pn{constructor(e,t,r,a,s,o){super(t,r,s,e),this.block=a,this.isReplace=o,this.mapMode=a?t<=0?Kr.TrackBefore:Kr.TrackAfter:Kr.TrackDel}get type(){return this.startSide!=this.endSide?kr.WidgetRange:this.startSide<=0?kr.WidgetBefore:kr.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof As&&SE(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}As.prototype.point=!0;function $w(n,e=!1){let{inclusiveStart:t,inclusiveEnd:r}=n;return t==null&&(t=n.inclusive),r==null&&(r=n.inclusive),{start:t??e,end:r??e}}function SE(n,e){return n==e||!!(n&&e&&n.compare(e))}function Ro(n,e,t,r=0){let a=t.length-1;a>=0&&t[a]+r>=n?t[a]=Math.max(t[a],e):t.push(n,e)}class Ic extends Cs{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof Ic&&this.tagName==e.tagName&&J0(this.attributes,e.attributes)}static create(e){return new Ic(e.tagName,e.attributes||nd)}static set(e,t=!1){return Gt.of(e,t)}}Ic.prototype.startSide=Ic.prototype.endSide=-1;function Uo(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function t0(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function Sc(n,e){if(!e.anchorNode)return!1;try{return t0(n,e.anchorNode)}catch{return!1}}function Kf(n){return n.nodeType==3?Pc(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function Cc(n,e,t,r){return t?g1(n,e,t,r,-1)||g1(n,e,t,r,1):!1}function Rl(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function rd(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function g1(n,e,t,r,a){for(;;){if(n==t&&e==r)return!0;if(e==(a<0?0:Ia(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=Rl(n)+(a<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(a<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=a<0?Ia(n):0}else return!1}}function Ia(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function id(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function CE(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function Qw(n,e){let t=e.width/n.offsetWidth,r=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.height-n.offsetHeight)<1)&&(r=1),{scaleX:t,scaleY:r}}function AE(n,e,t,r,a,s,o,c){let h=n.ownerDocument,d=h.defaultView||window;for(let p=n,g=!1;p&&!g;)if(p.nodeType==1){let k,w=p==h.body,A=1,E=1;if(w)k=CE(d);else{if(/^(fixed|sticky)$/.test(getComputedStyle(p).position)&&(g=!0),p.scrollHeight<=p.clientHeight&&p.scrollWidth<=p.clientWidth){p=p.assignedSlot||p.parentNode;continue}let U=p.getBoundingClientRect();({scaleX:A,scaleY:E}=Qw(p,U)),k={left:U.left,right:U.left+p.clientWidth*A,top:U.top,bottom:U.top+p.clientHeight*E}}let j=0,D=0;if(a=="nearest")e.top<k.top?(D=e.top-(k.top+o),t>0&&e.bottom>k.bottom+D&&(D=e.bottom-k.bottom+o)):e.bottom>k.bottom&&(D=e.bottom-k.bottom+o,t<0&&e.top-D<k.top&&(D=e.top-(k.top+o)));else{let U=e.bottom-e.top,O=k.bottom-k.top;D=(a=="center"&&U<=O?e.top+U/2-O/2:a=="start"||a=="center"&&t<0?e.top-o:e.bottom-O+o)-k.top}if(r=="nearest"?e.left<k.left?(j=e.left-(k.left+s),t>0&&e.right>k.right+j&&(j=e.right-k.right+s)):e.right>k.right&&(j=e.right-k.right+s,t<0&&e.left<k.left+j&&(j=e.left-(k.left+s))):j=(r=="center"?e.left+(e.right-e.left)/2-(k.right-k.left)/2:r=="start"==c?e.left-s:e.right-(k.right-k.left)+s)-k.left,j||D)if(w)d.scrollBy(j,D);else{let U=0,O=0;if(D){let J=p.scrollTop;p.scrollTop+=D/E,O=(p.scrollTop-J)*E}if(j){let J=p.scrollLeft;p.scrollLeft+=j/A,U=(p.scrollLeft-J)*A}e={left:e.left-U,top:e.top-O,right:e.right-U,bottom:e.bottom-O},U&&Math.abs(U-j)<1&&(r="nearest"),O&&Math.abs(O-D)<1&&(a="nearest")}if(w)break;(e.top<k.top||e.bottom>k.bottom||e.left<k.left||e.right>k.right)&&(e={left:Math.max(e.left,k.left),right:Math.min(e.right,k.right),top:Math.max(e.top,k.top),bottom:Math.min(e.bottom,k.bottom)}),p=p.assignedSlot||p.parentNode}else if(p.nodeType==11)p=p.host;else break}function TE(n){let e=n.ownerDocument,t,r;for(let a=n.parentNode;a&&!(a==e.body||t&&r);)if(a.nodeType==1)!r&&a.scrollHeight>a.clientHeight&&(r=a),!t&&a.scrollWidth>a.clientWidth&&(t=a),a=a.assignedSlot||a.parentNode;else if(a.nodeType==11)a=a.host;else break;return{x:t,y:r}}class NE{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?Ia(t):0),r,Math.min(e.focusOffset,r?Ia(r):0))}set(e,t,r,a){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=a}}let xs=null;Je.safari&&Je.safari_version>=26&&(xs=!1);function Xw(n){if(n.setActive)return n.setActive();if(xs)return n.focus(xs);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(xs==null?{get preventScroll(){return xs={preventScroll:!0},!0}}:void 0),!xs){xs=!1;for(let t=0;t<e.length;){let r=e[t++],a=e[t++],s=e[t++];r.scrollTop!=a&&(r.scrollTop=a),r.scrollLeft!=s&&(r.scrollLeft=s)}}}let y1;function Pc(n,e,t=e){let r=y1||(y1=document.createRange());return r.setEnd(n,t),r.setStart(n,e),r}function Lo(n,e,t,r){let a={key:e,code:e,keyCode:t,which:t,cancelable:!0};r&&({altKey:a.altKey,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,metaKey:a.metaKey}=r);let s=new KeyboardEvent("keydown",a);s.synthetic=!0,n.dispatchEvent(s);let o=new KeyboardEvent("keyup",a);return o.synthetic=!0,n.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function EE(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function ME(n,e){let t=e.focusNode,r=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=r)return!1;for(r=Math.min(r,Ia(t));;)if(r){if(t.nodeType!=1)return!1;let a=t.childNodes[r-1];a.contentEditable=="false"?r--:(t=a,r=Ia(t))}else{if(t==n)return!0;r=Rl(t),t=t.parentNode}}function Ww(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function Zw(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r>0)return{node:t,offset:r};if(t.nodeType==1&&r>0){if(t.contentEditable=="false")return null;t=t.childNodes[r-1],r=Ia(t)}else if(t.parentNode&&!rd(t))r=Rl(t),t=t.parentNode;else return null}}function Jw(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r<t.nodeValue.length)return{node:t,offset:r};if(t.nodeType==1&&r<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[r],r=0}else if(t.parentNode&&!rd(t))r=Rl(t)+1,t=t.parentNode;else return null}}class Si{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new Si(e.parentNode,Rl(e),t)}static after(e,t){return new Si(e.parentNode,Rl(e)+1,t)}}var xn=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(xn||(xn={}));const Ts=xn.LTR,ey=xn.RTL;function eS(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const jE=eS("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),_E=eS("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),n0=Object.create(null),Fi=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);n0[e]=t,n0[t]=-e}function tS(n){return n<=247?jE[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?_E[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const DE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Oa{get dir(){return this.level%2?ey:Ts}constructor(e,t,r){this.from=e,this.to=t,this.level=r}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,r,a){let s=-1;for(let o=0;o<e.length;o++){let c=e[o];if(c.from<=t&&c.to>=t){if(c.level==r)return o;(s<0||(a!=0?a<0?c.from<t:c.to>t:e[s].level>c.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function nS(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let r=n[t],a=e[t];if(r.from!=a.from||r.to!=a.to||r.direction!=a.direction||!nS(r.inner,a.inner))return!1}return!0}const nn=[];function OE(n,e,t,r,a){for(let s=0;s<=r.length;s++){let o=s?r[s-1].to:e,c=s<r.length?r[s].from:t,h=s?256:a;for(let d=o,p=h,g=h;d<c;d++){let k=tS(n.charCodeAt(d));k==512?k=p:k==8&&g==4&&(k=16),nn[d]=k==4?2:k,k&7&&(g=k),p=k}for(let d=o,p=h,g=h;d<c;d++){let k=nn[d];if(k==128)d<c-1&&p==nn[d+1]&&p&24?k=nn[d]=p:nn[d]=256;else if(k==64){let w=d+1;for(;w<c&&nn[w]==64;)w++;let A=d&&p==8||w<t&&nn[w]==8?g==1?1:8:256;for(let E=d;E<w;E++)nn[E]=A;d=w-1}else k==8&&g==1&&(nn[d]=1);p=k,k&7&&(g=k)}}}function RE(n,e,t,r,a){let s=a==1?2:1;for(let o=0,c=0,h=0;o<=r.length;o++){let d=o?r[o-1].to:e,p=o<r.length?r[o].from:t;for(let g=d,k,w,A;g<p;g++)if(w=n0[k=n.charCodeAt(g)])if(w<0){for(let E=c-3;E>=0;E-=3)if(Fi[E+1]==-w){let j=Fi[E+2],D=j&2?a:j&4?j&1?s:a:0;D&&(nn[g]=nn[Fi[E]]=D),c=E;break}}else{if(Fi.length==189)break;Fi[c++]=g,Fi[c++]=k,Fi[c++]=h}else if((A=nn[g])==2||A==1){let E=A==a;h=E?0:1;for(let j=c-3;j>=0;j-=3){let D=Fi[j+2];if(D&2)break;if(E)Fi[j+2]|=2;else{if(D&4)break;Fi[j+2]|=4}}}}}function LE(n,e,t,r){for(let a=0,s=r;a<=t.length;a++){let o=a?t[a-1].to:n,c=a<t.length?t[a].from:e;for(let h=o;h<c;){let d=nn[h];if(d==256){let p=h+1;for(;;)if(p==c){if(a==t.length)break;p=t[a++].to,c=a<t.length?t[a].from:e}else if(nn[p]==256)p++;else break;let g=s==1,k=(p<e?nn[p]:r)==1,w=g==k?g?1:2:r;for(let A=p,E=a,j=E?t[E-1].to:n;A>h;)A==j&&(A=t[--E].from,j=E?t[E-1].to:n),nn[--A]=w;h=p}else s=d,h++}}}function r0(n,e,t,r,a,s,o){let c=r%2?2:1;if(r%2==a%2)for(let h=e,d=0;h<t;){let p=!0,g=!1;if(d==s.length||h<s[d].from){let E=nn[h];E!=c&&(p=!1,g=E==16)}let k=!p&&c==1?[]:null,w=p?r:r+1,A=h;e:for(;;)if(d<s.length&&A==s[d].from){if(g)break e;let E=s[d];if(!p)for(let j=E.to,D=d+1;;){if(j==t)break e;if(D<s.length&&s[D].from==j)j=s[D++].to;else{if(nn[j]==c)break e;break}}if(d++,k)k.push(E);else{E.from>h&&o.push(new Oa(h,E.from,w));let j=E.direction==Ts!=!(w%2);i0(n,j?r+1:r,a,E.inner,E.from,E.to,o),h=E.to}A=E.to}else{if(A==t||(p?nn[A]!=c:nn[A]==c))break;A++}k?r0(n,h,A,r+1,a,k,o):h<A&&o.push(new Oa(h,A,w)),h=A}else for(let h=t,d=s.length;h>e;){let p=!0,g=!1;if(!d||h>s[d-1].to){let E=nn[h-1];E!=c&&(p=!1,g=E==16)}let k=!p&&c==1?[]:null,w=p?r:r+1,A=h;e:for(;;)if(d&&A==s[d-1].to){if(g)break e;let E=s[--d];if(!p)for(let j=E.from,D=d;;){if(j==e)break e;if(D&&s[D-1].to==j)j=s[--D].from;else{if(nn[j-1]==c)break e;break}}if(k)k.push(E);else{E.to<h&&o.push(new Oa(E.to,h,w));let j=E.direction==Ts!=!(w%2);i0(n,j?r+1:r,a,E.inner,E.from,E.to,o),h=E.from}A=E.from}else{if(A==e||(p?nn[A-1]!=c:nn[A-1]==c))break;A--}k?r0(n,A,h,r+1,a,k,o):A<h&&o.push(new Oa(A,h,w)),h=A}}function i0(n,e,t,r,a,s,o){let c=e%2?2:1;OE(n,a,s,r,c),RE(n,a,s,r,c),LE(a,s,r,c),r0(n,a,s,e,t,r,o)}function BE(n,e,t){if(!n)return[new Oa(0,0,e==ey?1:0)];if(e==Ts&&!t.length&&!DE.test(n))return rS(n.length);if(t.length)for(;n.length>nn.length;)nn[nn.length]=256;let r=[],a=e==Ts?0:1;return i0(n,a,a,t,0,n.length,r),r}function rS(n){return[new Oa(0,n,0)]}let iS="";function zE(n,e,t,r,a){var s;let o=r.head-n.from,c=Oa.find(e,o,(s=r.bidiLevel)!==null&&s!==void 0?s:-1,r.assoc),h=e[c],d=h.side(a,t);if(o==d){let k=c+=a?1:-1;if(k<0||k>=e.length)return null;h=e[c=k],o=h.side(!a,t),d=h.side(a,t)}let p=Un(n.text,o,h.forward(a,t));(p<h.from||p>h.to)&&(p=d),iS=n.text.slice(Math.min(o,p),Math.max(o,p));let g=c==(a?e.length-1:0)?null:e[c+(a?1:-1)];return g&&p==d&&g.level+(a?0:1)<h.level?Le.cursor(g.side(!a,t)+n.from,g.forward(a,t)?1:-1,g.level):Le.cursor(p+n.from,h.forward(a,t)?-1:1,h.level)}function IE(n,e,t){for(let r=e;r<t;r++){let a=tS(n.charCodeAt(r));if(a==1)return Ts;if(a==2||a==4)return ey}return Ts}const aS=ct.define(),lS=ct.define(),sS=ct.define(),oS=ct.define(),a0=ct.define(),uS=ct.define(),cS=ct.define(),ty=ct.define(),ny=ct.define(),hS=ct.define({combine:n=>n.some(e=>e)}),fS=ct.define({combine:n=>n.some(e=>e)}),dS=ct.define();class Bo{constructor(e,t="nearest",r="nearest",a=5,s=5,o=!1){this.range=e,this.y=t,this.x=r,this.yMargin=a,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new Bo(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Bo(Le.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const kf=on.define({map:(n,e)=>n.map(e)}),pS=on.define();function Zi(n,e,t){let r=n.facet(oS);r.length?r[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const Da=ct.define({combine:n=>n.length?n[0]:!0});let PE=0;const Mo=ct.define({combine(n){return n.filter((e,t)=>{for(let r=0;r<t;r++)if(n[r].plugin==e.plugin)return!1;return!0})}});class hi{constructor(e,t,r,a,s){this.id=e,this.create=t,this.domEventHandlers=r,this.domEventObservers=a,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(Mo.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Mo.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:r,eventObservers:a,provide:s,decorations:o}=t||{};return new hi(PE++,e,r,a,c=>{let h=[];return o&&h.push(Od.of(d=>{let p=d.plugin(c);return p?o(p):pn.none})),s&&h.push(s(c)),h})}static fromClass(e,t){return hi.define((r,a)=>new e(r,a),t)}}class Xm{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(r){if(Zi(t.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){Zi(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(r){Zi(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const mS=ct.define(),ry=ct.define(),Od=ct.define(),gS=ct.define(),iy=ct.define(),Xc=ct.define(),yS=ct.define();function x1(n,e){let t=n.state.facet(yS);if(!t.length)return t;let r=t.map(s=>s instanceof Function?s(n):s),a=[];return Gt.spans(r,e.from,e.to,{point(){},span(s,o,c,h){let d=s-e.from,p=o-e.from,g=a;for(let k=c.length-1;k>=0;k--,h--){let w=c[k].spec.bidiIsolate,A;if(w==null&&(w=IE(e.text,d,p)),h>0&&g.length&&(A=g[g.length-1]).to==d&&A.direction==w)A.to=p,g=A.inner;else{let E={from:d,to:p,direction:w,inner:[]};g.push(E),g=E.inner}}}}),a}const xS=ct.define();function vS(n){let e=0,t=0,r=0,a=0;for(let s of n.state.facet(xS)){let o=s(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(r=Math.max(r,o.top)),o.bottom!=null&&(a=Math.max(a,o.bottom)))}return{left:e,right:t,top:r,bottom:a}}const mc=ct.define();class oi{constructor(e,t,r,a){this.fromA=e,this.toA=t,this.fromB=r,this.toB=a}join(e){return new oi(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let a=e[t-1];if(!(a.fromA>r.toA)){if(a.toA<r.fromA)break;r=r.join(a),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(t.length==0)return e;let r=[];for(let a=0,s=0,o=0;;){let c=a<e.length?e[a].fromB:1e9,h=s<t.length?t[s]:1e9,d=Math.min(c,h);if(d==1e9)break;let p=d+o,g=d,k=p;for(;;)if(s<t.length&&t[s]<=g){let w=t[s+1];s+=2,g=Math.max(g,w);for(let A=a;A<e.length&&e[A].fromB<=g;A++)o=e[A].toA-e[A].toB;k=Math.max(k,w+o)}else if(a<e.length&&e[a].fromB<=g){let w=e[a++];g=Math.max(g,w.toB),k=Math.max(k,w.toA),o=w.toA-w.toB}else break;r.push(new oi(p,k,d,g))}return r}}class ad{constructor(e,t,r){this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=qn.empty(this.startState.doc.length);for(let s of r)this.changes=this.changes.compose(s.changes);let a=[];this.changes.iterChangedRanges((s,o,c,h)=>a.push(new oi(s,o,c,h))),this.changedRanges=a}static create(e,t,r){return new ad(e,t,r)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const HE=[];class In{constructor(e,t,r=0){this.dom=e,this.length=t,this.flags=r,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return HE}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let t=this.domAttrs;t&&kE(this.dom,t)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,t=this.posAtStart){let r=t;for(let a of this.children){if(a==e)return r;r+=a.length+a.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let r=Rl(this.dom),a=this.length?e>0:t>0;return new Si(this.parent.dom,r+(a?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof Ld)return e;return null}static get(e){return e.cmTile}}class Rd extends In{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let t=this.dom,r=null,a,s=e?.node==t?e:null,o=0;for(let c of this.children){if(c.sync(e),o+=c.length+c.breakAfter,a=r?r.nextSibling:t.firstChild,s&&a!=c.dom&&(s.written=!0),c.dom.parentNode==t)for(;a&&a!=c.dom;)a=v1(a);else t.insertBefore(c.dom,a);r=c.dom}for(a=r?r.nextSibling:t.firstChild,s&&a&&(s.written=!0);a;)a=v1(a);this.length=o}}function v1(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Ld extends Rd{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=In.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],r=this,a=0,s=0;;)if(a==r.children.length){if(!t.length)return;r=r.parent,r.breakAfter&&s++,a=t.pop()}else{let o=r.children[a++];if(o instanceof jl)t.push(a),r=o,a=0;else{let c=s+o.length,h=e(o,s);if(h!==void 0)return h;s=c+o.breakAfter}}}resolveBlock(e,t){let r,a=-1,s,o=-1;if(this.blockTiles((c,h)=>{let d=h+c.length;if(e>=h&&e<=d){if(c.isWidget()&&t>=-1&&t<=1){if(c.flags&32)return!0;c.flags&16&&(r=void 0)}(h<e||e==d&&(t<-1?c.length:c.covers(1)))&&(!r||!c.isWidget()&&r.isWidget())&&(r=c,a=e-h),(d>e||e==h&&(t>1?c.length:c.covers(-1)))&&(!s||!c.isWidget()&&s.isWidget())&&(s=c,o=e-h)}}),!r&&!s)throw new Error("No tile at position "+e);return r&&t<0||!s?{tile:r,offset:a}:{tile:s,offset:o}}}class jl extends Rd{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,t){let r=new jl(t||document.createElement(e.tagName),e);return t||(r.flags|=4),r}}class Vo extends Rd{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,r){let a=new Vo(t||document.createElement("div"),e);return(!t||!r)&&(a.flags|=4),a}get domAttrs(){return this.attrs}resolveInline(e,t,r){let a=null,s=-1,o=null,c=-1;function h(p,g){for(let k=0,w=0;k<p.children.length&&w<=g;k++){let A=p.children[k],E=w+A.length;E>=g&&(A.isComposite()?h(A,g-w):(!o||o.isHidden&&(t>0||r&&UE(o,A)))&&(E>g||A.flags&32)?(o=A,c=g-w):(w<g||A.flags&16&&!A.isHidden)&&(a=A,s=g-w)),w=E}}h(this,e);let d=(t<0?a:o)||a||o;return d?{tile:d,offset:d==a?s:c}:null}coordsIn(e,t){let r=this.resolveInline(e,t,!0);return r?r.tile.coordsIn(Math.max(0,r.offset),t):qE(this)}domIn(e,t){let r=this.resolveInline(e,t);if(r){let{tile:a,offset:s}=r;if(this.dom.contains(a.dom))return a.isText()?new Si(a.dom,Math.min(a.dom.nodeValue.length,s)):a.domPosFor(s,a.flags&16?1:a.flags&32?-1:t);let o=r.tile.parent,c=!1;for(let h of o.children){if(c)return new Si(h.dom,0);h==r.tile&&(c=!0)}}return new Si(this.dom,0)}}function qE(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=Kf(e);return t[t.length-1]||null}function UE(n,e){let t=n.coordsIn(0,1),r=e.coordsIn(0,1);return t&&r&&r.top<t.bottom}class jr extends Rd{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let r=new jr(t||document.createElement(e.tagName),e);return t||(r.flags|=4),r}}class ks extends In{constructor(e,t){super(e,t.length),this.text=t}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let r=this.dom.nodeValue.length;e>r&&(e=r);let a=e,s=e,o=0;e==0&&t<0||e==r&&t>=0?Je.chrome||Je.gecko||(e?(a--,o=1):s<r&&(s++,o=-1)):t<0?a--:s<r&&s++;let c=Pc(this.dom,a,s).getClientRects();if(!c.length)return null;let h=c[(o?o<0:t>=0)?0:c.length-1];return Je.safari&&!o&&h.width==0&&(h=Array.prototype.find.call(c,d=>d.width)||h),o?id(h,o<0):h||null}static of(e,t){let r=new ks(t||document.createTextNode(e),e);return t||(r.flags|=2),r}}class Ns extends In{constructor(e,t,r,a){super(e,t,a),this.widget=r}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,r){let a=this.widget.coordsAt(this.dom,e,t);if(a)return a;if(r)return id(this.dom.getBoundingClientRect(),this.length?e==0:t<=0);{let s=this.dom.getClientRects(),o=null;if(!s.length)return null;let c=this.flags&16?!0:this.flags&32?!1:e>0;for(let h=c?s.length-1:0;o=s[h],!(e>0?h==0:h==s.length-1||o.top<o.bottom);h+=c?-1:1);return id(o,!c)}}get overrideDOMText(){if(!this.length)return It.empty;let{root:e}=this;if(!e)return It.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,r,a,s){return s||(s=e.toDOM(t),e.editable||(s.contentEditable="false")),new Ns(s,r,e,a)}}class ld extends In{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!0}get overrideDOMText(){return It.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class VE{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,r){let{tile:a,index:s,beforeBreak:o,parents:c}=this;for(;e||t>0;)if(a.isComposite())if(o){if(!e)break;r&&r.break(),e--,o=!1}else if(s==a.children.length){if(!e&&!c.length)break;r&&r.leave(a),o=!!a.breakAfter,{tile:a,index:s}=c.pop(),s++}else{let h=a.children[s],d=h.breakAfter;(t>0?h.length<=e:h.length<e)&&(!r||r.skip(h,0,h.length)!==!1||!h.isComposite)?(o=!!d,s++,e-=h.length):(c.push({tile:a,index:s}),a=h,s=0,r&&h.isComposite()&&r.enter(h))}else if(s==a.length)o=!!a.breakAfter,{tile:a,index:s}=c.pop(),s++;else if(e){let h=Math.min(e,a.length-s);r&&r.skip(a,s,s+h),e-=h,s+=h}else break;return this.tile=a,this.index=s,this.beforeBreak=o,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class FE{constructor(e,t,r,a){this.from=e,this.to=t,this.wrapper=r,this.rank=a}}class KE{constructor(e,t,r){this.cache=e,this.root=t,this.blockWrappers=r,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,r,a){var s;this.flushBuffer();let o=this.ensureMarks(t,r),c=o.lastChild;if(c&&c.isText()&&!(c.flags&8)&&c.length+e.length<512){this.cache.reused.set(c,2);let h=o.children[o.children.length-1]=new ks(c.dom,c.text+e);h.parent=o}else o.append(a||ks.of(e,(s=this.cache.find(ks))===null||s===void 0?void 0:s.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let r=this.curLine;r.dom!=t.line.dom&&(r.setDOM(this.cache.reused.has(t.line)?Wm(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let a=r;for(let c=t.marks.length-1;c>=0;c--){let h=t.marks[c],d=a.lastChild;if(d instanceof jr&&d.mark.eq(h.mark))d.dom!=h.dom&&d.setDOM(Wm(h.dom)),a=d;else{if(this.cache.reused.get(h)){let g=In.get(h.dom);g&&g.setDOM(Wm(h.dom))}let p=jr.of(h.mark,h.dom);a.append(p),a=p}this.cache.reused.set(h,2)}let s=In.get(e.text);s&&this.cache.reused.set(s,2);let o=new ks(e.text,e.text.nodeValue);o.flags|=8,a.append(o)}addInlineWidget(e,t,r){let a=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);a||this.flushBuffer();let s=this.ensureMarks(t,r);!a&&!(e.flags&16)&&s.append(this.getBuffer(1)),s.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,r){this.flushBuffer(),this.ensureMarks(t,r).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let t=this.afterWidget||this.lastBlock;t.length+=e,this.pos+=e}addLineStart(e,t){var r;e||(e=bS);let a=Vo.start(e,t||((r=this.cache.find(Vo))===null||r===void 0?void 0:r.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=a)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var r;let a=this.curLine;for(let s=e.length-1;s>=0;s--){let o=e[s],c;if(t>0&&(c=a.lastChild)&&c instanceof jr&&c.mark.eq(o))a=c,t--;else{let h=jr.of(o,(r=this.cache.find(jr,d=>d.mark.eq(o)))===null||r===void 0?void 0:r.dom);a.append(h),a=h,t=0}}return a}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!b1(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(Je.ios&&b1(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(Zm,0,32)||new Ns(Zm.toDOM(),0,Zm,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new FE(e.from,e.to,e.value,e.rank),r=this.wrappers.length;for(;r>0&&(this.wrappers[r-1].rank-t.rank||this.wrappers[r-1].to-t.to)<0;)r--;this.wrappers.splice(r,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let r of this.wrappers){let a=t.lastChild;if(r.from<this.pos&&a instanceof jl&&a.wrapper.eq(r.wrapper))t=a;else{let s=jl.of(r.wrapper,(e=this.cache.find(jl,o=>o.wrapper.eq(r.wrapper)))===null||e===void 0?void 0:e.dom);t.append(s),t=s}}return t}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let t=2|(e<0?16:32),r=this.cache.find(ld,void 0,1);return r&&(r.flags=t),r||new ld(t)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class GE{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:a,lineBreak:s,done:o}=this.cursor.next(this.skipCount);if(this.skipCount=0,o)throw new Error("Ran out of text content when drawing inline views");this.text=a;let c=this.textOff=Math.min(e,a.length);return s?null:a.slice(0,c)}let t=Math.min(this.text.length,this.textOff+e),r=this.text.slice(this.textOff,t);return this.textOff=t,r}}const sd=[Ns,Vo,ks,jr,ld,jl,Ld];for(let n=0;n<sd.length;n++)sd[n].bucket=n;class YE{constructor(e){this.view=e,this.buckets=sd.map(()=>[]),this.index=sd.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,r=this.buckets[t];r.length<6?r.push(e):r[this.index[t]=(this.index[t]+1)%6]=e}find(e,t,r=2){let a=e.bucket,s=this.buckets[a],o=this.index[a];for(let c=s.length-1;c>=0;c--){let h=(c+o)%s.length,d=s[h];if((!t||t(d))&&!this.reused.has(d))return s.splice(h,1),h<o&&this.index[a]--,this.reused.set(d,r),d}return null}findWidget(e,t,r){let a=this.buckets[0];if(a.length)for(let s=0,o=0;;s++){if(s==a.length){if(o)return null;o=1,s=0}let c=a[s];if(!this.reused.has(c)&&(o==0?c.widget.compare(e):c.widget.constructor==e.constructor&&e.updateDOM(c.dom,this.view)))return a.splice(s,1),s<this.index[0]&&this.index[0]--,c.widget==e&&c.length==t&&(c.flags&497)==r?(this.reused.set(c,1),c):(this.reused.set(c,2),new Ns(c.dom,t,e,c.flags&-498|r))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,t=2){if(!this.reused.has(e))return this.reused.set(e,t),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class $E{constructor(e,t,r,a,s){this.view=e,this.decorations=a,this.disallowBlockEffectsFor=s,this.openWidget=!1,this.openMarks=0,this.cache=new YE(e),this.text=new GE(e.state.doc),this.builder=new KE(this.cache,new Ld(e,e.contentDOM),Gt.iter(r)),this.cache.reused.set(t,2),this.old=new VE(t),this.reuseWalker={skip:(o,c,h)=>{if(this.cache.add(o),o.isComposite())return!1},enter:o=>this.cache.add(o),leave:()=>{},break:()=>{}}}run(e,t){let r=t&&this.getCompositionContext(t.text);for(let a=0,s=0,o=0;;){let c=o<e.length?e[o++]:null,h=c?c.fromA:this.old.root.length;if(h>a){let d=h-a;this.preserve(d,!o,!c),a=h,s+=d}if(!c)break;t&&c.fromA<=t.range.fromA&&c.toA>=t.range.toA?(this.forward(c.fromA,t.range.fromA,t.range.fromA<t.range.toA?1:-1),this.emit(s,t.range.fromB),this.cache.clear(),this.builder.addComposition(t,r),this.text.skip(t.range.toB-t.range.fromB),this.forward(t.range.fromA,c.toA),this.emit(t.range.toB,c.toB)):(this.forward(c.fromA,c.toA),this.emit(s,c.toB)),s=c.toB,a=c.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,r){let a=WE(this.old),s=this.openMarks;this.old.advance(e,r?1:-1,{skip:(o,c,h)=>{if(o.isWidget())if(this.openWidget)this.builder.continueWidget(h-c);else{let d=h>0||c<o.length?Ns.of(o.widget,this.view,h-c,o.flags&496,this.cache.maybeReuse(o)):this.cache.reuse(o);d.flags&256?(d.flags&=-2,this.builder.addBlockWidget(d)):(this.builder.ensureLine(null),this.builder.addInlineWidget(d,a,s),s=a.length)}else if(o.isText())this.builder.ensureLine(null),!c&&h==o.length?this.builder.addText(o.text,a,s,this.cache.reuse(o)):(this.cache.add(o),this.builder.addText(o.text.slice(c,h),a,s)),s=a.length;else if(o.isLine())o.flags&=-2,this.cache.reused.set(o,1),this.builder.addLine(o);else if(o instanceof ld)this.cache.add(o);else if(o instanceof jr)this.builder.ensureLine(null),this.builder.addMark(o,a,s),this.cache.reused.set(o,1),s=a.length;else return!1;this.openWidget=!1},enter:o=>{o.isLine()?this.builder.addLineStart(o.attrs,this.cache.maybeReuse(o)):(this.cache.add(o),o instanceof jr&&a.unshift(o.mark)),this.openWidget=!1},leave:o=>{o.isLine()?a.length&&(a.length=s=0):o instanceof jr&&(a.shift(),s=Math.min(s,a.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let r=null,a=this.builder,s=0,o=Gt.spans(this.decorations,e,t,{point:(c,h,d,p,g,k)=>{if(d instanceof As){if(this.disallowBlockEffectsFor[k]){if(d.block)throw new RangeError("Block decorations may not be specified via plugins");if(h>this.view.state.doc.lineAt(c).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(s=p.length,g>p.length)a.continueWidget(h-c);else{let w=d.widget||(d.block?Fo.block:Fo.inline),A=QE(d),E=this.cache.findWidget(w,h-c,A)||Ns.of(w,this.view,h-c,A);d.block?(d.startSide>0&&a.addLineStartIfNotCovered(r),a.addBlockWidget(E)):(a.ensureLine(r),a.addInlineWidget(E,p,g))}r=null}else r=XE(r,d);h>c&&this.text.skip(h-c)},span:(c,h,d,p)=>{for(let g=c;g<h;){let k=this.text.next(Math.min(512,h-g));k==null?(a.addLineStartIfNotCovered(r),a.addBreak(),g++):(a.ensureLine(r),a.addText(k,d,g==c?p:d.length),g+=k.length),r=null}}});a.addLineStartIfNotCovered(r),this.openWidget=o>s,this.openMarks=o}forward(e,t,r=1){t-e<=10?this.old.advance(t-e,r,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(t-e-10,-1),this.old.advance(5,r,this.reuseWalker))}getCompositionContext(e){let t=[],r=null;for(let a=e.parentNode;;a=a.parentNode){let s=In.get(a);if(a==this.view.contentDOM)break;s instanceof jr?t.push(s):s?.isLine()?r=s:a.nodeName=="DIV"&&!r&&a!=this.view.contentDOM?r=new Vo(a,bS):t.push(jr.of(new $c({tagName:a.nodeName.toLowerCase(),attributes:wE(a)}),a))}return{line:r,marks:t}}}function b1(n,e){let t=r=>{for(let a of r.children)if((e?a.isText():a.length)||t(a))return!0;return!1};return t(n)}function QE(n){let e=n.isReplace?(n.startSide<0?64:0)|(n.endSide>0?128:0):n.startSide>0?32:16;return n.block&&(e|=256),e}const bS={class:"cm-line"};function XE(n,e){let t=e.spec.attributes,r=e.spec.class;return!t&&!r||(n||(n={class:"cm-line"}),t&&Z0(t,n),r&&(n.class+=" "+r)),n}function WE(n){let e=[];for(let t=n.parents.length;t>1;t--){let r=t==n.parents.length?n.tile:n.parents[t].tile;r instanceof jr&&e.push(r.mark)}return e}function Wm(n){let e=In.get(n);return e&&e.setDOM(n.cloneNode()),n}class Fo extends Dd{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Fo.inline=new Fo("span");Fo.block=new Fo("div");const Zm=new class extends Dd{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class k1{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=pn.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new Ld(e,e.contentDOM),this.updateInner([new oi(0,0,0,e.state.doc.length)],null)}update(e){var t;let r=e.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:p,toA:g})=>g<this.minWidthFrom||p>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let a=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?a=this.domChanged.newSel.head:!l3(e.changes,this.hasComposition)&&!e.selectionSet&&(a=e.state.selection.main.head));let s=a>-1?JE(this.view,e.changes,a):null;if(this.domChanged=null,this.hasComposition){let{from:p,to:g}=this.hasComposition;r=new oi(p,g,e.changes.mapPos(p,-1),e.changes.mapPos(g,1)).addToSet(r.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Je.ie||Je.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,c=this.blockWrappers;this.updateDeco();let h=n3(o,this.decorations,e.changes);h.length&&(r=oi.extendWithRanges(r,h));let d=i3(c,this.blockWrappers,e.changes);return d.length&&(r=oi.extendWithRanges(r,d)),s&&!r.some(p=>p.fromA<=s.range.fromA&&p.toA>=s.range.toA)&&(r=s.range.addToSet(r.slice())),this.tile.flags&2&&r.length==0?!1:(this.updateInner(r,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:r}=this.view;r.ignore(()=>{if(t||e.length){let o=this.tile,c=new $E(this.view,o,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=c.run(e,t),l0(o,c.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=Je.chrome||Je.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(s),s&&(s.written||r.selectionRange.focusNode!=s.node||!this.tile.dom.contains(s.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let a=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.tile.children)s.isWidget()&&s.widget instanceof Jm&&a.push(s.dom);r.updateGaps(a)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let r of t.effects)r.is(pS)&&(this.editContextFormatting=r.value)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:r}=this.tile,a=this.view.root.activeElement,s=a==r,o=!s&&!(this.view.state.facet(Da)||r.tabIndex>-1)&&Sc(r,this.view.observer.selectionRange)&&!(a&&r.contains(a));if(!(s||t||o))return;let c=this.forceSelection;this.forceSelection=!1;let h=this.view.state.selection.main,d,p;if(h.empty?p=d=this.inlineDOMNearPos(h.anchor,h.assoc||1):(p=this.inlineDOMNearPos(h.head,h.head==h.from?1:-1),d=this.inlineDOMNearPos(h.anchor,h.anchor==h.from?1:-1)),Je.gecko&&h.empty&&!this.hasComposition&&ZE(d)){let k=document.createTextNode("");this.view.observer.ignore(()=>d.node.insertBefore(k,d.node.childNodes[d.offset]||null)),d=p=new Si(k,0),c=!0}let g=this.view.observer.selectionRange;(c||!g.focusNode||(!Cc(d.node,d.offset,g.anchorNode,g.anchorOffset)||!Cc(p.node,p.offset,g.focusNode,g.focusOffset))&&!this.suppressWidgetCursorChange(g,h))&&(this.view.observer.ignore(()=>{Je.android&&Je.chrome&&r.contains(g.focusNode)&&a3(g.focusNode,r)&&(r.blur(),r.focus({preventScroll:!0}));let k=Uo(this.view.root);if(k)if(h.empty){if(Je.gecko){let w=e3(d.node,d.offset);if(w&&w!=3){let A=(w==1?Zw:Jw)(d.node,d.offset);A&&(d=new Si(A.node,A.offset))}}k.collapse(d.node,d.offset),h.bidiLevel!=null&&k.caretBidiLevel!==void 0&&(k.caretBidiLevel=h.bidiLevel)}else if(k.extend){k.collapse(d.node,d.offset);try{k.extend(p.node,p.offset)}catch{}}else{let w=document.createRange();h.anchor>h.head&&([d,p]=[p,d]),w.setEnd(p.node,p.offset),w.setStart(d.node,d.offset),k.removeAllRanges(),k.addRange(w)}o&&this.view.root.activeElement==r&&(r.blur(),a&&a.focus())}),this.view.observer.setSelectionRange(d,p)),this.impreciseAnchor=d.precise?null:new Si(g.anchorNode,g.anchorOffset),this.impreciseHead=p.precise?null:new Si(g.focusNode,g.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&Cc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,r=Uo(e.root),{anchorNode:a,anchorOffset:s}=e.observer.selectionRange;if(!r||!t.empty||!t.assoc||!r.modify)return;let o=this.lineAt(t.head,t.assoc);if(!o)return;let c=o.posAtStart;if(t.head==c||t.head==c+o.length)return;let h=this.coordsAt(t.head,-1),d=this.coordsAt(t.head,1);if(!h||!d||h.bottom>d.top)return;let p=this.domAtPos(t.head+t.assoc,t.assoc);r.collapse(p.node,p.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let g=e.observer.selectionRange;e.docView.posFromDOM(g.anchorNode,g.anchorOffset)!=t.from&&r.collapse(a,s)}posFromDOM(e,t){let r=this.tile.nearest(e);if(!r)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let a=r.posAtStart;if(r.isComposite()){let s;if(e==r.dom)s=r.dom.childNodes[t];else{let o=Ia(e)==0?0:t==0?-1:1;for(;;){let c=e.parentNode;if(c==r.dom)break;o==0&&c.firstChild!=c.lastChild&&(e==c.firstChild?o=-1:o=1),e=c}o<0?s=e:s=e.nextSibling}if(s==r.dom.firstChild)return a;for(;s&&!In.get(s);)s=s.nextSibling;if(!s)return a+r.length;for(let o=0,c=a;;o++){let h=r.children[o];if(h.dom==s)return c;c+=h.length+h.breakAfter}}else return r.isText()?e==r.dom?a+t:a+(t?r.length:0):a}domAtPos(e,t){let{tile:r,offset:a}=this.tile.resolveBlock(e,t);return r.isWidget()?r.domPosFor(e,t):r.domIn(a,t)}inlineDOMNearPos(e,t){let r,a=-1,s=!1,o,c=-1,h=!1;return this.tile.blockTiles((d,p)=>{if(d.isWidget()){if(d.flags&32&&p>=e)return!0;d.flags&16&&(s=!0)}else{let g=p+d.length;if(p<=e&&(r=d,a=e-p,s=g<e),g>=e&&!o&&(o=d,c=e-p,h=p>e),p>e&&o)return!0}}),!r&&!o?this.domAtPos(e,t):(s&&o?r=null:h&&r&&(o=null),r&&t<0||!o?r.domIn(a,t):o.domIn(c,t))}coordsAt(e,t){let{tile:r,offset:a}=this.tile.resolveBlock(e,t);return r.isWidget()?r.widget instanceof Jm?null:r.coordsInWidget(a,t,!0):r.coordsIn(a,t)}lineAt(e,t){let{tile:r}=this.tile.resolveBlock(e,t);return r.isLine()?r:null}coordsForChar(e){let{tile:t,offset:r}=this.tile.resolveBlock(e,1);if(!t.isLine())return null;function a(s,o){if(s.isComposite())for(let c of s.children){if(c.length>=o){let h=a(c,o);if(h)return h}if(o-=c.length,o<0)break}else if(s.isText()&&o<s.length){let c=Un(s.text,o);if(c==o)return null;let h=Pc(s.dom,o,c).getClientRects();for(let d=0;d<h.length;d++){let p=h[d];if(d==h.length-1||p.top<p.bottom&&p.left<p.right)return p}}return null}return a(t,r)}measureVisibleLineHeights(e){let t=[],{from:r,to:a}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,c=-1,h=this.view.textDirection==xn.LTR,d=0,p=(g,k,w)=>{for(let A=0;A<g.children.length&&!(k>a);A++){let E=g.children[A],j=k+E.length,D=E.dom.getBoundingClientRect(),{height:U}=D;if(w&&!A&&(d+=D.top-w.top),E instanceof jl)j>r&&p(E,k,D);else if(k>=r&&(d>0&&t.push(-d),t.push(U+d),d=0,o)){let O=E.dom.lastChild,J=O?Kf(O):[];if(J.length){let ee=J[J.length-1],H=h?ee.right-D.left:D.right-ee.left;H>c&&(c=H,this.minWidth=s,this.minWidthFrom=k,this.minWidthTo=j)}}w&&A==g.children.length-1&&(d+=w.bottom-D.bottom),k=j+E.breakAfter}};return p(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return getComputedStyle(t.dom).direction=="rtl"?xn.RTL:xn.LTR}measureTextSize(){let e=this.tile.blockTiles(o=>{if(o.isLine()&&o.children.length&&o.length<=20){let c=0,h;for(let d of o.children){if(!d.isText()||/[^ -~]/.test(d.text))return;let p=Kf(d.dom);if(p.length!=1)return;c+=p[0].width,h=p[0].height}if(c)return{lineHeight:o.dom.getBoundingClientRect().height,charWidth:c/o.length,textHeight:h}}});if(e)return e;let t=document.createElement("div"),r,a,s;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(t);let o=Kf(t.firstChild)[0];r=t.getBoundingClientRect().height,a=o&&o.width?o.width/27:7,s=o&&o.height?o.height:r,t.remove()}),{lineHeight:r,charWidth:a,textHeight:s}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,a=0;;a++){let s=a==t.viewports.length?null:t.viewports[a],o=s?s.from-1:this.view.state.doc.length;if(o>r){let c=(t.lineBlockAt(o).bottom-t.lineBlockAt(r).top)/this.view.scaleY;e.push(pn.replace({widget:new Jm(c),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!s)break;r=s.to+1}return pn.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Od).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),r=!1,a=this.view.state.facet(iy).map((s,o)=>{let c=typeof s=="function";return c&&(r=!0),c?s(this.view):s});for(a.length&&(this.dynamicDecorationMap[e++]=r,t.push(Gt.join(a))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(gS).map(s=>typeof s=="function"?s(this.view):s)}scrollIntoView(e){if(e.isSnapshot){let d=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=d.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let d of this.view.state.facet(dS))try{if(d(this.view,e.range,e))return!0}catch(p){Zi(this.view.state,p,"scroll handler")}let{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),a;if(!r)return;!t.empty&&(a=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,a.left),top:Math.min(r.top,a.top),right:Math.max(r.right,a.right),bottom:Math.max(r.bottom,a.bottom)});let s=vS(this.view),o={left:r.left-s.left,top:r.top-s.top,right:r.right+s.right,bottom:r.bottom+s.bottom},{offsetWidth:c,offsetHeight:h}=this.view.scrollDOM;AE(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,c),-c),Math.max(Math.min(e.yMargin,h),-h),this.view.textDirection==xn.LTR)}lineHasWidget(e){let t=r=>r.isWidget()||r.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){l0(this.tile)}}function l0(n,e){let t=e?.get(n);if(t!=1){t==null&&n.destroy();for(let r of n.children)l0(r,e)}}function ZE(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function kS(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let r=Zw(t.focusNode,t.focusOffset),a=Jw(t.focusNode,t.focusOffset),s=r||a;if(a&&r&&a.node!=r.node){let c=In.get(a.node);if(!c||c.isText()&&c.text!=a.node.nodeValue)s=a;else if(n.docView.lastCompositionAfterCursor){let h=In.get(r.node);!h||h.isText()&&h.text!=r.node.nodeValue||(s=a)}}if(n.docView.lastCompositionAfterCursor=s!=r,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function JE(n,e,t){let r=kS(n,t);if(!r)return null;let{node:a,from:s,to:o}=r,c=a.nodeValue;if(/[\n\r]/.test(c)||n.state.doc.sliceString(r.from,r.to)!=c)return null;let h=e.invertedDesc;return{range:new oi(h.mapPos(s),h.mapPos(o),s,o),text:a}}function e3(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let t3=class{constructor(){this.changes=[]}compareRange(e,t){Ro(e,t,this.changes)}comparePoint(e,t){Ro(e,t,this.changes)}boundChange(e){Ro(e,e,this.changes)}};function n3(n,e,t){let r=new t3;return Gt.compare(n,e,t,r),r.changes}class r3{constructor(){this.changes=[]}compareRange(e,t){Ro(e,t,this.changes)}comparePoint(){}boundChange(e){Ro(e,e,this.changes)}}function i3(n,e,t){let r=new r3;return Gt.compare(n,e,t,r),r.changes}function a3(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function l3(n,e){let t=!1;return e&&n.iterChangedRanges((r,a)=>{r<e.to&&a>e.from&&(t=!0)}),t}class Jm extends Dd{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function s3(n,e,t=1){let r=n.charCategorizer(e),a=n.doc.lineAt(e),s=e-a.from;if(a.length==0)return Le.cursor(e);s==0?t=1:s==a.length&&(t=-1);let o=s,c=s;t<0?o=Un(a.text,s,!1):c=Un(a.text,s);let h=r(a.text.slice(o,c));for(;o>0;){let d=Un(a.text,o,!1);if(r(a.text.slice(d,o))!=h)break;o=d}for(;c<a.length;){let d=Un(a.text,c);if(r(a.text.slice(c,d))!=h)break;c=d}return Le.range(o+a.from,c+a.from)}function o3(n,e,t,r,a){let s=Math.round((r-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let c=n.viewState.heightOracle.textHeight,h=Math.floor((a-t.top-(n.defaultLineHeight-c)*.5)/c);s+=h*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+mE(o,s,n.state.tabSize)}function s0(n,e,t){let r=n.lineBlockAt(e);if(Array.isArray(r.type)){let a;for(let s of r.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!a||s.type==kr.Text&&(a.type!=s.type||(t<0?s.from<e:s.to>e)))&&(a=s)}}return a||r}return r}function u3(n,e,t,r){let a=s0(n,e.head,e.assoc||-1),s=!r||a.type!=kr.Text||!(n.lineWrapping||a.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>a.from?e.head-1:e.head);if(s){let o=n.dom.getBoundingClientRect(),c=n.textDirectionAt(a.from),h=n.posAtCoords({x:t==(c==xn.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(h!=null)return Le.cursor(h,t?-1:1)}return Le.cursor(t?a.to:a.from,t?-1:1)}function w1(n,e,t,r){let a=n.state.doc.lineAt(e.head),s=n.bidiSpans(a),o=n.textDirectionAt(a.from);for(let c=e,h=null;;){let d=zE(a,s,o,c,t),p=iS;if(!d){if(a.number==(t?n.state.doc.lines:1))return c;p=`
`,a=n.state.doc.line(a.number+(t?1:-1)),s=n.bidiSpans(a),d=n.visualLineSide(a,!t)}if(h){if(!h(p))return c}else{if(!r)return d;h=r(p)}c=d}}function c3(n,e,t){let r=n.state.charCategorizer(e),a=r(t);return s=>{let o=r(s);return a==lr.Space&&(a=o),a==o}}function h3(n,e,t,r){let a=e.head,s=t?1:-1;if(a==(t?n.state.doc.length:0))return Le.cursor(a,e.assoc);let o=e.goalColumn,c,h=n.contentDOM.getBoundingClientRect(),d=n.coordsAtPos(a,e.assoc||-1),p=n.documentTop;if(d)o==null&&(o=d.left-h.left),c=s<0?d.top:d.bottom;else{let A=n.viewState.lineBlockAt(a);o==null&&(o=Math.min(h.right-h.left,n.defaultCharacterWidth*(a-A.from))),c=(s<0?A.top:A.bottom)+p}let g=h.left+o,k=r??n.viewState.heightOracle.textHeight>>1,w=o0(n,{x:g,y:c+k*s},!1,s);return Le.cursor(w.pos,w.assoc,void 0,o)}function Ac(n,e,t){for(;;){let r=0;for(let a of n)a.between(e-1,e+1,(s,o,c)=>{if(e>s&&e<o){let h=r||t||(e-s<o-e?-1:1);e=h<0?s:o,r=h}});if(!r)return e}}function wS(n,e){let t=null;for(let r=0;r<e.ranges.length;r++){let a=e.ranges[r],s=null;if(a.empty){let o=Ac(n,a.from,0);o!=a.from&&(s=Le.cursor(o,-1))}else{let o=Ac(n,a.from,-1),c=Ac(n,a.to,1);(o!=a.from||c!=a.to)&&(s=Le.range(a.from==a.anchor?o:c,a.from==a.head?o:c))}s&&(t||(t=e.ranges.slice()),t[r]=s)}return t?Le.create(t,e.mainIndex):e}function eg(n,e,t){let r=Ac(n.state.facet(Xc).map(a=>a(n)),t.from,e.head>t.from?-1:1);return r==t.from?t:Le.cursor(r,r<t.from?1:-1)}class Xi{constructor(e,t){this.pos=e,this.assoc=t}}function o0(n,e,t,r){let a=n.contentDOM.getBoundingClientRect(),s=a.top+n.viewState.paddingTop,{x:o,y:c}=e,h=c-s,d;for(;;){if(h<0)return new Xi(0,1);if(h>n.viewState.docHeight)return new Xi(n.state.doc.length,-1);if(d=n.elementAtHeight(h),r==null)break;if(d.type==kr.Text){if(r<0?d.to<n.viewport.from:d.from>n.viewport.to)break;let k=n.docView.coordsAt(r<0?d.from:d.to,r);if(k&&(r<0?k.top<=h+s:k.bottom>=h+s))break}let g=n.viewState.heightOracle.textHeight/2;h=r>0?d.bottom+g:d.top-g}if(n.viewport.from>=d.to||n.viewport.to<=d.from){if(t)return null;if(d.type==kr.Text){let g=o3(n,a,d,o,c);return new Xi(g,g==d.from?1:-1)}}if(d.type!=kr.Text)return h<(d.top+d.bottom)/2?new Xi(d.from,1):new Xi(d.to,-1);let p=n.docView.lineAt(d.from,2);return(!p||p.length!=d.length)&&(p=n.docView.lineAt(d.from,-2)),SS(n,p,d.from,o,c)}function SS(n,e,t,r,a){let s=-1,o=null,c=1e9,h=1e9,d=a,p=a,g=(k,w)=>{for(let A=0;A<k.length;A++){let E=k[A];if(E.top==E.bottom)continue;let j=E.left>r?E.left-r:E.right<r?r-E.right:0,D=E.top>a?E.top-a:E.bottom<a?a-E.bottom:0;E.top<=p&&E.bottom>=d&&(d=Math.min(E.top,d),p=Math.max(E.bottom,p),D=0),(s<0||(D-h||j-c)<0)&&(s>=0&&h&&c<j&&o.top<=p-2&&o.bottom>=d+2?h=0:(s=w,c=j,h=D,o=E))}};if(e.isText()){for(let w=0;w<e.length;){let A=Un(e.text,w);if(g(Pc(e.dom,w,A).getClientRects(),w),!c&&!h)break;w=A}return r>(o.left+o.right)/2==(S1(n,s+t)==xn.LTR)?new Xi(t+Un(e.text,s),-1):new Xi(t+s,1)}else{if(!e.length)return new Xi(t,1);for(let E=0;E<e.children.length;E++){let j=e.children[E];if(j.flags&48)continue;let D=(j.dom.nodeType==1?j.dom:Pc(j.dom,0,j.length)).getClientRects();if(g(D,E),!c&&!h)break}let k=e.children[s],w=e.posBefore(k,t);return k.isComposite()||k.isText()?SS(n,k,w,Math.max(o.left,Math.min(o.right,r)),a):r>(o.left+o.right)/2==(S1(n,s+t)==xn.LTR)?new Xi(w+k.length,-1):new Xi(w,1)}}function S1(n,e){let t=n.state.doc.lineAt(e);return n.bidiSpans(t)[Oa.find(n.bidiSpans(t),e-t.from,-1,1)].dir}const gc="";class f3{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineSeparator=t.state.facet(Ut.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=gc}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let a=e;;){this.findPointBefore(r,a);let s=this.text.length;this.readNode(a);let o=In.get(a),c=a.nextSibling;if(c==t){o?.breakAfter&&!c&&r!=this.view.contentDOM&&this.lineBreak();break}let h=In.get(c);(o&&h?o.breakAfter:(o?o.breakAfter:rd(a))||rd(c)&&(a.nodeName!="BR"||o?.isWidget())&&this.text.length>s)&&!p3(c,t)&&this.lineBreak(),a=c}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,a=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,c;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(c=a.exec(t))&&(s=c.index,o=c[0].length),this.append(t.slice(r,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let h of this.points)h.node==e&&h.pos>this.text.length&&(h.pos-=o-1);r=s+o}}readNode(e){let t=In.get(e),r=t&&t.overrideDOMText;if(r!=null){this.findPointInside(e,r.length);for(let a=r.iter();!a.next().done;)a.lineBreak?this.lineBreak():this.append(a.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(e.nodeType==3?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(d3(e,r.node,r.offset)?t:0))}}function d3(n,e,t){for(;;){if(!e||t<Ia(e))return!1;if(e==n)return!0;t=Rl(e)+1,e=e.parentNode}}function p3(n,e){let t;for(;!(n==e||!n);n=n.nextSibling){let r=In.get(n);if(!r?.isWidget())return!1;r&&(t||(t=[])).push(r)}if(t)for(let r of t){let a=r.overrideDOMText;if(a?.length)return!1}return!0}class C1{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class m3{constructor(e,t,r,a){this.typeOver=a,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=CS(e.docView.tile,t,r,0))){let c=s||o?[]:y3(e),h=new f3(c,e);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=x3(c,this.bounds.from)}else{let c=e.observer.selectionRange,h=s&&s.node==c.focusNode&&s.offset==c.focusOffset||!t0(e.contentDOM,c.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(c.focusNode,c.focusOffset),d=o&&o.node==c.anchorNode&&o.offset==c.anchorOffset||!t0(e.contentDOM,c.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(c.anchorNode,c.anchorOffset),p=e.viewport;if((Je.ios||Je.chrome)&&e.state.selection.main.empty&&h!=d&&(p.from>0||p.to<e.state.doc.length)){let g=Math.min(h,d),k=Math.max(h,d),w=p.from-g,A=p.to-k;(w==0||w==1||g==0)&&(A==0||A==-1||k==e.state.doc.length)&&(h=0,d=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(Le.range(d,h)):this.newSel=Le.single(d,h)}}}function CS(n,e,t,r){if(n.isComposite()){let a=-1,s=-1,o=-1,c=-1;for(let h=0,d=r,p=r;h<n.children.length;h++){let g=n.children[h],k=d+g.length;if(d<e&&k>t)return CS(g,e,t,d);if(k>=e&&a==-1&&(a=h,s=d),d>t&&g.dom.parentNode==n.dom){o=h,c=p;break}p=k,d=k+g.breakAfter}return{from:s,to:c<0?r+n.length:c,startDOM:(a?n.children[a-1].dom.nextSibling:null)||n.dom.firstChild,endDOM:o<n.children.length&&o>=0?n.children[o].dom:null}}else return n.isText()?{from:r,to:r+n.length,startDOM:n.dom,endDOM:n.dom.nextSibling}:null}function AS(n,e){let t,{newSel:r}=e,a=n.state.selection.main,s=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:c}=e.bounds,h=a.from,d=null;(s===8||Je.android&&e.text.length<c-o)&&(h=a.to,d="end");let p=TS(n.state.doc.sliceString(o,c,gc),e.text,h-o,d);p&&(Je.chrome&&s==13&&p.toB==p.from+2&&e.text.slice(p.from,p.toB)==gc+gc&&p.toB--,t={from:o+p.from,to:o+p.toA,insert:It.of(e.text.slice(p.from,p.toB).split(gc))})}else r&&(!n.hasFocus&&n.state.facet(Da)||od(r,a))&&(r=null);if(!t&&!r)return!1;if(!t&&e.typeOver&&!a.empty&&r&&r.main.empty?t={from:a.from,to:a.to,insert:n.state.doc.slice(a.from,a.to)}:(Je.mac||Je.android)&&t&&t.from==t.to&&t.from==a.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(r&&t.insert.length==2&&(r=Le.single(r.main.anchor-1,r.main.head-1)),t={from:t.from,to:t.to,insert:It.of([t.insert.toString().replace("."," ")])}):t&&t.from>=a.from&&t.to<=a.to&&(t.from!=a.from||t.to!=a.to)&&a.to-a.from-(t.to-t.from)<=4?t={from:a.from,to:a.to,insert:n.state.doc.slice(a.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,a.to))}:n.state.doc.lineAt(a.from).to<a.to&&n.docView.lineHasWidget(a.to)&&n.inputState.insertingTextAt>Date.now()-50?t={from:a.from,to:a.to,insert:n.state.toText(n.inputState.insertingText)}:Je.chrome&&t&&t.from==t.to&&t.from==a.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(r&&(r=Le.single(r.main.anchor-1,r.main.head-1)),t={from:a.from,to:a.to,insert:It.of([" "])}),t)return ay(n,t,r,s);if(r&&!od(r,a)){let o=!1,c="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),c=n.inputState.lastSelectionOrigin,c=="select.pointer"&&(r=wS(n.state.facet(Xc).map(h=>h(n)),r))),n.dispatch({selection:r,scrollIntoView:o,userEvent:c}),!0}else return!1}function ay(n,e,t,r=-1){if(Je.ios&&n.inputState.flushIOSKey(e))return!0;let a=n.state.selection.main;if(Je.android&&(e.to==a.to&&(e.from==a.from||e.from==a.from-1&&n.state.sliceDoc(e.from,a.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Lo(n.contentDOM,"Enter",13)||(e.from==a.from-1&&e.to==a.to&&e.insert.length==0||r==8&&e.insert.length<e.to-e.from&&e.to>a.head)&&Lo(n.contentDOM,"Backspace",8)||e.from==a.from&&e.to==a.to+1&&e.insert.length==0&&Lo(n.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,c=()=>o||(o=g3(n,e,t));return n.state.facet(uS).some(h=>h(n,e.from,e.to,s,c))||n.dispatch(c()),!0}function g3(n,e,t){let r,a=n.state,s=a.selection.main,o=-1;if(e.from==e.to&&e.from<s.from||e.from>s.to){let h=e.from<s.from?-1:1,d=h<0?s.from:s.to,p=Ac(a.facet(Xc).map(g=>g(n)),d,h);e.from==p&&(o=p)}if(o>-1)r={changes:e,selection:Le.cursor(e.from+e.insert.length,-1)};else if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let h=s.from<e.from?a.sliceDoc(s.from,e.from):"",d=s.to>e.to?a.sliceDoc(e.to,s.to):"";r=a.replaceSelection(n.state.toText(h+e.insert.sliceString(0,void 0,n.state.lineBreak)+d))}else{let h=a.changes(e),d=t&&t.main.to<=h.newLength?t.main:void 0;if(a.selection.ranges.length>1&&(n.inputState.composing>=0||n.inputState.compositionPendingChange)&&e.to<=s.to+10&&e.to>=s.to-10){let p=n.state.sliceDoc(e.from,e.to),g,k=t&&kS(n,t.main.head);if(k){let A=e.insert.length-(e.to-e.from);g={from:k.from,to:k.to-A}}else g=n.state.doc.lineAt(s.head);let w=s.to-e.to;r=a.changeByRange(A=>{if(A.from==s.from&&A.to==s.to)return{changes:h,range:d||A.map(h)};let E=A.to-w,j=E-p.length;if(n.state.sliceDoc(j,E)!=p||E>=g.from&&j<=g.to)return{range:A};let D=a.changes({from:j,to:E,insert:e.insert}),U=A.to-s.to;return{changes:D,range:d?Le.range(Math.max(0,d.anchor+U),Math.max(0,d.head+U)):A.map(D)}})}else r={changes:h,selection:d&&a.selection.replaceRange(d)}}let c="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,c+=".compose",n.inputState.compositionFirstChange&&(c+=".start",n.inputState.compositionFirstChange=!1)),a.update(r,{userEvent:c,scrollIntoView:!0})}function TS(n,e,t,r){let a=Math.min(n.length,e.length),s=0;for(;s<a&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==a&&n.length==e.length)return null;let o=n.length,c=e.length;for(;o>0&&c>0&&n.charCodeAt(o-1)==e.charCodeAt(c-1);)o--,c--;if(r=="end"){let h=Math.max(0,s-Math.min(o,c));t-=o+h-s}if(o<s&&n.length<e.length){let h=t<=s&&t>=o?s-t:0;s-=h,c=s+(c-o),o=s}else if(c<s){let h=t<=s&&t>=c?s-t:0;s-=h,o=s+(o-c),c=s}return{from:s,toA:o,toB:c}}function y3(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:r,focusNode:a,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new C1(t,r)),(a!=t||s!=r)&&e.push(new C1(a,s))),e}function x3(n,e){if(n.length==0)return null;let t=n[0].pos,r=n.length==2?n[1].pos:t;return t>-1&&r>-1?Le.single(t+e,r+e):null}function od(n,e){return e.head==n.main.head&&e.anchor==n.main.anchor}class v3{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Je.safari&&e.contentDOM.addEventListener("input",()=>null),Je.gecko&&R3(e.contentDOM.ownerDocument)}handleEvent(e){!N3(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let r=this.handlers[e];if(r){for(let a of r.observers)a(this.view,t);for(let a of r.handlers){if(t.defaultPrevented)break;if(a(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=b3(e),r=this.handlers,a=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,c=r[s];c&&o!=!c.handlers.length&&(a.removeEventListener(s,this.handleEvent),c=null),c||a.addEventListener(s,this.handleEvent,{passive:o})}for(let s in r)s!="scroll"&&!t[s]&&a.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&ES.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Je.android&&Je.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return Je.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=NS.find(r=>r.keyCode==e.keyCode))&&!e.ctrlKey||k3.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Lo(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:Je.safari&&!Je.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function A1(n,e){return(t,r)=>{try{return e.call(n,r,t)}catch(a){Zi(t.state,a)}}}function b3(n){let e=Object.create(null);function t(r){return e[r]||(e[r]={observers:[],handlers:[]})}for(let r of n){let a=r.spec,s=a&&a.plugin.domEventHandlers,o=a&&a.plugin.domEventObservers;if(s)for(let c in s){let h=s[c];h&&t(c).handlers.push(A1(r.value,h))}if(o)for(let c in o){let h=o[c];h&&t(c).observers.push(A1(r.value,h))}}for(let r in Ti)t(r).handlers.push(Ti[r]);for(let r in fi)t(r).observers.push(fi[r]);return e}const NS=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],k3="dthko",ES=[16,17,18,20,91,92,224,225],wf=6;function Sf(n){return Math.max(0,n)*.7+8}function w3(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class S3{constructor(e,t,r,a){this.view=e,this.startEvent=t,this.style=r,this.mustSelect=a,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=TE(e.contentDOM),this.atoms=e.state.facet(Xc).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Ut.allowMultipleSelections)&&C3(e,t),this.dragging=T3(e,t)&&_S(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&w3(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,r=0,a=0,s=0,o=this.view.win.innerWidth,c=this.view.win.innerHeight;this.scrollParents.x&&({left:a,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:c}=this.scrollParents.y.getBoundingClientRect());let h=vS(this.view);e.clientX-h.left<=a+wf?t=-Sf(a-e.clientX):e.clientX+h.right>=o-wf&&(t=Sf(e.clientX-o)),e.clientY-h.top<=s+wf?r=-Sf(s-e.clientY):e.clientY+h.bottom>=c-wf&&(r=Sf(e.clientY-c)),this.setScrollSpeed(t,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,r=wS(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function C3(n,e){let t=n.state.facet(aS);return t.length?t[0](e):Je.mac?e.metaKey:e.ctrlKey}function A3(n,e){let t=n.state.facet(lS);return t.length?t[0](e):Je.mac?!e.altKey:!e.ctrlKey}function T3(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let r=Uo(n.root);if(!r||r.rangeCount==0)return!0;let a=r.getRangeAt(0).getClientRects();for(let s=0;s<a.length;s++){let o=a[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function N3(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,r;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(r=In.get(t))&&r.isWidget()&&!r.isHidden&&r.widget.ignoreEvent(e))return!1;return!0}const Ti=Object.create(null),fi=Object.create(null),MS=Je.ie&&Je.ie_version<15||Je.ios&&Je.webkit_version<604;function E3(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),jS(n,t.value)},50)}function Bd(n,e,t){for(let r of n.facet(e))t=r(t,n);return t}function jS(n,e){e=Bd(n.state,ty,e);let{state:t}=n,r,a=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(u0!=null&&t.selection.ranges.every(h=>h.empty)&&u0==s.toString()){let h=-1;r=t.changeByRange(d=>{let p=t.doc.lineAt(d.from);if(p.from==h)return{range:d};h=p.from;let g=t.toText((o?s.line(a++).text:e)+t.lineBreak);return{changes:{from:p.from,insert:g},range:Le.cursor(d.from+g.length)}})}else o?r=t.changeByRange(h=>{let d=s.line(a++);return{changes:{from:h.from,to:h.to,insert:d.text},range:Le.cursor(h.from+d.length)}}):r=t.replaceSelection(s);n.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}fi.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};Ti.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);fi.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};fi.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Ti.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let r of n.state.facet(sS))if(t=r(n,e),t)break;if(!t&&e.button==0&&(t=j3(n,e)),t){let r=!n.hasFocus;n.inputState.startMouseSelection(new S3(n,e,t,r)),r&&n.observer.ignore(()=>{Xw(n.contentDOM);let s=n.root.activeElement;s&&!s.contains(n.contentDOM)&&s.blur()});let a=n.inputState.mouseSelection;if(a)return a.start(e),a.dragging===!1}else n.inputState.setSelectionOrigin("select.pointer");return!1};function T1(n,e,t,r){if(r==1)return Le.cursor(e,t);if(r==2)return s3(n.state,e,t);{let a=n.docView.lineAt(e,t),s=n.state.doc.lineAt(a?a.posAtEnd:e),o=a?a.posAtStart:s.from,c=a?a.posAtEnd:s.to;return c<n.state.doc.length&&c==s.to&&c++,Le.range(o,c)}}const M3=Je.ie&&Je.ie_version<=11;let N1=null,E1=0,M1=0;function _S(n){if(!M3)return n.detail;let e=N1,t=M1;return N1=n,M1=Date.now(),E1=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(E1+1)%3:1}function j3(n,e){let t=n.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),r=_S(e),a=n.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),a=a.map(s.changes))},get(s,o,c){let h=n.posAndSideAtCoords({x:s.clientX,y:s.clientY},!1),d,p=T1(n,h.pos,h.assoc,r);if(t.pos!=h.pos&&!o){let g=T1(n,t.pos,t.assoc,r),k=Math.min(g.from,p.from),w=Math.max(g.to,p.to);p=k<p.from?Le.range(k,w):Le.range(w,k)}return o?a.replaceRange(a.main.extend(p.from,p.to)):c&&r==1&&a.ranges.length>1&&(d=_3(a,h.pos))?d:c?a.addRange(p):Le.create([p])}}}function _3(n,e){for(let t=0;t<n.ranges.length;t++){let{from:r,to:a}=n.ranges[t];if(r<=e&&a>=e)return Le.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}Ti.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let a=n.docView.tile.nearest(e.target);if(a&&a.isWidget()){let s=a.posAtStart,o=s+a.length;(s>=t.to||o<=t.from)&&(t=Le.range(s,o))}}let{inputState:r}=n;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Bd(n.state,ny,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Ti.dragend=n=>(n.inputState.draggedContent=null,!1);function j1(n,e,t,r){if(t=Bd(n.state,ty,t),!t)return;let a=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=n.inputState,o=r&&s&&A3(n,e)?{from:s.from,to:s.to}:null,c={from:a,insert:t},h=n.state.changes(o?[o,c]:c);n.focus(),n.dispatch({changes:h,selection:{anchor:h.mapPos(a,-1),head:h.mapPos(a,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}Ti.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let r=Array(t.length),a=0,s=()=>{++a==t.length&&j1(n,e,r.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let c=new FileReader;c.onerror=s,c.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(c.result)||(r[o]=c.result),s()},c.readAsText(t[o])}return!0}else{let r=e.dataTransfer.getData("Text");if(r)return j1(n,e,r,!0),!0}return!1};Ti.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=MS?null:e.clipboardData;return t?(jS(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(E3(n),!1)};function D3(n,e){let t=n.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),n.focus()},50)}function O3(n){let e=[],t=[],r=!1;for(let a of n.selection.ranges)a.empty||(e.push(n.sliceDoc(a.from,a.to)),t.push(a));if(!e.length){let a=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>a&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),a=o.number}r=!0}return{text:Bd(n,ny,e.join(n.lineBreak)),ranges:t,linewise:r}}let u0=null;Ti.copy=Ti.cut=(n,e)=>{let t=Uo(n.root);if(t&&!Sc(n.contentDOM,t))return!1;let{text:r,ranges:a,linewise:s}=O3(n.state);if(!r&&!s)return!1;u0=s?r:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:a,scrollIntoView:!0,userEvent:"delete.cut"});let o=MS?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",r),!0):(D3(n,r),!1)};const DS=zl.define();function OS(n,e){let t=[];for(let r of n.facet(cS)){let a=r(n,e);a&&t.push(a)}return t.length?n.update({effects:t,annotations:DS.of(!0)}):null}function RS(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=OS(n.state,e);t?n.dispatch(t):n.update([])}},10)}fi.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),RS(n)};fi.blur=n=>{n.observer.clearSelectionRange(),RS(n)};fi.compositionstart=fi.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};fi.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Je.chrome&&Je.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};fi.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Ti.beforeinput=(n,e)=>{var t,r;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(n.inputState.insertingText=e.data,n.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&n.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let c=o[0],h=n.posAtDOM(c.startContainer,c.startOffset),d=n.posAtDOM(c.endContainer,c.endOffset);return ay(n,{from:h,to:d,insert:n.state.toText(s)},null),!0}}let a;if(Je.chrome&&Je.android&&(a=NS.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(a.key,a.keyCode),a.key=="Backspace"||a.key=="Delete")){let s=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return Je.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),Je.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>fi.compositionend(n,e),20),!1};const _1=new Set;function R3(n){_1.has(n)||(_1.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const D1=["pre-wrap","normal","pre-line","break-spaces"];let Ko=!1;function O1(){Ko=!1}class L3{constructor(e){this.lineWrapping=e,this.doc=It.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return D1.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let a=e[r];a<0?r++:this.heightSamples[Math.floor(a*10)]||(t=!0,this.heightSamples[Math.floor(a*10)]=!0)}return t}refresh(e,t,r,a,s,o){let c=D1.indexOf(e)>-1,h=Math.abs(t-this.lineHeight)>.3||this.lineWrapping!=c||Math.abs(r-this.charWidth)>.1;if(this.lineWrapping=c,this.lineHeight=t,this.charWidth=r,this.textHeight=a,this.lineLength=s,h){this.heightSamples={};for(let d=0;d<o.length;d++){let p=o[d];p<0?d++:this.heightSamples[Math.floor(p*10)]=!0}}return h}}class B3{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class wi{constructor(e,t,r,a,s){this.from=e,this.length=t,this.top=r,this.height=a,this._content=s}get type(){return typeof this._content=="number"?kr.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof As?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new wi(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var sn=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(sn||(sn={}));const Gf=.001;class wr{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Gf&&(Ko=!0),this.height=e)}replace(e,t,r){return wr.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,a){let s=this,o=r.doc;for(let c=a.length-1;c>=0;c--){let{fromA:h,toA:d,fromB:p,toB:g}=a[c],k=s.lineAt(h,sn.ByPosNoHeight,r.setDoc(t),0,0),w=k.to>=d?k:s.lineAt(d,sn.ByPosNoHeight,r,0,0);for(g+=w.to-d,d=w.to;c>0&&k.from<=a[c-1].toA;)h=a[c-1].fromA,p=a[c-1].fromB,c--,h<k.from&&(k=s.lineAt(h,sn.ByPosNoHeight,r,0,0));p+=k.from-h,h=k.from;let A=ly.build(r.setDoc(o),e,p,g);s=ud(s,s.replace(h,d,A))}return s.updateHeight(r,0)}static empty(){return new Fr(0,0,0)}static of(e){if(e.length==1)return e[0];let t=0,r=e.length,a=0,s=0;for(;;)if(t==r)if(a>s*2){let c=e[t-1];c.break?e.splice(--t,1,c.left,null,c.right):e.splice(--t,1,c.left,c.right),r+=1+c.break,a-=c.size}else if(s>a*2){let c=e[r];c.break?e.splice(r,1,c.left,null,c.right):e.splice(r,1,c.left,c.right),r+=2+c.break,s-=c.size}else break;else if(a<s){let c=e[t++];c&&(a+=c.size)}else{let c=e[--r];c&&(s+=c.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,r++),new I3(wr.of(e.slice(0,t)),o,wr.of(e.slice(r)))}}function ud(n,e){return n==e?n:(n.constructor!=e.constructor&&(Ko=!0),e)}wr.prototype.size=1;const z3=pn.replace({});class LS extends wr{constructor(e,t,r){super(e,t),this.deco=r,this.spaceAbove=0}mainBlock(e,t){return new wi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,r,a){return this.spaceAbove&&e<r+this.spaceAbove?new wi(a,0,r,this.spaceAbove,z3):this.mainBlock(r,a)}lineAt(e,t,r,a,s){let o=this.mainBlock(a,s);return this.spaceAbove?this.blockAt(0,r,a,s).join(o):o}forEachLine(e,t,r,a,s,o){e<=s+this.length&&t>=s&&o(this.lineAt(0,sn.ByPos,r,a,s))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e,t=0,r=!1,a){return a&&a.from<=t&&a.more&&this.setMeasuredHeight(a),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Fr extends LS{constructor(e,t,r){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=r}mainBlock(e,t){return new wi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,r){let a=r[0];return r.length==1&&(a instanceof Fr||a instanceof ir&&a.flags&4)&&Math.abs(this.length-a.length)<10?(a instanceof ir?a=new Fr(a.length,this.height,this.spaceAbove):a.height=this.height,this.outdated||(a.outdated=!1),a):wr.of(r)}updateHeight(e,t=0,r=!1,a){return a&&a.from<=t&&a.more?this.setMeasuredHeight(a):(r||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class ir extends wr{constructor(e){super(e,0)}heightMetrics(e,t){let r=e.doc.lineAt(t).number,a=e.doc.lineAt(t+this.length).number,s=a-r+1,o,c=0;if(e.lineWrapping){let h=Math.min(this.height,e.lineHeight*s);o=h/s,this.length>s+1&&(c=(this.height-h)/(this.length-s-1))}else o=this.height/s;return{firstLine:r,lastLine:a,perLine:o,perChar:c}}blockAt(e,t,r,a){let{firstLine:s,lastLine:o,perLine:c,perChar:h}=this.heightMetrics(t,a);if(t.lineWrapping){let d=a+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),p=t.doc.lineAt(d),g=c+p.length*h,k=Math.max(r,e-g/2);return new wi(p.from,p.length,k,g,0)}else{let d=Math.max(0,Math.min(o-s,Math.floor((e-r)/c))),{from:p,length:g}=t.doc.line(s+d);return new wi(p,g,r+c*d,c,0)}}lineAt(e,t,r,a,s){if(t==sn.ByHeight)return this.blockAt(e,r,a,s);if(t==sn.ByPosNoHeight){let{from:w,to:A}=r.doc.lineAt(e);return new wi(w,A-w,0,0,0)}let{firstLine:o,perLine:c,perChar:h}=this.heightMetrics(r,s),d=r.doc.lineAt(e),p=c+d.length*h,g=d.number-o,k=a+c*g+h*(d.from-s-g);return new wi(d.from,d.length,Math.max(a,Math.min(k,a+this.height-p)),p,0)}forEachLine(e,t,r,a,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:c,perLine:h,perChar:d}=this.heightMetrics(r,s);for(let p=e,g=a;p<=t;){let k=r.doc.lineAt(p);if(p==e){let A=k.number-c;g+=h*A+d*(e-s-A)}let w=h+d*k.length;o(new wi(k.from,k.length,g,w,0)),g+=w,p=k.to+1}}replace(e,t,r){let a=this.length-t;if(a>0){let s=r[r.length-1];s instanceof ir?r[r.length-1]=new ir(s.length+a):r.push(null,new ir(a-1))}if(e>0){let s=r[0];s instanceof ir?r[0]=new ir(e+s.length):r.unshift(new ir(e-1),null)}return wr.of(r)}decomposeLeft(e,t){t.push(new ir(e-1),null)}decomposeRight(e,t){t.push(null,new ir(this.length-e-1))}updateHeight(e,t=0,r=!1,a){let s=t+this.length;if(a&&a.from<=t+this.length&&a.more){let o=[],c=Math.max(t,a.from),h=-1;for(a.from>t&&o.push(new ir(a.from-t-1).updateHeight(e,t));c<=s&&a.more;){let p=e.doc.lineAt(c).length;o.length&&o.push(null);let g=a.heights[a.index++],k=0;g<0&&(k=-g,g=a.heights[a.index++]),h==-1?h=g:Math.abs(g-h)>=Gf&&(h=-2);let w=new Fr(p,g,k);w.outdated=!1,o.push(w),c+=p+1}c<=s&&o.push(null,new ir(s-c).updateHeight(e,c));let d=wr.of(o);return(h<0||Math.abs(d.height-this.height)>=Gf||Math.abs(h-this.heightMetrics(e,t).perLine)>=Gf)&&(Ko=!0),ud(this,d)}else(r||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class I3 extends wr{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return this.flags&1}blockAt(e,t,r,a){let s=r+this.left.height;return e<s?this.left.blockAt(e,t,r,a):this.right.blockAt(e,t,s,a+this.left.length+this.break)}lineAt(e,t,r,a,s){let o=a+this.left.height,c=s+this.left.length+this.break,h=t==sn.ByHeight?e<o:e<c,d=h?this.left.lineAt(e,t,r,a,s):this.right.lineAt(e,t,r,o,c);if(this.break||(h?d.to<c:d.from>c))return d;let p=t==sn.ByPosNoHeight?sn.ByPosNoHeight:sn.ByPos;return h?d.join(this.right.lineAt(c,p,r,o,c)):this.left.lineAt(c,p,r,a,s).join(d)}forEachLine(e,t,r,a,s,o){let c=a+this.left.height,h=s+this.left.length+this.break;if(this.break)e<h&&this.left.forEachLine(e,t,r,a,s,o),t>=h&&this.right.forEachLine(e,t,r,c,h,o);else{let d=this.lineAt(h,sn.ByPos,r,a,s);e<d.from&&this.left.forEachLine(e,d.from-1,r,a,s,o),d.to>=e&&d.from<=t&&o(d),t>d.to&&this.right.forEachLine(d.to+1,t,r,c,h,o)}}replace(e,t,r){let a=this.left.length+this.break;if(t<a)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-a,t-a,r));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let c of r)s.push(c);if(e>0&&R1(s,o-1),t<this.length){let c=s.length;this.decomposeRight(t,s),R1(s,c)}return wr.of(s)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(r++,e>=r&&t.push(null)),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,a=r+this.break;if(e>=a)return this.right.decomposeRight(e-a,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<a&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?wr.of(this.break?[e,null,t]:[e,t]):(this.left=ud(this.left,e),this.right=ud(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,a){let{left:s,right:o}=this,c=t+s.length+this.break,h=null;return a&&a.from<=t+s.length&&a.more?h=s=s.updateHeight(e,t,r,a):s.updateHeight(e,t,r),a&&a.from<=c+o.length&&a.more?h=o=o.updateHeight(e,c,r,a):o.updateHeight(e,c,r),h?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function R1(n,e){let t,r;n[e]==null&&(t=n[e-1])instanceof ir&&(r=n[e+1])instanceof ir&&n.splice(e-1,3,new ir(t.length+1+r.length))}const P3=5;class ly{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let r=Math.min(t,this.lineEnd),a=this.nodes[this.nodes.length-1];a instanceof Fr?a.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new Fr(r-this.pos,-1,0)),this.writtenTo=r,t>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let a=r.widget?r.widget.estimatedHeight:0,s=r.widget?r.widget.lineBreaks:0;a<0&&(a=this.oracle.lineHeight);let o=t-e;r.block?this.addBlock(new LS(o,a,r)):(o||s||a>=P3)&&this.addLineDeco(a,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Fr(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let r=new ir(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Fr)return e;let t=new Fr(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,r){let a=this.ensureLine();a.length+=r,a.collapsed+=r,a.widgetHeight=Math.max(a.widgetHeight,e),a.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Fr)&&!this.isCovered?this.nodes.push(new Fr(0,-1,0)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=e;for(let a of this.nodes)a instanceof Fr&&a.updateHeight(this.oracle,r),r+=a?a.length:1;return this.nodes}static build(e,t,r,a){let s=new ly(r,e);return Gt.spans(t,r,a,s,0),s.finish(r)}}function H3(n,e,t){let r=new q3;return Gt.compare(n,e,t,r,0),r.changes}class q3{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,a){(e<t||r&&r.heightRelevant||a&&a.heightRelevant)&&Ro(e,t,this.changes,5)}}function U3(n,e){let t=n.getBoundingClientRect(),r=n.ownerDocument,a=r.defaultView||window,s=Math.max(0,t.left),o=Math.min(a.innerWidth,t.right),c=Math.max(0,t.top),h=Math.min(a.innerHeight,t.bottom);for(let d=n.parentNode;d&&d!=r.body;)if(d.nodeType==1){let p=d,g=window.getComputedStyle(p);if((p.scrollHeight>p.clientHeight||p.scrollWidth>p.clientWidth)&&g.overflow!="visible"){let k=p.getBoundingClientRect();s=Math.max(s,k.left),o=Math.min(o,k.right),c=Math.max(c,k.top),h=Math.min(d==n.parentNode?a.innerHeight:h,k.bottom)}d=g.position=="absolute"||g.position=="fixed"?p.offsetParent:p.parentNode}else if(d.nodeType==11)d=d.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:c-(t.top+e),bottom:Math.max(c,h)-(t.top+e)}}function V3(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function F3(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class tg{constructor(e,t,r,a){this.from=e,this.to=t,this.size=r,this.displaySize=a}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let a=e[r],s=t[r];if(a.from!=s.from||a.to!=s.to||a.size!=s.size)return!1}return!0}draw(e,t){return pn.replace({widget:new K3(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class K3 extends Dd{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class L1{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=B1,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=xn.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(ry).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new L3(t),this.stateDeco=z1(e),this.heightMap=wr.empty().applyChanges(this.stateDeco,It.empty,this.heightOracle.setDoc(e.doc),[new oi(0,0,0,e.doc.length)]);for(let r=0;r<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());r++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=pn.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let a=r?t.head:t.anchor;if(!e.some(({from:s,to:o})=>a>=s&&a<=o)){let{from:s,to:o}=this.lineBlockAt(a);e.push(new Cf(s,o))}}return this.viewports=e.sort((r,a)=>r.from-a.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?B1:new sy(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(yc(e,this.scaler))})}update(e,t=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=z1(this.state);let a=e.changedRanges,s=oi.extendWithRanges(a,H3(r,this.stateDeco,e?e.changes:qn.empty(this.state.doc.length))),o=this.heightMap.height,c=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);O1(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||Ko)&&(e.flags|=2),c?(this.scrollAnchorPos=e.changes.mapPos(c.from,-1),this.scrollAnchorHeight=c.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let h=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<h.from||t.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,t));let d=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,e.flags|=this.updateForViewport(),(d||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(fS)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,r=window.getComputedStyle(t),a=this.heightOracle,s=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?xn.RTL:xn.LTR;let o=this.heightOracle.mustRefreshForWrapping(s)||this.mustMeasureContent,c=t.getBoundingClientRect(),h=o||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let d=0,p=0;if(c.width&&c.height){let{scaleX:J,scaleY:ee}=Qw(t,c);(J>.005&&Math.abs(this.scaleX-J)>.005||ee>.005&&Math.abs(this.scaleY-ee)>.005)&&(this.scaleX=J,this.scaleY=ee,d|=16,o=h=!0)}let g=(parseInt(r.paddingTop)||0)*this.scaleY,k=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=g||this.paddingBottom!=k)&&(this.paddingTop=g,this.paddingBottom=k,d|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(a.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,d|=16);let w=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=w&&(this.scrollAnchorHeight=-1,this.scrollTop=w),this.scrolledToBottom=Ww(e.scrollDOM);let A=(this.printing?F3:U3)(t,this.paddingTop),E=A.top-this.pixelViewport.top,j=A.bottom-this.pixelViewport.bottom;this.pixelViewport=A;let D=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(D!=this.inView&&(this.inView=D,D&&(h=!0)),!this.inView&&!this.scrollTarget&&!V3(e.dom))return 0;let U=c.width;if((this.contentDOMWidth!=U||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,d|=16),h){let J=e.docView.measureVisibleLineHeights(this.viewport);if(a.mustRefreshForHeights(J)&&(o=!0),o||a.lineWrapping&&Math.abs(U-this.contentDOMWidth)>a.charWidth){let{lineHeight:ee,charWidth:H,textHeight:L}=e.docView.measureTextSize();o=ee>0&&a.refresh(s,ee,H,L,Math.max(5,U/H),J),o&&(e.docView.minWidth=0,d|=16)}E>0&&j>0?p=Math.max(E,j):E<0&&j<0&&(p=Math.min(E,j)),O1();for(let ee of this.viewports){let H=ee.from==this.viewport.from?J:e.docView.measureVisibleLineHeights(ee);this.heightMap=(o?wr.empty().applyChanges(this.stateDeco,It.empty,this.heightOracle,[new oi(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(a,0,o,new B3(ee.from,H))}Ko&&(d|=2)}let O=!this.viewportIsAppropriate(this.viewport,p)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return O&&(d&2&&(d|=this.updateScaler()),this.viewport=this.getViewport(p,this.scrollTarget),d|=this.updateForViewport()),(d&2||O)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),d|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),d}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),a=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:c}=this,h=new Cf(a.lineAt(o-r*1e3,sn.ByHeight,s,0,0).from,a.lineAt(c+(1-r)*1e3,sn.ByHeight,s,0,0).to);if(t){let{head:d}=t.range;if(d<h.from||d>h.to){let p=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),g=a.lineAt(d,sn.ByPos,s,0,0),k;t.y=="center"?k=(g.top+g.bottom)/2-p/2:t.y=="start"||t.y=="nearest"&&d<h.from?k=g.top:k=g.bottom-p,h=new Cf(a.lineAt(k-1e3/2,sn.ByHeight,s,0,0).from,a.lineAt(k+p+1e3/2,sn.ByHeight,s,0,0).to)}}return h}mapViewport(e,t){let r=t.mapPos(e.from,-1),a=t.mapPos(e.to,1);return new Cf(this.heightMap.lineAt(r,sn.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(a,sn.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:a}=this.heightMap.lineAt(e,sn.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,sn.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:c}=this;return(e==0||a<=o-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||s>=c+Math.max(10,Math.min(r,250)))&&a>o-2*1e3&&s<c+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let a of e)t.touchesRange(a.from,a.to)||r.push(new tg(t.mapPos(a.from),t.mapPos(a.to),a.size,a.displaySize));return r}ensureLineGaps(e,t){let r=this.heightOracle.lineWrapping,a=r?1e4:2e3,s=a>>1,o=a<<1;if(this.defaultTextDirection!=xn.LTR&&!r)return[];let c=[],h=(p,g,k,w)=>{if(g-p<s)return;let A=this.state.selection.main,E=[A.from];A.empty||E.push(A.to);for(let D of E)if(D>p&&D<g){h(p,D-10,k,w),h(D+10,g,k,w);return}let j=Y3(e,D=>D.from>=k.from&&D.to<=k.to&&Math.abs(D.from-p)<s&&Math.abs(D.to-g)<s&&!E.some(U=>D.from<U&&D.to>U));if(!j){if(g<k.to&&t&&r&&t.visibleRanges.some(O=>O.from<=g&&O.to>=g)){let O=t.moveToLineBoundary(Le.cursor(g),!1,!0).head;O>p&&(g=O)}let D=this.gapSize(k,p,g,w),U=r||D<2e6?D:2e6;j=new tg(p,g,D,U)}c.push(j)},d=p=>{if(p.length<o||p.type!=kr.Text)return;let g=G3(p.from,p.to,this.stateDeco);if(g.total<o)return;let k=this.scrollTarget?this.scrollTarget.range.head:null,w,A;if(r){let E=a/this.heightOracle.lineLength*this.heightOracle.lineHeight,j,D;if(k!=null){let U=Tf(g,k),O=((this.visibleBottom-this.visibleTop)/2+E)/p.height;j=U-O,D=U+O}else j=(this.visibleTop-p.top-E)/p.height,D=(this.visibleBottom-p.top+E)/p.height;w=Af(g,j),A=Af(g,D)}else{let E=g.total*this.heightOracle.charWidth,j=a*this.heightOracle.charWidth,D=0;if(E>2e6)for(let H of e)H.from>=p.from&&H.from<p.to&&H.size!=H.displaySize&&H.from*this.heightOracle.charWidth+D<this.pixelViewport.left&&(D=H.size-H.displaySize);let U=this.pixelViewport.left+D,O=this.pixelViewport.right+D,J,ee;if(k!=null){let H=Tf(g,k),L=((O-U)/2+j)/E;J=H-L,ee=H+L}else J=(U-j)/E,ee=(O+j)/E;w=Af(g,J),A=Af(g,ee)}w>p.from&&h(p.from,w,p,g),A<p.to&&h(A,p.to,p,g)};for(let p of this.viewportLines)Array.isArray(p.type)?p.type.forEach(d):d(p);return c}gapSize(e,t,r,a){let s=Tf(a,r)-Tf(a,t);return this.heightOracle.lineWrapping?e.height*s:a.total*this.heightOracle.charWidth*s}updateLineGaps(e){tg.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=pn.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let r=[];Gt.spans(t,this.viewport.from,this.viewport.to,{span(s,o){r.push({from:s,to:o})},point(){}},20);let a=0;if(r.length!=this.visibleRanges.length)a=12;else for(let s=0;s<r.length&&!(a&8);s++){let o=this.visibleRanges[s],c=r[s];(o.from!=c.from||o.to!=c.to)&&(a|=4,e&&e.mapPos(o.from,-1)==c.from&&e.mapPos(o.to,1)==c.to||(a|=8))}return this.visibleRanges=r,a}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||yc(this.heightMap.lineAt(e,sn.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||yc(this.heightMap.lineAt(this.scaler.fromDOM(e),sn.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return yc(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Cf{constructor(e,t){this.from=e,this.to=t}}function G3(n,e,t){let r=[],a=n,s=0;return Gt.spans(t,n,e,{span(){},point(o,c){o>a&&(r.push({from:a,to:o}),s+=o-a),a=c}},20),a<e&&(r.push({from:a,to:e}),s+=e-a),{total:s,ranges:r}}function Af({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let r=Math.floor(n*t);for(let a=0;;a++){let{from:s,to:o}=e[a],c=o-s;if(r<=c)return s+r;r-=c}}function Tf(n,e){let t=0;for(let{from:r,to:a}of n.ranges){if(e<=a){t+=e-r;break}t+=a-r}return t/n.total}function Y3(n,e){for(let t of n)if(e(t))return t}const B1={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};function z1(n){let e=n.facet(Od).filter(r=>typeof r!="function"),t=n.facet(iy).filter(r=>typeof r!="function");return t.length&&e.push(Gt.join(t)),e}class sy{constructor(e,t,r){let a=0,s=0,o=0;this.viewports=r.map(({from:c,to:h})=>{let d=t.lineAt(c,sn.ByPos,e,0,0).top,p=t.lineAt(h,sn.ByPos,e,0,0).bottom;return a+=p-d,{from:c,to:h,top:d,bottom:p,domTop:0,domBottom:0}}),this.scale=(7e6-a)/(t.height-a);for(let c of this.viewports)c.domTop=o+(c.top-s)*this.scale,o=c.domBottom=c.domTop+(c.bottom-c.top),s=c.bottom}toDOM(e){for(let t=0,r=0,a=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return a+(e-r)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);r=s.bottom,a=s.domBottom}}fromDOM(e){for(let t=0,r=0,a=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return r+(e-a)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);r=s.bottom,a=s.domBottom}}eq(e){return e instanceof sy?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,r)=>t.from==e.viewports[r].from&&t.to==e.viewports[r].to):!1}}function yc(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),r=e.toDOM(n.bottom);return new wi(n.from,n.length,t,r-t,Array.isArray(n._content)?n._content.map(a=>yc(a,e)):n._content)}const Nf=ct.define({combine:n=>n.join(" ")}),c0=ct.define({combine:n=>n.indexOf(!0)>-1}),h0=Dl.newName(),BS=Dl.newName(),zS=Dl.newName(),IS={"&light":"."+BS,"&dark":"."+zS};function f0(n,e,t){return new Dl(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,a=>{if(a=="&")return n;if(!t||!t[a])throw new RangeError(`Unsupported selector: ${a}`);return t[a]}):n+" "+r}})}const $3=f0("."+h0,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},IS),Q3={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ng=Je.ie&&Je.ie_version<=11;class X3{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new NE,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let r of t)this.queue.push(r);(Je.ie&&Je.ie_version<=11||Je.ios&&e.composing)&&t.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&Je.android&&e.constructor.EDIT_CONTEXT!==!1&&!(Je.chrome&&Je.chrome_version<126)&&(this.editContext=new Z3(e),e.state.facet(Da)&&(e.contentDOM.editContext=this.editContext.editContext)),ng&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,a=this.selectionRange;if(r.state.facet(Da)?r.root.activeElement!=this.dom:!Sc(this.dom,a))return;let s=a.anchorNode&&r.docView.tile.nearest(a.anchorNode);if(s&&s.isWidget()&&s.widget.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(Je.ie&&Je.ie_version<=11||Je.android&&Je.chrome)&&!r.state.selection.main.empty&&a.focusNode&&Cc(a.focusNode,a.focusOffset,a.anchorNode,a.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Uo(e.root);if(!t)return!1;let r=Je.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&W3(this.view,t)||t;if(!r||this.selectionRange.eq(r))return!1;let a=Sc(this.dom,r);return a&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&ME(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),a&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(r.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=t)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Q3),ng&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),ng&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var r;if(!this.delayedAndroidKey){let a=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Lo(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(a)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,r=-1,a=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(a=!0),t==-1?{from:t,to:r}=o:(t=Math.min(o.from,t),r=Math.max(o.to,r)))}return{from:t,to:r,typeOver:a}}readChange(){let{from:e,to:t,typeOver:r}=this.processRecords(),a=this.selectionChanged&&Sc(this.dom,this.selectionRange);if(e<0&&!a)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new m3(this.view,e,t,r);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let r=this.view.state,a=AS(this.view,t);return this.view.state==r&&(t.domChanged||t.newSel&&!od(this.view.state.selection,t.newSel.main))&&this.view.update([]),a}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty(e.type=="attributes"),e.type=="childList"){let r=I1(t,e.previousSibling||e.target.previousSibling,-1),a=I1(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:a?t.posBefore(a):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Da)!=e.state.facet(Da)&&(e.view.contentDOM.editContext=e.state.facet(Da)?this.editContext.editContext:null))}destroy(){var e,t,r;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect();for(let a of this.scrollTargets)a.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function I1(n,e,t){for(;e;){let r=In.get(e);if(r&&r.parent==n)return r;let a=e.parentNode;e=a!=n.dom?a:t>0?e.nextSibling:e.previousSibling}return null}function P1(n,e){let t=e.startContainer,r=e.startOffset,a=e.endContainer,s=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor,1);return Cc(o.node,o.offset,a,s)&&([t,r,a,s]=[a,s,t,r]),{anchorNode:t,anchorOffset:r,focusNode:a,focusOffset:s}}function W3(n,e){if(e.getComposedRanges){let a=e.getComposedRanges(n.root)[0];if(a)return P1(n,a)}let t=null;function r(a){a.preventDefault(),a.stopImmediatePropagation(),t=a.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",r,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",r,!0),t?P1(n,t):null}class Z3{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=r=>{let a=e.state.selection.main,{anchor:s,head:o}=a,c=this.toEditorPos(r.updateRangeStart),h=this.toEditorPos(r.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:c,drifted:!1});let d=h-c>r.text.length;c==this.from&&s<this.from?c=s:h==this.to&&s>this.to&&(h=s);let p=TS(e.state.sliceDoc(c,h),r.text,(d?a.from:a.to)-c,d?"end":null);if(!p){let k=Le.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));od(k,a)||e.dispatch({selection:k,userEvent:"select"});return}let g={from:p.from+c,to:p.toA+c,insert:It.of(r.text.slice(p.from,p.toB).split(`
`))};if((Je.mac||Je.android)&&g.from==o-1&&/^\. ?$/.test(r.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(g={from:c,to:h,insert:It.of([r.text.replace("."," ")])}),this.pendingContextChange=g,!e.state.readOnly){let k=this.to-this.from+(g.to-g.from+g.insert.length);ay(e,g,Le.single(this.toEditorPos(r.selectionStart,k),this.toEditorPos(r.selectionEnd,k)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),g.from<g.to&&!g.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,r.updateRangeStart-1),Math.min(t.text.length,r.updateRangeStart+1)))&&this.handlers.compositionend(r)},this.handlers.characterboundsupdate=r=>{let a=[],s=null;for(let o=this.toEditorPos(r.rangeStart),c=this.toEditorPos(r.rangeEnd);o<c;o++){let h=e.coordsForChar(o);s=h&&new DOMRect(h.left,h.top,h.right-h.left,h.bottom-h.top)||s||new DOMRect,a.push(s)}t.updateCharacterBounds(r.rangeStart,a)},this.handlers.textformatupdate=r=>{let a=[];for(let s of r.getTextFormats()){let o=s.underlineStyle,c=s.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(c)){let h=this.toEditorPos(s.rangeStart),d=this.toEditorPos(s.rangeEnd);if(h<d){let p=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(c)?1:2}px`;a.push(pn.mark({attributes:{style:p}}).range(h,d))}}}e.dispatch({effects:pS.of(pn.set(a))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:r}=this.composing;this.composing=null,r&&this.reset(e.state)}};for(let r in this.handlers)t.addEventListener(r,this.handlers[r]);this.measureReq={read:r=>{this.editContext.updateControlBounds(r.contentDOM.getBoundingClientRect());let a=Uo(r.root);a&&a.rangeCount&&this.editContext.updateSelectionBounds(a.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,r=!1,a=this.pendingContextChange;return e.changes.iterChanges((s,o,c,h,d)=>{if(r)return;let p=d.length-(o-s);if(a&&o>=a.to)if(a.from==s&&a.to==o&&a.insert.eq(d)){a=this.pendingContextChange=null,t+=p,this.to+=p;return}else a=null,this.revertPending(e.state);if(s+=t,o+=t,o<=this.from)this.from+=p,this.to+=p;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+d.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),d.toString()),this.to+=p}t+=p}),a&&!r&&this.revertPending(e.state),!r}update(e){let t=this.pendingContextChange,r=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(r.from,r.to)&&e.transactions.some(a=>!a.isUserEvent("input.type")&&a.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),a=this.toContextPos(t.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=a)&&this.editContext.updateSelection(r,a)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let r=this.composing;return r&&r.drifted?r.editorBase+(e-r.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class lt{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:r}=e;this.dispatchTransactions=e.dispatchTransactions||r&&(a=>a.forEach(s=>r(s,this)))||(a=>this.update(a)),this.dispatch=this.dispatch.bind(this),this._root=e.root||EE(e.parent)||document,this.viewState=new L1(e.state||Ut.create(e)),e.scrollTo&&e.scrollTo.is(kf)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Mo).map(a=>new Xm(a));for(let a of this.plugins)a.update(this);this.observer=new X3(this),this.inputState=new v3(this),this.inputState.ensureHandlers(this.plugins),this.docView=new k1(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...e){let t=e.length==1&&e[0]instanceof Vn?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,r=!1,a,s=this.state;for(let k of e){if(k.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=k.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,c=0,h=null;e.some(k=>k.annotation(DS))?(this.inputState.notifiedFocused=o,c=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,h=OS(s,o),h||(c=1));let d=this.observer.delayedAndroidKey,p=null;if(d?(this.observer.clearDelayedAndroidKey(),p=this.observer.readChange(),(p&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(p=null)):this.observer.clear(),s.facet(Ut.phrases)!=this.state.facet(Ut.phrases))return this.setState(s);a=ad.create(this,s,e),a.flags|=c;let g=this.viewState.scrollTarget;try{this.updateState=2;for(let k of e){if(g&&(g=g.map(k.changes)),k.scrollIntoView){let{main:w}=k.state.selection;g=new Bo(w.empty?w:Le.cursor(w.head,w.head>w.anchor?-1:1))}for(let w of k.effects)w.is(kf)&&(g=w.value.clip(this.state))}this.viewState.update(a,g),this.bidiCache=cd.update(this.bidiCache,a.changes),a.empty||(this.updatePlugins(a),this.inputState.update(a)),t=this.docView.update(a),this.state.facet(mc)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(k=>k.isUserEvent("select.pointer")))}finally{this.updateState=0}if(a.startState.facet(Nf)!=a.state.facet(Nf)&&(this.viewState.mustMeasureContent=!0),(t||r||g||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!a.empty)for(let k of this.state.facet(a0))try{k(a)}catch(w){Zi(this.state,w,"update listener")}(h||p)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),p&&!AS(this,p)&&d.force&&Lo(this.contentDOM,d.key,d.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new L1(e),this.plugins=e.facet(Mo).map(r=>new Xm(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView.destroy(),this.docView=new k1(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Mo),r=e.state.facet(Mo);if(t!=r){let a=[];for(let s of r){let o=t.indexOf(s);if(o<0)a.push(new Xm(s));else{let c=this.plugins[o];c.mustUpdate=e,a.push(c)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=a,this.pluginMap.clear()}else for(let a of this.plugins)a.mustUpdate=e;for(let a=0;a<this.plugins.length;a++)this.plugins[a].update(this);t!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(r){Zi(this.state,r,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,r=this.scrollDOM,a=r.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(a-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let c=0;;c++){if(o<0)if(Ww(r))s=-1,o=this.viewState.heightMap.height;else{let w=this.viewState.scrollAnchorAt(a);s=w.from,o=w.top}this.updateState=1;let h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(c>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let d=[];h&4||([this.measureRequests,d]=[d,this.measureRequests]);let p=d.map(w=>{try{return w.read(this)}catch(A){return Zi(this.state,A),H1}}),g=ad.create(this,this.state,[]),k=!1;g.flags|=h,t?t.flags|=h:t=g,this.updateState=2,g.empty||(this.updatePlugins(g),this.inputState.update(g),this.updateAttrs(),k=this.docView.update(g),k&&this.docViewUpdate());for(let w=0;w<d.length;w++)if(p[w]!=H1)try{let A=d[w];A.write&&A.write(p[w],this)}catch(A){Zi(this.state,A)}if(k&&this.docView.updateSelection(!0),!g.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let A=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(A>1||A<-1){a=a+A,r.scrollTop=a/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let c of this.state.facet(a0))c(t)}get themeClasses(){return h0+" "+(this.state.facet(c0)?zS:BS)+" "+this.state.facet(Nf)}updateAttrs(){let e=q1(this,mS,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Da)?"true":"false",class:"cm-content",style:`${Je.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),q1(this,ry,t);let r=this.observer.ignore(()=>{let a=m1(this.contentDOM,this.contentAttrs,t),s=m1(this.dom,this.editorAttrs,e);return a||s});return this.editorAttrs=e,this.contentAttrs=t,r}showAnnouncements(e){let t=!0;for(let r of e)for(let a of r.effects)if(a.is(lt.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=a.value}}mountStyles(){this.styleModules=this.state.facet(mc);let e=this.state.facet(lt.cspNonce);Dl.mount(this.root,this.styleModules.concat($3).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(r=>r.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return eg(this,e,w1(this,e,t,r))}moveByGroup(e,t){return eg(this,e,w1(this,e,t,r=>c3(this,e.head,r)))}visualLineSide(e,t){let r=this.bidiSpans(e),a=this.textDirectionAt(e.from),s=r[t?r.length-1:0];return Le.cursor(s.side(t,a)+e.from,s.forward(!t,a)?1:-1)}moveToLineBoundary(e,t,r=!0){return u3(this,e,t,r)}moveVertically(e,t,r){return eg(this,e,h3(this,e,t,r))}domAtPos(e,t=1){return this.docView.domAtPos(e,t)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){this.readMeasured();let r=o0(this,e,t);return r&&r.pos}posAndSideAtCoords(e,t=!0){return this.readMeasured(),o0(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;let a=this.state.doc.lineAt(e),s=this.bidiSpans(a),o=s[Oa.find(s,e-a.from,-1,t)];return id(r,o.dir==xn.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(hS)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>J3)return rS(e.length);let t=this.textDirectionAt(e.from),r;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||nS(s.isolates,r=x1(this,e))))return s.order;r||(r=x1(this,e));let a=BE(e.text,t,r);return this.bidiCache.push(new cd(e.from,e.to,t,r,!0,a)),a}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Je.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Xw(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return kf.of(new Bo(typeof e=="number"?Le.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return kf.of(new Bo(Le.cursor(r.from),"start","start",r.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return hi.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return hi.define(()=>({}),{eventObservers:e})}static theme(e,t){let r=Dl.newName(),a=[Nf.of(r),mc.of(f0(`.${r}`,e))];return t&&t.dark&&a.push(c0.of(!0)),a}static baseTheme(e){return Yc.lowest(mc.of(f0("."+h0,e,IS)))}static findFromDOM(e){var t;let r=e.querySelector(".cm-content"),a=r&&In.get(r)||In.get(e);return((t=a?.root)===null||t===void 0?void 0:t.view)||null}}lt.styleModule=mc;lt.inputHandler=uS;lt.clipboardInputFilter=ty;lt.clipboardOutputFilter=ny;lt.scrollHandler=dS;lt.focusChangeEffect=cS;lt.perLineTextDirection=hS;lt.exceptionSink=oS;lt.updateListener=a0;lt.editable=Da;lt.mouseSelectionStyle=sS;lt.dragMovesSelection=lS;lt.clickAddsSelectionRange=aS;lt.decorations=Od;lt.blockWrappers=gS;lt.outerDecorations=iy;lt.atomicRanges=Xc;lt.bidiIsolatedRanges=yS;lt.scrollMargins=xS;lt.darkTheme=c0;lt.cspNonce=ct.define({combine:n=>n.length?n[0]:""});lt.contentAttributes=ry;lt.editorAttributes=mS;lt.lineWrapping=lt.contentAttributes.of({class:"cm-lineWrapping"});lt.announce=on.define();const J3=4096,H1={};class cd{constructor(e,t,r,a,s,o){this.from=e,this.to=t,this.dir=r,this.isolates=a,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let r=[],a=e.length?e[e.length-1].dir:xn.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==a&&!t.touchesRange(o.from,o.to)&&r.push(new cd(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return r}}function q1(n,e,t){for(let r=n.state.facet(e),a=r.length-1;a>=0;a--){let s=r[a],o=typeof s=="function"?s(n):s;o&&Z0(o,t)}return t}const e5=Je.mac?"mac":Je.windows?"win":Je.linux?"linux":"key";function t5(n,e){const t=n.split(/-(?!$)/);let r=t[t.length-1];r=="Space"&&(r=" ");let a,s,o,c;for(let h=0;h<t.length-1;++h){const d=t[h];if(/^(cmd|meta|m)$/i.test(d))c=!0;else if(/^a(lt)?$/i.test(d))a=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))o=!0;else if(/^mod$/i.test(d))e=="mac"?c=!0:s=!0;else throw new Error("Unrecognized modifier name: "+d)}return a&&(r="Alt-"+r),s&&(r="Ctrl-"+r),c&&(r="Meta-"+r),o&&(r="Shift-"+r),r}function Ef(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const n5=Yc.default(lt.domEventHandlers({keydown(n,e){return HS(PS(e.state),n,e,"editor")}})),hd=ct.define({enables:n5}),U1=new WeakMap;function PS(n){let e=n.facet(hd),t=U1.get(e);return t||U1.set(e,t=a5(e.reduce((r,a)=>r.concat(a),[]))),t}function r5(n,e,t){return HS(PS(n.state),e,n,t)}let Nl=null;const i5=4e3;function a5(n,e=e5){let t=Object.create(null),r=Object.create(null),a=(o,c)=>{let h=r[o];if(h==null)r[o]=c;else if(h!=c)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,c,h,d,p)=>{var g,k;let w=t[o]||(t[o]=Object.create(null)),A=c.split(/ (?!$)/).map(D=>t5(D,e));for(let D=1;D<A.length;D++){let U=A.slice(0,D).join(" ");a(U,!0),w[U]||(w[U]={preventDefault:!0,stopPropagation:!1,run:[O=>{let J=Nl={view:O,prefix:U,scope:o};return setTimeout(()=>{Nl==J&&(Nl=null)},i5),!0}]})}let E=A.join(" ");a(E,!1);let j=w[E]||(w[E]={preventDefault:!1,stopPropagation:!1,run:((k=(g=w._any)===null||g===void 0?void 0:g.run)===null||k===void 0?void 0:k.slice())||[]});h&&j.run.push(h),d&&(j.preventDefault=!0),p&&(j.stopPropagation=!0)};for(let o of n){let c=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let d of c){let p=t[d]||(t[d]=Object.create(null));p._any||(p._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:g}=o;for(let k in p)p[k].run.push(w=>g(w,d0))}let h=o[e]||o.key;if(h)for(let d of c)s(d,h,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(d,"Shift-"+h,o.shift,o.preventDefault,o.stopPropagation)}return t}let d0=null;function HS(n,e,t,r){d0=e;let a=vE(e),s=_w(a,0),o=Dw(s)==a.length&&a!=" ",c="",h=!1,d=!1,p=!1;Nl&&Nl.view==t&&Nl.scope==r&&(c=Nl.prefix+" ",ES.indexOf(e.keyCode)<0&&(d=!0,Nl=null));let g=new Set,k=j=>{if(j){for(let D of j.run)if(!g.has(D)&&(g.add(D),D(t)))return j.stopPropagation&&(p=!0),!0;j.preventDefault&&(j.stopPropagation&&(p=!0),d=!0)}return!1},w=n[r],A,E;return w&&(k(w[c+Ef(a,e,!o)])?h=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Je.windows&&e.ctrlKey&&e.altKey)&&!(Je.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(A=Ol[e.keyCode])&&A!=a?(k(w[c+Ef(A,e,!0)])||e.shiftKey&&(E=zc[e.keyCode])!=a&&E!=A&&k(w[c+Ef(E,e,!1)]))&&(h=!0):o&&e.shiftKey&&k(w[c+Ef(a,e,!0)])&&(h=!0),!h&&k(w._any)&&(h=!0)),d&&(h=!0),h&&p&&e.stopPropagation(),d0=null,h}class Wc{constructor(e,t,r,a,s){this.className=e,this.left=t,this.top=r,this.width=a,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,r){if(r.empty){let a=e.coordsAtPos(r.head,r.assoc||1);if(!a)return[];let s=qS(e);return[new Wc(t,a.left-s.left,a.top-s.top,null,a.bottom-a.top)]}else return l5(e,t,r)}}function qS(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==xn.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function V1(n,e,t,r){let a=n.coordsAtPos(e,t*2);if(!a)return r;let s=n.dom.getBoundingClientRect(),o=(a.top+a.bottom)/2,c=n.posAtCoords({x:s.left+1,y:o}),h=n.posAtCoords({x:s.right-1,y:o});return c==null||h==null?r:{from:Math.max(r.from,Math.min(c,h)),to:Math.min(r.to,Math.max(c,h))}}function l5(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let r=Math.max(t.from,n.viewport.from),a=Math.min(t.to,n.viewport.to),s=n.textDirection==xn.LTR,o=n.contentDOM,c=o.getBoundingClientRect(),h=qS(n),d=o.querySelector(".cm-line"),p=d&&window.getComputedStyle(d),g=c.left+(p?parseInt(p.paddingLeft)+Math.min(0,parseInt(p.textIndent)):0),k=c.right-(p?parseInt(p.paddingRight):0),w=s0(n,r,1),A=s0(n,a,-1),E=w.type==kr.Text?w:null,j=A.type==kr.Text?A:null;if(E&&(n.lineWrapping||w.widgetLineBreaks)&&(E=V1(n,r,1,E)),j&&(n.lineWrapping||A.widgetLineBreaks)&&(j=V1(n,a,-1,j)),E&&j&&E.from==j.from&&E.to==j.to)return U(O(t.from,t.to,E));{let ee=E?O(t.from,null,E):J(w,!1),H=j?O(null,t.to,j):J(A,!0),L=[];return(E||w).to<(j||A).from-(E&&j?1:0)||w.widgetLineBreaks>1&&ee.bottom+n.defaultLineHeight/2<H.top?L.push(D(g,ee.bottom,k,H.top)):ee.bottom<H.top&&n.elementAtHeight((ee.bottom+H.top)/2).type==kr.Text&&(ee.bottom=H.top=(ee.bottom+H.top)/2),U(ee).concat(L).concat(U(H))}function D(ee,H,L,me){return new Wc(e,ee-h.left,H-h.top,Math.max(0,L-ee),me-H)}function U({top:ee,bottom:H,horizontal:L}){let me=[];for(let he=0;he<L.length;he+=2)me.push(D(L[he],ee,L[he+1],H));return me}function O(ee,H,L){let me=1e9,he=-1e9,I=[];function te(ge,re,X,ve,Te){let Ee=n.coordsAtPos(ge,ge==L.to?-2:2),q=n.coordsAtPos(X,X==L.from?2:-2);!Ee||!q||(me=Math.min(Ee.top,q.top,me),he=Math.max(Ee.bottom,q.bottom,he),Te==xn.LTR?I.push(s&&re?g:Ee.left,s&&ve?k:q.right):I.push(!s&&ve?g:q.left,!s&&re?k:Ee.right))}let ne=ee??L.from,pe=H??L.to;for(let ge of n.visibleRanges)if(ge.to>ne&&ge.from<pe)for(let re=Math.max(ge.from,ne),X=Math.min(ge.to,pe);;){let ve=n.state.doc.lineAt(re);for(let Te of n.bidiSpans(ve)){let Ee=Te.from+ve.from,q=Te.to+ve.from;if(Ee>=X)break;q>re&&te(Math.max(Ee,re),ee==null&&Ee<=ne,Math.min(q,X),H==null&&q>=pe,Te.dir)}if(re=ve.to+1,re>=X)break}return I.length==0&&te(ne,ee==null,pe,H==null,n.textDirection),{top:me,bottom:he,horizontal:I}}function J(ee,H){let L=c.top+(H?ee.top:ee.bottom);return{top:L,bottom:L,horizontal:[]}}}function s5(n,e){return n.constructor==e.constructor&&n.eq(e)}class o5{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Yf)!=e.state.facet(Yf)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,r=e.facet(Yf);for(;t<r.length&&r[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,r)=>!s5(t,this.drawn[r]))){let t=this.dom.firstChild,r=0;for(let a of e)a.update&&t&&a.constructor&&this.drawn[r].constructor&&a.update(t,this.drawn[r])?(t=t.nextSibling,r++):this.dom.insertBefore(a.draw(),t);for(;t;){let a=t.nextSibling;t.remove(),t=a}this.drawn=e,Je.safari&&Je.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Yf=ct.define();function US(n){return[hi.define(e=>new o5(e,n)),Yf.of(n)]}const Hc=ct.define({combine(n){return Q0(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function u5(n={}){return[Hc.of(n),c5,h5,f5,fS.of(!0)]}function VS(n){return n.startState.facet(Hc)!=n.state.facet(Hc)}const c5=US({above:!0,markers(n){let{state:e}=n,t=e.facet(Hc),r=[];for(let a of e.selection.ranges){let s=a==e.selection.main;if(a.empty||t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",c=a.empty?a:Le.cursor(a.head,a.head>a.anchor?-1:1);for(let h of Wc.forRange(n,o,c))r.push(h)}}return r},update(n,e){n.transactions.some(r=>r.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=VS(n);return t&&F1(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){F1(e.state,n)},class:"cm-cursorLayer"});function F1(n,e){e.style.animationDuration=n.facet(Hc).cursorBlinkRate+"ms"}const h5=US({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Wc.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||VS(n)},class:"cm-selectionLayer"}),f5=Yc.highest(lt.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),K1=ct.define({combine(n){let e,t;for(let r of n)e=e||r.topContainer,t=t||r.bottomContainer;return{topContainer:e,bottomContainer:t}}});function FS(n,e){let t=n.plugin(KS),r=t?t.specs.indexOf(e):-1;return r>-1?t.panels[r]:null}const KS=hi.fromClass(class{constructor(n){this.input=n.state.facet(fd),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(K1);this.top=new Mf(n,!0,e.topContainer),this.bottom=new Mf(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(K1);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Mf(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Mf(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(fd);if(t!=this.input){let r=t.filter(h=>h),a=[],s=[],o=[],c=[];for(let h of r){let d=this.specs.indexOf(h),p;d<0?(p=h(n.view),c.push(p)):(p=this.panels[d],p.update&&p.update(n)),a.push(p),(p.top?s:o).push(p)}this.specs=r,this.panels=a,this.top.sync(s),this.bottom.sync(o);for(let h of c)h.dom.classList.add("cm-panel"),h.mount&&h.mount()}else for(let r of this.panels)r.update&&r.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>lt.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Mf{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=G1(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=G1(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function G1(n){let e=n.nextSibling;return n.remove(),e}const fd=ct.define({enables:KS});class Go extends Cs{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Go.prototype.elementClass="";Go.prototype.toDOM=void 0;Go.prototype.mapMode=Kr.TrackBefore;Go.prototype.startSide=Go.prototype.endSide=-1;Go.prototype.point=!0;const d5=1024;let p5=0;class rg{constructor(e,t){this.from=e,this.to=t}}class Dt{constructor(e={}){this.id=p5++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=di.match(e)),t=>{let r=e(t);return r===void 0?null:[this,r]}}}Dt.closedBy=new Dt({deserialize:n=>n.split(" ")});Dt.openedBy=new Dt({deserialize:n=>n.split(" ")});Dt.group=new Dt({deserialize:n=>n.split(" ")});Dt.isolate=new Dt({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});Dt.contextHash=new Dt({perNode:!0});Dt.lookAhead=new Dt({perNode:!0});Dt.mounted=new Dt({perNode:!0});class Tc{constructor(e,t,r,a=!1){this.tree=e,this.overlay=t,this.parser=r,this.bracketed=a}static get(e){return e&&e.props&&e.props[Dt.mounted.id]}}const m5=Object.create(null);class di{constructor(e,t,r,a=0){this.name=e,this.props=t,this.id=r,this.flags=a}static define(e){let t=e.props&&e.props.length?Object.create(null):m5,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),a=new di(e.name||"",t,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(a)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return a}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Dt.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let a of r.split(" "))t[a]=e[r];return r=>{for(let a=r.prop(Dt.group),s=-1;s<(a?a.length:0);s++){let o=t[s<0?r.name:a[s]];if(o)return o}}}}di.none=new di("",Object.create(null),0,8);const jf=new WeakMap,Y1=new WeakMap;var jn;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays",n[n.EnterBracketed=16]="EnterBracketed"})(jn||(jn={}));class sr{constructor(e,t,r,a,s){if(this.type=e,this.children=t,this.positions=r,this.length=a,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,c]of s)this.props[typeof o=="number"?o:o.id]=c}}toString(){let e=Tc.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let r of this.children){let a=r.toString();a&&(t&&(t+=","),t+=a)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new m0(this.topNode,e)}cursorAt(e,t=0,r=0){let a=jf.get(this)||this.topNode,s=new m0(a);return s.moveTo(e,t),jf.set(this,s._tree),s}get topNode(){return new ci(this,0,0,null)}resolve(e,t=0){let r=qc(jf.get(this)||this.topNode,e,t,!1);return jf.set(this,r),r}resolveInner(e,t=0){let r=qc(Y1.get(this)||this.topNode,e,t,!0);return Y1.set(this,r),r}resolveStack(e,t=0){return x5(this,e,t)}iterate(e){let{enter:t,leave:r,from:a=0,to:s=this.length}=e,o=e.mode||0,c=(o&jn.IncludeAnonymous)>0;for(let h=this.cursor(o|jn.IncludeAnonymous);;){let d=!1;if(h.from<=s&&h.to>=a&&(!c&&h.type.isAnonymous||t(h)!==!1)){if(h.firstChild())continue;d=!0}for(;d&&r&&(c||!h.type.isAnonymous)&&r(h),!h.nextSibling();){if(!h.parent())return;d=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:cy(di.none,this.children,this.positions,0,this.children.length,0,this.length,(t,r,a)=>new sr(this.type,t,r,a,this.propValues),e.makeTree||((t,r,a)=>new sr(di.none,t,r,a)))}static build(e){return v5(e)}}sr.empty=new sr(di.none,[],[],0);class oy{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new oy(this.buffer,this.index)}}class Ll{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return di.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],a=this.set.types[t],s=a.name;if(/\W/.test(s)&&!a.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,r,a,s){let{buffer:o}=this,c=-1;for(let h=e;h!=t&&!(GS(s,a,o[h+1],o[h+2])&&(c=h,r>0));h=o[h+3]);return c}slice(e,t,r){let a=this.buffer,s=new Uint16Array(t-e),o=0;for(let c=e,h=0;c<t;){s[h++]=a[c++],s[h++]=a[c++]-r;let d=s[h++]=a[c++]-r;s[h++]=a[c++]-e,o=Math.max(o,d)}return new Ll(s,o,this.set)}}function GS(n,e,t,r){switch(n){case-2:return t<e;case-1:return r>=e&&t<e;case 0:return t<e&&r>e;case 1:return t<=e&&r>e;case 2:return r>e;case 4:return!0}}function qc(n,e,t,r){for(var a;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!r&&n instanceof ci&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=r?0:jn.IgnoreOverlays;if(r)for(let o=n,c=o.parent;c;o=c,c=o.parent)o instanceof ci&&o.index<0&&((a=c.enter(e,t,s))===null||a===void 0?void 0:a.from)!=o.from&&(n=c);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class YS{cursor(e=0){return new m0(this,e)}getChild(e,t=null,r=null){let a=$1(this,e,t,r);return a.length?a[0]:null}getChildren(e,t=null,r=null){return $1(this,e,t,r)}resolve(e,t=0){return qc(this,e,t,!1)}resolveInner(e,t=0){return qc(this,e,t,!0)}matchContext(e){return p0(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let a=t.lastChild;if(!a||a.to!=t.to)break;a.type.isError&&a.from==a.to?(r=t,t=a.prevSibling):t=a}return r}get node(){return this}get next(){return this.parent}}class ci extends YS{constructor(e,t,r,a){super(),this._tree=e,this.from=t,this.index=r,this._parent=a}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,a,s=0){var o;for(let c=this;;){for(let{children:h,positions:d}=c._tree,p=t>0?h.length:-1;e!=p;e+=t){let g=h[e],k=d[e]+c.from;if(!(!(s&jn.EnterBracketed&&g instanceof sr&&((o=Tc.get(g))===null||o===void 0?void 0:o.overlay)===null&&(k>=r||k+g.length<=r))&&!GS(a,r,k,k+g.length))){if(g instanceof Ll){if(s&jn.ExcludeBuffers)continue;let w=g.findChild(0,g.buffer.length,t,r-k,a);if(w>-1)return new Ml(new g5(c,g,e,k),null,w)}else if(s&jn.IncludeAnonymous||!g.type.isAnonymous||uy(g)){let w;if(!(s&jn.IgnoreMounts)&&(w=Tc.get(g))&&!w.overlay)return new ci(w.tree,k,e,c);let A=new ci(g,k,e,c);return s&jn.IncludeAnonymous||!A.type.isAnonymous?A:A.nextChild(t<0?g.children.length-1:0,t,r,a,s)}}}if(s&jn.IncludeAnonymous||!c.type.isAnonymous||(c.index>=0?e=c.index+t:e=t<0?-1:c._parent._tree.children.length,c=c._parent,!c))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t,r=0){let a;if(!(r&jn.IgnoreOverlays)&&(a=Tc.get(this._tree))&&a.overlay){let s=e-this.from,o=r&jn.EnterBracketed&&a.bracketed;for(let{from:c,to:h}of a.overlay)if((t>0||o?c<=s:c<s)&&(t<0||o?h>=s:h>s))return new ci(a.tree,a.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function $1(n,e,t,r){let a=n.cursor(),s=[];if(!a.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=a.type.is(t),!a.nextSibling())return s}for(;;){if(r!=null&&a.type.is(r))return s;if(a.type.is(e)&&s.push(a.node),!a.nextSibling())return r==null?s:[]}}function p0(n,e,t=e.length-1){for(let r=n;t>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[t]&&e[t]!=r.name)return!1;t--}}return!0}class g5{constructor(e,t,r,a){this.parent=e,this.buffer=t,this.index=r,this.start=a}}class Ml extends YS{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:a}=this.context,s=a.findChild(this.index+4,a.buffer[this.index+3],e,t-this.context.start,r);return s<0?null:new Ml(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t,r=0){if(r&jn.ExcludeBuffers)return null;let{buffer:a}=this.context,s=a.findChild(this.index+4,a.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Ml(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Ml(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Ml(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,a=this.index+4,s=r.buffer[this.index+3];if(s>a){let o=r.buffer[this.index+1];e.push(r.slice(a,s,o)),t.push(0)}return new sr(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function $S(n){if(!n.length)return null;let e=0,t=n[0];for(let s=1;s<n.length;s++){let o=n[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let r=t instanceof ci&&t.index<0?null:t.parent,a=n.slice();return r?a[e]=r:a.splice(e,1),new y5(a,t)}class y5{constructor(e,t){this.heads=e,this.node=t}get next(){return $S(this.heads)}}function x5(n,e,t){let r=n.resolveInner(e,t),a=null;for(let s=r instanceof ci?r:r.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(a||(a=[r])).push(o.resolve(e,t)),s=o}else{let o=Tc.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let c=new ci(o.tree,o.overlay[0].from+s.from,-1,s);(a||(a=[r])).push(qc(c,e,t,!1))}}return a?$S(a):r}class m0{get name(){return this.type.name}constructor(e,t=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=t&~jn.EnterBracketed,e instanceof ci)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:r,buffer:a}=this.buffer;return this.type=t||a.set.types[a.buffer[e]],this.from=r+a.buffer[e+1],this.to=r+a.buffer[e+2],!0}yield(e){return e?e instanceof ci?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:a}=this.buffer,s=a.findChild(this.index+4,a.buffer[this.index+3],e,t-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?r&jn.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&jn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&jn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let a=r<0?0:this.stack[r]+4;if(this.index!=a)return this.yieldBuf(t.findChild(a,this.index,-1,0,4))}else{let a=t.buffer[this.index+3];if(a<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(a)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:a}=this;if(a){if(e>0){if(this.index<a.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(a.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:r}=a)}else({index:t,_parent:r}=this._tree);for(;r;{index:t,_parent:r}=r)if(t>-1)for(let s=t+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let c=r._tree.children[s];if(this.mode&jn.IncludeAnonymous||c instanceof Ll||!c.type.isAnonymous||uy(c))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let a=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==a){if(a==this.index)return o;t=o,r=s+1;break e}a=this.stack[--s]}for(let a=r;a<this.stack.length;a++)t=new Ml(this.buffer,t,this.stack[a]);return this.bufferNode=new Ml(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let a=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(a=!0)}for(;;){if(a&&t&&t(this),a=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,a=!0}}}matchContext(e){if(!this.buffer)return p0(this.node.parent,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let a=e.length-1,s=this.stack.length-1;a>=0;s--){if(s<0)return p0(this._tree,e,a);let o=r[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[a]&&e[a]!=o.name)return!1;a--}}return!0}}function uy(n){return n.children.some(e=>e instanceof Ll||!e.type.isAnonymous||uy(e))}function v5(n){var e;let{buffer:t,nodeSet:r,maxBufferLength:a=d5,reused:s=[],minRepeatType:o=r.types.length}=n,c=Array.isArray(t)?new oy(t,t.length):t,h=r.types,d=0,p=0;function g(ee,H,L,me,he,I){let{id:te,start:ne,end:pe,size:ge}=c,re=p,X=d;if(ge<0)if(c.next(),ge==-1){let ye=s[te];L.push(ye),me.push(ne-ee);return}else if(ge==-3){d=te;return}else if(ge==-4){p=te;return}else throw new RangeError(`Unrecognized record size: ${ge}`);let ve=h[te],Te,Ee,q=ne-ee;if(pe-ne<=a&&(Ee=j(c.pos-H,he))){let ye=new Uint16Array(Ee.size-Ee.skip),Ce=c.pos-Ee.size,B=ye.length;for(;c.pos>Ce;)B=D(Ee.start,ye,B);Te=new Ll(ye,pe-Ee.start,r),q=Ee.start-ee}else{let ye=c.pos-ge;c.next();let Ce=[],B=[],$e=te>=o?te:-1,rt=0,Qe=pe;for(;c.pos>ye;)$e>=0&&c.id==$e&&c.size>=0?(c.end<=Qe-a&&(A(Ce,B,ne,rt,c.end,Qe,$e,re,X),rt=Ce.length,Qe=c.end),c.next()):I>2500?k(ne,ye,Ce,B):g(ne,ye,Ce,B,$e,I+1);if($e>=0&&rt>0&&rt<Ce.length&&A(Ce,B,ne,rt,ne,Qe,$e,re,X),Ce.reverse(),B.reverse(),$e>-1&&rt>0){let wt=w(ve,X);Te=cy(ve,Ce,B,0,Ce.length,0,pe-ne,wt,wt)}else Te=E(ve,Ce,B,pe-ne,re-pe,X)}L.push(Te),me.push(q)}function k(ee,H,L,me){let he=[],I=0,te=-1;for(;c.pos>H;){let{id:ne,start:pe,end:ge,size:re}=c;if(re>4)c.next();else{if(te>-1&&pe<te)break;te<0&&(te=ge-a),he.push(ne,pe,ge),I++,c.next()}}if(I){let ne=new Uint16Array(I*4),pe=he[he.length-2];for(let ge=he.length-3,re=0;ge>=0;ge-=3)ne[re++]=he[ge],ne[re++]=he[ge+1]-pe,ne[re++]=he[ge+2]-pe,ne[re++]=re;L.push(new Ll(ne,he[2]-pe,r)),me.push(pe-ee)}}function w(ee,H){return(L,me,he)=>{let I=0,te=L.length-1,ne,pe;if(te>=0&&(ne=L[te])instanceof sr){if(!te&&ne.type==ee&&ne.length==he)return ne;(pe=ne.prop(Dt.lookAhead))&&(I=me[te]+ne.length+pe)}return E(ee,L,me,he,I,H)}}function A(ee,H,L,me,he,I,te,ne,pe){let ge=[],re=[];for(;ee.length>me;)ge.push(ee.pop()),re.push(H.pop()+L-he);ee.push(E(r.types[te],ge,re,I-he,ne-I,pe)),H.push(he-L)}function E(ee,H,L,me,he,I,te){if(I){let ne=[Dt.contextHash,I];te=te?[ne].concat(te):[ne]}if(he>25){let ne=[Dt.lookAhead,he];te=te?[ne].concat(te):[ne]}return new sr(ee,H,L,me,te)}function j(ee,H){let L=c.fork(),me=0,he=0,I=0,te=L.end-a,ne={size:0,start:0,skip:0};e:for(let pe=L.pos-ee;L.pos>pe;){let ge=L.size;if(L.id==H&&ge>=0){ne.size=me,ne.start=he,ne.skip=I,I+=4,me+=4,L.next();continue}let re=L.pos-ge;if(ge<0||re<pe||L.start<te)break;let X=L.id>=o?4:0,ve=L.start;for(L.next();L.pos>re;){if(L.size<0)if(L.size==-3||L.size==-4)X+=4;else break e;else L.id>=o&&(X+=4);L.next()}he=ve,me+=ge,I+=X}return(H<0||me==ee)&&(ne.size=me,ne.start=he,ne.skip=I),ne.size>4?ne:void 0}function D(ee,H,L){let{id:me,start:he,end:I,size:te}=c;if(c.next(),te>=0&&me<o){let ne=L;if(te>4){let pe=c.pos-(te-4);for(;c.pos>pe;)L=D(ee,H,L)}H[--L]=ne,H[--L]=I-ee,H[--L]=he-ee,H[--L]=me}else te==-3?d=me:te==-4&&(p=me);return L}let U=[],O=[];for(;c.pos>0;)g(n.start||0,n.bufferStart||0,U,O,-1,0);let J=(e=n.length)!==null&&e!==void 0?e:U.length?O[0]+U[0].length:0;return new sr(h[n.topID],U.reverse(),O.reverse(),J)}const Q1=new WeakMap;function $f(n,e){if(!n.isAnonymous||e instanceof Ll||e.type!=n)return 1;let t=Q1.get(e);if(t==null){t=1;for(let r of e.children){if(r.type!=n||!(r instanceof sr)){t=1;break}t+=$f(n,r)}Q1.set(e,t)}return t}function cy(n,e,t,r,a,s,o,c,h){let d=0;for(let A=r;A<a;A++)d+=$f(n,e[A]);let p=Math.ceil(d*1.5/8),g=[],k=[];function w(A,E,j,D,U){for(let O=j;O<D;){let J=O,ee=E[O],H=$f(n,A[O]);for(O++;O<D;O++){let L=$f(n,A[O]);if(H+L>=p)break;H+=L}if(O==J+1){if(H>p){let L=A[J];w(L.children,L.positions,0,L.children.length,E[J]+U);continue}g.push(A[J])}else{let L=E[O-1]+A[O-1].length-ee;g.push(cy(n,A,E,J,O,ee,L,null,h))}k.push(ee+U-s)}}return w(e,t,r,a,0),(c||h)(g,k,o)}class Ss{constructor(e,t,r,a,s=!1,o=!1){this.from=e,this.to=t,this.tree=r,this.offset=a,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],r=!1){let a=[new Ss(0,e.length,e,0,!1,r)];for(let s of t)s.to>e.length&&a.push(s);return a}static applyChanges(e,t,r=128){if(!t.length)return e;let a=[],s=1,o=e.length?e[0]:null;for(let c=0,h=0,d=0;;c++){let p=c<t.length?t[c]:null,g=p?p.fromA:1e9;if(g-h>=r)for(;o&&o.from<g;){let k=o;if(h>=k.from||g<=k.to||d){let w=Math.max(k.from,h)-d,A=Math.min(k.to,g)-d;k=w>=A?null:new Ss(w,A,k.tree,k.offset+d,c>0,!!p)}if(k&&a.push(k),o.to>g)break;o=s<e.length?e[s++]:null}if(!p)break;h=p.toA,d=p.toA-p.toB}return a}}class b5{startParse(e,t,r){return typeof e=="string"&&(e=new k5(e)),r=r?r.length?r.map(a=>new rg(a.from,a.to)):[new rg(0,0)]:[new rg(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let a=this.startParse(e,t,r);for(;;){let s=a.advance();if(s)return s}}}class k5{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Dt({perNode:!0});let w5=0;class li{constructor(e,t,r,a){this.name=e,this.set=t,this.base=r,this.modified=a,this.id=w5++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let r=typeof e=="string"?e:"?";if(e instanceof li&&(t=e),t?.base)throw new Error("Can not derive from a modified tag");let a=new li(r,[],null,[]);if(a.set.push(a),t)for(let s of t.set)a.set.push(s);return a}static defineModifier(e){let t=new dd(e);return r=>r.modified.indexOf(t)>-1?r:dd.get(r.base||r,r.modified.concat(t).sort((a,s)=>a.id-s.id))}}let S5=0;class dd{constructor(e){this.name=e,this.instances=[],this.id=S5++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(c=>c.base==e&&C5(t,c.modified));if(r)return r;let a=[],s=new li(e.name,a,e,t);for(let c of t)c.instances.push(s);let o=A5(t);for(let c of e.set)if(!c.modified.length)for(let h of o)a.push(dd.get(c,h));return s}}function C5(n,e){return n.length==e.length&&n.every((t,r)=>t==e[r])}function A5(n){let e=[[]];for(let t=0;t<n.length;t++)for(let r=0,a=e.length;r<a;r++)e.push(e[r].concat(n[t]));return e.sort((t,r)=>r.length-t.length)}function T5(n){let e=Object.create(null);for(let t in n){let r=n[t];Array.isArray(r)||(r=[r]);for(let a of t.split(" "))if(a){let s=[],o=2,c=a;for(let g=0;;){if(c=="..."&&g>0&&g+3==a.length){o=1;break}let k=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(c);if(!k)throw new RangeError("Invalid path: "+a);if(s.push(k[0]=="*"?"":k[0][0]=='"'?JSON.parse(k[0]):k[0]),g+=k[0].length,g==a.length)break;let w=a[g++];if(g==a.length&&w=="!"){o=0;break}if(w!="/")throw new RangeError("Invalid path: "+a);c=a.slice(g)}let h=s.length-1,d=s[h];if(!d)throw new RangeError("Invalid path: "+a);let p=new Uc(r,o,h>0?s.slice(0,h):null);e[d]=p.sort(e[d])}}return QS.add(e)}const QS=new Dt({combine(n,e){let t,r,a;for(;n||e;){if(!n||e&&n.depth>=e.depth?(a=e,e=e.next):(a=n,n=n.next),t&&t.mode==a.mode&&!a.context&&!t.context)continue;let s=new Uc(a.tags,a.mode,a.context);t?t.next=s:r=s,t=s}return r}});class Uc{constructor(e,t,r,a){this.tags=e,this.mode=t,this.context=r,this.next=a}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Uc.empty=new Uc([],2,null);function XS(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:r,all:a=null}=e||{};return{style:s=>{let o=a;for(let c of s)for(let h of c.set){let d=t[h.id];if(d){o=o?o+" "+d:d;break}}return o},scope:r}}function N5(n,e){let t=null;for(let r of n){let a=r.style(e);a&&(t=t?t+" "+a:a)}return t}function E5(n,e,t,r=0,a=n.length){let s=new M5(r,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),r,a,"",s.highlighters),s.flush(a)}class M5{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,a,s){let{type:o,from:c,to:h}=e;if(c>=r||h<=t)return;o.isTop&&(s=this.highlighters.filter(w=>!w.scope||w.scope(o)));let d=a,p=j5(e)||Uc.empty,g=N5(s,p.tags);if(g&&(d&&(d+=" "),d+=g,p.mode==1&&(a+=(a?" ":"")+g)),this.startSpan(Math.max(t,c),d),p.opaque)return;let k=e.tree&&e.tree.prop(Dt.mounted);if(k&&k.overlay){let w=e.node.enter(k.overlay[0].from+c,1),A=this.highlighters.filter(j=>!j.scope||j.scope(k.tree.type)),E=e.firstChild();for(let j=0,D=c;;j++){let U=j<k.overlay.length?k.overlay[j]:null,O=U?U.from+c:h,J=Math.max(t,D),ee=Math.min(r,O);if(J<ee&&E)for(;e.from<ee&&(this.highlightRange(e,J,ee,a,s),this.startSpan(Math.min(ee,e.to),d),!(e.to>=O||!e.nextSibling())););if(!U||O>r)break;D=U.to+c,D>t&&(this.highlightRange(w.cursor(),Math.max(t,U.from+c),Math.min(r,D),"",A),this.startSpan(Math.min(r,D),d))}E&&e.parent()}else if(e.firstChild()){k&&(a="");do if(!(e.to<=t)){if(e.from>=r)break;this.highlightRange(e,t,r,a,s),this.startSpan(Math.min(r,e.to),d)}while(e.nextSibling());e.parent()}}}function j5(n){let e=n.type.prop(QS);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const Ge=li.define,_f=Ge(),Sl=Ge(),X1=Ge(Sl),W1=Ge(Sl),Cl=Ge(),Df=Ge(Cl),ig=Ge(Cl),Yi=Ge(),gs=Ge(Yi),Ki=Ge(),Gi=Ge(),g0=Ge(),oc=Ge(g0),Of=Ge(),Ie={comment:_f,lineComment:Ge(_f),blockComment:Ge(_f),docComment:Ge(_f),name:Sl,variableName:Ge(Sl),typeName:X1,tagName:Ge(X1),propertyName:W1,attributeName:Ge(W1),className:Ge(Sl),labelName:Ge(Sl),namespace:Ge(Sl),macroName:Ge(Sl),literal:Cl,string:Df,docString:Ge(Df),character:Ge(Df),attributeValue:Ge(Df),number:ig,integer:Ge(ig),float:Ge(ig),bool:Ge(Cl),regexp:Ge(Cl),escape:Ge(Cl),color:Ge(Cl),url:Ge(Cl),keyword:Ki,self:Ge(Ki),null:Ge(Ki),atom:Ge(Ki),unit:Ge(Ki),modifier:Ge(Ki),operatorKeyword:Ge(Ki),controlKeyword:Ge(Ki),definitionKeyword:Ge(Ki),moduleKeyword:Ge(Ki),operator:Gi,derefOperator:Ge(Gi),arithmeticOperator:Ge(Gi),logicOperator:Ge(Gi),bitwiseOperator:Ge(Gi),compareOperator:Ge(Gi),updateOperator:Ge(Gi),definitionOperator:Ge(Gi),typeOperator:Ge(Gi),controlOperator:Ge(Gi),punctuation:g0,separator:Ge(g0),bracket:oc,angleBracket:Ge(oc),squareBracket:Ge(oc),paren:Ge(oc),brace:Ge(oc),content:Yi,heading:gs,heading1:Ge(gs),heading2:Ge(gs),heading3:Ge(gs),heading4:Ge(gs),heading5:Ge(gs),heading6:Ge(gs),contentSeparator:Ge(Yi),list:Ge(Yi),quote:Ge(Yi),emphasis:Ge(Yi),strong:Ge(Yi),link:Ge(Yi),monospace:Ge(Yi),strikethrough:Ge(Yi),inserted:Ge(),deleted:Ge(),changed:Ge(),invalid:Ge(),meta:Of,documentMeta:Ge(Of),annotation:Ge(Of),processingInstruction:Ge(Of),definition:li.defineModifier("definition"),constant:li.defineModifier("constant"),function:li.defineModifier("function"),standard:li.defineModifier("standard"),local:li.defineModifier("local"),special:li.defineModifier("special")};for(let n in Ie){let e=Ie[n];e instanceof li&&(e.name=n)}XS([{tag:Ie.link,class:"tok-link"},{tag:Ie.heading,class:"tok-heading"},{tag:Ie.emphasis,class:"tok-emphasis"},{tag:Ie.strong,class:"tok-strong"},{tag:Ie.keyword,class:"tok-keyword"},{tag:Ie.atom,class:"tok-atom"},{tag:Ie.bool,class:"tok-bool"},{tag:Ie.url,class:"tok-url"},{tag:Ie.labelName,class:"tok-labelName"},{tag:Ie.inserted,class:"tok-inserted"},{tag:Ie.deleted,class:"tok-deleted"},{tag:Ie.literal,class:"tok-literal"},{tag:Ie.string,class:"tok-string"},{tag:Ie.number,class:"tok-number"},{tag:[Ie.regexp,Ie.escape,Ie.special(Ie.string)],class:"tok-string2"},{tag:Ie.variableName,class:"tok-variableName"},{tag:Ie.local(Ie.variableName),class:"tok-variableName tok-local"},{tag:Ie.definition(Ie.variableName),class:"tok-variableName tok-definition"},{tag:Ie.special(Ie.variableName),class:"tok-variableName2"},{tag:Ie.definition(Ie.propertyName),class:"tok-propertyName tok-definition"},{tag:Ie.typeName,class:"tok-typeName"},{tag:Ie.namespace,class:"tok-namespace"},{tag:Ie.className,class:"tok-className"},{tag:Ie.macroName,class:"tok-macroName"},{tag:Ie.propertyName,class:"tok-propertyName"},{tag:Ie.operator,class:"tok-operator"},{tag:Ie.comment,class:"tok-comment"},{tag:Ie.meta,class:"tok-meta"},{tag:Ie.invalid,class:"tok-invalid"},{tag:Ie.punctuation,class:"tok-punctuation"}]);var ag;const xc=new Dt,_5=new Dt;class Ji{constructor(e,t,r=[],a=""){this.data=e,this.name=a,Ut.prototype.hasOwnProperty("tree")||Object.defineProperty(Ut.prototype,"tree",{get(){return na(this)}}),this.parser=t,this.extension=[$o.of(this),Ut.languageData.of((s,o,c)=>{let h=Z1(s,o,c),d=h.type.prop(xc);if(!d)return[];let p=s.facet(d),g=h.type.prop(_5);if(g){let k=h.resolve(o-h.from,c);for(let w of g)if(w.test(k,s)){let A=s.facet(w.facet);return w.type=="replace"?A:A.concat(p)}}return p})].concat(r)}isActiveAt(e,t,r=-1){return Z1(e,t,r).type.prop(xc)==this.data}findRegions(e){let t=e.facet($o);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let r=[],a=(s,o)=>{if(s.prop(xc)==this.data){r.push({from:o,to:o+s.length});return}let c=s.prop(Dt.mounted);if(c){if(c.tree.prop(xc)==this.data){if(c.overlay)for(let h of c.overlay)r.push({from:h.from+o,to:h.to+o});else r.push({from:o,to:o+s.length});return}else if(c.overlay){let h=r.length;if(a(c.tree,c.overlay[0].from+o),r.length>h)return}}for(let h=0;h<s.children.length;h++){let d=s.children[h];d instanceof sr&&a(d,s.positions[h]+o)}};return a(na(e),0),r}get allowsNesting(){return!0}}Ji.setState=on.define();function Z1(n,e,t){let r=n.facet($o),a=na(n).topNode;if(!r||r.allowsNesting)for(let s=a;s;s=s.enter(e,t,jn.ExcludeBuffers|jn.EnterBracketed))s.type.isTop&&(a=s);return a}function na(n){let e=n.field(Ji.state,!1);return e?e.tree:sr.empty}class D5{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let uc=null;class pd{constructor(e,t,r=[],a,s,o,c,h){this.parser=e,this.state=t,this.fragments=r,this.tree=a,this.treeLen=s,this.viewport=o,this.skipped=c,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new pd(e,t,[],sr.empty,0,r,[],null)}startParse(){return this.parser.startParse(new D5(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=sr.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let a=Date.now()+e;e=()=>Date.now()>a}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let a=this.parse.advance();if(a)if(this.fragments=this.withoutTempSkipped(Ss.addTree(a,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=a,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Ss.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=uc;uc=this;try{return e()}finally{uc=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=J1(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:a,treeLen:s,viewport:o,skipped:c}=this;if(this.takeTree(),!e.empty){let h=[];if(e.iterChangedRanges((d,p,g,k)=>h.push({fromA:d,toA:p,fromB:g,toB:k})),r=Ss.applyChanges(r,h),a=sr.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){c=[];for(let d of this.skipped){let p=e.mapPos(d.from,1),g=e.mapPos(d.to,-1);p<g&&c.push({from:p,to:g})}}}return new pd(this.parser,t,r,a,s,o,c,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:a,to:s}=this.skipped[r];a<e.to&&s>e.from&&(this.fragments=J1(this.fragments,a,s),this.skipped.splice(r--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends b5{createParse(t,r,a){let s=a[0].from,o=a[a.length-1].to;return{parsedPos:s,advance(){let h=uc;if(h){for(let d of a)h.tempSkipped.push(d);e&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,e]):e)}return this.parsedPos=o,new sr(di.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return uc}}function J1(n,e,t){return Ss.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Yo{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new Yo(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=pd.create(e.facet($o).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new Yo(r)}}Ji.state=Ni.define({create:Yo.init,update(n,e){for(let t of e.effects)if(t.is(Ji.setState))return t.value;return e.startState.facet($o)!=e.state.facet($o)?Yo.init(e.state):n.apply(e)}});let WS=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(WS=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const lg=typeof navigator<"u"&&(!((ag=navigator.scheduling)===null||ag===void 0)&&ag.isInputPending)?()=>navigator.scheduling.isInputPending():null,O5=hi.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Ji.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Ji.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=WS(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:a}}=this.view,s=r.field(Ji.state);if(s.tree==s.context.tree&&s.context.isDone(a+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!lg?Math.max(25,e.timeRemaining()-5):1e9),c=s.context.treeLen<a&&r.doc.length>a+1e3,h=s.context.work(()=>lg&&lg()||Date.now()>o,a+(c?0:1e5));this.chunkBudget-=Date.now()-t,(h||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Ji.setState.of(new Yo(s.context))})),this.chunkBudget>0&&!(h&&!c)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Zi(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),$o=ct.define({combine(n){return n.length?n[0]:null},enables:n=>[Ji.state,O5,lt.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]}),R5=ct.define(),hy=ct.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function md(n){let e=n.facet(hy);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function gd(n,e){let t="",r=n.tabSize,a=n.facet(hy)[0];if(a=="	"){for(;e>=r;)t+="	",e-=r;a=" "}for(let s=0;s<e;s++)t+=a;return t}function ZS(n,e){n instanceof Ut&&(n=new zd(n));for(let r of n.state.facet(R5)){let a=r(n,e);if(a!==void 0)return a}let t=na(n.state);return t.length>=e?B5(n,t,e):null}class zd{constructor(e,t={}){this.state=e,this.options=t,this.unit=md(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:a,simulateDoubleBreak:s}=this.options;return a!=null&&a>=r.from&&a<=r.to?s&&a==e?{text:"",from:e}:(t<0?a<e:a<=e)?{text:r.text.slice(a-r.from),from:a}:{text:r.text.slice(0,a-r.from),from:r.from}:r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:a}=this.lineAt(e,t);return r.slice(e-a,Math.min(r.length,e+100-a))}column(e,t=1){let{text:r,from:a}=this.lineAt(e,t),s=this.countColumn(r,e-a),o=this.options.overrideIndentation?this.options.overrideIndentation(a):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,t=e.length){return jd(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:a}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(a);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const L5=new Dt;function B5(n,e,t){let r=e.resolveStack(t),a=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(a!=r.node){let s=[];for(let o=a;o&&!(o.from<r.node.from||o.to>r.node.to||o.from==r.node.from&&o.type==r.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)r={node:s[o],next:r}}return JS(r,n,t)}function JS(n,e,t){for(let r=n;r;r=r.next){let a=I5(r.node);if(a)return a(fy.create(e,t,r))}return 0}function z5(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function I5(n){let e=n.type.prop(L5);if(e)return e;let t=n.firstChild,r;if(t&&(r=t.type.prop(Dt.closedBy))){let a=n.lastChild,s=a&&r.indexOf(a.name)>-1;return o=>U5(o,!0,1,void 0,s&&!z5(o)?a.from:void 0)}return n.parent==null?P5:null}function P5(){return 0}class fy extends zd{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.context=r}get node(){return this.context.node}static create(e,t,r){return new fy(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(t.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(H5(r,e))break;t=this.state.doc.lineAt(r.from)}return this.lineIndent(t.from)}continue(){return JS(this.context.next,this.base,this.pos)}}function H5(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function q5(n){let e=n.node,t=e.childAfter(e.from),r=e.lastChild;if(!t)return null;let a=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=a==null||a<=s.from?s.to:Math.min(s.to,a);for(let c=t.to;;){let h=e.childAfter(c);if(!h||h==r)return null;if(!h.type.isSkipped){if(h.from>=o)return null;let d=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+d}}c=h.to}}function U5(n,e,t,r,a){let s=n.textAfter,o=s.match(/^\s*/)[0].length,c=r&&s.slice(o,o+r.length)==r||a==n.pos+o,h=q5(n);return h?c?n.column(h.from):n.column(h.to):n.baseIndent+(c?0:n.unit*t)}class Id{constructor(e,t){this.specs=e;let r;function a(c){let h=Dl.newName();return(r||(r=Object.create(null)))["."+h]=c,h}const s=typeof t.all=="string"?t.all:t.all?a(t.all):void 0,o=t.scope;this.scope=o instanceof Ji?c=>c.prop(xc)==o.data:o?c=>c==o:void 0,this.style=XS(e.map(c=>({tag:c.tag,class:c.class||a(Object.assign({},c,{tag:null}))})),{all:s}).style,this.module=r?new Dl(r):null,this.themeType=t.themeType}static define(e,t){return new Id(e,t||{})}}const y0=ct.define(),V5=ct.define({combine(n){return n.length?[n[0]]:null}});function sg(n){let e=n.facet(y0);return e.length?e:n.facet(V5)}function F5(n,e){let t=[G5],r;return n instanceof Id&&(n.module&&t.push(lt.styleModule.of(n.module)),r=n.themeType),r?t.push(y0.computeN([lt.darkTheme],a=>a.facet(lt.darkTheme)==(r=="dark")?[n]:[])):t.push(y0.of(n)),t}class K5{constructor(e){this.markCache=Object.create(null),this.tree=na(e.state),this.decorations=this.buildDeco(e,sg(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=na(e.state),r=sg(e.state),a=r!=sg(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!a&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||a)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return pn.none;let r=new qo;for(let{from:a,to:s}of e.visibleRanges)E5(this.tree,t,(o,c,h)=>{r.add(o,c,this.markCache[h]||(this.markCache[h]=pn.mark({class:h})))},a,s);return r.finish()}}const G5=Yc.high(hi.fromClass(K5,{decorations:n=>n.decorations})),Y5=1e4,$5="()[]{}",Q5=new Dt;function x0(n,e,t){let r=n.prop(e<0?Dt.openedBy:Dt.closedBy);if(r)return r;if(n.name.length==1){let a=t.indexOf(n.name);if(a>-1&&a%2==(e<0?1:0))return[t[a+e]]}return null}function v0(n){let e=n.type.prop(Q5);return e?e(n.node):n}function jo(n,e,t,r={}){let a=r.maxScanDistance||Y5,s=r.brackets||$5,o=na(n),c=o.resolveInner(e,t);for(let h=c;h;h=h.parent){let d=x0(h.type,t,s);if(d&&h.from<h.to){let p=v0(h);if(p&&(t>0?e>=p.from&&e<p.to:e>p.from&&e<=p.to))return X5(n,e,t,h,p,d,s)}}return W5(n,e,t,o,c.type,a,s)}function X5(n,e,t,r,a,s,o){let c=r.parent,h={from:a.from,to:a.to},d=0,p=c?.cursor();if(p&&(t<0?p.childBefore(r.from):p.childAfter(r.to)))do if(t<0?p.to<=r.from:p.from>=r.to){if(d==0&&s.indexOf(p.type.name)>-1&&p.from<p.to){let g=v0(p);return{start:h,end:g?{from:g.from,to:g.to}:void 0,matched:!0}}else if(x0(p.type,t,o))d++;else if(x0(p.type,-t,o)){if(d==0){let g=v0(p);return{start:h,end:g&&g.from<g.to?{from:g.from,to:g.to}:void 0,matched:!1}}d--}}while(t<0?p.prevSibling():p.nextSibling());return{start:h,matched:!1}}function W5(n,e,t,r,a,s,o){let c=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),h=o.indexOf(c);if(h<0||h%2==0!=t>0)return null;let d={from:t<0?e-1:e,to:t>0?e+1:e},p=n.doc.iterRange(e,t>0?n.doc.length:0),g=0;for(let k=0;!p.next().done&&k<=s;){let w=p.value;t<0&&(k+=w.length);let A=e+k*t;for(let E=t>0?0:w.length-1,j=t>0?w.length:-1;E!=j;E+=t){let D=o.indexOf(w[E]);if(!(D<0||r.resolveInner(A+E,1).type!=a))if(D%2==0==t>0)g++;else{if(g==1)return{start:d,end:{from:A+E,to:A+E+1},matched:D>>1==h>>1};g--}}t>0&&(k+=w.length)}return p.done?{start:d,matched:!1}:null}const Z5=Object.create(null),ek=[di.none],tk=[],nk=Object.create(null),J5=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])J5[n]=eM(Z5,e);function og(n,e){tk.indexOf(n)>-1||(tk.push(n),console.warn(e))}function eM(n,e){let t=[];for(let c of e.split(" ")){let h=[];for(let d of c.split(".")){let p=n[d]||Ie[d];p?typeof p=="function"?h.length?h=h.map(p):og(d,`Modifier ${d} used at start of tag`):h.length?og(d,`Tag ${d} used as modifier`):h=Array.isArray(p)?p:[p]:og(d,`Unknown highlighting tag ${d}`)}for(let d of h)t.push(d)}if(!t.length)return 0;let r=e.replace(/ /g,"_"),a=r+" "+t.map(c=>c.id),s=nk[a];if(s)return s.id;let o=nk[a]=di.define({id:ek.length,name:r,props:[T5({[r]:t})]});return ek.push(o),o.id}xn.RTL,xn.LTR;const tM=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),r=py(n.state,t.from);return r.line?nM(n):r.block?iM(n):!1};function dy(n,e){return({state:t,dispatch:r})=>{if(t.readOnly)return!1;let a=n(e,t);return a?(r(t.update(a)),!0):!1}}const nM=dy(sM,0),rM=dy(e2,0),iM=dy((n,e)=>e2(n,e,lM(e)),0);function py(n,e){let t=n.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const cc=50;function aM(n,{open:e,close:t},r,a){let s=n.sliceDoc(r-cc,r),o=n.sliceDoc(a,a+cc),c=/\s*$/.exec(s)[0].length,h=/^\s*/.exec(o)[0].length,d=s.length-c;if(s.slice(d-e.length,d)==e&&o.slice(h,h+t.length)==t)return{open:{pos:r-c,margin:c&&1},close:{pos:a+h,margin:h&&1}};let p,g;a-r<=2*cc?p=g=n.sliceDoc(r,a):(p=n.sliceDoc(r,r+cc),g=n.sliceDoc(a-cc,a));let k=/^\s*/.exec(p)[0].length,w=/\s*$/.exec(g)[0].length,A=g.length-w-t.length;return p.slice(k,k+e.length)==e&&g.slice(A,A+t.length)==t?{open:{pos:r+k+e.length,margin:/\s/.test(p.charAt(k+e.length))?1:0},close:{pos:a-w-t.length,margin:/\s/.test(g.charAt(A-1))?1:0}}:null}function lM(n){let e=[];for(let t of n.selection.ranges){let r=n.doc.lineAt(t.from),a=t.to<=r.to?r:n.doc.lineAt(t.to);a.from>r.from&&a.from==t.to&&(a=t.to==r.to+1?r:n.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>r.from?e[s].to=a.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:a.to})}return e}function e2(n,e,t=e.selection.ranges){let r=t.map(s=>py(e,s.from).block);if(!r.every(s=>s))return null;let a=t.map((s,o)=>aM(e,r[o],s.from,s.to));if(n!=2&&!a.every(s=>s))return{changes:e.changes(t.map((s,o)=>a[o]?[]:[{from:s.from,insert:r[o].open+" "},{from:s.to,insert:" "+r[o].close}]))};if(n!=1&&a.some(s=>s)){let s=[];for(let o=0,c;o<a.length;o++)if(c=a[o]){let h=r[o],{open:d,close:p}=c;s.push({from:d.pos-h.open.length,to:d.pos+d.margin},{from:p.pos-p.margin,to:p.pos+h.close.length})}return{changes:s}}return null}function sM(n,e,t=e.selection.ranges){let r=[],a=-1;for(let{from:s,to:o}of t){let c=r.length,h=1e9,d=py(e,s).line;if(d){for(let p=s;p<=o;){let g=e.doc.lineAt(p);if(g.from>a&&(s==o||o>g.from)){a=g.from;let k=/^\s*/.exec(g.text)[0].length,w=k==g.length,A=g.text.slice(k,k+d.length)==d?k:-1;k<g.text.length&&k<h&&(h=k),r.push({line:g,comment:A,token:d,indent:k,empty:w,single:!1})}p=g.to+1}if(h<1e9)for(let p=c;p<r.length;p++)r[p].indent<r[p].line.text.length&&(r[p].indent=h);r.length==c+1&&(r[c].single=!0)}}if(n!=2&&r.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:c,token:h,indent:d,empty:p,single:g}of r)(g||!p)&&s.push({from:c.from+d,insert:h+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&r.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:c,token:h}of r)if(c>=0){let d=o.from+c,p=d+h.length;o.text[p-o.from]==" "&&p++,s.push({from:d,to:p})}return{changes:s}}return null}const b0=zl.define(),oM=zl.define(),uM=ct.define(),t2=ct.define({combine(n){return Q0(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,a)=>e(r,a)||t(r,a)})}}),n2=Ni.define({create(){return ea.empty},update(n,e){let t=e.state.facet(t2),r=e.annotation(b0);if(r){let h=_r.fromTransaction(e,r.selection),d=r.side,p=d==0?n.undone:n.done;return h?p=yd(p,p.length,t.minDepth,h):p=a2(p,e.startState.selection),new ea(d==0?r.rest:p,d==0?p:r.rest)}let a=e.annotation(oM);if((a=="full"||a=="before")&&(n=n.isolate()),e.annotation(Vn.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=_r.fromTransaction(e),o=e.annotation(Vn.time),c=e.annotation(Vn.userEvent);return s?n=n.addChanges(s,o,c,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,c,t.newGroupDelay)),(a=="full"||a=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new ea(n.done.map(_r.fromJSON),n.undone.map(_r.fromJSON))}});function cM(n={}){return[n2,t2.of(n),lt.domEventHandlers({beforeinput(e,t){let r=e.inputType=="historyUndo"?r2:e.inputType=="historyRedo"?k0:null;return r?(e.preventDefault(),r(t)):!1}})]}function Pd(n,e){return function({state:t,dispatch:r}){if(!e&&t.readOnly)return!1;let a=t.field(n2,!1);if(!a)return!1;let s=a.pop(n,t,e);return s?(r(s),!0):!1}}const r2=Pd(0,!1),k0=Pd(1,!1),hM=Pd(0,!0),fM=Pd(1,!0);class _r{constructor(e,t,r,a,s){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=a,this.selectionsAfter=s}setSelAfter(e){return new _r(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(a=>a.toJSON())}}static fromJSON(e){return new _r(e.changes&&qn.fromJSON(e.changes),[],e.mapped&&ta.fromJSON(e.mapped),e.startSelection&&Le.fromJSON(e.startSelection),e.selectionsAfter.map(Le.fromJSON))}static fromTransaction(e,t){let r=ui;for(let a of e.startState.facet(uM)){let s=a(e);s.length&&(r=r.concat(s))}return!r.length&&e.changes.empty?null:new _r(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,ui)}static selection(e){return new _r(void 0,ui,void 0,void 0,e)}}function yd(n,e,t,r){let a=e+1>t+20?e-t-1:0,s=n.slice(a,e);return s.push(r),s}function dM(n,e){let t=[],r=!1;return n.iterChangedRanges((a,s)=>t.push(a,s)),e.iterChangedRanges((a,s,o,c)=>{for(let h=0;h<t.length;){let d=t[h++],p=t[h++];c>=d&&o<=p&&(r=!0)}}),r}function pM(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length===0}function i2(n,e){return n.length?e.length?n.concat(e):n:e}const ui=[],mM=200;function a2(n,e){if(n.length){let t=n[n.length-1],r=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-mM));return r.length&&r[r.length-1].eq(e)?n:(r.push(e),yd(n,n.length-1,1e9,t.setSelAfter(r)))}else return[_r.selection([e])]}function gM(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function ug(n,e){if(!n.length)return n;let t=n.length,r=ui;for(;t;){let a=yM(n[t-1],e,r);if(a.changes&&!a.changes.empty||a.effects.length){let s=n.slice(0,t);return s[t-1]=a,s}else e=a.mapped,t--,r=a.selectionsAfter}return r.length?[_r.selection(r)]:ui}function yM(n,e,t){let r=i2(n.selectionsAfter.length?n.selectionsAfter.map(c=>c.map(e)):ui,t);if(!n.changes)return _r.selection(r);let a=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new _r(a,on.mapEffects(n.effects,e),o,n.startSelection.map(s),r)}const xM=/^(input\.type|delete)($|\.)/;class ea{constructor(e,t,r=0,a=void 0){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=a}isolate(){return this.prevTime?new ea(this.done,this.undone):this}addChanges(e,t,r,a,s){let o=this.done,c=o[o.length-1];return c&&c.changes&&!c.changes.empty&&e.changes&&(!r||xM.test(r))&&(!c.selectionsAfter.length&&t-this.prevTime<a.newGroupDelay&&a.joinToEvent(s,dM(c.changes,e.changes))||r=="input.type.compose")?o=yd(o,o.length-1,a.minDepth,new _r(e.changes.compose(c.changes),i2(on.mapEffects(e.effects,c.changes),c.effects),c.mapped,c.startSelection,ui)):o=yd(o,o.length,a.minDepth,e),new ea(o,ui,t,r)}addSelection(e,t,r,a){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:ui;return s.length>0&&t-this.prevTime<a&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&pM(s[s.length-1],e)?this:new ea(a2(this.done,e),this.undone,t,r)}addMapping(e){return new ea(ug(this.done,e),ug(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,r){let a=e==0?this.done:this.undone;if(a.length==0)return null;let s=a[a.length-1],o=s.selectionsAfter[0]||t.selection;if(r&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:b0.of({side:e,rest:gM(a),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let c=a.length==1?ui:a.slice(0,a.length-1);return s.mapped&&(c=ug(c,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:b0.of({side:e,rest:c,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}ea.empty=new ea(ui,ui);const vM=[{key:"Mod-z",run:r2,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:k0,preventDefault:!0},{linux:"Ctrl-Shift-z",run:k0,preventDefault:!0},{key:"Mod-u",run:hM,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:fM,preventDefault:!0}];function Jo(n,e){return Le.create(n.ranges.map(e),n.mainIndex)}function Ei(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Mi({state:n,dispatch:e},t){let r=Jo(n.selection,t);return r.eq(n.selection,!0)?!1:(e(Ei(n,r)),!0)}function Hd(n,e){return Le.cursor(e?n.to:n.from)}function l2(n,e){return Mi(n,t=>t.empty?n.moveByChar(t,e):Hd(t,e))}function pr(n){return n.textDirectionAt(n.state.selection.main.head)==xn.LTR}const s2=n=>l2(n,!pr(n)),o2=n=>l2(n,pr(n));function u2(n,e){return Mi(n,t=>t.empty?n.moveByGroup(t,e):Hd(t,e))}const bM=n=>u2(n,!pr(n)),kM=n=>u2(n,pr(n));function wM(n,e,t){if(e.type.prop(t))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function qd(n,e,t){let r=na(n).resolveInner(e.head),a=t?Dt.closedBy:Dt.openedBy;for(let h=e.head;;){let d=t?r.childAfter(h):r.childBefore(h);if(!d)break;wM(n,d,a)?r=d:h=t?d.to:d.from}let s=r.type.prop(a),o,c;return s&&(o=t?jo(n,r.from,1):jo(n,r.to,-1))&&o.matched?c=t?o.end.to:o.end.from:c=t?r.to:r.from,Le.cursor(c,t?-1:1)}const SM=n=>Mi(n,e=>qd(n.state,e,!pr(n))),CM=n=>Mi(n,e=>qd(n.state,e,pr(n)));function c2(n,e){return Mi(n,t=>{if(!t.empty)return Hd(t,e);let r=n.moveVertically(t,e);return r.head!=t.head?r:n.moveToLineBoundary(t,e)})}const h2=n=>c2(n,!1),f2=n=>c2(n,!0);function d2(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,r=0,a;if(e){for(let s of n.state.facet(lt.scrollMargins)){let o=s(n);o?.top&&(t=Math.max(o?.top,t)),o?.bottom&&(r=Math.max(o?.bottom,r))}a=n.scrollDOM.clientHeight-t-r}else a=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:r,selfScroll:e,height:Math.max(n.defaultLineHeight,a-5)}}function p2(n,e){let t=d2(n),{state:r}=n,a=Jo(r.selection,o=>o.empty?n.moveVertically(o,e,t.height):Hd(o,e));if(a.eq(r.selection))return!1;let s;if(t.selfScroll){let o=n.coordsAtPos(r.selection.main.head),c=n.scrollDOM.getBoundingClientRect(),h=c.top+t.marginTop,d=c.bottom-t.marginBottom;o&&o.top>h&&o.bottom<d&&(s=lt.scrollIntoView(a.main.head,{y:"start",yMargin:o.top-h}))}return n.dispatch(Ei(r,a),{effects:s}),!0}const rk=n=>p2(n,!1),w0=n=>p2(n,!0);function Il(n,e,t){let r=n.lineBlockAt(e.head),a=n.moveToLineBoundary(e,t);if(a.head==e.head&&a.head!=(t?r.to:r.from)&&(a=n.moveToLineBoundary(e,t,!1)),!t&&a.head==r.from&&r.length){let s=/^\s*/.exec(n.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&e.head!=r.from+s&&(a=Le.cursor(r.from+s))}return a}const AM=n=>Mi(n,e=>Il(n,e,!0)),TM=n=>Mi(n,e=>Il(n,e,!1)),NM=n=>Mi(n,e=>Il(n,e,!pr(n))),EM=n=>Mi(n,e=>Il(n,e,pr(n))),MM=n=>Mi(n,e=>Le.cursor(n.lineBlockAt(e.head).from,1)),jM=n=>Mi(n,e=>Le.cursor(n.lineBlockAt(e.head).to,-1));function _M(n,e,t){let r=!1,a=Jo(n.selection,s=>{let o=jo(n,s.head,-1)||jo(n,s.head,1)||s.head>0&&jo(n,s.head-1,1)||s.head<n.doc.length&&jo(n,s.head+1,-1);if(!o||!o.end)return s;r=!0;let c=o.start.from==s.head?o.end.to:o.end.from;return Le.cursor(c)});return r?(e(Ei(n,a)),!0):!1}const DM=({state:n,dispatch:e})=>_M(n,e);function pi(n,e){let t=Jo(n.state.selection,r=>{let a=e(r);return Le.range(r.anchor,a.head,a.goalColumn,a.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(Ei(n.state,t)),!0)}function m2(n,e){return pi(n,t=>n.moveByChar(t,e))}const g2=n=>m2(n,!pr(n)),y2=n=>m2(n,pr(n));function x2(n,e){return pi(n,t=>n.moveByGroup(t,e))}const OM=n=>x2(n,!pr(n)),RM=n=>x2(n,pr(n)),LM=n=>pi(n,e=>qd(n.state,e,!pr(n))),BM=n=>pi(n,e=>qd(n.state,e,pr(n)));function v2(n,e){return pi(n,t=>n.moveVertically(t,e))}const b2=n=>v2(n,!1),k2=n=>v2(n,!0);function w2(n,e){return pi(n,t=>n.moveVertically(t,e,d2(n).height))}const ik=n=>w2(n,!1),ak=n=>w2(n,!0),zM=n=>pi(n,e=>Il(n,e,!0)),IM=n=>pi(n,e=>Il(n,e,!1)),PM=n=>pi(n,e=>Il(n,e,!pr(n))),HM=n=>pi(n,e=>Il(n,e,pr(n))),qM=n=>pi(n,e=>Le.cursor(n.lineBlockAt(e.head).from)),UM=n=>pi(n,e=>Le.cursor(n.lineBlockAt(e.head).to)),lk=({state:n,dispatch:e})=>(e(Ei(n,{anchor:0})),!0),sk=({state:n,dispatch:e})=>(e(Ei(n,{anchor:n.doc.length})),!0),ok=({state:n,dispatch:e})=>(e(Ei(n,{anchor:n.selection.main.anchor,head:0})),!0),uk=({state:n,dispatch:e})=>(e(Ei(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),VM=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),FM=({state:n,dispatch:e})=>{let t=Ud(n).map(({from:r,to:a})=>Le.range(r,Math.min(a+1,n.doc.length)));return e(n.update({selection:Le.create(t),userEvent:"select"})),!0},KM=({state:n,dispatch:e})=>{let t=Jo(n.selection,r=>{let a=na(n),s=a.resolveStack(r.from,1);if(r.empty){let o=a.resolveStack(r.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:c}=o;if((c.from<r.from&&c.to>=r.to||c.to>r.to&&c.from<=r.from)&&o.next)return Le.range(c.to,c.from)}return r});return t.eq(n.selection)?!1:(e(Ei(n,t)),!0)};function S2(n,e){let{state:t}=n,r=t.selection,a=t.selection.ranges.slice();for(let s of t.selection.ranges){let o=t.doc.lineAt(s.head);if(e?o.to<n.state.doc.length:o.from>0)for(let c=s;;){let h=n.moveVertically(c,e);if(h.head<o.from||h.head>o.to){a.some(d=>d.head==h.head)||a.push(h);break}else{if(h.head==c.head)break;c=h}}}return a.length==r.ranges.length?!1:(n.dispatch(Ei(t,Le.create(a,a.length-1))),!0)}const GM=n=>S2(n,!1),YM=n=>S2(n,!0),$M=({state:n,dispatch:e})=>{let t=n.selection,r=null;return t.ranges.length>1?r=Le.create([t.main]):t.main.empty||(r=Le.create([Le.cursor(t.main.head)])),r?(e(Ei(n,r)),!0):!1};function Zc(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:r}=n,a=r.changeByRange(s=>{let{from:o,to:c}=s;if(o==c){let h=e(s);h<o?(t="delete.backward",h=Rf(n,h,!1)):h>o&&(t="delete.forward",h=Rf(n,h,!0)),o=Math.min(o,h),c=Math.max(c,h)}else o=Rf(n,o,!1),c=Rf(n,c,!0);return o==c?{range:s}:{changes:{from:o,to:c},range:Le.cursor(o,o<s.head?-1:1)}});return a.changes.empty?!1:(n.dispatch(r.update(a,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?lt.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function Rf(n,e,t){if(n instanceof lt)for(let r of n.state.facet(lt.atomicRanges).map(a=>a(n)))r.between(e,e,(a,s)=>{a<e&&s>e&&(e=t?s:a)});return e}const C2=(n,e,t)=>Zc(n,r=>{let a=r.from,{state:s}=n,o=s.doc.lineAt(a),c,h;if(t&&!e&&a>o.from&&a<o.from+200&&!/[^ \t]/.test(c=o.text.slice(0,a-o.from))){if(c[c.length-1]=="	")return a-1;let d=jd(c,s.tabSize),p=d%md(s)||md(s);for(let g=0;g<p&&c[c.length-1-g]==" ";g++)a--;h=a}else h=Un(o.text,a-o.from,e,e)+o.from,h==a&&o.number!=(e?s.doc.lines:1)?h+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(h-o.from,a-o.from))&&(h=Un(o.text,h-o.from,!1,!1)+o.from);return h}),S0=n=>C2(n,!1,!0),A2=n=>C2(n,!0,!1),T2=(n,e)=>Zc(n,t=>{let r=t.head,{state:a}=n,s=a.doc.lineAt(r),o=a.charCategorizer(r);for(let c=null;;){if(r==(e?s.to:s.from)){r==t.head&&s.number!=(e?a.doc.lines:1)&&(r+=e?1:-1);break}let h=Un(s.text,r-s.from,e)+s.from,d=s.text.slice(Math.min(r,h)-s.from,Math.max(r,h)-s.from),p=o(d);if(c!=null&&p!=c)break;(d!=" "||r!=t.head)&&(c=p),r=h}return r}),N2=n=>T2(n,!1),QM=n=>T2(n,!0),XM=n=>Zc(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),WM=n=>Zc(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),ZM=n=>Zc(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),JM=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:It.of(["",""])},range:Le.cursor(r.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},ej=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>{if(!r.empty||r.from==0||r.from==n.doc.length)return{range:r};let a=r.from,s=n.doc.lineAt(a),o=a==s.from?a-1:Un(s.text,a-s.from,!1)+s.from,c=a==s.to?a+1:Un(s.text,a-s.from,!0)+s.from;return{changes:{from:o,to:c,insert:n.doc.slice(a,c).append(n.doc.slice(o,a))},range:Le.cursor(c)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Ud(n){let e=[],t=-1;for(let r of n.selection.ranges){let a=n.doc.lineAt(r.from),s=n.doc.lineAt(r.to);if(!r.empty&&r.to==s.from&&(s=n.doc.lineAt(r.to-1)),t>=a.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(r)}else e.push({from:a.from,to:s.to,ranges:[r]});t=s.number+1}return e}function E2(n,e,t){if(n.readOnly)return!1;let r=[],a=[];for(let s of Ud(n)){if(t?s.to==n.doc.length:s.from==0)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),c=o.length+1;if(t){r.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let h of s.ranges)a.push(Le.range(Math.min(n.doc.length,h.anchor+c),Math.min(n.doc.length,h.head+c)))}else{r.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let h of s.ranges)a.push(Le.range(h.anchor-c,h.head-c))}}return r.length?(e(n.update({changes:r,scrollIntoView:!0,selection:Le.create(a,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const tj=({state:n,dispatch:e})=>E2(n,e,!1),nj=({state:n,dispatch:e})=>E2(n,e,!0);function M2(n,e,t){if(n.readOnly)return!1;let r=[];for(let s of Ud(n))t?r.push({from:s.from,insert:n.doc.slice(s.from,s.to)+n.lineBreak}):r.push({from:s.to,insert:n.lineBreak+n.doc.slice(s.from,s.to)});let a=n.changes(r);return e(n.update({changes:a,selection:n.selection.map(a,t?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const rj=({state:n,dispatch:e})=>M2(n,e,!1),ij=({state:n,dispatch:e})=>M2(n,e,!0),aj=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Ud(e).map(({from:a,to:s})=>(a>0?a--:s<e.doc.length&&s++,{from:a,to:s}))),r=Jo(e.selection,a=>{let s;if(n.lineWrapping){let o=n.lineBlockAt(a.head),c=n.coordsAtPos(a.head,a.assoc||1);c&&(s=o.bottom+n.documentTop-c.bottom+n.defaultLineHeight/2)}return n.moveVertically(a,!0,s)}).map(t);return n.dispatch({changes:t,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function lj(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=na(n).resolveInner(e),r=t.childBefore(e),a=t.childAfter(e),s;return r&&a&&r.to<=e&&a.from>=e&&(s=r.type.prop(Dt.closedBy))&&s.indexOf(a.name)>-1&&n.doc.lineAt(r.to).from==n.doc.lineAt(a.from).from&&!/\S/.test(n.sliceDoc(r.to,a.from))?{from:r.to,to:a.from}:null}const ck=j2(!1),sj=j2(!0);function j2(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(a=>{let{from:s,to:o}=a,c=e.doc.lineAt(s),h=!n&&s==o&&lj(e,s);n&&(s=o=(o<=c.to?c:e.doc.lineAt(o)).to);let d=new zd(e,{simulateBreak:s,simulateDoubleBreak:!!h}),p=ZS(d,s);for(p==null&&(p=jd(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<c.to&&/\s/.test(c.text[o-c.from]);)o++;h?{from:s,to:o}=h:s>c.from&&s<c.from+100&&!/\S/.test(c.text.slice(0,s))&&(s=c.from);let g=["",gd(e,p)];return h&&g.push(gd(e,d.lineIndent(c.from,-1))),{changes:{from:s,to:o,insert:It.of(g)},range:Le.cursor(s+1+g[1].length)}});return t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function my(n,e){let t=-1;return n.changeByRange(r=>{let a=[];for(let o=r.from;o<=r.to;){let c=n.doc.lineAt(o);c.number>t&&(r.empty||r.to>c.from)&&(e(c,a,r),t=c.number),o=c.to+1}let s=n.changes(a);return{changes:a,range:Le.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}})}const oj=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),r=new zd(n,{overrideIndentation:s=>{let o=t[s];return o??-1}}),a=my(n,(s,o,c)=>{let h=ZS(r,s.from);if(h==null)return;/\S/.test(s.text)||(h=0);let d=/^\s*/.exec(s.text)[0],p=gd(n,h);(d!=p||c.from<s.from+d.length)&&(t[s.from]=h,o.push({from:s.from,to:s.from+d.length,insert:p}))});return a.changes.empty||e(n.update(a,{userEvent:"indent"})),!0},uj=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(my(n,(t,r)=>{r.push({from:t.from,insert:n.facet(hy)})}),{userEvent:"input.indent"})),!0),cj=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(my(n,(t,r)=>{let a=/^\s*/.exec(t.text)[0];if(!a)return;let s=jd(a,n.tabSize),o=0,c=gd(n,Math.max(0,s-md(n)));for(;o<a.length&&o<c.length&&a.charCodeAt(o)==c.charCodeAt(o);)o++;r.push({from:t.from+o,to:t.from+a.length,insert:c.slice(o)})}),{userEvent:"delete.dedent"})),!0),hj=n=>(n.setTabFocusMode(),!0),fj=[{key:"Ctrl-b",run:s2,shift:g2,preventDefault:!0},{key:"Ctrl-f",run:o2,shift:y2},{key:"Ctrl-p",run:h2,shift:b2},{key:"Ctrl-n",run:f2,shift:k2},{key:"Ctrl-a",run:MM,shift:qM},{key:"Ctrl-e",run:jM,shift:UM},{key:"Ctrl-d",run:A2},{key:"Ctrl-h",run:S0},{key:"Ctrl-k",run:XM},{key:"Ctrl-Alt-h",run:N2},{key:"Ctrl-o",run:JM},{key:"Ctrl-t",run:ej},{key:"Ctrl-v",run:w0}],dj=[{key:"ArrowLeft",run:s2,shift:g2,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:bM,shift:OM,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:NM,shift:PM,preventDefault:!0},{key:"ArrowRight",run:o2,shift:y2,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:kM,shift:RM,preventDefault:!0},{mac:"Cmd-ArrowRight",run:EM,shift:HM,preventDefault:!0},{key:"ArrowUp",run:h2,shift:b2,preventDefault:!0},{mac:"Cmd-ArrowUp",run:lk,shift:ok},{mac:"Ctrl-ArrowUp",run:rk,shift:ik},{key:"ArrowDown",run:f2,shift:k2,preventDefault:!0},{mac:"Cmd-ArrowDown",run:sk,shift:uk},{mac:"Ctrl-ArrowDown",run:w0,shift:ak},{key:"PageUp",run:rk,shift:ik},{key:"PageDown",run:w0,shift:ak},{key:"Home",run:TM,shift:IM,preventDefault:!0},{key:"Mod-Home",run:lk,shift:ok},{key:"End",run:AM,shift:zM,preventDefault:!0},{key:"Mod-End",run:sk,shift:uk},{key:"Enter",run:ck,shift:ck},{key:"Mod-a",run:VM},{key:"Backspace",run:S0,shift:S0,preventDefault:!0},{key:"Delete",run:A2,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:N2,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:QM,preventDefault:!0},{mac:"Mod-Backspace",run:WM,preventDefault:!0},{mac:"Mod-Delete",run:ZM,preventDefault:!0}].concat(fj.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),pj=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:SM,shift:LM},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:CM,shift:BM},{key:"Alt-ArrowUp",run:tj},{key:"Shift-Alt-ArrowUp",run:rj},{key:"Alt-ArrowDown",run:nj},{key:"Shift-Alt-ArrowDown",run:ij},{key:"Mod-Alt-ArrowUp",run:GM},{key:"Mod-Alt-ArrowDown",run:YM},{key:"Escape",run:$M},{key:"Mod-Enter",run:sj},{key:"Alt-l",mac:"Ctrl-l",run:FM},{key:"Mod-i",run:KM,preventDefault:!0},{key:"Mod-[",run:cj},{key:"Mod-]",run:uj},{key:"Mod-Alt-\\",run:oj},{key:"Shift-Mod-k",run:aj},{key:"Shift-Mod-\\",run:DM},{key:"Mod-/",run:tM},{key:"Alt-A",run:rM},{key:"Ctrl-m",mac:"Shift-Alt-m",run:hj}].concat(dj),mj="#e5c07b",hk="#e06c75",gj="#56b6c2",yj="#ffffff",Qf="#abb2bf",C0="#7d8799",xj="#61afef",vj="#98c379",fk="#d19a66",bj="#c678dd",kj="#21252b",dk="#2c313a",pk="#282c34",cg="#353a42",wj="#3E4451",mk="#528bff",Sj=lt.theme({"&":{color:Qf,backgroundColor:pk},".cm-content":{caretColor:mk},".cm-cursor, .cm-dropCursor":{borderLeftColor:mk},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:wj},".cm-panels":{backgroundColor:kj,color:Qf},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:pk,color:C0,border:"none"},".cm-activeLineGutter":{backgroundColor:dk},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:cg},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:cg,borderBottomColor:cg},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:dk,color:Qf}}},{dark:!0}),Cj=Id.define([{tag:Ie.keyword,color:bj},{tag:[Ie.name,Ie.deleted,Ie.character,Ie.propertyName,Ie.macroName],color:hk},{tag:[Ie.function(Ie.variableName),Ie.labelName],color:xj},{tag:[Ie.color,Ie.constant(Ie.name),Ie.standard(Ie.name)],color:fk},{tag:[Ie.definition(Ie.name),Ie.separator],color:Qf},{tag:[Ie.typeName,Ie.className,Ie.number,Ie.changed,Ie.annotation,Ie.modifier,Ie.self,Ie.namespace],color:mj},{tag:[Ie.operator,Ie.operatorKeyword,Ie.url,Ie.escape,Ie.regexp,Ie.link,Ie.special(Ie.string)],color:gj},{tag:[Ie.meta,Ie.comment],color:C0},{tag:Ie.strong,fontWeight:"bold"},{tag:Ie.emphasis,fontStyle:"italic"},{tag:Ie.strikethrough,textDecoration:"line-through"},{tag:Ie.link,color:C0,textDecoration:"underline"},{tag:Ie.heading,fontWeight:"bold",color:hk},{tag:[Ie.atom,Ie.bool,Ie.special(Ie.variableName)],color:fk},{tag:[Ie.processingInstruction,Ie.string,Ie.inserted],color:vj},{tag:Ie.invalid,color:yj}]),Aj=[Sj,F5(Cj)],gk=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class _2{constructor(e,t,r=0,a=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,a),this.bufferStart=r,this.normalize=s?c=>s(gk(c)):gk,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return _w(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=nE(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=Dw(e);let a=this.normalize(t);if(a.length)for(let s=0,o=r;;s++){let c=a.charCodeAt(s),h=this.match(c,o,this.bufferPos+this.bufferStart);if(s==a.length-1){if(h)return this.value=h,this;break}o==r&&s<t.length&&t.charCodeAt(s)==c&&o++}}}match(e,t,r){let a=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],c=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?a={from:this.matches[s+1],to:r}:(this.matches[s]++,c=!0)),c||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?a={from:t,to:r}:this.matches.push(1,t)),a&&this.test&&!this.test(a.from,a.to,this.buffer,this.bufferStart)&&(a=null),a}}typeof Symbol<"u"&&(_2.prototype[Symbol.iterator]=function(){return this});const D2={from:-1,to:-1,match:/.*/.exec("")},gy="gm"+(/x/.unicode==null?"":"u");class O2{constructor(e,t,r,a=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=D2,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new R2(e,t,r,a,s);this.re=new RegExp(t,gy+(r?.ignoreCase?"i":"")),this.test=r?.test,this.iter=e.iter();let o=e.lineAt(a);this.curLineStart=o.from,this.matchPos=xd(e,a),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,a=r+t[0].length;if(this.matchPos=xd(this.text,a+(r==a?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<a||r>this.value.to)&&(!this.test||this.test(r,a,t)))return this.value={from:r,to:a,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const hg=new WeakMap;class zo{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let a=hg.get(e);if(!a||a.from>=r||a.to<=t){let c=new zo(t,e.sliceString(t,r));return hg.set(e,c),c}if(a.from==t&&a.to==r)return a;let{text:s,from:o}=a;return o>t&&(s=e.sliceString(t,o)+s,o=t),a.to<r&&(s+=e.sliceString(a.to,r)),hg.set(e,new zo(o,s)),new zo(t,s.slice(t-o,r-o))}}class R2{constructor(e,t,r,a,s){this.text=e,this.to=s,this.done=!1,this.value=D2,this.matchPos=xd(e,a),this.re=new RegExp(t,gy+(r?.ignoreCase?"i":"")),this.test=r?.test,this.flat=zo.get(e,a,this.chunkEnd(a+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let r=this.flat.from+t.index,a=r+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,a,t)))return this.value={from:r,to:a,match:t},this.matchPos=xd(this.text,a+(r==a?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=zo.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(O2.prototype[Symbol.iterator]=R2.prototype[Symbol.iterator]=function(){return this});function Tj(n){try{return new RegExp(n,gy),!0}catch{return!1}}function xd(n,e){if(e>=n.length)return e;let t=n.lineAt(e),r;for(;e<t.to&&(r=t.text.charCodeAt(e-t.from))>=56320&&r<57344;)e++;return e}const eu=ct.define({combine(n){return Q0(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new zj(e),scrollToMatch:e=>lt.scrollIntoView(e)})}});class Vc{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||Tj(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord,this.test=e.test}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord&&this.test==e.test}create(){return this.regexp?new Dj(this):new Mj(this)}getCursor(e,t=0,r){let a=e.doc?e:Ut.create({doc:e});return r==null&&(r=a.doc.length),this.regexp?To(this,a,t,r):Ao(this,a,t,r)}}class L2{constructor(e){this.spec=e}}function Nj(n,e,t){return(r,a,s,o)=>{if(t&&!t(r,a,s,o))return!1;let c=r>=o&&a<=o+s.length?s.slice(r-o,a-o):e.doc.sliceString(r,a);return n(c,e,r,a)}}function Ao(n,e,t,r){let a;return n.wholeWord&&(a=Ej(e.doc,e.charCategorizer(e.selection.main.head))),n.test&&(a=Nj(n.test,e,a)),new _2(e.doc,n.unquoted,t,r,n.caseSensitive?void 0:s=>s.toLowerCase(),a)}function Ej(n,e){return(t,r,a,s)=>((s>t||s+a.length<r)&&(s=Math.max(0,t-2),a=n.sliceString(s,Math.min(n.length,r+2))),(e(vd(a,t-s))!=lr.Word||e(bd(a,t-s))!=lr.Word)&&(e(bd(a,r-s))!=lr.Word||e(vd(a,r-s))!=lr.Word))}class Mj extends L2{constructor(e){super(e)}nextMatch(e,t,r){let a=Ao(this.spec,e,r,e.doc.length).nextOverlapping();if(a.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);a=Ao(this.spec,e,0,s).nextOverlapping()}return a.done||a.value.from==t&&a.value.to==r?null:a.value}prevMatchInRange(e,t,r){for(let a=r;;){let s=Math.max(t,a-1e4-this.spec.unquoted.length),o=Ao(this.spec,e,s,a),c=null;for(;!o.nextOverlapping().done;)c=o.value;if(c)return c;if(s==t)return null;a-=1e4}}prevMatch(e,t,r){let a=this.prevMatchInRange(e,0,t);return a||(a=this.prevMatchInRange(e,Math.max(0,r-this.spec.unquoted.length),e.doc.length)),a&&(a.from!=t||a.to!=r)?a:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=Ao(this.spec,e,0,e.doc.length),a=[];for(;!r.next().done;){if(a.length>=t)return null;a.push(r.value)}return a}highlight(e,t,r,a){let s=Ao(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)a(s.value.from,s.value.to)}}function jj(n,e,t){return(r,a,s)=>(!t||t(r,a,s))&&n(s[0],e,r,a)}function To(n,e,t,r){let a;return n.wholeWord&&(a=_j(e.charCategorizer(e.selection.main.head))),n.test&&(a=jj(n.test,e,a)),new O2(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:a},t,r)}function vd(n,e){return n.slice(Un(n,e,!1),e)}function bd(n,e){return n.slice(e,Un(n,e))}function _j(n){return(e,t,r)=>!r[0].length||(n(vd(r.input,r.index))!=lr.Word||n(bd(r.input,r.index))!=lr.Word)&&(n(bd(r.input,r.index+r[0].length))!=lr.Word||n(vd(r.input,r.index+r[0].length))!=lr.Word)}class Dj extends L2{nextMatch(e,t,r){let a=To(this.spec,e,r,e.doc.length).next();return a.done&&(a=To(this.spec,e,0,t).next()),a.done?null:a.value}prevMatchInRange(e,t,r){for(let a=1;;a++){let s=Math.max(t,r-a*1e4),o=To(this.spec,e,s,r),c=null;for(;!o.next().done;)c=o.value;if(c&&(s==t||c.from>s+10))return c;if(s==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,r)=>{if(r=="&")return e.match[0];if(r=="$")return"$";for(let a=r.length;a>0;a--){let s=+r.slice(0,a);if(s>0&&s<e.match.length)return e.match[s]+r.slice(a)}return t})}matchAll(e,t){let r=To(this.spec,e,0,e.doc.length),a=[];for(;!r.next().done;){if(a.length>=t)return null;a.push(r.value)}return a}highlight(e,t,r,a){let s=To(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));for(;!s.next().done;)a(s.value.from,s.value.to)}}const Bl=on.define(),yy=on.define(),Ra=Ni.define({create(n){return new fg(wd(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Bl)?n=new fg(t.value.create(),n.panel):t.is(yy)&&(n=new fg(n.query,t.value?xy:null));return n},provide:n=>fd.from(n,e=>e.panel)});function Qo(n){let e=n.field(Ra,!1);return e?e.query.spec:wd(n)}class fg{constructor(e,t){this.query=e,this.panel=t}}const Oj=pn.mark({class:"cm-searchMatch"}),Rj=pn.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Lj=hi.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(Ra))}update(n){let e=n.state.field(Ra);(e!=n.startState.field(Ra)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return pn.none;let{view:t}=this,r=new qo;for(let a=0,s=t.visibleRanges,o=s.length;a<o;a++){let{from:c,to:h}=s[a];for(;a<o-1&&h>s[a+1].from-500;)h=s[++a].to;n.highlight(t.state,c,h,(d,p)=>{let g=t.state.selection.ranges.some(k=>k.from==d&&k.to==p);r.add(d,p,g?Rj:Oj)})}return r.finish()}},{decorations:n=>n.decorations});function Jc(n){return e=>{let t=e.state.field(Ra,!1);return t&&t.query.spec.valid?n(e,t):P2(e)}}const Nc=Jc((n,{query:e})=>{let{to:t}=n.state.selection.main,r=e.nextMatch(n.state,t,t);if(!r)return!1;let a=Le.single(r.from,r.to),s=n.state.facet(eu);return n.dispatch({selection:a,effects:[vy(n,r),s.scrollToMatch(a.main,n)],userEvent:"select.search"}),I2(n),!0}),kd=Jc((n,{query:e})=>{let{state:t}=n,{from:r}=t.selection.main,a=e.prevMatch(t,r,r);if(!a)return!1;let s=Le.single(a.from,a.to),o=n.state.facet(eu);return n.dispatch({selection:s,effects:[vy(n,a),o.scrollToMatch(s.main,n)],userEvent:"select.search"}),I2(n),!0}),Bj=Jc((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:Le.create(t.map(r=>Le.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),A0=Jc((n,{query:e})=>{let{state:t}=n,{from:r,to:a}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,r,r);if(!s)return!1;let o=s,c=[],h,d,p=[];o.from==r&&o.to==a&&(d=t.toText(e.getReplacement(o)),c.push({from:o.from,to:o.to,insert:d}),o=e.nextMatch(t,o.from,o.to),p.push(lt.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(r).number)+".")));let g=n.state.changes(c);return o&&(h=Le.single(o.from,o.to).map(g),p.push(vy(n,o)),p.push(t.facet(eu).scrollToMatch(h.main,n))),n.dispatch({changes:g,selection:h,effects:p,userEvent:"input.replace"}),!0}),B2=Jc((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(a=>{let{from:s,to:o}=a;return{from:s,to:o,insert:e.getReplacement(a)}});if(!t.length)return!1;let r=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:lt.announce.of(r),userEvent:"input.replace.all"}),!0});function xy(n){return n.state.facet(eu).createPanel(n)}function wd(n,e){var t,r,a,s,o;let c=n.selection.main,h=c.empty||c.to>c.from+100?"":n.sliceDoc(c.from,c.to);if(e&&!h)return e;let d=n.facet(eu);return new Vc({search:((t=e?.literal)!==null&&t!==void 0?t:d.literal)?h:h.replace(/\n/g,"\\n"),caseSensitive:(r=e?.caseSensitive)!==null&&r!==void 0?r:d.caseSensitive,literal:(a=e?.literal)!==null&&a!==void 0?a:d.literal,regexp:(s=e?.regexp)!==null&&s!==void 0?s:d.regexp,wholeWord:(o=e?.wholeWord)!==null&&o!==void 0?o:d.wholeWord})}function z2(n){let e=FS(n,xy);return e&&e.dom.querySelector("[main-field]")}function I2(n){let e=z2(n);e&&e==n.root.activeElement&&e.select()}const P2=n=>{let e=n.state.field(Ra,!1);if(e&&e.panel){let t=z2(n);if(t&&t!=n.root.activeElement){let r=wd(n.state,e.query.spec);r.valid&&n.dispatch({effects:Bl.of(r)}),t.focus(),t.select()}}else n.dispatch({effects:[yy.of(!0),e?Bl.of(wd(n.state,e.query.spec)):on.appendConfig.of(Pj)]});return!0},H2=n=>{let e=n.state.field(Ra,!1);if(!e||!e.panel)return!1;let t=FS(n,xy);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:yy.of(!1)}),!0};class zj{constructor(e){this.view=e;let t=this.query=e.state.field(Ra).query.spec;this.commit=this.commit.bind(this),this.searchField=ai("input",{value:t.search,placeholder:Ur(e,"Find"),"aria-label":Ur(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ai("input",{value:t.replace,placeholder:Ur(e,"Replace"),"aria-label":Ur(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ai("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=ai("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=ai("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function r(a,s,o){return ai("button",{class:"cm-button",name:a,onclick:s,type:"button"},o)}this.dom=ai("div",{onkeydown:a=>this.keydown(a),class:"cm-search"},[this.searchField,r("next",()=>Nc(e),[Ur(e,"next")]),r("prev",()=>kd(e),[Ur(e,"previous")]),r("select",()=>Bj(e),[Ur(e,"all")]),ai("label",null,[this.caseField,Ur(e,"match case")]),ai("label",null,[this.reField,Ur(e,"regexp")]),ai("label",null,[this.wordField,Ur(e,"by word")]),...e.state.readOnly?[]:[ai("br"),this.replaceField,r("replace",()=>A0(e),[Ur(e,"replace")]),r("replaceAll",()=>B2(e),[Ur(e,"replace all")])],ai("button",{name:"close",onclick:()=>H2(e),"aria-label":Ur(e,"close"),type:"button"},[""])])}commit(){let e=new Vc({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Bl.of(e)}))}keydown(e){r5(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?kd:Nc)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),A0(this.view))}update(e){for(let t of e.transactions)for(let r of t.effects)r.is(Bl)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(eu).top}}function Ur(n,e){return n.state.phrase(e)}const Lf=30,Bf=/[\s\.,:;?!]/;function vy(n,{from:e,to:t}){let r=n.state.doc.lineAt(e),a=n.state.doc.lineAt(t).to,s=Math.max(r.from,e-Lf),o=Math.min(a,t+Lf),c=n.state.sliceDoc(s,o);if(s!=r.from){for(let h=0;h<Lf;h++)if(!Bf.test(c[h+1])&&Bf.test(c[h])){c=c.slice(h);break}}if(o!=a){for(let h=c.length-1;h>c.length-Lf;h--)if(!Bf.test(c[h-1])&&Bf.test(c[h])){c=c.slice(0,h);break}}return lt.announce.of(`${n.state.phrase("current match")}. ${c} ${n.state.phrase("on line")} ${r.number}.`)}const Ij=lt.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Pj=[Ra,Yc.low(Lj),Ij],Ec=Ni.define({create:()=>!1,update:(n,e)=>{for(const t of e.effects)if(t.is(Sd))return t.value;return n}}),Sd=on.define();function Hj(n){const e=n.state.selection.main;return e.from===e.to?null:n.state.doc.sliceString(e.from,e.to)}function T0(n){const e=Hj(n),t=Qo(n.state);if(e!==null){const r=new Vc({search:e,caseSensitive:t.caseSensitive,wholeWord:t.wholeWord,regexp:t.regexp,replace:t.replace});n.dispatch({effects:[Bl.of(r),Sd.of(!0)]})}else n.dispatch({effects:Sd.of(!0)});return P2(n),!0}function Mc(n){return n.dispatch({effects:Sd.of(!1)}),H2(n),!0}function qj(n){return n.state.field(Ec)?Mc(n):T0(n)}function Uj(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function q2(n){if(!n.search)return null;let e=n.regexp?n.search:Uj(n.search);n.wholeWord&&(e=`\\b(?:${e})\\b`);try{return new RegExp(e,n.caseSensitive?"g":"gi")}catch{return null}}function Vj(n,e){if(!e.search)return 0;const t=n.state.doc.toString(),r=q2(e);if(!r)return 0;let a=0,s;for(;(s=r.exec(t))!==null;)a++,s[0].length===0&&r.lastIndex++;return a}function Fj(n,e){if(!e.search)return 0;const t=n.state.selection.main,r=n.state.doc.toString(),a=t.from,s=q2(e);if(!s)return 0;let o=0,c;for(;(c=s.exec(r))!==null;){if(o++,c.index<=a&&a<c.index+c[0].length)return o;c[0].length===0&&s.lastIndex++}return 0}function Kj(n,e){const t=Qo(n.state);if(!t.search){e.style.display="none",e.textContent="";return}const r=Vj(n,t);if(r<=0){e.textContent="0/0",e.style.display="inline";return}const a=Fj(n,t);e.textContent=`${a||1}/${r}`,e.style.display="inline"}function Gj(n,e){return n.search===e.search&&n.replace===e.replace&&n.caseSensitive===e.caseSensitive&&n.wholeWord===e.wholeWord&&n.regexp===e.regexp}function U2(n,e){e.searchInput.value=n.search||"",e.replaceInput.value=n.replace||"",e.caseCb.checked=n.caseSensitive,e.wordCb.checked=n.wholeWord,e.regexpCb.checked=n.regexp}function Yj(n){const e=document.createElement("div");e.className="cm-toolbar-search-panel";const t=document.createElement("div");t.className="search-container",e.appendChild(t);const r=document.createElement("div");r.className="search-row",t.appendChild(r);const a=document.createElement("div");a.className="replace-row",t.appendChild(a);const s=document.createElement("input");s.type="text",s.className="search-input",s.placeholder="Find...",r.appendChild(s);const o=document.createElement("button");o.type="button",o.className="search-btn prev",o.textContent="^",o.title="Previous match (Shift+Enter)",o.setAttribute("aria-label","Previous match"),r.appendChild(o);const c=document.createElement("button");c.type="button",c.className="search-btn next",c.textContent="v",c.title="Next match (Enter)",c.setAttribute("aria-label","Next match"),r.appendChild(c);const h=document.createElement("span");h.className="search-match-count",r.appendChild(h);const d=(L,me,he,I)=>{const te=document.createElement("label");te.className="search-option",te.title=he;const ne=document.createElement("input");ne.type="checkbox",ne.className=L,ne.setAttribute("aria-label",I),ne.title=he;const pe=document.createElement("span");return pe.textContent=me,te.appendChild(ne),te.appendChild(pe),{label:te,input:ne}},p=d("case-sensitive","Aa","Match case","Match case"),g=d("whole-word","ab","Whole word only","Whole word only"),k=d("regexp",".*","Use regular expression","Use regular expression");r.appendChild(p.label),r.appendChild(g.label),r.appendChild(k.label);const w=document.createElement("button");w.type="button",w.className="search-btn close",w.textContent="x",w.title="Close search (Escape)",w.setAttribute("aria-label","Close search"),r.appendChild(w);const A=document.createElement("input");A.type="text",A.className="replace-input",A.placeholder="Replace...",a.appendChild(A);const E=document.createElement("button");E.type="button",E.className="search-btn replace",E.textContent="Replace",E.title="Replace current match",E.setAttribute("aria-label","Replace current match"),a.appendChild(E);const j=document.createElement("button");j.type="button",j.className="search-btn replace-all",j.textContent="Replace All",j.title="Replace all matches",j.setAttribute("aria-label","Replace all matches"),a.appendChild(j);const D=p.input,U=g.input,O=k.input,J=()=>{Kj(n,h)},ee=()=>{U2(Qo(n.state),{searchInput:s,replaceInput:A,caseCb:D,wordCb:U,regexpCb:O})};ee(),setTimeout(()=>s.focus(),0);const H=()=>{const L=new Vc({search:s.value,caseSensitive:D.checked,wholeWord:U.checked,regexp:O.checked,replace:A.value});n.dispatch({effects:Bl.of(L)}),J()};return[s,A].forEach(L=>L.addEventListener("input",H)),[D,U,O].forEach(L=>L.addEventListener("change",H)),s.addEventListener("keydown",L=>{L.key==="Enter"?(L.preventDefault(),L.shiftKey?kd(n):Nc(n),J()):L.key==="Escape"&&(Mc(n),n.focus())}),A.addEventListener("keydown",L=>{L.key==="Escape"&&(Mc(n),n.focus())}),o.addEventListener("click",()=>{kd(n),J()}),c.addEventListener("click",()=>{Nc(n),J()}),w.addEventListener("click",()=>{Mc(n),n.focus()}),E.addEventListener("click",()=>{A0(n),Nc(n),J()}),j.addEventListener("click",()=>{B2(n);const L=Qo(n.state);n.dispatch({effects:Bl.of(new Vc({search:"",replace:L.replace,caseSensitive:L.caseSensitive,wholeWord:L.wholeWord,regexp:L.regexp}))}),ee(),J()}),J(),{dom:e,searchInput:s,replaceInput:A,caseCb:D,wordCb:U,regexpCb:O,countEl:h,refreshCount:J}}const $j=hi.fromClass(class{panel=null;controls=null;parent=null;constructor(n){this.parent=n.dom.parentElement,n.state.field(Ec)&&this.openPanel(n)}update(n){const e=n.startState.field(Ec),t=n.state.field(Ec);if(t&&!e)this.openPanel(n.view);else if(!t&&e)this.closePanel();else if(t&&this.controls){const r=Qo(n.startState),a=Qo(n.state),s=!Gj(r,a);s&&U2(a,this.controls),(s||n.docChanged||n.selectionSet)&&this.controls.refreshCount()}}openPanel(n){this.panel||(this.controls=Yj(n),this.panel=this.controls.dom,this.parent?.firstChild&&this.parent.insertBefore(this.panel,this.parent.firstChild))}closePanel(){this.panel?.remove(),this.panel=null,this.controls=null}destroy(){this.closePanel()}});function Qj(){return[Ec,$j,hd.of([{key:"Mod-f",run:T0},{key:"Mod-h",run:T0},{key:"Escape",run:Mc}])]}function Xj(){return lt.theme({"& .cm-search":{display:"none !important"},"& .cm-searchMatch":{backgroundColor:"var(--vault-search-match-bg, rgba(253, 224, 71, 0.4))",borderRadius:"2px",boxShadow:"inset 0 -1px 0 rgba(146, 64, 14, 0.2)"},"& .cm-searchMatch-selected":{backgroundColor:"var(--vault-search-match-selected, rgba(253, 224, 71, 0.8))",borderRadius:"2px",outline:"1px solid var(--vault-search-match-selected-ring, rgba(180, 83, 9, 0.65))",boxShadow:"0 0 0 1px var(--vault-search-match-selected-ring, rgba(180, 83, 9, 0.65))"}})}const Al={SEPARATE_FIELD:"separate_field",INLINE_TAGS:"inline_tags"};class _o{buffer="";isInThinkBlock=!1;reasoningContent="";mainContent="";static THINK_START_VARIATIONS=["<think>","<thinking>","<reasoning>","<thought>"];static THINK_END_VARIATIONS=["</think>","</thinking>","</reasoning>","</thought>"];parseChunk(e,t){const r=t?Wj(t):Al.INLINE_TAGS,a=e?.choices?.[0],s=a?.delta,o=s?.content??"",c=s?.reasoning_content??s?.reasoning??a?.reasoning?.content??"";return c||r===Al.SEPARATE_FIELD?(c&&(this.reasoningContent+=c),o&&(this.mainContent+=o),{content:this.mainContent,reasoning:this.reasoningContent,isInThinkBlock:!1}):this.parseInlineTagChunk(e)}findThinkTag(e,t=0){const r=e.toLowerCase();let a=null;for(const s of _o.THINK_START_VARIATIONS){const o=r.indexOf(s,t);o!==-1&&(a===null||o<a.index)&&(a={index:o,tag:s})}return a}findCloseTag(e,t=0){const r=e.toLowerCase();let a=null;for(const s of _o.THINK_END_VARIATIONS){const o=r.indexOf(s,t);o!==-1&&(a===null||o<a.index)&&(a={index:o,tag:s})}return a}parseInlineTagChunk(e){const r=e?.choices?.[0]?.delta?.content??"";return this.buffer+=r,this.processBuffer(),{content:this.mainContent,reasoning:this.reasoningContent,isInThinkBlock:this.isInThinkBlock}}processBuffer(){for(;this.buffer.length>0;)if(this.isInThinkBlock){const e=this.findCloseTag(this.buffer);if(e===null){const t=Math.max(..._o.THINK_END_VARIATIONS.map(s=>s.length)),r=Math.min(this.buffer.length,t-1),a=this.buffer.slice(0,this.buffer.length-r);this.reasoningContent+=a,this.buffer=this.buffer.slice(this.buffer.length-r);break}this.reasoningContent+=this.buffer.slice(0,e.index),this.buffer=this.buffer.slice(e.index+e.tag.length),this.isInThinkBlock=!1}else{const e=this.findThinkTag(this.buffer);if(e===null){const t=Math.max(..._o.THINK_START_VARIATIONS.map(s=>s.length)),r=Math.min(this.buffer.length,t-1),a=this.buffer.slice(0,this.buffer.length-r);this.mainContent+=a,this.buffer=this.buffer.slice(this.buffer.length-r);break}this.mainContent+=this.buffer.slice(0,e.index),this.buffer=this.buffer.slice(e.index+e.tag.length),this.isInThinkBlock=!0}}parseInlineTags(e){let t="",r="",a=e;for(;a.length>0;){const s=this.findThinkTag(a);if(s===null){t+=a;break}t+=a.slice(0,s.index);const o=this.findCloseTag(a,s.index+s.tag.length);if(o===null){r+=a.slice(s.index+s.tag.length);break}r+=a.slice(s.index+s.tag.length,o.index),a=a.slice(o.index+o.tag.length)}return{text:t,reasoning:r}}flush(){return this.buffer.length>0&&(this.isInThinkBlock?this.reasoningContent+=this.buffer:this.mainContent+=this.buffer,this.buffer=""),{content:this.mainContent,reasoning:this.reasoningContent,isInThinkBlock:this.isInThinkBlock}}reset(){this.buffer="",this.isInThinkBlock=!1,this.reasoningContent="",this.mainContent=""}}function Wj(n){const e=n.toLowerCase();return e.includes("deepseek")||e.includes(":thinking")||e.includes("-thinking")||e.includes("reasoning")?Al.SEPARATE_FIELD:(e.includes("qwen")||e.includes("qwq"),Al.INLINE_TAGS)}const yk={expand:`Please expand and elaborate on the following text, adding more detail and depth while maintaining the same style and tone:

"""
\${text}
"""

Provide only the expanded text without any additional commentary.`,rewrite:`Please rewrite the following text to improve clarity, flow, and impact while preserving the original meaning:

"""
\${text}
"""

Provide only the rewritten text without any additional commentary.`,instruct:`Please apply the following instruction to the text below:

Instruction: \${instruction}

Text:
"""
\${text}
"""

Provide only the modified text without any additional commentary.`,shorten:`Please shorten and condense the following text, making it more concise while preserving the key meaning and essential details:

"""
\${text}
"""

Provide only the shortened text without any additional commentary.`,lengthen:`Please lengthen the following text by adding more detail, depth, and elaboration while maintaining the same style and tone:

"""
\${text}
"""

Provide only the lengthened text without any additional commentary.`,vivid:`Please rewrite the following text to make it more vivid and descriptive, adding sensory details, imagery, and evocative language:

"""
\${text}
"""

Provide only the enhanced text without any additional commentary.`,emotion:`Please rewrite the following text to add more emotional depth, feeling, and character voice while preserving the original meaning:

"""
\${text}
"""

Provide only the enhanced text without any additional commentary.`,grammar:`Please fix any grammar, spelling, and punctuation errors in the following text while preserving the original meaning and style:

"""
\${text}
"""

Provide only the corrected text without any additional commentary.`},Zj=`You are Zoggy, a friendly and knowledgeable assistant built into CharacterVault.

# Your Role
You help users create, edit, and understand character cards for roleplay tools like SillyTavern. You answer questions about character card creation, best practices, and how to use CharacterVault's features.

# CharacterVault Features
Users can:
- Upload character cards (JSON or PNG) in v2 or v3 spec format
- Edit cards section by section OR create new cards from scratch
- Export finished cards as JSON or PNG (via top-right corner export)
- Add specific sections to context so you can see and help with their card content

# Available Editing Sections

## Core Character Sections:
- Image, Name, Description, Personality, Scenario, First Message, Examples, System Prompt, Post-History, Greetings, Appearance, Extensions
  - **Note**: Modern cards typically use Description for all character info. Personality/Appearance exist for legacy compatibility. NEVER suggest using them.

## Lorebook:
- Basic editing suite (entry name, trigger keys, priority, position, enabled, case sensitive, constant, content editor)
- Fine-tuning requires SillyTavern or similar tools

## Metadata (doesn't affect character behavior):
- Avatar URL (for Character Hub/Chub), Creator Notes, Creator, Version, Tags

# Your Approach
- Helpful and encouraging, especially for beginners
- Clear, concise explanations with minimal jargon (unless user shows familiarity)
- Non-judgmental about all content types (SFW to NSFW) - you're here to help with quality and functionality, not moderate content
- When users ask about adding themselves to cards, remind them to use {{user}} as the placeholder, not a hardcoded name
- If users ask vague questions about "their card" or need specific help, gently suggest adding relevant sections to context to the **Ai Context** panel (Left Side) so you can provide better assistance
- Offer concrete next steps when users seem stuck
- Explain section purposes and best practices when relevant`;class En extends Error{type;statusCode;constructor(e,t,r){super(e),this.name="AIError",this.type=t,this.statusCode=r}}class Et{config;sampler;prompts;abortController=null;static SAFETY_MARGIN=100;constructor(e,t,r){this.config=e,this.sampler=t,this.prompts=r?{...yk,...r}:yk}static estimateTokens(e){return e?Math.ceil(e.length/4):0}fitContextToLimit(e,t){if(t<=0)return[];const r=[];let a=0;for(const s of e){const o=Et.estimateTokens(s)+5;if(a+o<=t)r.push(s),a+=o;else break}return r}truncateTextToLimit(e,t){if(t<=0)return"...";const r=t*4;return e.length<=r?e:e.substring(0,Math.max(0,r-3))+"..."}abort(){this.abortController&&(this.abortController.abort(),console.log("[AIService] Request aborted by user"),this.abortController=null)}updateConfig(e){this.config=e}updateSampler(e){this.sampler=e}updatePrompts(e){this.prompts=e}interpolatePrompt(e,t){return e.replace(/\$\{text\}/g,t)}interpolateInstructPrompt(e,t,r){return e.replace(/\$\{text\}/g,t).replace(/\$\{instruction\}/g,r)}getBaseUrl(){return this.config.baseUrl.replace(/\/$/,"")}getHeaders(){const e={"Content-Type":"application/json"};return this.config.apiKey&&(e.Authorization=`Bearer ${this.config.apiKey}`),e}handleError(e){throw e instanceof En?e:e instanceof Error?e.message.includes("fetch")?new En("Network error. Please check your connection.","network"):new En(e.message,"unknown"):new En("An unknown error occurred","unknown")}async fetchModels(){try{const e=await fetch(`${this.getBaseUrl()}/models`,{method:"GET",headers:this.getHeaders()});if(!e.ok)throw e.status===401?new En("Invalid API key","auth",401):e.status===429?new En("Rate limit exceeded","rate_limit",429):new En(`Failed to fetch models: ${e.statusText}`,"server",e.status);return(await e.json()).data.map(a=>({id:a.id,name:this.formatModelName(a.id)})).sort((a,s)=>a.name.localeCompare(s.name))}catch(e){this.handleError(e)}}formatModelName(e){return e.replace(/^(openai|anthropic|google|meta|mistral)\//,"").replace(/-/g," ").replace(/_/g," ").split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")}async chatCompletion(e,t,r){const a={...this.sampler,...t},s=this.config.enableStreaming&&r;this.abortController=new AbortController;const{signal:o}=this.abortController,c={model:this.config.modelId,messages:e,temperature:a.temperature,top_p:a.topP,min_p:a.minP,top_k:a.topK,repetition_penalty:a.repetitionPenalty,stream:!!s,max_tokens:a.maxTokens,include_reasoning:this.config.enableReasoning??!1,reasoning:this.config.enableReasoning?{enabled:!0}:{enabled:!1}};try{const h=await fetch(`${this.getBaseUrl()}/chat/completions`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(c),signal:o});if(!h.ok){if(h.status===401)throw new En("Invalid API key","auth",401);if(h.status===429)throw new En("Rate limit exceeded","rate_limit",429);if(h.status===400){const E=await h.json().catch(()=>({}));throw new En(E.error?.message||"Invalid request","invalid_request",400)}let A=h.statusText||`HTTP ${h.status}`;try{const E=await h.json().catch(()=>null);E?.error?.message?A=E.error.message:E?.message&&(A=E.message)}catch{}throw new En(`API error: ${A}`,"server",h.status)}if(s&&h.body)return await this.handleStreamingResponse(h.body,r);const d=await h.json();if(!d.choices||d.choices.length===0)throw new En("No response from AI","unknown");const g=d.choices[0].message,k=g.reasoning_content,w=g.reasoning;return{content:g.content,reasoning:k??w??void 0}}catch(h){if(h instanceof Error&&h.name==="AbortError")throw console.log("[AIService] Request aborted - operation cancelled by user"),new En("Request was cancelled","unknown");this.handleError(h)}finally{this.abortController=null}}async handleStreamingResponse(e,t){const r=e.getReader(),a=new TextDecoder;let s="",o="";const c=new _o;try{for(;;){const{done:d,value:p}=await r.read();if(d)break;if(this.abortController?.signal.aborted)throw console.log("[AIService] Streaming aborted"),new En("Request was cancelled","unknown");const k=a.decode(p,{stream:!0}).split(`
`).filter(w=>w.trim()!=="");for(let w=0;w<k.length;w++){const A=k[w];if(A.startsWith("data: ")){const E=A.slice(6);if(E==="[DONE]")continue;try{const j=JSON.parse(E),D=c.parseChunk(j,this.config.modelId),U=D.content,O=D.reasoning;if(U!==s||O!==o){const J=U.slice(s.length),ee=O.slice(o.length);s=U,o=O,(J||ee)&&t({content:J||void 0,reasoning:ee||void 0})}}catch(j){console.warn("[AIService] Failed to parse streaming chunk:",j),console.warn("[AIService] Problematic line:",A.slice(0,200))}}}}const h=c.flush();if(h.content.length>s.length){const d=h.content.slice(s.length);s=h.content,t({content:d})}if(h.reasoning.length>o.length){const d=h.reasoning.slice(o.length);o=h.reasoning,t({reasoning:d})}return{content:s,reasoning:o||void 0}}finally{r.releaseLock()}}async expandText(e,t,r,a){const s=this.sampler.contextLength-this.sampler.maxTokens-Et.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.expand,""),h=Et.estimateTokens(o+c);let d=s-h,p=e;const g=Et.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const k=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(k),A=this.interpolatePrompt(this.prompts.expand,p),E=[{role:"system",content:w},{role:"user",content:A}];return this.chatCompletion(E,r,a)}async rewriteText(e,t,r,a){const s=this.sampler.contextLength-this.sampler.maxTokens-Et.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.rewrite,""),h=Et.estimateTokens(o+c);let d=s-h,p=e;const g=Et.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const k=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(k),A=this.interpolatePrompt(this.prompts.rewrite,p),E=[{role:"system",content:w},{role:"user",content:A}];return this.chatCompletion(E,r,a)}async instructText(e,t,r,a,s){const o=this.sampler.contextLength-this.sampler.maxTokens-Et.SAFETY_MARGIN,c=this.buildSystemPrompt([]),h=this.interpolateInstructPrompt(this.prompts.instruct,"",t),d=Et.estimateTokens(c+h);let p=o-d,g=e;const k=Et.estimateTokens(e);k>p?(g=this.truncateTextToLimit(e,p),p=0):p-=k;const w=this.fitContextToLimit(r,p),A=this.buildSystemPrompt(w),E=this.interpolateInstructPrompt(this.prompts.instruct,g,t),j=[{role:"system",content:A},{role:"user",content:E}];return this.chatCompletion(j,a,s)}async shortenText(e,t,r,a){const s=this.sampler.contextLength-this.sampler.maxTokens-Et.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.shorten,""),h=Et.estimateTokens(o+c);let d=s-h,p=e;const g=Et.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const k=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(k),A=this.interpolatePrompt(this.prompts.shorten,p),E=[{role:"system",content:w},{role:"user",content:A}];return this.chatCompletion(E,r,a)}async lengthenText(e,t,r,a){const s=this.sampler.contextLength-this.sampler.maxTokens-Et.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.lengthen,""),h=Et.estimateTokens(o+c);let d=s-h,p=e;const g=Et.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const k=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(k),A=this.interpolatePrompt(this.prompts.lengthen,p),E=[{role:"system",content:w},{role:"user",content:A}];return this.chatCompletion(E,r,a)}async makeVivid(e,t,r,a){const s=this.sampler.contextLength-this.sampler.maxTokens-Et.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.vivid,""),h=Et.estimateTokens(o+c);let d=s-h,p=e;const g=Et.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const k=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(k),A=this.interpolatePrompt(this.prompts.vivid,p),E=[{role:"system",content:w},{role:"user",content:A}];return this.chatCompletion(E,r,a)}async addEmotion(e,t,r,a){const s=this.sampler.contextLength-this.sampler.maxTokens-Et.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.emotion,""),h=Et.estimateTokens(o+c);let d=s-h,p=e;const g=Et.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const k=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(k),A=this.interpolatePrompt(this.prompts.emotion,p),E=[{role:"system",content:w},{role:"user",content:A}];return this.chatCompletion(E,r,a)}async fixGrammar(e,t,r,a){const s=this.sampler.contextLength-this.sampler.maxTokens-Et.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.grammar,""),h=Et.estimateTokens(o+c);let d=s-h,p=e;const g=Et.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const k=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(k),A=this.interpolatePrompt(this.prompts.grammar,p),E=[{role:"system",content:w},{role:"user",content:A}];return this.chatCompletion(E,r,a)}async askAIWithConversation(e,t,r,a,s){const o=this.sampler.contextLength-this.sampler.maxTokens-Et.SAFETY_MARGIN,c=Zj,h=Et.estimateTokens(e),p=Et.estimateTokens(c)+h;let g=o-p;const k=this.fitContextToLimit(t,g),w=k.reduce((D,U)=>D+Et.estimateTokens(U)+5,0);g-=w;const A=[];for(let D=r.length-1;D>=0;D--){const U=r[D],O=Et.estimateTokens(U.content)+10;if(g>=O)A.unshift(U),g-=O;else break}let E=c;if(k.length>0){const D=k.map((U,O)=>`--- Context Entry ${O+1} ---
${U}`).join(`

`);E+=`

Use the following context entries to inform your responses:

${D}`}const j=[{role:"system",content:E}];return A.forEach(D=>{j.push({role:D.role==="user"?"user":"assistant",content:D.content})}),j.push({role:"user",content:e}),this.chatCompletion(j,a,s)}buildSystemPrompt(e){const t="You are a helpful AI assistant for a character editing application called CharacterVault. You help users create and edit character cards for roleplay programs.";if(e.length===0)return t;const r=e.map((a,s)=>`--- Context Entry ${s+1} ---
${a}`).join(`

`);return`${t}

Use the following context entries to inform your responses:

${r}`}isReady(){return!!(this.config.apiKey&&this.config.baseUrl&&this.config.modelId)}}const by=new WeakMap;function Jj(n){return by.get(n)}function e_(n,e,t,r,a,s){const o=document.createElement("div");o.className="ai-toolbar-panel",o.style.cssText=`
    display: flex;
    flex-direction: column;
    background: var(--ai-toolbar-bg);
    border-bottom: 1px solid var(--ai-toolbar-border);
  `;const c={isProcessing:!1,isStreaming:!1,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:null,error:null,showReasoning:!1};let h=e;const d=100,p=document.createElement("div");p.className="ai-toolbar-controls",p.style.cssText=`
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    min-height: 44px;
  `,o.appendChild(p);const g=document.createElement("div");g.className="ai-result-container",g.style.cssText=`
    display: none;
    flex-direction: column;
    padding: 12px;
    border-top: 1px solid var(--ai-toolbar-border);
    background: var(--ai-toolbar-result-bg);
    max-height: 500px;
    overflow-y: auto;
  `,o.appendChild(g);const k=[{id:"expand",label:"Enhance",icon:"",color:"var(--ai-toolbar-accent-primary, #7c3aed)"},{id:"rewrite",label:"Rephrase",icon:"",color:"var(--ai-toolbar-accent-secondary, #2563eb)"},{id:"instruct",label:"Custom",icon:"",color:"var(--ai-toolbar-accent-success, #059669)"}],w=[{id:"shorten",label:"Shorten",icon:"",color:"var(--ai-toolbar-accent-warning, #d97706)"},{id:"lengthen",label:"Lengthen",icon:"",color:"var(--ai-toolbar-accent-info, #0891b2)"},{id:"vivid",label:"Vivid",icon:"",color:"var(--ai-toolbar-accent-pink, #db2777)"},{id:"emotion",label:"Emotion",icon:"",color:"var(--ai-toolbar-accent-rose, #e11d48)"},{id:"grammar",label:"Fix",icon:"",color:"var(--ai-toolbar-accent-neutral, #475569)"}];let A=!1,E=null,j="",D=!1;function U(Pe,Rt){const $t=document.createElement("button");return $t.className=`ai-toolbar-btn ai-toolbar-btn-${Pe.id}`,$t.innerHTML=`<span style="margin-right: 4px;">${Pe.icon}</span>${Pe.label}`,$t.style.cssText=`
      display: flex;
      align-items: center;
      padding: ${Rt?"6px 12px":"4px 8px"};
      font-size: ${Rt?"13px":"12px"};
      font-weight: 500;
      color: white;
      background: ${Pe.color};
      border: none;
      border-radius: 6px;
      cursor: pointer;
      opacity: 0.5;
      pointer-events: none;
      transition: opacity 0.2s, transform 0.1s;
    `,$t.addEventListener("click",()=>{A&&E&&(Rt||(ne.style.display="none"),t(Pe.id,j,E))}),$t.addEventListener("mousedown",Pt=>{Pt.preventDefault()}),$t}const O=document.createElement("div");O.className="ai-toolbar-instruct",O.style.cssText="display: none; align-items: center; gap: 6px; flex: 1; min-width: 200px;";const J=document.createElement("input");J.className="ai-toolbar-instruct-input",J.type="text",J.placeholder="What would you like me to do?",J.style.cssText=`
    flex: 1;
    padding: 6px 10px;
    font-size: 13px;
    background: var(--ai-toolbar-input-bg);
    border: 1px solid var(--ai-toolbar-input-border);
    border-radius: 6px;
    color: var(--ai-toolbar-text);
    outline: none;
  `;const ee=document.createElement("button");ee.className="ai-toolbar-instruct-send",ee.innerHTML="Send",ee.style.cssText=`
    padding: 6px 12px;
    font-size: 13px;
    font-weight: 500;
    color: white;
    background: var(--ai-toolbar-accent-success, #059669);
    border: none;
    border-radius: 6px;
    cursor: pointer;
  `;const H=document.createElement("button");H.className="ai-toolbar-instruct-cancel",H.innerHTML="Cancel",H.style.cssText=`
    padding: 6px 10px;
    font-size: 12px;
    color: var(--ai-toolbar-text-secondary);
    background: transparent;
    border: 1px solid var(--ai-toolbar-input-border);
    border-radius: 6px;
    cursor: pointer;
  `,O.appendChild(J),O.appendChild(ee),O.appendChild(H),p.appendChild(O);const L=document.createElement("div");L.className="ai-toolbar-primary",L.style.cssText="display: flex; flex-wrap: wrap; gap: 6px;";const me=new Map;for(const Pe of k){if(Pe.id==="instruct")continue;const Rt=U(Pe,!0);me.set(Pe.id,Rt),L.appendChild(Rt)}const he=document.createElement("button");he.className="ai-toolbar-btn ai-toolbar-btn-instruct",he.innerHTML='<span style="margin-right: 4px;"></span>Custom',he.style.cssText=`
    display: flex;
    align-items: center;
    padding: 6px 12px;
    font-size: 13px;
    font-weight: 500;
    color: white;
    background: var(--ai-toolbar-accent-success, #059669);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    opacity: 0.5;
    pointer-events: none;
    transition: opacity 0.2s, transform 0.1s;
  `,he.addEventListener("mousedown",Pe=>{Pe.preventDefault()}),he.addEventListener("click",()=>{A&&(D=!0,mn(),J.focus())}),me.set("instruct",he),L.appendChild(he),p.appendChild(L);const I=()=>{const Pe=J.value.trim();!Pe||!A||!E||(D=!1,t("instruct",j,E,Pe),J.value="",mn())};ee.addEventListener("click",I),J.addEventListener("keydown",Pe=>{Pe.key==="Enter"&&I(),Pe.key==="Escape"&&(D=!1,J.value="",mn())}),H.addEventListener("click",()=>{D=!1,J.value="",mn()});const te=document.createElement("button");te.className="ai-toolbar-btn-more",te.innerHTML=" More",te.style.cssText=`
    display: flex;
    align-items: center;
    padding: 6px 10px;
    font-size: 12px;
    font-weight: 500;
    color: var(--ai-toolbar-text-secondary);
    background: transparent;
    border: 1px solid var(--ai-toolbar-input-border);
    border-radius: 6px;
    cursor: pointer;
    opacity: 0.5;
    pointer-events: none;
  `;const ne=document.createElement("div");ne.style.cssText=`
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 4px;
    background: var(--ai-toolbar-bg);
    border: 1px solid var(--ai-toolbar-border);
    border-radius: 6px;
    padding: 4px;
    display: none;
    flex-direction: column;
    gap: 2px;
    z-index: 100;
    min-width: 120px;
  `;const pe=new Map;for(const Pe of w){const Rt=U(Pe,!1);pe.set(Pe.id,Rt),ne.appendChild(Rt)}const ge=document.createElement("div");ge.className="ai-toolbar-more",ge.style.cssText="position: relative;",ge.appendChild(te),ge.appendChild(ne),p.appendChild(ge);const re=document.createElement("button");re.className="ai-toolbar-btn-search",re.innerHTML="",re.title="Search & Replace (Ctrl+F)",re.style.cssText=`
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 6px 10px;
    font-size: 14px;
    background: transparent;
    border: 1px solid var(--ai-toolbar-input-border);
    border-radius: 6px;
    cursor: pointer;
    color: var(--ai-toolbar-text-secondary);
    transition: all 0.15s ease;
    margin-left: 4px;
  `,re.addEventListener("click",()=>{qj(n)}),re.addEventListener("mousedown",Pe=>{Pe.preventDefault()}),p.appendChild(re);const X=document.createElement("button");X.className="ai-toolbar-btn-abort",X.innerHTML=" Stop",X.title="Stop AI operation",X.style.cssText=`
    display: none;
    align-items: center;
    padding: 6px 12px;
    font-size: 13px;
    font-weight: 500;
    color: white;
    background: #dc2626;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
  `,X.addEventListener("click",()=>{s()}),X.addEventListener("mousedown",Pe=>{Pe.preventDefault()}),p.appendChild(X),te.addEventListener("click",()=>{if(!A)return;const Pe=ne.style.display==="flex";ne.style.display=Pe?"none":"flex"}),te.addEventListener("mousedown",Pe=>{Pe.preventDefault()}),document.addEventListener("click",Pe=>{ge.contains(Pe.target)||(ne.style.display="none")});const ve=document.createElement("div");ve.className="ai-toolbar-separator",ve.style.cssText="width: 1px; height: 24px; background: var(--ai-toolbar-border); margin: 0 4px;",p.appendChild(ve);const Te=document.createElement("span");Te.className="ai-toolbar-info",Te.textContent="Select text to use AI",Te.style.cssText=`
    font-size: 12px;
    color: var(--ai-toolbar-text-muted);
    margin-left: auto;
  `,p.appendChild(Te);const Ee=document.createElement("div");Ee.style.cssText=`
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 8px;
  `,g.appendChild(Ee);const q=document.createElement("span");q.style.cssText=`
    font-size: 12px;
    font-weight: 600;
    color: var(--ai-toolbar-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  `,Ee.appendChild(q);const ye=document.createElement("button");ye.innerHTML="",ye.style.cssText=`
    padding: 2px 6px;
    font-size: 14px;
    color: var(--ai-toolbar-text-muted);
    background: transparent;
    border: none;
    cursor: pointer;
    border-radius: 4px;
  `,ye.addEventListener("click",()=>{a()}),Ee.appendChild(ye);const Ce=document.createElement("div");Ce.style.cssText=`
    display: none;
    padding: 8px 12px;
    background: var(--ai-toolbar-error-bg);
    border: 1px solid var(--ai-toolbar-error-border);
    border-radius: 6px;
    color: var(--ai-toolbar-error-text);
    font-size: 13px;
    margin-bottom: 8px;
  `,g.appendChild(Ce);const B=document.createElement("div");B.style.cssText=`
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    gap: 12px;
  `,B.innerHTML=`
    <div style="
      width: 32px;
      height: 32px;
      border: 3px solid var(--ai-toolbar-input-border);
      border-top-color: var(--ai-toolbar-text-muted);
      border-radius: 50%;
      animation: ai-spin 1s linear infinite;
    "></div>
    <span style="font-size: 13px; color: var(--ai-toolbar-text-muted);">AI is working...</span>
    <style>
      @keyframes ai-spin {
        to { transform: rotate(360deg); }
      }
    </style>
  `,g.appendChild(B);const $e=document.createElement("div");$e.style.cssText=`
    display: none;
    margin-bottom: 8px;
    border: 1px solid var(--ai-toolbar-border);
    border-radius: 6px;
    overflow: hidden;
    flex-shrink: 0;
  `,g.appendChild($e);const rt=document.createElement("button");rt.style.cssText=`
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: 8px 12px;
    background: var(--ai-toolbar-reasoning-bg);
    border: none;
    color: var(--ai-toolbar-text-muted);
    font-size: 12px;
    cursor: pointer;
    text-align: left;
  `,rt.innerHTML=`
    <span style="display: flex; align-items: center; gap: 4px;">
      <span></span> Thinking process
    </span>
    <span class="reasoning-toggle">Show</span>
  `,$e.appendChild(rt);const Qe=document.createElement("div");Qe.style.cssText=`
    display: none;
    max-height: 150px;
    overflow-y: auto;
    padding: 8px 12px;
    background: var(--ai-toolbar-reasoning-bg);
    border-top: 1px solid var(--ai-toolbar-border);
  `,$e.appendChild(Qe);const wt=document.createElement("pre");wt.style.cssText=`
    margin: 0;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
    font-size: 11px;
    color: var(--ai-toolbar-text-muted);
    white-space: pre-wrap;
    word-break: break-word;
    line-height: 1.5;
  `,Qe.appendChild(wt),rt.addEventListener("click",()=>{const Pe=Qe.style.display==="block";Qe.style.display=Pe?"none":"block";const Rt=rt.querySelector(".reasoning-toggle");Rt&&(Rt.textContent=Pe?"Show":"Hide"),c.showReasoning=!Pe});const ft=document.createElement("div");ft.style.cssText=`
    display: none;
    padding: 12px;
    background: var(--ai-toolbar-bg);
    border: 1px solid var(--ai-toolbar-border);
    border-radius: 6px;
    margin-bottom: 12px;
  `,g.appendChild(ft);const Ot=document.createElement("p");Ot.style.cssText=`
    margin: 0;
    font-size: 13px;
    color: var(--ai-toolbar-text);
    white-space: pre-wrap;
    line-height: 1.6;
  `,ft.appendChild(Ot);const Fe=document.createElement("span");Fe.style.cssText=`
    display: inline-block;
    width: 2px;
    height: 1.2em;
    background: var(--ai-toolbar-text-muted);
    margin-left: 2px;
    animation: ai-blink 1s step-end infinite;
    vertical-align: text-bottom;
  `,Fe.innerHTML=`
    <style>
      @keyframes ai-blink {
        50% { opacity: 0; }
      }
    </style>
  `;const Yt=document.createElement("div");Yt.style.cssText=`
    display: none;
    gap: 8px;
  `,g.appendChild(Yt);const dt=document.createElement("button");dt.innerHTML=" Accept",dt.style.cssText=`
    flex: 1;
    padding: 8px 16px;
    font-size: 13px;
    font-weight: 500;
    color: white;
    background: var(--ai-toolbar-accept-bg, #16a34a);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
  `,dt.addEventListener("click",()=>{r()}),dt.addEventListener("mousedown",Pe=>{Pe.preventDefault()}),Yt.appendChild(dt);const wn=document.createElement("button");wn.innerHTML=" Reject",wn.style.cssText=`
    flex: 1;
    padding: 8px 16px;
    font-size: 13px;
    font-weight: 500;
    color: var(--ai-toolbar-text);
    background: var(--ai-toolbar-btn-hover);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
  `,wn.addEventListener("click",()=>{a()}),wn.addEventListener("mousedown",Pe=>{Pe.preventDefault()}),Yt.appendChild(wn);let vn=0,un=0,Pn=!1;g.addEventListener("scroll",()=>{Pn=!(g.scrollTop+g.clientHeight>=g.scrollHeight-10)}),Qe.addEventListener("scroll",()=>{Qe.scrollTop+Qe.clientHeight>=Qe.scrollHeight-5||(Pn=!0)});function Qn(){if(!(c.isProcessing||c.isStreaming||c.aiResult||c.error)){g.style.display="none";return}g.style.display="flex";const Rt=c.currentOperation?{expand:"Enhance",rewrite:"Rephrase",instruct:"Custom",shorten:"Shorten",lengthen:"Lengthen",vivid:"Vivid",emotion:"Emotion",grammar:"Fix"}[c.currentOperation]:"AI Result";if(q.textContent=c.isStreaming?`${Rt}...`:Rt,c.error){Ce.style.display="block",Ce.textContent=c.error,B.style.display="none",$e.style.display="none",ft.style.display="none",Yt.style.display="none";return}else Ce.style.display="none";B.style.display=c.isProcessing&&!c.isStreaming?"flex":"none";const $t=(c.streamingReasoning?.trim()?.length??0)>0||(c.aiReasoning?.trim()?.length??0)>0;if($e.style.display=$t?"block":"none",$t){if(wt.textContent=c.isStreaming?c.streamingReasoning:c.aiReasoning,c.isStreaming&&!c.showReasoning){Qe.style.display="block";const ie=rt.querySelector(".reasoning-toggle");ie&&(ie.textContent="Hide"),c.showReasoning=!0}else if(!c.isStreaming&&c.aiReasoning&&c.showReasoning){Qe.style.display="block";const ie=rt.querySelector(".reasoning-toggle");ie&&(ie.textContent="Hide")}if(c.isStreaming&&c.streamingReasoning){const ie=c.streamingReasoning.length;ie>vn&&!Pn&&requestAnimationFrame(()=>{Qe.scrollTop=Qe.scrollHeight}),vn=ie}}const Pt=c.isStreaming?c.streamingContent:c.aiResult||"";if(Pt){if(ft.style.display="block",Ot.textContent=Pt,c.isStreaming&&Ot.appendChild(Fe),c.isStreaming&&c.streamingContent){const ie=c.streamingContent.length;ie>un&&!Pn&&requestAnimationFrame(()=>{ft.scrollTop=ft.scrollHeight,g.scrollTop=g.scrollHeight}),un=ie}}else ft.style.display="none";const yn=!c.isProcessing&&!c.isStreaming&&c.aiResult&&!c.error;Yt.style.display=yn?"flex":"none",!c.isStreaming&&(c.aiResult||c.aiReasoning)&&(requestAnimationFrame(()=>{Qe.scrollTop=Qe.scrollHeight,ft.scrollTop=ft.scrollHeight,g.scrollTop=g.scrollHeight}),vn=0,un=0,Pn=!1)}function mn(){const Pe=n.state.selection.main;if(A=Pe.from!==Pe.to,A){E=Pe,j=n.state.doc.sliceString(Pe.from,Pe.to);const yn=j.length,ie=Et.estimateTokens(j),be=Math.max(0,h.contextLength-h.maxTokens-d);h.maxTokens>=h.contextLength?(Te.textContent=" Please adjust Max Tokens to be less than Context Length",Te.style.color="var(--ai-toolbar-error-text, #ef4444)",Te.classList.add("warning"),A=!1):ie>be?(be<=0?Te.textContent=" AI needs a larger context window":Te.textContent=` Selection is too long (${ie}/${be} tokens)`,Te.style.color="var(--ai-toolbar-error-text, #ef4444)",Te.classList.add("warning"),A=!1):(Te.textContent=`${yn} chars selected`,Te.style.color="var(--ai-toolbar-text-muted)",Te.classList.remove("warning"))}else E=null,j="",D=!1,J.value="",Te.textContent="Select text to use AI",Te.style.color="var(--ai-toolbar-text-muted)",Te.classList.remove("warning"),ne.style.display="none";c.isProcessing?(X.style.display="flex",O.style.display="none",L.style.display="none",ge.style.display="none",ve.style.display="none",Te.style.display="none"):D?(X.style.display="none",O.style.display="flex",L.style.display="none",ge.style.display="none",ve.style.display="none",Te.style.display="none"):(X.style.display="none",O.style.display="none",L.style.display="flex",ge.style.display="block",ve.style.display="block",Te.style.display="block");const Rt=!c.isProcessing&&D;p.classList.toggle("ai-toolbar-instruct-mode",Rt),re.style.display=Rt||c.isProcessing?"none":"flex";const $t=A?"1":"0.5",Pt=A?"auto":"none";for(const yn of me.values())yn.style.opacity=$t,yn.style.pointerEvents=Pt;for(const yn of pe.values())yn.style.opacity=$t,yn.style.pointerEvents=Pt;te.style.opacity=$t,te.style.pointerEvents=Pt}const Xn=Pe=>{const Rt=c.isProcessing;Pe.isProcessing!==void 0&&(c.isProcessing=Pe.isProcessing),Pe.isStreaming!==void 0&&(c.isStreaming=Pe.isStreaming),Pe.streamingContent!==void 0&&(c.streamingContent=Pe.streamingContent),Pe.streamingReasoning!==void 0&&(c.streamingReasoning=Pe.streamingReasoning),Pe.aiResult!==void 0&&(c.aiResult=Pe.aiResult),Pe.aiReasoning!==void 0&&(c.aiReasoning=Pe.aiReasoning),Pe.currentOperation!==void 0&&(c.currentOperation=Pe.currentOperation),Pe.error!==void 0&&(c.error=Pe.error),Rt!==c.isProcessing&&mn(),Qn()};mn(),by.set(n,Xn);const Fn={dom:o,top:!0,update:mn,updateState:mn,updateAIState:Xn,updateSampler:Pe=>{h=Pe,mn()}};return o.__panel=Fn,Fn}function t_(n){return hi.fromClass(class{constructor(e){}update(e){e.selectionSet&&by.get(e.view)}})}function n_(n,e,t,r,a){return[fd.of(s=>e_(s,n,e,t,r,a)),t_()]}const N0=on.define(),r_=Ni.define({create(){return pn.none},update(n,e){let t=n.map(e.changes);for(const r of e.effects){if(!r.is(N0))continue;const a=r.value;!a||a.from>=a.to?t=pn.none:t=pn.set([pn.mark({class:"cm-ai-accepted-highlight"}).range(a.from,a.to)])}return t},provide:n=>lt.decorations.from(n)});function ky(n){const{key:e,value:t,onChange:r,onImmediateChange:a,onPersistChange:s,saveMode:o="immediate",saveDebounceMs:c=250,setSelectedText:h,aiConfig:d,samplerSettings:p,promptSettings:g,getContextContent:k,contextSectionIds:w,minHeight:A="100px",maxHeight:E,editorStyles:j={},isActive:D=!0}=n,U=z.useRef(null),O=z.useRef(null),J=z.useRef(null),ee=z.useRef(null),[H,L]=z.useState(!1),[me,he]=z.useState(!1),[I,te]=z.useState(null),[ne,pe]=z.useState(null),[ge,re]=z.useState(""),[X,ve]=z.useState(""),[Te,Ee]=z.useState(""),[q,ye]=z.useState(null),[Ce,B]=z.useState(null),$e=z.useRef(null),rt=z.useRef(null),Qe=z.useRef(w),wt=z.useRef(null),ft=z.useRef(null),Ot=z.useRef(null),Fe=z.useRef(!1),Yt=z.useRef(!1),dt=z.useRef(!1);z.useEffect(()=>{$e.current=ne},[ne]),z.useEffect(()=>{rt.current=Ce},[Ce]),z.useEffect(()=>{Qe.current=w},[w]);const wn=z.useRef(d);z.useEffect(()=>{wn.current=d},[d]);const vn=z.useRef(a),un=z.useRef(s??r),Pn=z.useRef(o),Qn=z.useRef(c);z.useEffect(()=>{vn.current=a},[a]),z.useEffect(()=>{un.current=s??r},[s,r]),z.useEffect(()=>{Pn.current=o},[o]),z.useEffect(()=>{Qn.current=c},[c]);const mn=z.useCallback(ie=>{const be=un.current;be&&Promise.resolve(be(ie))},[]),Xn=z.useCallback(()=>{ft.current!==null&&(window.clearTimeout(ft.current),ft.current=null);const ie=Ot.current;ie!==null&&(Ot.current=null,mn(ie))},[mn]),Fn=z.useCallback(ie=>{if(un.current){if(Pn.current==="immediate"){Ot.current=null,ft.current!==null&&(window.clearTimeout(ft.current),ft.current=null),mn(ie);return}Ot.current=ie,ft.current!==null&&window.clearTimeout(ft.current),ft.current=window.setTimeout(()=>{ft.current=null;const be=Ot.current;be!==null&&(Ot.current=null,mn(be))},Qn.current)}},[mn]),Pe=z.useCallback(async(ie,be,Ke,tt)=>{const it=wn.current;ye(null),pe(null),re(""),ve(""),Ee(""),te(ie),L(!0),he(it.enableStreaming),J.current?.({isProcessing:!0,isStreaming:it.enableStreaming,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:ie,error:null});const Ne={from:Ke.from,to:Ke.to,text:be};rt.current=Ne,B(Ne),h(be);try{console.log("[useAIEditor] Using model:",it.modelId,"Base URL:",it.baseUrl);const Be=new Et(it,p,g);ee.current=Be;const je=k(Qe.current),He=it.enableStreaming?Se=>{Se.reasoning&&Ee(ot=>{const mt=ot+Se.reasoning;return J.current?.({streamingReasoning:mt}),mt}),Se.content&&ve(ot=>{const mt=ot+Se.content;return J.current?.({streamingContent:mt}),mt})}:void 0;let De;switch(ie){case"expand":De=await Be.expandText(be,je,void 0,He);break;case"rewrite":De=await Be.rewriteText(be,je,void 0,He);break;case"instruct":if(!tt)throw new Error("No custom prompt provided");De=await Be.instructText(be,tt,je,void 0,He);break;case"shorten":De=await Be.shortenText(be,je,void 0,He);break;case"lengthen":De=await Be.lengthenText(be,je,void 0,He);break;case"vivid":De=await Be.makeVivid(be,je,void 0,He);break;case"emotion":De=await Be.addEmotion(be,je,void 0,He);break;case"grammar":De=await Be.fixGrammar(be,je,void 0,He);break;default:throw new Error("Unknown operation")}$e.current=De.content,pe(De.content),re(De.reasoning||""),L(!1),he(!1),J.current?.({isProcessing:!1,isStreaming:!1,aiResult:De.content,aiReasoning:De.reasoning||""})}catch(Be){if(Be instanceof En&&Be.message==="Request was cancelled")console.log("[useAIEditor] AI request cancelled by user"),L(!1),he(!1),J.current?.({isProcessing:!1,isStreaming:!1,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:null,error:null});else{console.error("AI operation failed:",Be);const je=Be instanceof En?Be.message:"AI operation failed. Please try again.";ye(je),L(!1),he(!1),J.current?.({isProcessing:!1,isStreaming:!1,error:je})}}finally{ee.current=null}},[d,p,g,k,h]),Rt=z.useCallback(()=>{const ie=$e.current,be=rt.current,Ke=O.current;if(!Ke||!ie||!be)return;const tt=be.from,it=tt+ie.length;Ke.dispatch({changes:{from:tt,to:be.to,insert:ie},selection:{anchor:tt,head:it},effects:N0.of({from:tt,to:it})}),wt.current!==null&&window.clearTimeout(wt.current),wt.current=window.setTimeout(()=>{const Ne=O.current;Ne&&(Ne.dispatch({effects:N0.of(null)}),wt.current=null)},4e3),pe(null),re(""),ve(""),Ee(""),te(null),ye(null),B(null),h(""),J.current?.({isProcessing:!1,isStreaming:!1,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:null,error:null})},[h]),$t=z.useCallback(()=>{pe(null),re(""),ve(""),Ee(""),te(null),ye(null),L(!1),he(!1),B(null),h(""),J.current?.({isProcessing:!1,isStreaming:!1,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:null,error:null})},[h]),Pt=z.useCallback(()=>{ee.current&&ee.current.abort()},[]),yn=z.useCallback(ie=>{const be=O.current;if(!be)return;const Ke=be.state.doc.toString();ie!==Ke&&be.dispatch({changes:{from:0,to:Ke.length,insert:ie}})},[]);return z.useEffect(()=>{if(!U.current||!D)return;const ie=Ut.create({doc:t,extensions:[hd.of(pj),hd.of(vM),cM(),Aj,u5(),lt.lineWrapping,lt.contentAttributes.of({spellcheck:"true"}),lt.theme({"&":{fontSize:"clamp(14px, 2.6vw, 16px)",height:"100%",overflow:"hidden",...j},".cm-scroller":{height:E?"auto":"100%",maxHeight:E??"100%",overflowY:"auto",overflowX:"hidden",overscrollBehaviorY:"contain",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},".cm-content":{fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace",padding:"clamp(8px, 2vw, 12px)",minHeight:A},".cm-gutters":{backgroundColor:"transparent",border:"none"},".cm-activeLineGutter":{backgroundColor:"transparent"},".cm-line":{padding:"0 clamp(2px, 0.8vw, 4px)"}}),lt.baseTheme({".cm-ai-accepted-highlight":{backgroundColor:"rgba(22, 163, 74, 0.28)",outline:"1px solid rgba(22, 163, 74, 0.5)",borderRadius:"2px"}}),r_,lt.updateListener.of(Ke=>{if(Ke.docChanged){const it=Ke.state.doc.toString();Fe.current||(dt.current=!0),vn.current?.(it),Fe.current||Fn(it)}Ke.focusChanged&&(Yt.current=Ke.view.hasFocus,Yt.current||Xn());const tt=Ke.state.selection.main;if(tt.from!==tt.to){const it=Ke.state.doc.sliceString(tt.from,tt.to);B({from:tt.from,to:tt.to,text:it}),h(it)}else B(null),h("")}),n_(p,(Ke,tt,it,Ne)=>{Pe(Ke,tt,it,Ne)},Rt,$t,Pt),Qj(),Xj()]}),be=new lt({state:ie,parent:U.current});return O.current=be,setTimeout(()=>{be.focus()},50),setTimeout(()=>{const Ke=Jj(be);Ke&&(J.current=Ke)},100),()=>{wt.current!==null&&(window.clearTimeout(wt.current),wt.current=null),Xn(),ft.current!==null&&(window.clearTimeout(ft.current),ft.current=null),be.destroy(),O.current=null,J.current=null}},[e,D,A,E,JSON.stringify(j),Xn,Fn]),z.useEffect(()=>{const ie=O.current;if(!ie)return;const be=ie.state.doc.toString();if(t===be){dt.current=!1;return}if(Yt.current&&dt.current)return;const Ke=ie.state.selection.main,tt=Math.min(Ke.anchor,t.length),it=Math.min(Ke.head,t.length);Fe.current=!0,ie.dispatch({changes:{from:0,to:be.length,insert:t},selection:{anchor:tt,head:it}}),Fe.current=!1,dt.current=!1},[t]),z.useEffect(()=>{const ie=O.current;if(!ie)return;const be=ie.dom.querySelector(".ai-toolbar-panel");be?.__panel?.updateSampler&&be.__panel.updateSampler(p)},[p]),{editorRef:U,view:O.current,selection:Ce,isProcessing:H,isStreaming:me,currentOperation:I,aiResult:ne,accept:Rt,reject:$t,setContent:yn}}function i_({greeting:n,index:e,isOpen:t,onToggle:r,onImmediateUpdate:a,onPersistUpdate:s,onDelete:o,aiConfig:c,samplerSettings:h,promptSettings:d,getContextContent:p,contextSectionIds:g,setSelectedText:k}){const{editorRef:w}=ky({value:n,onImmediateChange:a,onPersistChange:s,setSelectedText:k,aiConfig:c,samplerSettings:h,promptSettings:d,getContextContent:p,contextSectionIds:g,minHeight:"clamp(84px, 18vh, 140px)",maxHeight:"clamp(180px, 36vh, 300px)",isActive:t});return b.jsxs("div",{className:"border border-vault-200 dark:border-vault-700 rounded-lg overflow-hidden bg-white dark:bg-vault-800",children:[b.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-vault-50 dark:bg-vault-700/50 border-b border-vault-200 dark:border-vault-700",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsxs("span",{className:"text-sm font-medium text-vault-700 dark:text-vault-300",children:["Greeting ",e+1]}),b.jsxs("span",{className:"text-xs text-vault-500 dark:text-vault-400",children:["(",n.length," chars)"]})]}),b.jsxs("div",{className:"flex items-center gap-1",children:[b.jsx("button",{onClick:r,className:"p-1 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-700 rounded transition-colors",title:t?"Collapse":"Expand",children:t?b.jsx(Po,{className:"w-4 h-4"}):b.jsx(La,{className:"w-4 h-4"})}),b.jsx("button",{onClick:o,className:"p-1 text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Delete greeting",children:b.jsx(_l,{className:"w-4 h-4"})})]})]}),t&&b.jsx("div",{ref:w,className:"min-h-[clamp(84px,18vh,140px)]"}),!t&&b.jsx("div",{className:"px-4 py-3 text-sm text-vault-600 dark:text-vault-400 italic truncate",children:n||b.jsx("span",{className:"text-vault-400",children:"Empty greeting"})})]})}function a_({greetings:n,onChange:e,setSelectedText:t,contextSectionIds:r,aiConfig:a,samplerSettings:s,promptSettings:o,getContextContent:c}){const[h,d]=z.useState(n),[p,g]=z.useState(new Set([0]));z.useEffect(()=>{const U=setTimeout(()=>{d(n)},0);return()=>clearTimeout(U)},[n]);const k=z.useCallback((U,O)=>{const J=[...h];return J[U]=O,J},[h]),w=z.useCallback((U,O)=>{d(k(U,O))},[k]),A=z.useCallback((U,O)=>{e(k(U,O))},[k,e]),E=z.useCallback(()=>{const U=[...h,""],O=new Set(p);O.add(U.length-1),d(U),g(O),e(U)},[h,p,e]),j=z.useCallback(U=>{if(!window.confirm(`Delete greeting ${U+1}?`))return;const J=h.filter((L,me)=>me!==U),ee=new Set(p);ee.delete(U);const H=new Set;ee.forEach(L=>{L>U?H.add(L-1):H.add(L)}),d(J),g(H),e(J)},[h,p,e]),D=z.useCallback(U=>{const O=new Set(p);O.has(U)?O.delete(U):O.add(U),g(O)},[p]);return b.jsxs("div",{className:"h-full flex flex-col min-h-0 overflow-hidden",children:[b.jsxs("div",{className:"mb-4 flex items-center justify-between shrink-0",children:[b.jsxs("div",{children:[b.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:"Greetings"}),b.jsxs("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:["Alternate greetings for your character (",h.length," total)"]})]}),b.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-vault-600 hover:bg-vault-700 text-white text-sm rounded-lg transition-colors",children:[b.jsx(Zo,{className:"w-4 h-4"}),"Add Greeting"]})]}),b.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 min-h-0",children:h.length===0?b.jsxs("div",{className:"text-center py-12 text-vault-400 dark:text-vault-500",children:[b.jsx("p",{className:"text-sm",children:"No alternate greetings yet"}),b.jsx("p",{className:"text-xs mt-1",children:'Click "Add Greeting" to create one'})]}):h.map((U,O)=>b.jsx(i_,{greeting:U,index:O,isOpen:p.has(O),onToggle:()=>D(O),onImmediateUpdate:J=>w(O,J),onPersistUpdate:J=>A(O,J),onDelete:()=>j(O),aiConfig:a,samplerSettings:s,promptSettings:o,getContextContent:c,contextSectionIds:r,setSelectedText:t},O))})]})}const l_=[{value:"before_char",label:"Before Character"},{value:"after_char",label:"After Character"},{value:"before_example",label:"Before Example"},{value:"after_example",label:"After Example"}];function s_({entry:n,index:e,isOpen:t,onToggle:r,onUpdate:a,onDelete:s,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,contextSectionIds:p,setSelectedText:g}){const{editorRef:k}=ky({value:n.content,onChange:I=>a({...n,content:I}),setSelectedText:g,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,contextSectionIds:p,minHeight:"clamp(110px, 22vh, 180px)",maxHeight:"clamp(220px, 40vh, 360px)",isActive:t}),[w,A]=Ci.useState(n.keys.join(", "));Ci.useEffect(()=>{const I=n.keys.join(", ");A(te=>te!==I?I:te)},[n.keys]);const E=I=>a({...n,name:I}),j=I=>{A(I)},D=()=>{const I=w.split(",").map(te=>te.trim()).filter(te=>te);a({...n,keys:I})},U=I=>a({...n,comment:I}),O=I=>{const te=parseInt(I,10);a({...n,priority:isNaN(te)?0:te})},J=I=>a({...n,position:I}),ee=I=>a({...n,enabled:I}),H=I=>a({...n,case_sensitive:I}),L=I=>a({...n,constant:I}),me=n.keys.join(", ")||"No keys",he=n.enabled?"Enabled":"Disabled";return b.jsxs("div",{className:"border border-vault-200 dark:border-vault-700 rounded-xl overflow-hidden bg-white dark:bg-vault-800 shadow-sm",children:[b.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-vault-50 dark:bg-vault-700/50 border-b border-vault-200 dark:border-vault-700",children:[b.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[b.jsxs("span",{className:"text-xs font-mono text-vault-400 dark:text-vault-500 shrink-0",children:["(UID: ",n.id,")"]}),b.jsx("span",{className:"text-sm font-medium text-vault-700 dark:text-vault-300 truncate",children:n.name||`Entry ${e+1}`}),b.jsxs("span",{className:"text-xs text-vault-500 dark:text-vault-400 shrink-0",children:["(",n.keys.length," keys)"]}),b.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full shrink-0 ${n.enabled?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}`,children:he})]}),b.jsxs("div",{className:"flex items-center gap-1",children:[b.jsx("button",{onClick:r,className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-700 rounded-lg transition-colors",title:t?"Collapse":"Expand",children:t?b.jsx(Po,{className:"w-4 h-4"}):b.jsx(La,{className:"w-4 h-4"})}),b.jsx("button",{onClick:s,className:"p-1.5 text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Delete entry",children:b.jsx(_l,{className:"w-4 h-4"})})]})]}),t&&b.jsxs("div",{className:"p-4 space-y-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Entry Name"}),b.jsx("input",{type:"text",value:n.name||"",onChange:I=>E(I.target.value),placeholder:"Entry display name (optional)",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]}),b.jsxs("div",{children:[b.jsxs("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:["Trigger Keys ",b.jsx("span",{className:"text-vault-400",children:"(comma-separated)"})]}),b.jsx("input",{type:"text",value:w,onChange:I=>j(I.target.value),onBlur:D,placeholder:"castle, fortress, stronghold",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]}),b.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Priority"}),b.jsx("input",{type:"number",value:n.priority??0,onChange:I=>O(I.target.value),className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                  text-vault-900 dark:text-vault-100\r
                  focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Position"}),b.jsx("select",{value:n.position||"before_char",onChange:I=>J(I.target.value),className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                  text-vault-900 dark:text-vault-100\r
                  focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`,children:l_.map(I=>b.jsx("option",{value:I.value,children:I.label},I.value))})]}),b.jsxs("div",{className:"flex flex-col gap-2",children:[b.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[b.jsx("input",{type:"checkbox",checked:n.enabled,onChange:I=>ee(I.target.checked),className:"w-4 h-4 rounded border-vault-300 text-vault-600 focus:ring-vault-500"}),b.jsx("span",{className:"text-xs text-vault-600 dark:text-vault-400",children:"Enabled"})]}),b.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[b.jsx("input",{type:"checkbox",checked:n.case_sensitive,onChange:I=>H(I.target.checked),className:"w-4 h-4 rounded border-vault-300 text-vault-600 focus:ring-vault-500"}),b.jsx("span",{className:"text-xs text-vault-600 dark:text-vault-400",children:"Case Sensitive"})]})]}),b.jsx("div",{className:"flex flex-col gap-2",children:b.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[b.jsx("input",{type:"checkbox",checked:n.constant??!1,onChange:I=>L(I.target.checked),className:"w-4 h-4 rounded border-vault-300 text-vault-600 focus:ring-vault-500"}),b.jsx("span",{className:"text-xs text-vault-600 dark:text-vault-400",children:"Constant"})]})})]}),b.jsxs("div",{children:[b.jsxs("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:["Content ",b.jsx("span",{className:"text-vault-400",children:"(AI toolbar available when text is selected)"})]}),b.jsx("div",{ref:k,className:"border border-vault-200 dark:border-vault-700 rounded-xl overflow-hidden min-h-[clamp(110px,22vh,180px)]"})]}),b.jsxs("div",{children:[b.jsxs("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:["Comment ",b.jsx("span",{className:"text-vault-400",children:"(internal notes, not included in output)"})]}),b.jsx("input",{type:"text",value:n.comment||"",onChange:I=>U(I.target.value),placeholder:"Internal notes about this entry",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]})]}),!t&&b.jsxs("div",{className:"px-4 py-3 bg-vault-50/50 dark:bg-vault-800/50",children:[b.jsxs("div",{className:"text-xs text-vault-600 dark:text-vault-400 mb-1",children:[b.jsx("strong",{children:"Keys:"})," ",me]}),b.jsx("div",{className:"text-xs text-vault-500 dark:text-vault-500 truncate",children:n.content||b.jsx("span",{className:"italic",children:"No content"})})]})]})}function o_({lorebook:n,onChange:e,setSelectedText:t,contextSectionIds:r,aiConfig:a,samplerSettings:s,promptSettings:o,getContextContent:c,activeSection:h}){return b.jsx(u_,{lorebook:n,onChange:e,setSelectedText:t,contextSectionIds:r,aiConfig:a,samplerSettings:s,promptSettings:o,getContextContent:c,activeSection:h})}function u_({lorebook:n,onChange:e,setSelectedText:t,contextSectionIds:r,aiConfig:a,samplerSettings:s,promptSettings:o,getContextContent:c}){const[h,d]=z.useState(new Set([0])),p=z.useRef(null),g=z.useRef(new Map),k=z.useMemo(()=>({name:n?.name||"",description:n?.description||"",entries:n?.entries||[],extensions:n?.extensions||{}}),[n]),[w,A]=z.useState(()=>({name:n?.name||"",description:n?.description||"",entries:n?.entries||[],extensions:n?.extensions||{}}));z.useEffect(()=>{const I=setTimeout(()=>{A(k)},0);return()=>clearTimeout(I)},[k]);const E=z.useMemo(()=>w.entries,[w.entries]),j=w.name??"",D=w.description??"",U=z.useCallback((I,te,ne)=>{const pe={name:te,description:ne,entries:I,extensions:w.extensions||{}};A(pe),e(pe)},[w.extensions,e]),O=z.useCallback((I,te)=>{const ne=[...E];ne[I]=te,U(ne,j,D)},[E,j,D,U]),J=z.useCallback(()=>{const I=new Set(E.map(ne=>ne.id));let te=0;for(;I.has(te);)te++;return te},[E]),ee=z.useCallback(()=>{const I=J(),te={id:I,keys:[],content:"",extensions:{},enabled:!0,insertion_order:E.length,case_sensitive:!1,name:"",priority:0,position:"before_char"},ne=[...E,te],pe=ne.length-1;p.current=I,d(ge=>new Set([...ge,pe])),U(ne,j,D)},[E,j,D,U,J]);z.useEffect(()=>{const I=p.current;if(I==null)return;const te=()=>{const pe=g.current.get(I);return pe?(pe.scrollIntoView({behavior:"smooth",block:"start"}),p.current=null,!0):!1};if(te())return;const ne=window.requestAnimationFrame(()=>{te()});return()=>{window.cancelAnimationFrame(ne)}},[E.length,h]);const H=z.useCallback(I=>{if(!window.confirm(`Delete lorebook entry ${I+1}?`))return;const ne=E.filter((ge,re)=>re!==I),pe=new Set;h.forEach(ge=>{ge<I?pe.add(ge):ge>I&&pe.add(ge-1)}),d(pe),U(ne,j,D)},[E,h,j,D,U]),L=z.useCallback(I=>{const te=new Set(h);te.has(I)?te.delete(I):te.add(I),d(te)},[h]),me=I=>{U(E,I,D)},he=I=>{U(E,j,I)};return b.jsxs("div",{className:"h-full flex flex-col min-h-0 overflow-hidden",children:[b.jsxs("div",{className:"mb-4 flex items-center justify-between shrink-0",children:[b.jsxs("div",{children:[b.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:"Lorebook"}),b.jsxs("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:[E.length," entr",E.length===1?"y":"ies"," total"]})]}),b.jsxs("button",{onClick:ee,className:"flex items-center gap-2 px-4 py-2 bg-vault-600 hover:bg-vault-700 text-white text-sm rounded-lg transition-colors",children:[b.jsx(Zo,{className:"w-4 h-4"}),"Add Entry"]})]}),b.jsxs("div",{className:"mb-4 p-4 bg-vault-50 dark:bg-vault-800/50 border border-vault-200 dark:border-vault-700 rounded-xl shrink-0",children:[b.jsx("h3",{className:"text-sm font-semibold text-vault-700 dark:text-vault-300 mb-3",children:"Book Settings"}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Book Name"}),b.jsx("input",{type:"text",value:j,onChange:I=>me(I.target.value),placeholder:"Character Lorebook",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Description"}),b.jsx("input",{type:"text",value:D,onChange:I=>he(I.target.value),placeholder:"Brief description of this lorebook",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]})]})]}),b.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 min-h-0",children:E.length===0?b.jsxs("div",{className:"text-center py-12 text-vault-400 dark:text-vault-500",children:[b.jsx(q0,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),b.jsx("p",{className:"text-sm",children:"No lore entries yet"}),b.jsx("p",{className:"text-xs mt-1",children:'Click "Add Entry" to create your first lore entry'})]}):E.map((I,te)=>b.jsx("div",{ref:ne=>{ne?g.current.set(I.id,ne):g.current.delete(I.id)},children:b.jsx(s_,{entry:I,index:te,isOpen:h.has(te),onToggle:()=>L(te),onUpdate:ne=>O(te,ne),onDelete:()=>H(te),aiConfig:a,samplerSettings:s,promptSettings:o,getContextContent:c,contextSectionIds:r,setSelectedText:t})},I.id))}),b.jsx("div",{className:"mt-4 p-3 bg-vault-50 dark:bg-vault-800/50 border border-vault-200 dark:border-vault-700 rounded-lg shrink-0",children:b.jsxs("p",{className:"text-xs text-vault-600 dark:text-vault-400",children:[b.jsx("strong",{children:"Note:"})," This editor provides essential lore management. For advanced logic or complex world-building features, power users may prefer using dedicated tools like SillyTavern's World Info."]})})]})}function c_(n,e){const t=n.data.spec;switch(e){case"name":return String(t.name||"");case"description":return String(t.description||"");case"personality":return String(t.personality||"");case"scenario":return String(t.scenario||"");case"first_mes":return String(t.first_mes||"");case"mes_example":return String(t.mes_example||"");case"system_prompt":return String(t.system_prompt||"");case"post_history_instructions":return String(t.post_history_instructions||"");case"alternate_greetings":return Array.isArray(t.alternate_greetings)?t.alternate_greetings.join(`
---
`):"";case"physical_description":return String(t.physical_description||"");case"extensions":return JSON.stringify(n.data.extensions||{},null,2);case"avatar":return String(t.avatar||"");case"creator_notes":return String(t.creator_notes||"");case"creator":return String(t.creator||"");case"character_version":return String(t.character_version||"");case"tags":return Array.isArray(t.tags)?t.tags.join(", "):"";default:return""}}function h_({section:n}){const{currentCharacter:e,updateCharacter:t,updateSpecField:r,setSelectedText:a,contextSectionIds:s,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,activeSection:p}=Wo(),g=Ci.useMemo(()=>e?c_(e,n):"",[e,n]),k=z.useCallback(E=>{n==="image"||n==="extensions"||n==="lorebook"||(n==="alternate_greetings"?r(n,E.split(`
---
`).filter(j=>j.trim())):n==="tags"?r(n,E.split(",").map(j=>j.trim()).filter(j=>j)):r(n,E))},[n,r]),{editorRef:w}=ky({key:n,value:g,onPersistChange:k,setSelectedText:a,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,contextSectionIds:s,minHeight:"clamp(180px, 40vh, 400px)",editorStyles:{padding:"clamp(8px, 2vw, 16px)"},isActive:n!=="image"&&n!=="alternate_greetings"&&n!=="lorebook"&&!!e});if(!e)return b.jsx("div",{children:"No character selected"});const A=ws.find(E=>E.id===n);return n==="image"?b.jsx("div",{className:"h-full flex items-center justify-center text-vault-500 animate-fade-in-slow",children:b.jsx("p",{children:"Use the Image section in the left sidebar to upload a character image."})}):n==="extensions"?b.jsxs("div",{className:"h-full flex flex-col min-h-0 overflow-hidden animate-fade-in-slow",children:[b.jsxs("div",{className:"mb-4 shrink-0",children:[b.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:A?.label}),b.jsx("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:"Extension data (JSON format)"})]}),b.jsx("div",{ref:w,className:"flex-1 min-h-0 border border-vault-200 dark:border-vault-700 rounded-xl overflow-hidden"})]}):n==="alternate_greetings"?b.jsx("div",{className:"h-full animate-fade-in-slow",children:b.jsx(a_,{greetings:e?.data?.spec?.alternate_greetings||[],onChange:E=>{r(n,E)},selectedText:"",setSelectedText:a,contextSectionIds:s,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,activeSection:p})}):n==="lorebook"?b.jsx("div",{className:"h-full animate-fade-in-slow",children:b.jsx(o_,{lorebook:e?.data?.characterBook,onChange:E=>{t({data:{...e.data,characterBook:E}})},setSelectedText:a,contextSectionIds:s,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,activeSection:p})}):b.jsxs("div",{className:"h-full flex flex-col min-h-0 overflow-hidden animate-fade-in-slow",children:[b.jsxs("div",{className:"mb-4 shrink-0",children:[b.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:A?.label}),b.jsx("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:A?.description})]}),b.jsx("div",{ref:w,className:"flex-1 min-h-0 border border-vault-200 dark:border-vault-700 rounded-xl overflow-hidden"})]})}function f_({onClose:n,isMobile:e=!1}){const{currentCharacter:t,contextSectionIds:r,setContextSectionIds:a,addContextSection:s,removeContextSection:o,samplerSettings:c}=Wo(),[h,d]=z.useState(""),[p,g]=z.useState(!0),[k,w]=z.useState(!0),A=c.contextLength,E=ws.filter(O=>{if(["image","extensions","avatar","character_version","tags"].includes(O.id)||r.includes(O.id)||O.id==="lorebook"&&!(t?.data.characterBook&&t.data.characterBook.entries.length>0))return!1;if(!h.trim())return!0;const ee=h.toLowerCase();return O.label.toLowerCase().includes(ee)||O.description.toLowerCase().includes(ee)}),j=ws.filter(O=>r.includes(O.id)),D=z.useCallback(()=>{if(!t)return 0;let O=0;return r.forEach(J=>{const ee=t.data.spec;switch(J){case"name":O+=ee.name.length;break;case"description":O+=ee.description.length;break;case"personality":O+=ee.personality.length;break;case"scenario":O+=ee.scenario.length;break;case"first_mes":O+=ee.first_mes.length;break;case"mes_example":O+=ee.mes_example.length;break;case"system_prompt":O+=ee.system_prompt.length;break;case"post_history_instructions":O+=ee.post_history_instructions.length;break;case"alternate_greetings":O+=ee.alternate_greetings.join(`
---
`).length;break;case"physical_description":O+=ee.physical_description.length;break;case"creator":O+=ee.creator?.length||0;break;case"creator_notes":O+=ee.creator_notes?.length||0;break;case"lorebook":{const H=t.data.characterBook;H&&(O+=H.name?.length||0,O+=H.description?.length||0,H.entries.forEach(L=>{L.enabled&&(O+=L.content.length,O+=L.keys.join(",").length,O+=L.name?.length||0,O+=L.comment?.length||0)}));break}}}),Math.ceil(O/4)},[t,r]),U=Ci.useMemo(()=>{const O=D(),J=Math.min(100,O/A*100);let ee="good";return J>80?ee="danger":J>50&&(ee="warning"),{tokenCount:O,percentage:J,status:ee}},[D,A]);return t?b.jsxs("div",{className:"h-full flex flex-col bg-vault-50 dark:bg-vault-900 border-r border-vault-200 dark:border-vault-800 animate-fade-in-slow",children:[b.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-vault-200 dark:border-vault-800 bg-vault-100 dark:bg-vault-800/50 shrink-0",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx(Ba,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),b.jsx("h2",{className:"font-semibold text-vault-900 dark:text-vault-100",children:"AI Context"})]}),b.jsxs("div",{className:"flex items-center gap-1",children:[b.jsx("button",{onClick:()=>a([]),className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-800 rounded-lg transition-colors disabled:opacity-50",title:"Clear all context",disabled:r.length===0,children:b.jsx(xw,{className:"w-4 h-4"})}),e&&n&&b.jsx("button",{onClick:n,className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-800 rounded-lg transition-colors",title:"Close Context Panel",children:b.jsx(za,{className:"w-4 h-4"})})]})]}),b.jsxs("div",{className:"border-b border-vault-200 dark:border-vault-800 shrink-0",children:[b.jsxs("button",{onClick:()=>g(!p),className:"w-full flex items-center justify-between px-4 py-2.5 hover:bg-vault-100 dark:hover:bg-vault-800/50 transition-colors",children:[b.jsxs("h3",{className:"text-xs font-medium text-vault-500 dark:text-vault-400 uppercase tracking-wide",children:["Selected Context (",j.length,")"]}),p?b.jsx(Po,{className:"w-4 h-4 text-vault-400"}):b.jsx(La,{className:"w-4 h-4 text-vault-400"})]}),p&&b.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[j.length>0&&b.jsxs("div",{className:"p-3 bg-white dark:bg-vault-800 rounded-lg border border-vault-200 dark:border-vault-700",children:[b.jsxs("div",{className:"flex items-center justify-between mb-2",children:[b.jsx("span",{className:"text-xs text-vault-600 dark:text-vault-400",children:"Context Usage"}),b.jsxs("span",{className:`text-xs font-medium ${U.status==="good"?"text-green-600 dark:text-green-400":U.status==="warning"?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,children:[U.percentage.toFixed(0),"%"]})]}),b.jsx("div",{className:"h-2 bg-vault-200 dark:bg-vault-700 rounded-full overflow-hidden mb-2",children:b.jsx("div",{className:`h-full transition-all duration-300 ${U.status==="good"?"bg-green-500":U.status==="warning"?"bg-yellow-500":"bg-red-500"}`,style:{width:`${U.percentage}%`}})}),b.jsxs("div",{className:"flex items-center justify-between text-xs",children:[b.jsxs("span",{className:"text-vault-500 dark:text-vault-400",children:[U.tokenCount.toLocaleString()," / ",A.toLocaleString()," tokens"]}),U.status==="danger"&&b.jsxs("span",{className:"flex items-center gap-1 text-red-600 dark:text-red-400",children:[b.jsx(Wi,{className:"w-3 h-3"}),"Over limit"]})]})]}),b.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:b.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-700 dark:text-blue-400",children:[b.jsx(jT,{className:"w-4 h-4 shrink-0"}),b.jsx("span",{children:"Current section is automatically included"})]})}),j.length===0?b.jsxs("div",{className:"text-center py-4 text-vault-400 dark:text-vault-500",children:[b.jsx(Zf,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),b.jsx("p",{className:"text-sm",children:"No context selected"}),b.jsx("p",{className:"text-xs mt-1",children:"Add sections to provide context for AI"})]}):b.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:j.map(O=>b.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border bg-white dark:bg-vault-800 border-vault-200 dark:border-vault-700",children:[b.jsx("span",{className:"text-sm font-medium text-vault-900 dark:text-vault-100",children:O.label}),b.jsx("button",{onClick:()=>o(O.id),className:"p-1.5 text-vault-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors ml-2",title:"Remove from context",children:b.jsx(_l,{className:"w-3.5 h-3.5"})})]},O.id))})]})]}),b.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[b.jsxs("button",{onClick:()=>w(!k),className:"w-full flex items-center justify-between px-4 py-2.5 border-b border-vault-200 dark:border-vault-800 hover:bg-vault-100 dark:hover:bg-vault-800/50 transition-colors shrink-0",children:[b.jsx("h3",{className:"text-xs font-medium text-vault-500 dark:text-vault-400 uppercase tracking-wide",children:"Add Context"}),k?b.jsx(Po,{className:"w-4 h-4 text-vault-400"}):b.jsx(La,{className:"w-4 h-4 text-vault-400"})]}),k&&b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"p-4 border-b border-vault-200 dark:border-vault-800 shrink-0",children:b.jsxs("div",{className:"relative",children:[b.jsx(Jf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-vault-400"}),b.jsx("input",{type:"text",value:h,onChange:O=>d(O.target.value),placeholder:"Search sections...",className:"w-full pl-9 pr-4 py-2 text-sm border border-vault-300 dark:border-vault-700 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 placeholder-vault-400 focus:outline-none focus:ring-2 focus:ring-vault-500"})]})}),b.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:E.length===0?b.jsx("div",{className:"text-center py-8 text-vault-400 dark:text-vault-500",children:b.jsx("p",{className:"text-sm",children:h.trim()?"No matching sections found":"All sections are in context"})}):b.jsx("div",{className:"space-y-2",children:E.map(O=>b.jsx("button",{onClick:()=>{s(O.id),d("")},className:"w-full text-left p-3 bg-white dark:bg-vault-800 hover:bg-vault-100 dark:hover:bg-vault-700 border border-vault-200 dark:border-vault-700 rounded-lg transition-colors group",children:b.jsxs("div",{className:"flex items-start justify-between gap-2",children:[b.jsxs("div",{className:"flex-1 min-w-0",children:[b.jsx("p",{className:"text-sm font-medium text-vault-900 dark:text-vault-100 truncate group-hover:text-vault-600 dark:group-hover:text-vault-400",children:O.label}),b.jsx("p",{className:"text-xs text-vault-500 mt-1",children:O.description})]}),b.jsx(Zo,{className:"w-4 h-4 text-vault-400 group-hover:text-vault-600 dark:group-hover:text-vault-400 shrink-0 mt-0.5"})]})},O.id))})})]})]})]}):b.jsx(b.Fragment,{})}function d_(n,e){const t={};return(n[n.length-1]===""?[...n,""]:n).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const p_=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,m_=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,g_={};function xk(n,e){return(g_.jsx?m_:p_).test(n)}const y_=/[ \t\n\f\r]/g;function x_(n){return typeof n=="object"?n.type==="text"?vk(n.value):!1:vk(n)}function vk(n){return n.replace(y_,"")===""}class eh{constructor(e,t,r){this.normal=t,this.property=e,r&&(this.space=r)}}eh.prototype.normal={};eh.prototype.property={};eh.prototype.space=void 0;function V2(n,e){const t={},r={};for(const a of n)Object.assign(t,a.property),Object.assign(r,a.normal);return new eh(t,r,e)}function E0(n){return n.toLowerCase()}class Dr{constructor(e,t){this.attribute=t,this.property=e}}Dr.prototype.attribute="";Dr.prototype.booleanish=!1;Dr.prototype.boolean=!1;Dr.prototype.commaOrSpaceSeparated=!1;Dr.prototype.commaSeparated=!1;Dr.prototype.defined=!1;Dr.prototype.mustUseProperty=!1;Dr.prototype.number=!1;Dr.prototype.overloadedBoolean=!1;Dr.prototype.property="";Dr.prototype.spaceSeparated=!1;Dr.prototype.space=void 0;let v_=0;const vt=Ms(),zn=Ms(),M0=Ms(),ze=Ms(),ln=Ms(),Io=Ms(),Vr=Ms();function Ms(){return 2**++v_}const j0=Object.freeze(Object.defineProperty({__proto__:null,boolean:vt,booleanish:zn,commaOrSpaceSeparated:Vr,commaSeparated:Io,number:ze,overloadedBoolean:M0,spaceSeparated:ln},Symbol.toStringTag,{value:"Module"})),dg=Object.keys(j0);class wy extends Dr{constructor(e,t,r,a){let s=-1;if(super(e,t),bk(this,"space",a),typeof r=="number")for(;++s<dg.length;){const o=dg[s];bk(this,dg[s],(r&j0[o])===j0[o])}}}wy.prototype.defined=!0;function bk(n,e,t){t&&(n[e]=t)}function tu(n){const e={},t={};for(const[r,a]of Object.entries(n.properties)){const s=new wy(r,n.transform(n.attributes||{},r),a,n.space);n.mustUseProperty&&n.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),e[r]=s,t[E0(r)]=r,t[E0(s.attribute)]=r}return new eh(e,t,n.space)}const F2=tu({properties:{ariaActiveDescendant:null,ariaAtomic:zn,ariaAutoComplete:null,ariaBusy:zn,ariaChecked:zn,ariaColCount:ze,ariaColIndex:ze,ariaColSpan:ze,ariaControls:ln,ariaCurrent:null,ariaDescribedBy:ln,ariaDetails:null,ariaDisabled:zn,ariaDropEffect:ln,ariaErrorMessage:null,ariaExpanded:zn,ariaFlowTo:ln,ariaGrabbed:zn,ariaHasPopup:null,ariaHidden:zn,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ln,ariaLevel:ze,ariaLive:null,ariaModal:zn,ariaMultiLine:zn,ariaMultiSelectable:zn,ariaOrientation:null,ariaOwns:ln,ariaPlaceholder:null,ariaPosInSet:ze,ariaPressed:zn,ariaReadOnly:zn,ariaRelevant:null,ariaRequired:zn,ariaRoleDescription:ln,ariaRowCount:ze,ariaRowIndex:ze,ariaRowSpan:ze,ariaSelected:zn,ariaSetSize:ze,ariaSort:null,ariaValueMax:ze,ariaValueMin:ze,ariaValueNow:ze,ariaValueText:null,role:null},transform(n,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function K2(n,e){return e in n?n[e]:e}function G2(n,e){return K2(n,e.toLowerCase())}const b_=tu({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Io,acceptCharset:ln,accessKey:ln,action:null,allow:null,allowFullScreen:vt,allowPaymentRequest:vt,allowUserMedia:vt,alt:null,as:null,async:vt,autoCapitalize:null,autoComplete:ln,autoFocus:vt,autoPlay:vt,blocking:ln,capture:null,charSet:null,checked:vt,cite:null,className:ln,cols:ze,colSpan:null,content:null,contentEditable:zn,controls:vt,controlsList:ln,coords:ze|Io,crossOrigin:null,data:null,dateTime:null,decoding:null,default:vt,defer:vt,dir:null,dirName:null,disabled:vt,download:M0,draggable:zn,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:vt,formTarget:null,headers:ln,height:ze,hidden:M0,high:ze,href:null,hrefLang:null,htmlFor:ln,httpEquiv:ln,id:null,imageSizes:null,imageSrcSet:null,inert:vt,inputMode:null,integrity:null,is:null,isMap:vt,itemId:null,itemProp:ln,itemRef:ln,itemScope:vt,itemType:ln,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:vt,low:ze,manifest:null,max:null,maxLength:ze,media:null,method:null,min:null,minLength:ze,multiple:vt,muted:vt,name:null,nonce:null,noModule:vt,noValidate:vt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:vt,optimum:ze,pattern:null,ping:ln,placeholder:null,playsInline:vt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:vt,referrerPolicy:null,rel:ln,required:vt,reversed:vt,rows:ze,rowSpan:ze,sandbox:ln,scope:null,scoped:vt,seamless:vt,selected:vt,shadowRootClonable:vt,shadowRootDelegatesFocus:vt,shadowRootMode:null,shape:null,size:ze,sizes:null,slot:null,span:ze,spellCheck:zn,src:null,srcDoc:null,srcLang:null,srcSet:null,start:ze,step:null,style:null,tabIndex:ze,target:null,title:null,translate:null,type:null,typeMustMatch:vt,useMap:null,value:zn,width:ze,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ln,axis:null,background:null,bgColor:null,border:ze,borderColor:null,bottomMargin:ze,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:vt,declare:vt,event:null,face:null,frame:null,frameBorder:null,hSpace:ze,leftMargin:ze,link:null,longDesc:null,lowSrc:null,marginHeight:ze,marginWidth:ze,noResize:vt,noHref:vt,noShade:vt,noWrap:vt,object:null,profile:null,prompt:null,rev:null,rightMargin:ze,rules:null,scheme:null,scrolling:zn,standby:null,summary:null,text:null,topMargin:ze,valueType:null,version:null,vAlign:null,vLink:null,vSpace:ze,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:vt,disableRemotePlayback:vt,prefix:null,property:null,results:ze,security:null,unselectable:null},space:"html",transform:G2}),k_=tu({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Vr,accentHeight:ze,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:ze,amplitude:ze,arabicForm:null,ascent:ze,attributeName:null,attributeType:null,azimuth:ze,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:ze,by:null,calcMode:null,capHeight:ze,className:ln,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:ze,diffuseConstant:ze,direction:null,display:null,dur:null,divisor:ze,dominantBaseline:null,download:vt,dx:null,dy:null,edgeMode:null,editable:null,elevation:ze,enableBackground:null,end:null,event:null,exponent:ze,externalResourcesRequired:null,fill:null,fillOpacity:ze,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Io,g2:Io,glyphName:Io,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:ze,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:ze,horizOriginX:ze,horizOriginY:ze,id:null,ideographic:ze,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:ze,k:ze,k1:ze,k2:ze,k3:ze,k4:ze,kernelMatrix:Vr,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:ze,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:ze,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:ze,overlineThickness:ze,paintOrder:null,panose1:null,path:null,pathLength:ze,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ln,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:ze,pointsAtY:ze,pointsAtZ:ze,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Vr,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Vr,rev:Vr,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Vr,requiredFeatures:Vr,requiredFonts:Vr,requiredFormats:Vr,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:ze,specularExponent:ze,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:ze,strikethroughThickness:ze,string:null,stroke:null,strokeDashArray:Vr,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:ze,strokeOpacity:ze,strokeWidth:null,style:null,surfaceScale:ze,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Vr,tabIndex:ze,tableValues:null,target:null,targetX:ze,targetY:ze,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Vr,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:ze,underlineThickness:ze,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:ze,values:null,vAlphabetic:ze,vMathematical:ze,vectorEffect:null,vHanging:ze,vIdeographic:ze,version:null,vertAdvY:ze,vertOriginX:ze,vertOriginY:ze,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:ze,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:K2}),Y2=tu({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(n,e){return"xlink:"+e.slice(5).toLowerCase()}}),$2=tu({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:G2}),Q2=tu({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(n,e){return"xml:"+e.slice(3).toLowerCase()}}),w_={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},S_=/[A-Z]/g,kk=/-[a-z]/g,C_=/^data[-\w.:]+$/i;function A_(n,e){const t=E0(e);let r=e,a=Dr;if(t in n.normal)return n.property[n.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&C_.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(kk,N_);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!kk.test(s)){let o=s.replace(S_,T_);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}a=wy}return new a(r,e)}function T_(n){return"-"+n.toLowerCase()}function N_(n){return n.charAt(1).toUpperCase()}const E_=V2([F2,b_,Y2,$2,Q2],"html"),Sy=V2([F2,k_,Y2,$2,Q2],"svg");function M_(n){return n.join(" ").trim()}var wo={},pg,wk;function j_(){if(wk)return pg;wk=1;var n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,c=/^\s+|\s+$/g,h=`
`,d="/",p="*",g="",k="comment",w="declaration";function A(j,D){if(typeof j!="string")throw new TypeError("First argument must be a string");if(!j)return[];D=D||{};var U=1,O=1;function J(ge){var re=ge.match(e);re&&(U+=re.length);var X=ge.lastIndexOf(h);O=~X?ge.length-X:O+ge.length}function ee(){var ge={line:U,column:O};return function(re){return re.position=new H(ge),he(),re}}function H(ge){this.start=ge,this.end={line:U,column:O},this.source=D.source}H.prototype.content=j;function L(ge){var re=new Error(D.source+":"+U+":"+O+": "+ge);if(re.reason=ge,re.filename=D.source,re.line=U,re.column=O,re.source=j,!D.silent)throw re}function me(ge){var re=ge.exec(j);if(re){var X=re[0];return J(X),j=j.slice(X.length),re}}function he(){me(t)}function I(ge){var re;for(ge=ge||[];re=te();)re!==!1&&ge.push(re);return ge}function te(){var ge=ee();if(!(d!=j.charAt(0)||p!=j.charAt(1))){for(var re=2;g!=j.charAt(re)&&(p!=j.charAt(re)||d!=j.charAt(re+1));)++re;if(re+=2,g===j.charAt(re-1))return L("End of comment missing");var X=j.slice(2,re-2);return O+=2,J(X),j=j.slice(re),O+=2,ge({type:k,comment:X})}}function ne(){var ge=ee(),re=me(r);if(re){if(te(),!me(a))return L("property missing ':'");var X=me(s),ve=ge({type:w,property:E(re[0].replace(n,g)),value:X?E(X[0].replace(n,g)):g});return me(o),ve}}function pe(){var ge=[];I(ge);for(var re;re=ne();)re!==!1&&(ge.push(re),I(ge));return ge}return he(),pe()}function E(j){return j?j.replace(c,g):g}return pg=A,pg}var Sk;function __(){if(Sk)return wo;Sk=1;var n=wo&&wo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(wo,"__esModule",{value:!0}),wo.default=t;const e=n(j_());function t(r,a){let s=null;if(!r||typeof r!="string")return s;const o=(0,e.default)(r),c=typeof a=="function";return o.forEach(h=>{if(h.type!=="declaration")return;const{property:d,value:p}=h;c?a(d,p,h):p&&(s=s||{},s[d]=p)}),s}return wo}var hc={},Ck;function D_(){if(Ck)return hc;Ck=1,Object.defineProperty(hc,"__esModule",{value:!0}),hc.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,s=function(d){return!d||t.test(d)||n.test(d)},o=function(d,p){return p.toUpperCase()},c=function(d,p){return"".concat(p,"-")},h=function(d,p){return p===void 0&&(p={}),s(d)?d:(d=d.toLowerCase(),p.reactCompat?d=d.replace(a,c):d=d.replace(r,c),d.replace(e,o))};return hc.camelCase=h,hc}var fc,Ak;function O_(){if(Ak)return fc;Ak=1;var n=fc&&fc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},e=n(__()),t=D_();function r(a,s){var o={};return!a||typeof a!="string"||(0,e.default)(a,function(c,h){c&&h&&(o[(0,t.camelCase)(c,s)]=h)}),o}return r.default=r,fc=r,fc}var R_=O_();const L_=Ed(R_),X2=W2("end"),Cy=W2("start");function W2(n){return e;function e(t){const r=t&&t.position&&t.position[n]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function B_(n){const e=Cy(n),t=X2(n);if(e&&t)return{start:e,end:t}}function jc(n){return!n||typeof n!="object"?"":"position"in n||"type"in n?Tk(n.position):"start"in n||"end"in n?Tk(n):"line"in n||"column"in n?_0(n):""}function _0(n){return Nk(n&&n.line)+":"+Nk(n&&n.column)}function Tk(n){return _0(n&&n.start)+"-"+_0(n&&n.end)}function Nk(n){return n&&typeof n=="number"?n:1}class mr extends Error{constructor(e,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let a="",s={},o=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof e=="string"?a=e:!s.cause&&e&&(o=!0,a=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof r=="string"){const h=r.indexOf(":");h===-1?s.ruleId=r:(s.source=r.slice(0,h),s.ruleId=r.slice(h+1))}if(!s.place&&s.ancestors&&s.ancestors){const h=s.ancestors[s.ancestors.length-1];h&&(s.place=h.position)}const c=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=c?c.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=c?c.line:void 0,this.name=jc(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=o&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}mr.prototype.file="";mr.prototype.name="";mr.prototype.reason="";mr.prototype.message="";mr.prototype.stack="";mr.prototype.column=void 0;mr.prototype.line=void 0;mr.prototype.ancestors=void 0;mr.prototype.cause=void 0;mr.prototype.fatal=void 0;mr.prototype.place=void 0;mr.prototype.ruleId=void 0;mr.prototype.source=void 0;const Ay={}.hasOwnProperty,z_=new Map,I_=/[A-Z]/g,P_=new Set(["table","tbody","thead","tfoot","tr"]),H_=new Set(["td","th"]),Z2="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function q_(n,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=Q_(t,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=$_(t,e.jsx,e.jsxs)}const a={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?Sy:E_,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},s=J2(a,n,void 0);return s&&typeof s!="string"?s:a.create(n,a.Fragment,{children:s||void 0},void 0)}function J2(n,e,t){if(e.type==="element")return U_(n,e,t);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return V_(n,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return K_(n,e,t);if(e.type==="mdxjsEsm")return F_(n,e);if(e.type==="root")return G_(n,e,t);if(e.type==="text")return Y_(n,e)}function U_(n,e,t){const r=n.schema;let a=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(a=Sy,n.schema=a),n.ancestors.push(e);const s=tC(n,e.tagName,!1),o=X_(n,e);let c=Ny(n,e);return P_.has(e.tagName)&&(c=c.filter(function(h){return typeof h=="string"?!x_(h):!0})),eC(n,o,s,e),Ty(o,c),n.ancestors.pop(),n.schema=r,n.create(e,s,o,t)}function V_(n,e){if(e.data&&e.data.estree&&n.evaluater){const r=e.data.estree.body[0];return r.type,n.evaluater.evaluateExpression(r.expression)}Fc(n,e.position)}function F_(n,e){if(e.data&&e.data.estree&&n.evaluater)return n.evaluater.evaluateProgram(e.data.estree);Fc(n,e.position)}function K_(n,e,t){const r=n.schema;let a=r;e.name==="svg"&&r.space==="html"&&(a=Sy,n.schema=a),n.ancestors.push(e);const s=e.name===null?n.Fragment:tC(n,e.name,!0),o=W_(n,e),c=Ny(n,e);return eC(n,o,s,e),Ty(o,c),n.ancestors.pop(),n.schema=r,n.create(e,s,o,t)}function G_(n,e,t){const r={};return Ty(r,Ny(n,e)),n.create(e,n.Fragment,r,t)}function Y_(n,e){return e.value}function eC(n,e,t,r){typeof t!="string"&&t!==n.Fragment&&n.passNode&&(e.node=r)}function Ty(n,e){if(e.length>0){const t=e.length>1?e:e[0];t&&(n.children=t)}}function $_(n,e,t){return r;function r(a,s,o,c){const d=Array.isArray(o.children)?t:e;return c?d(s,o,c):d(s,o)}}function Q_(n,e){return t;function t(r,a,s,o){const c=Array.isArray(s.children),h=Cy(r);return e(a,s,o,c,{columnNumber:h?h.column-1:void 0,fileName:n,lineNumber:h?h.line:void 0},void 0)}}function X_(n,e){const t={};let r,a;for(a in e.properties)if(a!=="children"&&Ay.call(e.properties,a)){const s=Z_(n,a,e.properties[a]);if(s){const[o,c]=s;n.tableCellAlignToStyle&&o==="align"&&typeof c=="string"&&H_.has(e.tagName)?r=c:t[o]=c}}if(r){const s=t.style||(t.style={});s[n.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function W_(n,e){const t={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&n.evaluater){const s=r.data.estree.body[0];s.type;const o=s.expression;o.type;const c=o.properties[0];c.type,Object.assign(t,n.evaluater.evaluateExpression(c.argument))}else Fc(n,e.position);else{const a=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&n.evaluater){const c=r.value.data.estree.body[0];c.type,s=n.evaluater.evaluateExpression(c.expression)}else Fc(n,e.position);else s=r.value===null?!0:r.value;t[a]=s}return t}function Ny(n,e){const t=[];let r=-1;const a=n.passKeys?new Map:z_;for(;++r<e.children.length;){const s=e.children[r];let o;if(n.passKeys){const h=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(h){const d=a.get(h)||0;o=h+"-"+d,a.set(h,d+1)}}const c=J2(n,s,o);c!==void 0&&t.push(c)}return t}function Z_(n,e,t){const r=A_(n.schema,e);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?d_(t):M_(t)),r.property==="style"){let a=typeof t=="object"?t:J_(n,String(t));return n.stylePropertyNameCase==="css"&&(a=eD(a)),["style",a]}return[n.elementAttributeNameCase==="react"&&r.space?w_[r.property]||r.property:r.attribute,t]}}function J_(n,e){try{return L_(e,{reactCompat:!0})}catch(t){if(n.ignoreInvalidStyle)return{};const r=t,a=new mr("Cannot parse `style` attribute",{ancestors:n.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=n.filePath||void 0,a.url=Z2+"#cannot-parse-style-attribute",a}}function tC(n,e,t){let r;if(!t)r={type:"Literal",value:e};else if(e.includes(".")){const a=e.split(".");let s=-1,o;for(;++s<a.length;){const c=xk(a[s])?{type:"Identifier",name:a[s]}:{type:"Literal",value:a[s]};o=o?{type:"MemberExpression",object:o,property:c,computed:!!(s&&c.type==="Literal"),optional:!1}:c}r=o}else r=xk(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const a=r.value;return Ay.call(n.components,a)?n.components[a]:a}if(n.evaluater)return n.evaluater.evaluateExpression(r);Fc(n)}function Fc(n,e){const t=new mr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:n.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=n.filePath||void 0,t.url=Z2+"#cannot-handle-mdx-estrees-without-createevaluater",t}function eD(n){const e={};let t;for(t in n)Ay.call(n,t)&&(e[tD(t)]=n[t]);return e}function tD(n){let e=n.replace(I_,nD);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function nD(n){return"-"+n.toLowerCase()}const mg={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},rD={};function Ey(n,e){const t=rD,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,a=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return nC(n,r,a)}function nC(n,e,t){if(iD(n)){if("value"in n)return n.type==="html"&&!t?"":n.value;if(e&&"alt"in n&&n.alt)return n.alt;if("children"in n)return Ek(n.children,e,t)}return Array.isArray(n)?Ek(n,e,t):""}function Ek(n,e,t){const r=[];let a=-1;for(;++a<n.length;)r[a]=nC(n[a],e,t);return r.join("")}function iD(n){return!!(n&&typeof n=="object")}const Mk=document.createElement("i");function My(n){const e="&"+n+";";Mk.innerHTML=e;const t=Mk.textContent;return t.charCodeAt(t.length-1)===59&&n!=="semi"||t===e?!1:t}function Gr(n,e,t,r){const a=n.length;let s=0,o;if(e<0?e=-e>a?0:a+e:e=e>a?a:e,t=t>0?t:0,r.length<1e4)o=Array.from(r),o.unshift(e,t),n.splice(...o);else for(t&&n.splice(e,t);s<r.length;)o=r.slice(s,s+1e4),o.unshift(e,0),n.splice(...o),s+=1e4,e+=1e4}function si(n,e){return n.length>0?(Gr(n,n.length,0,e),n):e}const jk={}.hasOwnProperty;function rC(n){const e={};let t=-1;for(;++t<n.length;)aD(e,n[t]);return e}function aD(n,e){let t;for(t in e){const a=(jk.call(n,t)?n[t]:void 0)||(n[t]={}),s=e[t];let o;if(s)for(o in s){jk.call(a,o)||(a[o]=[]);const c=s[o];lD(a[o],Array.isArray(c)?c:c?[c]:[])}}}function lD(n,e){let t=-1;const r=[];for(;++t<e.length;)(e[t].add==="after"?n:r).push(e[t]);Gr(n,0,0,r)}function iC(n,e){const t=Number.parseInt(n,e);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function Ai(n){return n.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const br=Pl(/[A-Za-z]/),dr=Pl(/[\dA-Za-z]/),sD=Pl(/[#-'*+\--9=?A-Z^-~]/);function Cd(n){return n!==null&&(n<32||n===127)}const D0=Pl(/\d/),oD=Pl(/[\dA-Fa-f]/),uD=Pl(/[!-/:-@[-`{-~]/);function ut(n){return n!==null&&n<-2}function rn(n){return n!==null&&(n<0||n===32)}function At(n){return n===-2||n===-1||n===32}const Vd=Pl(/\p{P}|\p{S}/u),Es=Pl(/\s/);function Pl(n){return e;function e(t){return t!==null&&t>-1&&n.test(String.fromCharCode(t))}}function nu(n){const e=[];let t=-1,r=0,a=0;for(;++t<n.length;){const s=n.charCodeAt(t);let o="";if(s===37&&dr(n.charCodeAt(t+1))&&dr(n.charCodeAt(t+2)))a=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(o=String.fromCharCode(s));else if(s>55295&&s<57344){const c=n.charCodeAt(t+1);s<56320&&c>56319&&c<57344?(o=String.fromCharCode(s,c),a=1):o=""}else o=String.fromCharCode(s);o&&(e.push(n.slice(r,t),encodeURIComponent(o)),r=t+a+1,o=""),a&&(t+=a,a=0)}return e.join("")+n.slice(r)}function _t(n,e,t,r){const a=r?r-1:Number.POSITIVE_INFINITY;let s=0;return o;function o(h){return At(h)?(n.enter(t),c(h)):e(h)}function c(h){return At(h)&&s++<a?(n.consume(h),c):(n.exit(t),e(h))}}const cD={tokenize:hD};function hD(n){const e=n.attempt(this.parser.constructs.contentInitial,r,a);let t;return e;function r(c){if(c===null){n.consume(c);return}return n.enter("lineEnding"),n.consume(c),n.exit("lineEnding"),_t(n,e,"linePrefix")}function a(c){return n.enter("paragraph"),s(c)}function s(c){const h=n.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=h),t=h,o(c)}function o(c){if(c===null){n.exit("chunkText"),n.exit("paragraph"),n.consume(c);return}return ut(c)?(n.consume(c),n.exit("chunkText"),s):(n.consume(c),o)}}const fD={tokenize:dD},_k={tokenize:pD};function dD(n){const e=this,t=[];let r=0,a,s,o;return c;function c(O){if(r<t.length){const J=t[r];return e.containerState=J[1],n.attempt(J[0].continuation,h,d)(O)}return d(O)}function h(O){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,a&&U();const J=e.events.length;let ee=J,H;for(;ee--;)if(e.events[ee][0]==="exit"&&e.events[ee][1].type==="chunkFlow"){H=e.events[ee][1].end;break}D(r);let L=J;for(;L<e.events.length;)e.events[L][1].end={...H},L++;return Gr(e.events,ee+1,0,e.events.slice(J)),e.events.length=L,d(O)}return c(O)}function d(O){if(r===t.length){if(!a)return k(O);if(a.currentConstruct&&a.currentConstruct.concrete)return A(O);e.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return e.containerState={},n.check(_k,p,g)(O)}function p(O){return a&&U(),D(r),k(O)}function g(O){return e.parser.lazy[e.now().line]=r!==t.length,o=e.now().offset,A(O)}function k(O){return e.containerState={},n.attempt(_k,w,A)(O)}function w(O){return r++,t.push([e.currentConstruct,e.containerState]),k(O)}function A(O){if(O===null){a&&U(),D(0),n.consume(O);return}return a=a||e.parser.flow(e.now()),n.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:s}),E(O)}function E(O){if(O===null){j(n.exit("chunkFlow"),!0),D(0),n.consume(O);return}return ut(O)?(n.consume(O),j(n.exit("chunkFlow")),r=0,e.interrupt=void 0,c):(n.consume(O),E)}function j(O,J){const ee=e.sliceStream(O);if(J&&ee.push(null),O.previous=s,s&&(s.next=O),s=O,a.defineSkip(O.start),a.write(ee),e.parser.lazy[O.start.line]){let H=a.events.length;for(;H--;)if(a.events[H][1].start.offset<o&&(!a.events[H][1].end||a.events[H][1].end.offset>o))return;const L=e.events.length;let me=L,he,I;for(;me--;)if(e.events[me][0]==="exit"&&e.events[me][1].type==="chunkFlow"){if(he){I=e.events[me][1].end;break}he=!0}for(D(r),H=L;H<e.events.length;)e.events[H][1].end={...I},H++;Gr(e.events,me+1,0,e.events.slice(L)),e.events.length=H}}function D(O){let J=t.length;for(;J-- >O;){const ee=t[J];e.containerState=ee[1],ee[0].exit.call(e,n)}t.length=O}function U(){a.write([null]),s=void 0,a=void 0,e.containerState._closeFlow=void 0}}function pD(n,e,t){return _t(n,n.attempt(this.parser.constructs.document,e,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Xo(n){if(n===null||rn(n)||Es(n))return 1;if(Vd(n))return 2}function Fd(n,e,t){const r=[];let a=-1;for(;++a<n.length;){const s=n[a].resolveAll;s&&!r.includes(s)&&(e=s(e,t),r.push(s))}return e}const O0={name:"attention",resolveAll:mD,tokenize:gD};function mD(n,e){let t=-1,r,a,s,o,c,h,d,p;for(;++t<n.length;)if(n[t][0]==="enter"&&n[t][1].type==="attentionSequence"&&n[t][1]._close){for(r=t;r--;)if(n[r][0]==="exit"&&n[r][1].type==="attentionSequence"&&n[r][1]._open&&e.sliceSerialize(n[r][1]).charCodeAt(0)===e.sliceSerialize(n[t][1]).charCodeAt(0)){if((n[r][1]._close||n[t][1]._open)&&(n[t][1].end.offset-n[t][1].start.offset)%3&&!((n[r][1].end.offset-n[r][1].start.offset+n[t][1].end.offset-n[t][1].start.offset)%3))continue;h=n[r][1].end.offset-n[r][1].start.offset>1&&n[t][1].end.offset-n[t][1].start.offset>1?2:1;const g={...n[r][1].end},k={...n[t][1].start};Dk(g,-h),Dk(k,h),o={type:h>1?"strongSequence":"emphasisSequence",start:g,end:{...n[r][1].end}},c={type:h>1?"strongSequence":"emphasisSequence",start:{...n[t][1].start},end:k},s={type:h>1?"strongText":"emphasisText",start:{...n[r][1].end},end:{...n[t][1].start}},a={type:h>1?"strong":"emphasis",start:{...o.start},end:{...c.end}},n[r][1].end={...o.start},n[t][1].start={...c.end},d=[],n[r][1].end.offset-n[r][1].start.offset&&(d=si(d,[["enter",n[r][1],e],["exit",n[r][1],e]])),d=si(d,[["enter",a,e],["enter",o,e],["exit",o,e],["enter",s,e]]),d=si(d,Fd(e.parser.constructs.insideSpan.null,n.slice(r+1,t),e)),d=si(d,[["exit",s,e],["enter",c,e],["exit",c,e],["exit",a,e]]),n[t][1].end.offset-n[t][1].start.offset?(p=2,d=si(d,[["enter",n[t][1],e],["exit",n[t][1],e]])):p=0,Gr(n,r-1,t-r+3,d),t=r+d.length-p-2;break}}for(t=-1;++t<n.length;)n[t][1].type==="attentionSequence"&&(n[t][1].type="data");return n}function gD(n,e){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,a=Xo(r);let s;return o;function o(h){return s=h,n.enter("attentionSequence"),c(h)}function c(h){if(h===s)return n.consume(h),c;const d=n.exit("attentionSequence"),p=Xo(h),g=!p||p===2&&a||t.includes(h),k=!a||a===2&&p||t.includes(r);return d._open=!!(s===42?g:g&&(a||!k)),d._close=!!(s===42?k:k&&(p||!g)),e(h)}}function Dk(n,e){n.column+=e,n.offset+=e,n._bufferIndex+=e}const yD={name:"autolink",tokenize:xD};function xD(n,e,t){let r=0;return a;function a(w){return n.enter("autolink"),n.enter("autolinkMarker"),n.consume(w),n.exit("autolinkMarker"),n.enter("autolinkProtocol"),s}function s(w){return br(w)?(n.consume(w),o):w===64?t(w):d(w)}function o(w){return w===43||w===45||w===46||dr(w)?(r=1,c(w)):d(w)}function c(w){return w===58?(n.consume(w),r=0,h):(w===43||w===45||w===46||dr(w))&&r++<32?(n.consume(w),c):(r=0,d(w))}function h(w){return w===62?(n.exit("autolinkProtocol"),n.enter("autolinkMarker"),n.consume(w),n.exit("autolinkMarker"),n.exit("autolink"),e):w===null||w===32||w===60||Cd(w)?t(w):(n.consume(w),h)}function d(w){return w===64?(n.consume(w),p):sD(w)?(n.consume(w),d):t(w)}function p(w){return dr(w)?g(w):t(w)}function g(w){return w===46?(n.consume(w),r=0,p):w===62?(n.exit("autolinkProtocol").type="autolinkEmail",n.enter("autolinkMarker"),n.consume(w),n.exit("autolinkMarker"),n.exit("autolink"),e):k(w)}function k(w){if((w===45||dr(w))&&r++<63){const A=w===45?k:g;return n.consume(w),A}return t(w)}}const th={partial:!0,tokenize:vD};function vD(n,e,t){return r;function r(s){return At(s)?_t(n,a,"linePrefix")(s):a(s)}function a(s){return s===null||ut(s)?e(s):t(s)}}const aC={continuation:{tokenize:kD},exit:wD,name:"blockQuote",tokenize:bD};function bD(n,e,t){const r=this;return a;function a(o){if(o===62){const c=r.containerState;return c.open||(n.enter("blockQuote",{_container:!0}),c.open=!0),n.enter("blockQuotePrefix"),n.enter("blockQuoteMarker"),n.consume(o),n.exit("blockQuoteMarker"),s}return t(o)}function s(o){return At(o)?(n.enter("blockQuotePrefixWhitespace"),n.consume(o),n.exit("blockQuotePrefixWhitespace"),n.exit("blockQuotePrefix"),e):(n.exit("blockQuotePrefix"),e(o))}}function kD(n,e,t){const r=this;return a;function a(o){return At(o)?_t(n,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):s(o)}function s(o){return n.attempt(aC,e,t)(o)}}function wD(n){n.exit("blockQuote")}const lC={name:"characterEscape",tokenize:SD};function SD(n,e,t){return r;function r(s){return n.enter("characterEscape"),n.enter("escapeMarker"),n.consume(s),n.exit("escapeMarker"),a}function a(s){return uD(s)?(n.enter("characterEscapeValue"),n.consume(s),n.exit("characterEscapeValue"),n.exit("characterEscape"),e):t(s)}}const sC={name:"characterReference",tokenize:CD};function CD(n,e,t){const r=this;let a=0,s,o;return c;function c(g){return n.enter("characterReference"),n.enter("characterReferenceMarker"),n.consume(g),n.exit("characterReferenceMarker"),h}function h(g){return g===35?(n.enter("characterReferenceMarkerNumeric"),n.consume(g),n.exit("characterReferenceMarkerNumeric"),d):(n.enter("characterReferenceValue"),s=31,o=dr,p(g))}function d(g){return g===88||g===120?(n.enter("characterReferenceMarkerHexadecimal"),n.consume(g),n.exit("characterReferenceMarkerHexadecimal"),n.enter("characterReferenceValue"),s=6,o=oD,p):(n.enter("characterReferenceValue"),s=7,o=D0,p(g))}function p(g){if(g===59&&a){const k=n.exit("characterReferenceValue");return o===dr&&!My(r.sliceSerialize(k))?t(g):(n.enter("characterReferenceMarker"),n.consume(g),n.exit("characterReferenceMarker"),n.exit("characterReference"),e)}return o(g)&&a++<s?(n.consume(g),p):t(g)}}const Ok={partial:!0,tokenize:TD},Rk={concrete:!0,name:"codeFenced",tokenize:AD};function AD(n,e,t){const r=this,a={partial:!0,tokenize:ee};let s=0,o=0,c;return h;function h(H){return d(H)}function d(H){const L=r.events[r.events.length-1];return s=L&&L[1].type==="linePrefix"?L[2].sliceSerialize(L[1],!0).length:0,c=H,n.enter("codeFenced"),n.enter("codeFencedFence"),n.enter("codeFencedFenceSequence"),p(H)}function p(H){return H===c?(o++,n.consume(H),p):o<3?t(H):(n.exit("codeFencedFenceSequence"),At(H)?_t(n,g,"whitespace")(H):g(H))}function g(H){return H===null||ut(H)?(n.exit("codeFencedFence"),r.interrupt?e(H):n.check(Ok,E,J)(H)):(n.enter("codeFencedFenceInfo"),n.enter("chunkString",{contentType:"string"}),k(H))}function k(H){return H===null||ut(H)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),g(H)):At(H)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),_t(n,w,"whitespace")(H)):H===96&&H===c?t(H):(n.consume(H),k)}function w(H){return H===null||ut(H)?g(H):(n.enter("codeFencedFenceMeta"),n.enter("chunkString",{contentType:"string"}),A(H))}function A(H){return H===null||ut(H)?(n.exit("chunkString"),n.exit("codeFencedFenceMeta"),g(H)):H===96&&H===c?t(H):(n.consume(H),A)}function E(H){return n.attempt(a,J,j)(H)}function j(H){return n.enter("lineEnding"),n.consume(H),n.exit("lineEnding"),D}function D(H){return s>0&&At(H)?_t(n,U,"linePrefix",s+1)(H):U(H)}function U(H){return H===null||ut(H)?n.check(Ok,E,J)(H):(n.enter("codeFlowValue"),O(H))}function O(H){return H===null||ut(H)?(n.exit("codeFlowValue"),U(H)):(n.consume(H),O)}function J(H){return n.exit("codeFenced"),e(H)}function ee(H,L,me){let he=0;return I;function I(re){return H.enter("lineEnding"),H.consume(re),H.exit("lineEnding"),te}function te(re){return H.enter("codeFencedFence"),At(re)?_t(H,ne,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(re):ne(re)}function ne(re){return re===c?(H.enter("codeFencedFenceSequence"),pe(re)):me(re)}function pe(re){return re===c?(he++,H.consume(re),pe):he>=o?(H.exit("codeFencedFenceSequence"),At(re)?_t(H,ge,"whitespace")(re):ge(re)):me(re)}function ge(re){return re===null||ut(re)?(H.exit("codeFencedFence"),L(re)):me(re)}}}function TD(n,e,t){const r=this;return a;function a(o){return o===null?t(o):(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),s)}function s(o){return r.parser.lazy[r.now().line]?t(o):e(o)}}const gg={name:"codeIndented",tokenize:ED},ND={partial:!0,tokenize:MD};function ED(n,e,t){const r=this;return a;function a(d){return n.enter("codeIndented"),_t(n,s,"linePrefix",5)(d)}function s(d){const p=r.events[r.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?o(d):t(d)}function o(d){return d===null?h(d):ut(d)?n.attempt(ND,o,h)(d):(n.enter("codeFlowValue"),c(d))}function c(d){return d===null||ut(d)?(n.exit("codeFlowValue"),o(d)):(n.consume(d),c)}function h(d){return n.exit("codeIndented"),e(d)}}function MD(n,e,t){const r=this;return a;function a(o){return r.parser.lazy[r.now().line]?t(o):ut(o)?(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),a):_t(n,s,"linePrefix",5)(o)}function s(o){const c=r.events[r.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?e(o):ut(o)?a(o):t(o)}}const jD={name:"codeText",previous:DD,resolve:_D,tokenize:OD};function _D(n){let e=n.length-4,t=3,r,a;if((n[t][1].type==="lineEnding"||n[t][1].type==="space")&&(n[e][1].type==="lineEnding"||n[e][1].type==="space")){for(r=t;++r<e;)if(n[r][1].type==="codeTextData"){n[t][1].type="codeTextPadding",n[e][1].type="codeTextPadding",t+=2,e-=2;break}}for(r=t-1,e++;++r<=e;)a===void 0?r!==e&&n[r][1].type!=="lineEnding"&&(a=r):(r===e||n[r][1].type==="lineEnding")&&(n[a][1].type="codeTextData",r!==a+2&&(n[a][1].end=n[r-1][1].end,n.splice(a+2,r-a-2),e-=r-a-2,r=a+2),a=void 0);return n}function DD(n){return n!==96||this.events[this.events.length-1][1].type==="characterEscape"}function OD(n,e,t){let r=0,a,s;return o;function o(g){return n.enter("codeText"),n.enter("codeTextSequence"),c(g)}function c(g){return g===96?(n.consume(g),r++,c):(n.exit("codeTextSequence"),h(g))}function h(g){return g===null?t(g):g===32?(n.enter("space"),n.consume(g),n.exit("space"),h):g===96?(s=n.enter("codeTextSequence"),a=0,p(g)):ut(g)?(n.enter("lineEnding"),n.consume(g),n.exit("lineEnding"),h):(n.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||ut(g)?(n.exit("codeTextData"),h(g)):(n.consume(g),d)}function p(g){return g===96?(n.consume(g),a++,p):a===r?(n.exit("codeTextSequence"),n.exit("codeText"),e(g)):(s.type="codeTextData",d(g))}}class RD{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,t,r){const a=t||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return r&&dc(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),dc(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),dc(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);dc(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);dc(this.left,t.reverse())}}}function dc(n,e){let t=0;if(e.length<1e4)n.push(...e);else for(;t<e.length;)n.push(...e.slice(t,t+1e4)),t+=1e4}function oC(n){const e={};let t=-1,r,a,s,o,c,h,d;const p=new RD(n);for(;++t<p.length;){for(;t in e;)t=e[t];if(r=p.get(t),t&&r[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(h=r[1]._tokenizer.events,s=0,s<h.length&&h[s][1].type==="lineEndingBlank"&&(s+=2),s<h.length&&h[s][1].type==="content"))for(;++s<h.length&&h[s][1].type!=="content";)h[s][1].type==="chunkText"&&(h[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,LD(p,t)),t=e[t],d=!0);else if(r[1]._container){for(s=t,a=void 0;s--;)if(o=p.get(s),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),o[1].type="lineEnding",a=s);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;a&&(r[1].end={...p.get(a)[1].start},c=p.slice(a,t),c.unshift(r),p.splice(a,t-a+1,c))}}return Gr(n,0,Number.POSITIVE_INFINITY,p.slice(0)),!d}function LD(n,e){const t=n.get(e)[1],r=n.get(e)[2];let a=e-1;const s=[];let o=t._tokenizer;o||(o=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const c=o.events,h=[],d={};let p,g,k=-1,w=t,A=0,E=0;const j=[E];for(;w;){for(;n.get(++a)[1]!==w;);s.push(a),w._tokenizer||(p=r.sliceStream(w),w.next||p.push(null),g&&o.defineSkip(w.start),w._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(p),w._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),g=w,w=w.next}for(w=t;++k<c.length;)c[k][0]==="exit"&&c[k-1][0]==="enter"&&c[k][1].type===c[k-1][1].type&&c[k][1].start.line!==c[k][1].end.line&&(E=k+1,j.push(E),w._tokenizer=void 0,w.previous=void 0,w=w.next);for(o.events=[],w?(w._tokenizer=void 0,w.previous=void 0):j.pop(),k=j.length;k--;){const D=c.slice(j[k],j[k+1]),U=s.pop();h.push([U,U+D.length-1]),n.splice(U,2,D)}for(h.reverse(),k=-1;++k<h.length;)d[A+h[k][0]]=A+h[k][1],A+=h[k][1]-h[k][0]-1;return d}const BD={resolve:ID,tokenize:PD},zD={partial:!0,tokenize:HD};function ID(n){return oC(n),n}function PD(n,e){let t;return r;function r(c){return n.enter("content"),t=n.enter("chunkContent",{contentType:"content"}),a(c)}function a(c){return c===null?s(c):ut(c)?n.check(zD,o,s)(c):(n.consume(c),a)}function s(c){return n.exit("chunkContent"),n.exit("content"),e(c)}function o(c){return n.consume(c),n.exit("chunkContent"),t.next=n.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,a}}function HD(n,e,t){const r=this;return a;function a(o){return n.exit("chunkContent"),n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),_t(n,s,"linePrefix")}function s(o){if(o===null||ut(o))return t(o);const c=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?e(o):n.interrupt(r.parser.constructs.flow,t,e)(o)}}function uC(n,e,t,r,a,s,o,c,h){const d=h||Number.POSITIVE_INFINITY;let p=0;return g;function g(D){return D===60?(n.enter(r),n.enter(a),n.enter(s),n.consume(D),n.exit(s),k):D===null||D===32||D===41||Cd(D)?t(D):(n.enter(r),n.enter(o),n.enter(c),n.enter("chunkString",{contentType:"string"}),E(D))}function k(D){return D===62?(n.enter(s),n.consume(D),n.exit(s),n.exit(a),n.exit(r),e):(n.enter(c),n.enter("chunkString",{contentType:"string"}),w(D))}function w(D){return D===62?(n.exit("chunkString"),n.exit(c),k(D)):D===null||D===60||ut(D)?t(D):(n.consume(D),D===92?A:w)}function A(D){return D===60||D===62||D===92?(n.consume(D),w):w(D)}function E(D){return!p&&(D===null||D===41||rn(D))?(n.exit("chunkString"),n.exit(c),n.exit(o),n.exit(r),e(D)):p<d&&D===40?(n.consume(D),p++,E):D===41?(n.consume(D),p--,E):D===null||D===32||D===40||Cd(D)?t(D):(n.consume(D),D===92?j:E)}function j(D){return D===40||D===41||D===92?(n.consume(D),E):E(D)}}function cC(n,e,t,r,a,s){const o=this;let c=0,h;return d;function d(w){return n.enter(r),n.enter(a),n.consume(w),n.exit(a),n.enter(s),p}function p(w){return c>999||w===null||w===91||w===93&&!h||w===94&&!c&&"_hiddenFootnoteSupport"in o.parser.constructs?t(w):w===93?(n.exit(s),n.enter(a),n.consume(w),n.exit(a),n.exit(r),e):ut(w)?(n.enter("lineEnding"),n.consume(w),n.exit("lineEnding"),p):(n.enter("chunkString",{contentType:"string"}),g(w))}function g(w){return w===null||w===91||w===93||ut(w)||c++>999?(n.exit("chunkString"),p(w)):(n.consume(w),h||(h=!At(w)),w===92?k:g)}function k(w){return w===91||w===92||w===93?(n.consume(w),c++,g):g(w)}}function hC(n,e,t,r,a,s){let o;return c;function c(k){return k===34||k===39||k===40?(n.enter(r),n.enter(a),n.consume(k),n.exit(a),o=k===40?41:k,h):t(k)}function h(k){return k===o?(n.enter(a),n.consume(k),n.exit(a),n.exit(r),e):(n.enter(s),d(k))}function d(k){return k===o?(n.exit(s),h(o)):k===null?t(k):ut(k)?(n.enter("lineEnding"),n.consume(k),n.exit("lineEnding"),_t(n,d,"linePrefix")):(n.enter("chunkString",{contentType:"string"}),p(k))}function p(k){return k===o||k===null||ut(k)?(n.exit("chunkString"),d(k)):(n.consume(k),k===92?g:p)}function g(k){return k===o||k===92?(n.consume(k),p):p(k)}}function _c(n,e){let t;return r;function r(a){return ut(a)?(n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),t=!0,r):At(a)?_t(n,r,t?"linePrefix":"lineSuffix")(a):e(a)}}const qD={name:"definition",tokenize:VD},UD={partial:!0,tokenize:FD};function VD(n,e,t){const r=this;let a;return s;function s(w){return n.enter("definition"),o(w)}function o(w){return cC.call(r,n,c,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(w)}function c(w){return a=Ai(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),w===58?(n.enter("definitionMarker"),n.consume(w),n.exit("definitionMarker"),h):t(w)}function h(w){return rn(w)?_c(n,d)(w):d(w)}function d(w){return uC(n,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(w)}function p(w){return n.attempt(UD,g,g)(w)}function g(w){return At(w)?_t(n,k,"whitespace")(w):k(w)}function k(w){return w===null||ut(w)?(n.exit("definition"),r.parser.defined.push(a),e(w)):t(w)}}function FD(n,e,t){return r;function r(c){return rn(c)?_c(n,a)(c):t(c)}function a(c){return hC(n,s,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(c)}function s(c){return At(c)?_t(n,o,"whitespace")(c):o(c)}function o(c){return c===null||ut(c)?e(c):t(c)}}const KD={name:"hardBreakEscape",tokenize:GD};function GD(n,e,t){return r;function r(s){return n.enter("hardBreakEscape"),n.consume(s),a}function a(s){return ut(s)?(n.exit("hardBreakEscape"),e(s)):t(s)}}const YD={name:"headingAtx",resolve:$D,tokenize:QD};function $D(n,e){let t=n.length-2,r=3,a,s;return n[r][1].type==="whitespace"&&(r+=2),t-2>r&&n[t][1].type==="whitespace"&&(t-=2),n[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&n[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(a={type:"atxHeadingText",start:n[r][1].start,end:n[t][1].end},s={type:"chunkText",start:n[r][1].start,end:n[t][1].end,contentType:"text"},Gr(n,r,t-r+1,[["enter",a,e],["enter",s,e],["exit",s,e],["exit",a,e]])),n}function QD(n,e,t){let r=0;return a;function a(p){return n.enter("atxHeading"),s(p)}function s(p){return n.enter("atxHeadingSequence"),o(p)}function o(p){return p===35&&r++<6?(n.consume(p),o):p===null||rn(p)?(n.exit("atxHeadingSequence"),c(p)):t(p)}function c(p){return p===35?(n.enter("atxHeadingSequence"),h(p)):p===null||ut(p)?(n.exit("atxHeading"),e(p)):At(p)?_t(n,c,"whitespace")(p):(n.enter("atxHeadingText"),d(p))}function h(p){return p===35?(n.consume(p),h):(n.exit("atxHeadingSequence"),c(p))}function d(p){return p===null||p===35||rn(p)?(n.exit("atxHeadingText"),c(p)):(n.consume(p),d)}}const XD=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Lk=["pre","script","style","textarea"],WD={concrete:!0,name:"htmlFlow",resolveTo:eO,tokenize:tO},ZD={partial:!0,tokenize:rO},JD={partial:!0,tokenize:nO};function eO(n){let e=n.length;for(;e--&&!(n[e][0]==="enter"&&n[e][1].type==="htmlFlow"););return e>1&&n[e-2][1].type==="linePrefix"&&(n[e][1].start=n[e-2][1].start,n[e+1][1].start=n[e-2][1].start,n.splice(e-2,2)),n}function tO(n,e,t){const r=this;let a,s,o,c,h;return d;function d(B){return p(B)}function p(B){return n.enter("htmlFlow"),n.enter("htmlFlowData"),n.consume(B),g}function g(B){return B===33?(n.consume(B),k):B===47?(n.consume(B),s=!0,E):B===63?(n.consume(B),a=3,r.interrupt?e:q):br(B)?(n.consume(B),o=String.fromCharCode(B),j):t(B)}function k(B){return B===45?(n.consume(B),a=2,w):B===91?(n.consume(B),a=5,c=0,A):br(B)?(n.consume(B),a=4,r.interrupt?e:q):t(B)}function w(B){return B===45?(n.consume(B),r.interrupt?e:q):t(B)}function A(B){const $e="CDATA[";return B===$e.charCodeAt(c++)?(n.consume(B),c===$e.length?r.interrupt?e:ne:A):t(B)}function E(B){return br(B)?(n.consume(B),o=String.fromCharCode(B),j):t(B)}function j(B){if(B===null||B===47||B===62||rn(B)){const $e=B===47,rt=o.toLowerCase();return!$e&&!s&&Lk.includes(rt)?(a=1,r.interrupt?e(B):ne(B)):XD.includes(o.toLowerCase())?(a=6,$e?(n.consume(B),D):r.interrupt?e(B):ne(B)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(B):s?U(B):O(B))}return B===45||dr(B)?(n.consume(B),o+=String.fromCharCode(B),j):t(B)}function D(B){return B===62?(n.consume(B),r.interrupt?e:ne):t(B)}function U(B){return At(B)?(n.consume(B),U):I(B)}function O(B){return B===47?(n.consume(B),I):B===58||B===95||br(B)?(n.consume(B),J):At(B)?(n.consume(B),O):I(B)}function J(B){return B===45||B===46||B===58||B===95||dr(B)?(n.consume(B),J):ee(B)}function ee(B){return B===61?(n.consume(B),H):At(B)?(n.consume(B),ee):O(B)}function H(B){return B===null||B===60||B===61||B===62||B===96?t(B):B===34||B===39?(n.consume(B),h=B,L):At(B)?(n.consume(B),H):me(B)}function L(B){return B===h?(n.consume(B),h=null,he):B===null||ut(B)?t(B):(n.consume(B),L)}function me(B){return B===null||B===34||B===39||B===47||B===60||B===61||B===62||B===96||rn(B)?ee(B):(n.consume(B),me)}function he(B){return B===47||B===62||At(B)?O(B):t(B)}function I(B){return B===62?(n.consume(B),te):t(B)}function te(B){return B===null||ut(B)?ne(B):At(B)?(n.consume(B),te):t(B)}function ne(B){return B===45&&a===2?(n.consume(B),X):B===60&&a===1?(n.consume(B),ve):B===62&&a===4?(n.consume(B),ye):B===63&&a===3?(n.consume(B),q):B===93&&a===5?(n.consume(B),Ee):ut(B)&&(a===6||a===7)?(n.exit("htmlFlowData"),n.check(ZD,Ce,pe)(B)):B===null||ut(B)?(n.exit("htmlFlowData"),pe(B)):(n.consume(B),ne)}function pe(B){return n.check(JD,ge,Ce)(B)}function ge(B){return n.enter("lineEnding"),n.consume(B),n.exit("lineEnding"),re}function re(B){return B===null||ut(B)?pe(B):(n.enter("htmlFlowData"),ne(B))}function X(B){return B===45?(n.consume(B),q):ne(B)}function ve(B){return B===47?(n.consume(B),o="",Te):ne(B)}function Te(B){if(B===62){const $e=o.toLowerCase();return Lk.includes($e)?(n.consume(B),ye):ne(B)}return br(B)&&o.length<8?(n.consume(B),o+=String.fromCharCode(B),Te):ne(B)}function Ee(B){return B===93?(n.consume(B),q):ne(B)}function q(B){return B===62?(n.consume(B),ye):B===45&&a===2?(n.consume(B),q):ne(B)}function ye(B){return B===null||ut(B)?(n.exit("htmlFlowData"),Ce(B)):(n.consume(B),ye)}function Ce(B){return n.exit("htmlFlow"),e(B)}}function nO(n,e,t){const r=this;return a;function a(o){return ut(o)?(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),s):t(o)}function s(o){return r.parser.lazy[r.now().line]?t(o):e(o)}}function rO(n,e,t){return r;function r(a){return n.enter("lineEnding"),n.consume(a),n.exit("lineEnding"),n.attempt(th,e,t)}}const iO={name:"htmlText",tokenize:aO};function aO(n,e,t){const r=this;let a,s,o;return c;function c(q){return n.enter("htmlText"),n.enter("htmlTextData"),n.consume(q),h}function h(q){return q===33?(n.consume(q),d):q===47?(n.consume(q),ee):q===63?(n.consume(q),O):br(q)?(n.consume(q),me):t(q)}function d(q){return q===45?(n.consume(q),p):q===91?(n.consume(q),s=0,A):br(q)?(n.consume(q),U):t(q)}function p(q){return q===45?(n.consume(q),w):t(q)}function g(q){return q===null?t(q):q===45?(n.consume(q),k):ut(q)?(o=g,ve(q)):(n.consume(q),g)}function k(q){return q===45?(n.consume(q),w):g(q)}function w(q){return q===62?X(q):q===45?k(q):g(q)}function A(q){const ye="CDATA[";return q===ye.charCodeAt(s++)?(n.consume(q),s===ye.length?E:A):t(q)}function E(q){return q===null?t(q):q===93?(n.consume(q),j):ut(q)?(o=E,ve(q)):(n.consume(q),E)}function j(q){return q===93?(n.consume(q),D):E(q)}function D(q){return q===62?X(q):q===93?(n.consume(q),D):E(q)}function U(q){return q===null||q===62?X(q):ut(q)?(o=U,ve(q)):(n.consume(q),U)}function O(q){return q===null?t(q):q===63?(n.consume(q),J):ut(q)?(o=O,ve(q)):(n.consume(q),O)}function J(q){return q===62?X(q):O(q)}function ee(q){return br(q)?(n.consume(q),H):t(q)}function H(q){return q===45||dr(q)?(n.consume(q),H):L(q)}function L(q){return ut(q)?(o=L,ve(q)):At(q)?(n.consume(q),L):X(q)}function me(q){return q===45||dr(q)?(n.consume(q),me):q===47||q===62||rn(q)?he(q):t(q)}function he(q){return q===47?(n.consume(q),X):q===58||q===95||br(q)?(n.consume(q),I):ut(q)?(o=he,ve(q)):At(q)?(n.consume(q),he):X(q)}function I(q){return q===45||q===46||q===58||q===95||dr(q)?(n.consume(q),I):te(q)}function te(q){return q===61?(n.consume(q),ne):ut(q)?(o=te,ve(q)):At(q)?(n.consume(q),te):he(q)}function ne(q){return q===null||q===60||q===61||q===62||q===96?t(q):q===34||q===39?(n.consume(q),a=q,pe):ut(q)?(o=ne,ve(q)):At(q)?(n.consume(q),ne):(n.consume(q),ge)}function pe(q){return q===a?(n.consume(q),a=void 0,re):q===null?t(q):ut(q)?(o=pe,ve(q)):(n.consume(q),pe)}function ge(q){return q===null||q===34||q===39||q===60||q===61||q===96?t(q):q===47||q===62||rn(q)?he(q):(n.consume(q),ge)}function re(q){return q===47||q===62||rn(q)?he(q):t(q)}function X(q){return q===62?(n.consume(q),n.exit("htmlTextData"),n.exit("htmlText"),e):t(q)}function ve(q){return n.exit("htmlTextData"),n.enter("lineEnding"),n.consume(q),n.exit("lineEnding"),Te}function Te(q){return At(q)?_t(n,Ee,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(q):Ee(q)}function Ee(q){return n.enter("htmlTextData"),o(q)}}const jy={name:"labelEnd",resolveAll:uO,resolveTo:cO,tokenize:hO},lO={tokenize:fO},sO={tokenize:dO},oO={tokenize:pO};function uO(n){let e=-1;const t=[];for(;++e<n.length;){const r=n[e][1];if(t.push(n[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const a=r.type==="labelImage"?4:2;r.type="data",e+=a}}return n.length!==t.length&&Gr(n,0,n.length,t),n}function cO(n,e){let t=n.length,r=0,a,s,o,c;for(;t--;)if(a=n[t][1],s){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;n[t][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(o){if(n[t][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(s=t,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(o=t);const h={type:n[s][1].type==="labelLink"?"link":"image",start:{...n[s][1].start},end:{...n[n.length-1][1].end}},d={type:"label",start:{...n[s][1].start},end:{...n[o][1].end}},p={type:"labelText",start:{...n[s+r+2][1].end},end:{...n[o-2][1].start}};return c=[["enter",h,e],["enter",d,e]],c=si(c,n.slice(s+1,s+r+3)),c=si(c,[["enter",p,e]]),c=si(c,Fd(e.parser.constructs.insideSpan.null,n.slice(s+r+4,o-3),e)),c=si(c,[["exit",p,e],n[o-2],n[o-1],["exit",d,e]]),c=si(c,n.slice(o+1)),c=si(c,[["exit",h,e]]),Gr(n,s,n.length,c),n}function hO(n,e,t){const r=this;let a=r.events.length,s,o;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){s=r.events[a][1];break}return c;function c(k){return s?s._inactive?g(k):(o=r.parser.defined.includes(Ai(r.sliceSerialize({start:s.end,end:r.now()}))),n.enter("labelEnd"),n.enter("labelMarker"),n.consume(k),n.exit("labelMarker"),n.exit("labelEnd"),h):t(k)}function h(k){return k===40?n.attempt(lO,p,o?p:g)(k):k===91?n.attempt(sO,p,o?d:g)(k):o?p(k):g(k)}function d(k){return n.attempt(oO,p,g)(k)}function p(k){return e(k)}function g(k){return s._balanced=!0,t(k)}}function fO(n,e,t){return r;function r(g){return n.enter("resource"),n.enter("resourceMarker"),n.consume(g),n.exit("resourceMarker"),a}function a(g){return rn(g)?_c(n,s)(g):s(g)}function s(g){return g===41?p(g):uC(n,o,c,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function o(g){return rn(g)?_c(n,h)(g):p(g)}function c(g){return t(g)}function h(g){return g===34||g===39||g===40?hC(n,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function d(g){return rn(g)?_c(n,p)(g):p(g)}function p(g){return g===41?(n.enter("resourceMarker"),n.consume(g),n.exit("resourceMarker"),n.exit("resource"),e):t(g)}}function dO(n,e,t){const r=this;return a;function a(c){return cC.call(r,n,s,o,"reference","referenceMarker","referenceString")(c)}function s(c){return r.parser.defined.includes(Ai(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(c):t(c)}function o(c){return t(c)}}function pO(n,e,t){return r;function r(s){return n.enter("reference"),n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),a}function a(s){return s===93?(n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),n.exit("reference"),e):t(s)}}const mO={name:"labelStartImage",resolveAll:jy.resolveAll,tokenize:gO};function gO(n,e,t){const r=this;return a;function a(c){return n.enter("labelImage"),n.enter("labelImageMarker"),n.consume(c),n.exit("labelImageMarker"),s}function s(c){return c===91?(n.enter("labelMarker"),n.consume(c),n.exit("labelMarker"),n.exit("labelImage"),o):t(c)}function o(c){return c===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(c):e(c)}}const yO={name:"labelStartLink",resolveAll:jy.resolveAll,tokenize:xO};function xO(n,e,t){const r=this;return a;function a(o){return n.enter("labelLink"),n.enter("labelMarker"),n.consume(o),n.exit("labelMarker"),n.exit("labelLink"),s}function s(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(o):e(o)}}const yg={name:"lineEnding",tokenize:vO};function vO(n,e){return t;function t(r){return n.enter("lineEnding"),n.consume(r),n.exit("lineEnding"),_t(n,e,"linePrefix")}}const Xf={name:"thematicBreak",tokenize:bO};function bO(n,e,t){let r=0,a;return s;function s(d){return n.enter("thematicBreak"),o(d)}function o(d){return a=d,c(d)}function c(d){return d===a?(n.enter("thematicBreakSequence"),h(d)):r>=3&&(d===null||ut(d))?(n.exit("thematicBreak"),e(d)):t(d)}function h(d){return d===a?(n.consume(d),r++,h):(n.exit("thematicBreakSequence"),At(d)?_t(n,c,"whitespace")(d):c(d))}}const Mr={continuation:{tokenize:CO},exit:TO,name:"list",tokenize:SO},kO={partial:!0,tokenize:NO},wO={partial:!0,tokenize:AO};function SO(n,e,t){const r=this,a=r.events[r.events.length-1];let s=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,o=0;return c;function c(w){const A=r.containerState.type||(w===42||w===43||w===45?"listUnordered":"listOrdered");if(A==="listUnordered"?!r.containerState.marker||w===r.containerState.marker:D0(w)){if(r.containerState.type||(r.containerState.type=A,n.enter(A,{_container:!0})),A==="listUnordered")return n.enter("listItemPrefix"),w===42||w===45?n.check(Xf,t,d)(w):d(w);if(!r.interrupt||w===49)return n.enter("listItemPrefix"),n.enter("listItemValue"),h(w)}return t(w)}function h(w){return D0(w)&&++o<10?(n.consume(w),h):(!r.interrupt||o<2)&&(r.containerState.marker?w===r.containerState.marker:w===41||w===46)?(n.exit("listItemValue"),d(w)):t(w)}function d(w){return n.enter("listItemMarker"),n.consume(w),n.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||w,n.check(th,r.interrupt?t:p,n.attempt(kO,k,g))}function p(w){return r.containerState.initialBlankLine=!0,s++,k(w)}function g(w){return At(w)?(n.enter("listItemPrefixWhitespace"),n.consume(w),n.exit("listItemPrefixWhitespace"),k):t(w)}function k(w){return r.containerState.size=s+r.sliceSerialize(n.exit("listItemPrefix"),!0).length,e(w)}}function CO(n,e,t){const r=this;return r.containerState._closeFlow=void 0,n.check(th,a,s);function a(c){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,_t(n,e,"listItemIndent",r.containerState.size+1)(c)}function s(c){return r.containerState.furtherBlankLines||!At(c)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(c)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,n.attempt(wO,e,o)(c))}function o(c){return r.containerState._closeFlow=!0,r.interrupt=void 0,_t(n,n.attempt(Mr,e,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(c)}}function AO(n,e,t){const r=this;return _t(n,a,"listItemIndent",r.containerState.size+1);function a(s){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(s):t(s)}}function TO(n){n.exit(this.containerState.type)}function NO(n,e,t){const r=this;return _t(n,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(s){const o=r.events[r.events.length-1];return!At(s)&&o&&o[1].type==="listItemPrefixWhitespace"?e(s):t(s)}}const Bk={name:"setextUnderline",resolveTo:EO,tokenize:MO};function EO(n,e){let t=n.length,r,a,s;for(;t--;)if(n[t][0]==="enter"){if(n[t][1].type==="content"){r=t;break}n[t][1].type==="paragraph"&&(a=t)}else n[t][1].type==="content"&&n.splice(t,1),!s&&n[t][1].type==="definition"&&(s=t);const o={type:"setextHeading",start:{...n[r][1].start},end:{...n[n.length-1][1].end}};return n[a][1].type="setextHeadingText",s?(n.splice(a,0,["enter",o,e]),n.splice(s+1,0,["exit",n[r][1],e]),n[r][1].end={...n[s][1].end}):n[r][1]=o,n.push(["exit",o,e]),n}function MO(n,e,t){const r=this;let a;return s;function s(d){let p=r.events.length,g;for(;p--;)if(r.events[p][1].type!=="lineEnding"&&r.events[p][1].type!=="linePrefix"&&r.events[p][1].type!=="content"){g=r.events[p][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(n.enter("setextHeadingLine"),a=d,o(d)):t(d)}function o(d){return n.enter("setextHeadingLineSequence"),c(d)}function c(d){return d===a?(n.consume(d),c):(n.exit("setextHeadingLineSequence"),At(d)?_t(n,h,"lineSuffix")(d):h(d))}function h(d){return d===null||ut(d)?(n.exit("setextHeadingLine"),e(d)):t(d)}}const jO={tokenize:_O};function _O(n){const e=this,t=n.attempt(th,r,n.attempt(this.parser.constructs.flowInitial,a,_t(n,n.attempt(this.parser.constructs.flow,a,n.attempt(BD,a)),"linePrefix")));return t;function r(s){if(s===null){n.consume(s);return}return n.enter("lineEndingBlank"),n.consume(s),n.exit("lineEndingBlank"),e.currentConstruct=void 0,t}function a(s){if(s===null){n.consume(s);return}return n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),e.currentConstruct=void 0,t}}const DO={resolveAll:dC()},OO=fC("string"),RO=fC("text");function fC(n){return{resolveAll:dC(n==="text"?LO:void 0),tokenize:e};function e(t){const r=this,a=this.parser.constructs[n],s=t.attempt(a,o,c);return o;function o(p){return d(p)?s(p):c(p)}function c(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),h}function h(p){return d(p)?(t.exit("data"),s(p)):(t.consume(p),h)}function d(p){if(p===null)return!0;const g=a[p];let k=-1;if(g)for(;++k<g.length;){const w=g[k];if(!w.previous||w.previous.call(r,r.previous))return!0}return!1}}}function dC(n){return e;function e(t,r){let a=-1,s;for(;++a<=t.length;)s===void 0?t[a]&&t[a][1].type==="data"&&(s=a,a++):(!t[a]||t[a][1].type!=="data")&&(a!==s+2&&(t[s][1].end=t[a-1][1].end,t.splice(s+2,a-s-2),a=s+2),s=void 0);return n?n(t,r):t}}function LO(n,e){let t=0;for(;++t<=n.length;)if((t===n.length||n[t][1].type==="lineEnding")&&n[t-1][1].type==="data"){const r=n[t-1][1],a=e.sliceStream(r);let s=a.length,o=-1,c=0,h;for(;s--;){const d=a[s];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)c++,o--;if(o)break;o=-1}else if(d===-2)h=!0,c++;else if(d!==-1){s++;break}}if(e._contentTypeTextTrailing&&t===n.length&&(c=0),c){const d={type:t===n.length||h||c<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?o:r.start._bufferIndex+o,_index:r.start._index+s,line:r.end.line,column:r.end.column-c,offset:r.end.offset-c},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(n.splice(t,0,["enter",d,e],["exit",d,e]),t+=2)}t++}return n}const BO={42:Mr,43:Mr,45:Mr,48:Mr,49:Mr,50:Mr,51:Mr,52:Mr,53:Mr,54:Mr,55:Mr,56:Mr,57:Mr,62:aC},zO={91:qD},IO={[-2]:gg,[-1]:gg,32:gg},PO={35:YD,42:Xf,45:[Bk,Xf],60:WD,61:Bk,95:Xf,96:Rk,126:Rk},HO={38:sC,92:lC},qO={[-5]:yg,[-4]:yg,[-3]:yg,33:mO,38:sC,42:O0,60:[yD,iO],91:yO,92:[KD,lC],93:jy,95:O0,96:jD},UO={null:[O0,DO]},VO={null:[42,95]},FO={null:[]},KO=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:VO,contentInitial:zO,disable:FO,document:BO,flow:PO,flowInitial:IO,insideSpan:UO,string:HO,text:qO},Symbol.toStringTag,{value:"Module"}));function GO(n,e,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const a={},s=[];let o=[],c=[];const h={attempt:L(ee),check:L(H),consume:U,enter:O,exit:J,interrupt:L(H,{interrupt:!0})},d={code:null,containerState:{},defineSkip:E,events:[],now:A,parser:n,previous:null,sliceSerialize:k,sliceStream:w,write:g};let p=e.tokenize.call(d,h);return e.resolveAll&&s.push(e),d;function g(te){return o=si(o,te),j(),o[o.length-1]!==null?[]:(me(e,0),d.events=Fd(s,d.events,d),d.events)}function k(te,ne){return $O(w(te),ne)}function w(te){return YO(o,te)}function A(){const{_bufferIndex:te,_index:ne,line:pe,column:ge,offset:re}=r;return{_bufferIndex:te,_index:ne,line:pe,column:ge,offset:re}}function E(te){a[te.line]=te.column,I()}function j(){let te;for(;r._index<o.length;){const ne=o[r._index];if(typeof ne=="string")for(te=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===te&&r._bufferIndex<ne.length;)D(ne.charCodeAt(r._bufferIndex));else D(ne)}}function D(te){p=p(te)}function U(te){ut(te)?(r.line++,r.column=1,r.offset+=te===-3?2:1,I()):te!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=te}function O(te,ne){const pe=ne||{};return pe.type=te,pe.start=A(),d.events.push(["enter",pe,d]),c.push(pe),pe}function J(te){const ne=c.pop();return ne.end=A(),d.events.push(["exit",ne,d]),ne}function ee(te,ne){me(te,ne.from)}function H(te,ne){ne.restore()}function L(te,ne){return pe;function pe(ge,re,X){let ve,Te,Ee,q;return Array.isArray(ge)?Ce(ge):"tokenize"in ge?Ce([ge]):ye(ge);function ye(Qe){return wt;function wt(ft){const Ot=ft!==null&&Qe[ft],Fe=ft!==null&&Qe.null,Yt=[...Array.isArray(Ot)?Ot:Ot?[Ot]:[],...Array.isArray(Fe)?Fe:Fe?[Fe]:[]];return Ce(Yt)(ft)}}function Ce(Qe){return ve=Qe,Te=0,Qe.length===0?X:B(Qe[Te])}function B(Qe){return wt;function wt(ft){return q=he(),Ee=Qe,Qe.partial||(d.currentConstruct=Qe),Qe.name&&d.parser.constructs.disable.null.includes(Qe.name)?rt():Qe.tokenize.call(ne?Object.assign(Object.create(d),ne):d,h,$e,rt)(ft)}}function $e(Qe){return te(Ee,q),re}function rt(Qe){return q.restore(),++Te<ve.length?B(ve[Te]):X}}}function me(te,ne){te.resolveAll&&!s.includes(te)&&s.push(te),te.resolve&&Gr(d.events,ne,d.events.length-ne,te.resolve(d.events.slice(ne),d)),te.resolveTo&&(d.events=te.resolveTo(d.events,d))}function he(){const te=A(),ne=d.previous,pe=d.currentConstruct,ge=d.events.length,re=Array.from(c);return{from:ge,restore:X};function X(){r=te,d.previous=ne,d.currentConstruct=pe,d.events.length=ge,c=re,I()}}function I(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function YO(n,e){const t=e.start._index,r=e.start._bufferIndex,a=e.end._index,s=e.end._bufferIndex;let o;if(t===a)o=[n[t].slice(r,s)];else{if(o=n.slice(t,a),r>-1){const c=o[0];typeof c=="string"?o[0]=c.slice(r):o.shift()}s>0&&o.push(n[a].slice(0,s))}return o}function $O(n,e){let t=-1;const r=[];let a;for(;++t<n.length;){const s=n[t];let o;if(typeof s=="string")o=s;else switch(s){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&a)continue;o=" ";break}default:o=String.fromCharCode(s)}a=s===-2,r.push(o)}return r.join("")}function QO(n){const r={constructs:rC([KO,...(n||{}).extensions||[]]),content:a(cD),defined:[],document:a(fD),flow:a(jO),lazy:{},string:a(OO),text:a(RO)};return r;function a(s){return o;function o(c){return GO(r,s,c)}}}function XO(n){for(;!oC(n););return n}const zk=/[\0\t\n\r]/g;function WO(){let n=1,e="",t=!0,r;return a;function a(s,o,c){const h=[];let d,p,g,k,w;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(o||void 0).decode(s)),g=0,e="",t&&(s.charCodeAt(0)===65279&&g++,t=void 0);g<s.length;){if(zk.lastIndex=g,d=zk.exec(s),k=d&&d.index!==void 0?d.index:s.length,w=s.charCodeAt(k),!d){e=s.slice(g);break}if(w===10&&g===k&&r)h.push(-3),r=void 0;else switch(r&&(h.push(-5),r=void 0),g<k&&(h.push(s.slice(g,k)),n+=k-g),w){case 0:{h.push(65533),n++;break}case 9:{for(p=Math.ceil(n/4)*4,h.push(-2);n++<p;)h.push(-1);break}case 10:{h.push(-4),n=1;break}default:r=!0,n=1}g=k+1}return c&&(r&&h.push(-5),e&&h.push(e),h.push(null)),h}}const ZO=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function JO(n){return n.replace(ZO,e6)}function e6(n,e,t){if(e)return e;if(t.charCodeAt(0)===35){const a=t.charCodeAt(1),s=a===120||a===88;return iC(t.slice(s?2:1),s?16:10)}return My(t)||n}const pC={}.hasOwnProperty;function t6(n,e,t){return typeof e!="string"&&(t=e,e=void 0),n6(t)(XO(QO(t).document().write(WO()(n,e,!0))))}function n6(n){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(Xn),autolinkProtocol:he,autolinkEmail:he,atxHeading:s(un),blockQuote:s(Fe),characterEscape:he,characterReference:he,codeFenced:s(Yt),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:s(Yt,o),codeText:s(dt,o),codeTextData:he,data:he,codeFlowValue:he,definition:s(wn),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:s(vn),hardBreakEscape:s(Pn),hardBreakTrailing:s(Pn),htmlFlow:s(Qn,o),htmlFlowData:he,htmlText:s(Qn,o),htmlTextData:he,image:s(mn),label:o,link:s(Xn),listItem:s(Pe),listItemValue:k,listOrdered:s(Fn,g),listUnordered:s(Fn),paragraph:s(Rt),reference:B,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:s(un),strong:s($t),thematicBreak:s(yn)},exit:{atxHeading:h(),atxHeadingSequence:ee,autolink:h(),autolinkEmail:Ot,autolinkProtocol:ft,blockQuote:h(),characterEscapeValue:I,characterReferenceMarkerHexadecimal:rt,characterReferenceMarkerNumeric:rt,characterReferenceValue:Qe,characterReference:wt,codeFenced:h(j),codeFencedFence:E,codeFencedFenceInfo:w,codeFencedFenceMeta:A,codeFlowValue:I,codeIndented:h(D),codeText:h(re),codeTextData:I,data:I,definition:h(),definitionDestinationString:J,definitionLabelString:U,definitionTitleString:O,emphasis:h(),hardBreakEscape:h(ne),hardBreakTrailing:h(ne),htmlFlow:h(pe),htmlFlowData:I,htmlText:h(ge),htmlTextData:I,image:h(ve),label:Ee,labelText:Te,lineEnding:te,link:h(X),listItem:h(),listOrdered:h(),listUnordered:h(),paragraph:h(),referenceString:$e,resourceDestinationString:q,resourceTitleString:ye,resource:Ce,setextHeading:h(me),setextHeadingLineSequence:L,setextHeadingText:H,strong:h(),thematicBreak:h()}};mC(e,(n||{}).mdastExtensions||[]);const t={};return r;function r(ie){let be={type:"root",children:[]};const Ke={stack:[be],tokenStack:[],config:e,enter:c,exit:d,buffer:o,resume:p,data:t},tt=[];let it=-1;for(;++it<ie.length;)if(ie[it][1].type==="listOrdered"||ie[it][1].type==="listUnordered")if(ie[it][0]==="enter")tt.push(it);else{const Ne=tt.pop();it=a(ie,Ne,it)}for(it=-1;++it<ie.length;){const Ne=e[ie[it][0]];pC.call(Ne,ie[it][1].type)&&Ne[ie[it][1].type].call(Object.assign({sliceSerialize:ie[it][2].sliceSerialize},Ke),ie[it][1])}if(Ke.tokenStack.length>0){const Ne=Ke.tokenStack[Ke.tokenStack.length-1];(Ne[1]||Ik).call(Ke,void 0,Ne[0])}for(be.position={start:wl(ie.length>0?ie[0][1].start:{line:1,column:1,offset:0}),end:wl(ie.length>0?ie[ie.length-2][1].end:{line:1,column:1,offset:0})},it=-1;++it<e.transforms.length;)be=e.transforms[it](be)||be;return be}function a(ie,be,Ke){let tt=be-1,it=-1,Ne=!1,Be,je,He,De;for(;++tt<=Ke;){const Se=ie[tt];switch(Se[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Se[0]==="enter"?it++:it--,De=void 0;break}case"lineEndingBlank":{Se[0]==="enter"&&(Be&&!De&&!it&&!He&&(He=tt),De=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:De=void 0}if(!it&&Se[0]==="enter"&&Se[1].type==="listItemPrefix"||it===-1&&Se[0]==="exit"&&(Se[1].type==="listUnordered"||Se[1].type==="listOrdered")){if(Be){let ot=tt;for(je=void 0;ot--;){const mt=ie[ot];if(mt[1].type==="lineEnding"||mt[1].type==="lineEndingBlank"){if(mt[0]==="exit")continue;je&&(ie[je][1].type="lineEndingBlank",Ne=!0),mt[1].type="lineEnding",je=ot}else if(!(mt[1].type==="linePrefix"||mt[1].type==="blockQuotePrefix"||mt[1].type==="blockQuotePrefixWhitespace"||mt[1].type==="blockQuoteMarker"||mt[1].type==="listItemIndent"))break}He&&(!je||He<je)&&(Be._spread=!0),Be.end=Object.assign({},je?ie[je][1].start:Se[1].end),ie.splice(je||tt,0,["exit",Be,Se[2]]),tt++,Ke++}if(Se[1].type==="listItemPrefix"){const ot={type:"listItem",_spread:!1,start:Object.assign({},Se[1].start),end:void 0};Be=ot,ie.splice(tt,0,["enter",ot,Se[2]]),tt++,Ke++,He=void 0,De=!0}}}return ie[be][1]._spread=Ne,Ke}function s(ie,be){return Ke;function Ke(tt){c.call(this,ie(tt),tt),be&&be.call(this,tt)}}function o(){this.stack.push({type:"fragment",children:[]})}function c(ie,be,Ke){this.stack[this.stack.length-1].children.push(ie),this.stack.push(ie),this.tokenStack.push([be,Ke||void 0]),ie.position={start:wl(be.start),end:void 0}}function h(ie){return be;function be(Ke){ie&&ie.call(this,Ke),d.call(this,Ke)}}function d(ie,be){const Ke=this.stack.pop(),tt=this.tokenStack.pop();if(tt)tt[0].type!==ie.type&&(be?be.call(this,ie,tt[0]):(tt[1]||Ik).call(this,ie,tt[0]));else throw new Error("Cannot close `"+ie.type+"` ("+jc({start:ie.start,end:ie.end})+"): its not open");Ke.position.end=wl(ie.end)}function p(){return Ey(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function k(ie){if(this.data.expectingFirstListItemValue){const be=this.stack[this.stack.length-2];be.start=Number.parseInt(this.sliceSerialize(ie),10),this.data.expectingFirstListItemValue=void 0}}function w(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.lang=ie}function A(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.meta=ie}function E(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function j(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.value=ie.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function D(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.value=ie.replace(/(\r?\n|\r)$/g,"")}function U(ie){const be=this.resume(),Ke=this.stack[this.stack.length-1];Ke.label=be,Ke.identifier=Ai(this.sliceSerialize(ie)).toLowerCase()}function O(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.title=ie}function J(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.url=ie}function ee(ie){const be=this.stack[this.stack.length-1];if(!be.depth){const Ke=this.sliceSerialize(ie).length;be.depth=Ke}}function H(){this.data.setextHeadingSlurpLineEnding=!0}function L(ie){const be=this.stack[this.stack.length-1];be.depth=this.sliceSerialize(ie).codePointAt(0)===61?1:2}function me(){this.data.setextHeadingSlurpLineEnding=void 0}function he(ie){const Ke=this.stack[this.stack.length-1].children;let tt=Ke[Ke.length-1];(!tt||tt.type!=="text")&&(tt=Pt(),tt.position={start:wl(ie.start),end:void 0},Ke.push(tt)),this.stack.push(tt)}function I(ie){const be=this.stack.pop();be.value+=this.sliceSerialize(ie),be.position.end=wl(ie.end)}function te(ie){const be=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ke=be.children[be.children.length-1];Ke.position.end=wl(ie.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(be.type)&&(he.call(this,ie),I.call(this,ie))}function ne(){this.data.atHardBreak=!0}function pe(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.value=ie}function ge(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.value=ie}function re(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.value=ie}function X(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const be=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=be,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function ve(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const be=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=be,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function Te(ie){const be=this.sliceSerialize(ie),Ke=this.stack[this.stack.length-2];Ke.label=JO(be),Ke.identifier=Ai(be).toLowerCase()}function Ee(){const ie=this.stack[this.stack.length-1],be=this.resume(),Ke=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ke.type==="link"){const tt=ie.children;Ke.children=tt}else Ke.alt=be}function q(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.url=ie}function ye(){const ie=this.resume(),be=this.stack[this.stack.length-1];be.title=ie}function Ce(){this.data.inReference=void 0}function B(){this.data.referenceType="collapsed"}function $e(ie){const be=this.resume(),Ke=this.stack[this.stack.length-1];Ke.label=be,Ke.identifier=Ai(this.sliceSerialize(ie)).toLowerCase(),this.data.referenceType="full"}function rt(ie){this.data.characterReferenceType=ie.type}function Qe(ie){const be=this.sliceSerialize(ie),Ke=this.data.characterReferenceType;let tt;Ke?(tt=iC(be,Ke==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):tt=My(be);const it=this.stack[this.stack.length-1];it.value+=tt}function wt(ie){const be=this.stack.pop();be.position.end=wl(ie.end)}function ft(ie){I.call(this,ie);const be=this.stack[this.stack.length-1];be.url=this.sliceSerialize(ie)}function Ot(ie){I.call(this,ie);const be=this.stack[this.stack.length-1];be.url="mailto:"+this.sliceSerialize(ie)}function Fe(){return{type:"blockquote",children:[]}}function Yt(){return{type:"code",lang:null,meta:null,value:""}}function dt(){return{type:"inlineCode",value:""}}function wn(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function vn(){return{type:"emphasis",children:[]}}function un(){return{type:"heading",depth:0,children:[]}}function Pn(){return{type:"break"}}function Qn(){return{type:"html",value:""}}function mn(){return{type:"image",title:null,url:"",alt:null}}function Xn(){return{type:"link",title:null,url:"",children:[]}}function Fn(ie){return{type:"list",ordered:ie.type==="listOrdered",start:null,spread:ie._spread,children:[]}}function Pe(ie){return{type:"listItem",spread:ie._spread,checked:null,children:[]}}function Rt(){return{type:"paragraph",children:[]}}function $t(){return{type:"strong",children:[]}}function Pt(){return{type:"text",value:""}}function yn(){return{type:"thematicBreak"}}}function wl(n){return{line:n.line,column:n.column,offset:n.offset}}function mC(n,e){let t=-1;for(;++t<e.length;){const r=e[t];Array.isArray(r)?mC(n,r):r6(n,r)}}function r6(n,e){let t;for(t in e)if(pC.call(e,t))switch(t){case"canContainEols":{const r=e[t];r&&n[t].push(...r);break}case"transforms":{const r=e[t];r&&n[t].push(...r);break}case"enter":case"exit":{const r=e[t];r&&Object.assign(n[t],r);break}}}function Ik(n,e){throw n?new Error("Cannot close `"+n.type+"` ("+jc({start:n.start,end:n.end})+"): a different token (`"+e.type+"`, "+jc({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+jc({start:e.start,end:e.end})+") is still open")}function i6(n){const e=this;e.parser=t;function t(r){return t6(r,{...e.data("settings"),...n,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function a6(n,e){const t={type:"element",tagName:"blockquote",properties:{},children:n.wrap(n.all(e),!0)};return n.patch(e,t),n.applyData(e,t)}function l6(n,e){const t={type:"element",tagName:"br",properties:{},children:[]};return n.patch(e,t),[n.applyData(e,t),{type:"text",value:`
`}]}function s6(n,e){const t=e.value?e.value+`
`:"",r={},a=e.lang?e.lang.split(/\s+/):[];a.length>0&&(r.className=["language-"+a[0]]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return e.meta&&(s.data={meta:e.meta}),n.patch(e,s),s=n.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},n.patch(e,s),s}function o6(n,e){const t={type:"element",tagName:"del",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function u6(n,e){const t={type:"element",tagName:"em",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function c6(n,e){const t=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),a=nu(r.toLowerCase()),s=n.footnoteOrder.indexOf(r);let o,c=n.footnoteCounts.get(r);c===void 0?(c=0,n.footnoteOrder.push(r),o=n.footnoteOrder.length):o=s+1,c+=1,n.footnoteCounts.set(r,c);const h={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+a,id:t+"fnref-"+a+(c>1?"-"+c:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};n.patch(e,h);const d={type:"element",tagName:"sup",properties:{},children:[h]};return n.patch(e,d),n.applyData(e,d)}function h6(n,e){const t={type:"element",tagName:"h"+e.depth,properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function f6(n,e){if(n.options.allowDangerousHtml){const t={type:"raw",value:e.value};return n.patch(e,t),n.applyData(e,t)}}function gC(n,e){const t=e.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const a=n.all(e),s=a[0];s&&s.type==="text"?s.value="["+s.value:a.unshift({type:"text",value:"["});const o=a[a.length-1];return o&&o.type==="text"?o.value+=r:a.push({type:"text",value:r}),a}function d6(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return gC(n,e);const a={src:nu(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"img",properties:a,children:[]};return n.patch(e,s),n.applyData(e,s)}function p6(n,e){const t={src:nu(e.url)};e.alt!==null&&e.alt!==void 0&&(t.alt=e.alt),e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"img",properties:t,children:[]};return n.patch(e,r),n.applyData(e,r)}function m6(n,e){const t={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};n.patch(e,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return n.patch(e,r),n.applyData(e,r)}function g6(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return gC(n,e);const a={href:nu(r.url||"")};r.title!==null&&r.title!==void 0&&(a.title=r.title);const s={type:"element",tagName:"a",properties:a,children:n.all(e)};return n.patch(e,s),n.applyData(e,s)}function y6(n,e){const t={href:nu(e.url)};e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"a",properties:t,children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function x6(n,e,t){const r=n.all(e),a=t?v6(t):yC(e),s={},o=[];if(typeof e.checked=="boolean"){const p=r[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let c=-1;for(;++c<r.length;){const p=r[c];(a||c!==0||p.type!=="element"||p.tagName!=="p")&&o.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?o.push(...p.children):o.push(p)}const h=r[r.length-1];h&&(a||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:s,children:o};return n.patch(e,d),n.applyData(e,d)}function v6(n){let e=!1;if(n.type==="list"){e=n.spread||!1;const t=n.children;let r=-1;for(;!e&&++r<t.length;)e=yC(t[r])}return e}function yC(n){const e=n.spread;return e??n.children.length>1}function b6(n,e){const t={},r=n.all(e);let a=-1;for(typeof e.start=="number"&&e.start!==1&&(t.start=e.start);++a<r.length;){const o=r[a];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:t,children:n.wrap(r,!0)};return n.patch(e,s),n.applyData(e,s)}function k6(n,e){const t={type:"element",tagName:"p",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function w6(n,e){const t={type:"root",children:n.wrap(n.all(e))};return n.patch(e,t),n.applyData(e,t)}function S6(n,e){const t={type:"element",tagName:"strong",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function C6(n,e){const t=n.all(e),r=t.shift(),a=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:n.wrap([r],!0)};n.patch(e.children[0],o),a.push(o)}if(t.length>0){const o={type:"element",tagName:"tbody",properties:{},children:n.wrap(t,!0)},c=Cy(e.children[1]),h=X2(e.children[e.children.length-1]);c&&h&&(o.position={start:c,end:h}),a.push(o)}const s={type:"element",tagName:"table",properties:{},children:n.wrap(a,!0)};return n.patch(e,s),n.applyData(e,s)}function A6(n,e,t){const r=t?t.children:void 0,s=(r?r.indexOf(e):1)===0?"th":"td",o=t&&t.type==="table"?t.align:void 0,c=o?o.length:e.children.length;let h=-1;const d=[];for(;++h<c;){const g=e.children[h],k={},w=o?o[h]:void 0;w&&(k.align=w);let A={type:"element",tagName:s,properties:k,children:[]};g&&(A.children=n.all(g),n.patch(g,A),A=n.applyData(g,A)),d.push(A)}const p={type:"element",tagName:"tr",properties:{},children:n.wrap(d,!0)};return n.patch(e,p),n.applyData(e,p)}function T6(n,e){const t={type:"element",tagName:"td",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}const Pk=9,Hk=32;function N6(n){const e=String(n),t=/\r?\n|\r/g;let r=t.exec(e),a=0;const s=[];for(;r;)s.push(qk(e.slice(a,r.index),a>0,!0),r[0]),a=r.index+r[0].length,r=t.exec(e);return s.push(qk(e.slice(a),a>0,!1)),s.join("")}function qk(n,e,t){let r=0,a=n.length;if(e){let s=n.codePointAt(r);for(;s===Pk||s===Hk;)r++,s=n.codePointAt(r)}if(t){let s=n.codePointAt(a-1);for(;s===Pk||s===Hk;)a--,s=n.codePointAt(a-1)}return a>r?n.slice(r,a):""}function E6(n,e){const t={type:"text",value:N6(String(e.value))};return n.patch(e,t),n.applyData(e,t)}function M6(n,e){const t={type:"element",tagName:"hr",properties:{},children:[]};return n.patch(e,t),n.applyData(e,t)}const j6={blockquote:a6,break:l6,code:s6,delete:o6,emphasis:u6,footnoteReference:c6,heading:h6,html:f6,imageReference:d6,image:p6,inlineCode:m6,linkReference:g6,link:y6,listItem:x6,list:b6,paragraph:k6,root:w6,strong:S6,table:C6,tableCell:T6,tableRow:A6,text:E6,thematicBreak:M6,toml:zf,yaml:zf,definition:zf,footnoteDefinition:zf};function zf(){}const xC=-1,Kd=0,Dc=1,Ad=2,_y=3,Dy=4,Oy=5,Ry=6,vC=7,bC=8,Uk=typeof self=="object"?self:globalThis,_6=(n,e)=>{const t=(a,s)=>(n.set(s,a),a),r=a=>{if(n.has(a))return n.get(a);const[s,o]=e[a];switch(s){case Kd:case xC:return t(o,a);case Dc:{const c=t([],a);for(const h of o)c.push(r(h));return c}case Ad:{const c=t({},a);for(const[h,d]of o)c[r(h)]=r(d);return c}case _y:return t(new Date(o),a);case Dy:{const{source:c,flags:h}=o;return t(new RegExp(c,h),a)}case Oy:{const c=t(new Map,a);for(const[h,d]of o)c.set(r(h),r(d));return c}case Ry:{const c=t(new Set,a);for(const h of o)c.add(r(h));return c}case vC:{const{name:c,message:h}=o;return t(new Uk[c](h),a)}case bC:return t(BigInt(o),a);case"BigInt":return t(Object(BigInt(o)),a);case"ArrayBuffer":return t(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:c}=new Uint8Array(o);return t(new DataView(c),o)}}return t(new Uk[s](o),a)};return r},Vk=n=>_6(new Map,n)(0),So="",{toString:D6}={},{keys:O6}=Object,pc=n=>{const e=typeof n;if(e!=="object"||!n)return[Kd,e];const t=D6.call(n).slice(8,-1);switch(t){case"Array":return[Dc,So];case"Object":return[Ad,So];case"Date":return[_y,So];case"RegExp":return[Dy,So];case"Map":return[Oy,So];case"Set":return[Ry,So];case"DataView":return[Dc,t]}return t.includes("Array")?[Dc,t]:t.includes("Error")?[vC,t]:[Ad,t]},If=([n,e])=>n===Kd&&(e==="function"||e==="symbol"),R6=(n,e,t,r)=>{const a=(o,c)=>{const h=r.push(o)-1;return t.set(c,h),h},s=o=>{if(t.has(o))return t.get(o);let[c,h]=pc(o);switch(c){case Kd:{let p=o;switch(h){case"bigint":c=bC,p=o.toString();break;case"function":case"symbol":if(n)throw new TypeError("unable to serialize "+h);p=null;break;case"undefined":return a([xC],o)}return a([c,p],o)}case Dc:{if(h){let k=o;return h==="DataView"?k=new Uint8Array(o.buffer):h==="ArrayBuffer"&&(k=new Uint8Array(o)),a([h,[...k]],o)}const p=[],g=a([c,p],o);for(const k of o)p.push(s(k));return g}case Ad:{if(h)switch(h){case"BigInt":return a([h,o.toString()],o);case"Boolean":case"Number":case"String":return a([h,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const p=[],g=a([c,p],o);for(const k of O6(o))(n||!If(pc(o[k])))&&p.push([s(k),s(o[k])]);return g}case _y:return a([c,o.toISOString()],o);case Dy:{const{source:p,flags:g}=o;return a([c,{source:p,flags:g}],o)}case Oy:{const p=[],g=a([c,p],o);for(const[k,w]of o)(n||!(If(pc(k))||If(pc(w))))&&p.push([s(k),s(w)]);return g}case Ry:{const p=[],g=a([c,p],o);for(const k of o)(n||!If(pc(k)))&&p.push(s(k));return g}}const{message:d}=o;return a([c,{name:h,message:d}],o)};return s},Fk=(n,{json:e,lossy:t}={})=>{const r=[];return R6(!(e||t),!!e,new Map,r)(n),r},Td=typeof structuredClone=="function"?(n,e)=>e&&("json"in e||"lossy"in e)?Vk(Fk(n,e)):structuredClone(n):(n,e)=>Vk(Fk(n,e));function L6(n,e){const t=[{type:"text",value:""}];return e>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),t}function B6(n,e){return"Back to reference "+(n+1)+(e>1?"-"+e:"")}function z6(n){const e=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",t=n.options.footnoteBackContent||L6,r=n.options.footnoteBackLabel||B6,a=n.options.footnoteLabel||"Footnotes",s=n.options.footnoteLabelTagName||"h2",o=n.options.footnoteLabelProperties||{className:["sr-only"]},c=[];let h=-1;for(;++h<n.footnoteOrder.length;){const d=n.footnoteById.get(n.footnoteOrder[h]);if(!d)continue;const p=n.all(d),g=String(d.identifier).toUpperCase(),k=nu(g.toLowerCase());let w=0;const A=[],E=n.footnoteCounts.get(g);for(;E!==void 0&&++w<=E;){A.length>0&&A.push({type:"text",value:" "});let U=typeof t=="string"?t:t(h,w);typeof U=="string"&&(U={type:"text",value:U}),A.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+k+(w>1?"-"+w:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(h,w),className:["data-footnote-backref"]},children:Array.isArray(U)?U:[U]})}const j=p[p.length-1];if(j&&j.type==="element"&&j.tagName==="p"){const U=j.children[j.children.length-1];U&&U.type==="text"?U.value+=" ":j.children.push({type:"text",value:" "}),j.children.push(...A)}else p.push(...A);const D={type:"element",tagName:"li",properties:{id:e+"fn-"+k},children:n.wrap(p,!0)};n.patch(d,D),c.push(D)}if(c.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...Td(o),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:n.wrap(c,!0)},{type:"text",value:`
`}]}}const Gd=(function(n){if(n==null)return q6;if(typeof n=="function")return Yd(n);if(typeof n=="object")return Array.isArray(n)?I6(n):P6(n);if(typeof n=="string")return H6(n);throw new Error("Expected function, string, or object as test")});function I6(n){const e=[];let t=-1;for(;++t<n.length;)e[t]=Gd(n[t]);return Yd(r);function r(...a){let s=-1;for(;++s<e.length;)if(e[s].apply(this,a))return!0;return!1}}function P6(n){const e=n;return Yd(t);function t(r){const a=r;let s;for(s in n)if(a[s]!==e[s])return!1;return!0}}function H6(n){return Yd(e);function e(t){return t&&t.type===n}}function Yd(n){return e;function e(t,r,a){return!!(U6(t)&&n.call(this,t,typeof r=="number"?r:void 0,a||void 0))}}function q6(){return!0}function U6(n){return n!==null&&typeof n=="object"&&"type"in n}const kC=[],V6=!0,R0=!1,F6="skip";function wC(n,e,t,r){let a;typeof e=="function"&&typeof t!="function"?(r=t,t=e):a=e;const s=Gd(a),o=r?-1:1;c(n,void 0,[])();function c(h,d,p){const g=h&&typeof h=="object"?h:{};if(typeof g.type=="string"){const w=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(k,"name",{value:"node ("+(h.type+(w?"<"+w+">":""))+")"})}return k;function k(){let w=kC,A,E,j;if((!e||s(h,d,p[p.length-1]||void 0))&&(w=K6(t(h,p)),w[0]===R0))return w;if("children"in h&&h.children){const D=h;if(D.children&&w[0]!==F6)for(E=(r?D.children.length:-1)+o,j=p.concat(D);E>-1&&E<D.children.length;){const U=D.children[E];if(A=c(U,E,j)(),A[0]===R0)return A;E=typeof A[1]=="number"?A[1]:E+o}}return w}}}function K6(n){return Array.isArray(n)?n:typeof n=="number"?[V6,n]:n==null?kC:[n]}function Ly(n,e,t,r){let a,s,o;typeof e=="function"&&typeof t!="function"?(s=void 0,o=e,a=t):(s=e,o=t,a=r),wC(n,s,c,a);function c(h,d){const p=d[d.length-1],g=p?p.children.indexOf(h):void 0;return o(h,g,p)}}const L0={}.hasOwnProperty,G6={};function Y6(n,e){const t=e||G6,r=new Map,a=new Map,s=new Map,o={...j6,...t.handlers},c={all:d,applyData:Q6,definitionById:r,footnoteById:a,footnoteCounts:s,footnoteOrder:[],handlers:o,one:h,options:t,patch:$6,wrap:W6};return Ly(n,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?r:a,k=String(p.identifier).toUpperCase();g.has(k)||g.set(k,p)}}),c;function h(p,g){const k=p.type,w=c.handlers[k];if(L0.call(c.handlers,k)&&w)return w(c,p,g);if(c.options.passThrough&&c.options.passThrough.includes(k)){if("children"in p){const{children:E,...j}=p,D=Td(j);return D.children=c.all(p),D}return Td(p)}return(c.options.unknownHandler||X6)(c,p,g)}function d(p){const g=[];if("children"in p){const k=p.children;let w=-1;for(;++w<k.length;){const A=c.one(k[w],p);if(A){if(w&&k[w-1].type==="break"&&(!Array.isArray(A)&&A.type==="text"&&(A.value=Kk(A.value)),!Array.isArray(A)&&A.type==="element")){const E=A.children[0];E&&E.type==="text"&&(E.value=Kk(E.value))}Array.isArray(A)?g.push(...A):g.push(A)}}}return g}}function $6(n,e){n.position&&(e.position=B_(n))}function Q6(n,e){let t=e;if(n&&n.data){const r=n.data.hName,a=n.data.hChildren,s=n.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const o="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:o}}t.type==="element"&&s&&Object.assign(t.properties,Td(s)),"children"in t&&t.children&&a!==null&&a!==void 0&&(t.children=a)}return t}function X6(n,e){const t=e.data||{},r="value"in e&&!(L0.call(t,"hProperties")||L0.call(t,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function W6(n,e){const t=[];let r=-1;for(e&&t.push({type:"text",value:`
`});++r<n.length;)r&&t.push({type:"text",value:`
`}),t.push(n[r]);return e&&n.length>0&&t.push({type:"text",value:`
`}),t}function Kk(n){let e=0,t=n.charCodeAt(e);for(;t===9||t===32;)e++,t=n.charCodeAt(e);return n.slice(e)}function Gk(n,e){const t=Y6(n,e),r=t.one(n,void 0),a=z6(t),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return a&&s.children.push({type:"text",value:`
`},a),s}function Z6(n,e){return n&&"run"in n?async function(t,r){const a=Gk(t,{file:r,...e});await n.run(a,r)}:function(t,r){return Gk(t,{file:r,...n||e})}}function Yk(n){if(n)throw n}var xg,$k;function J6(){if($k)return xg;$k=1;var n=Object.prototype.hasOwnProperty,e=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):e.call(d)==="[object Array]"},s=function(d){if(!d||e.call(d)!=="[object Object]")return!1;var p=n.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&n.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!p&&!g)return!1;var k;for(k in d);return typeof k>"u"||n.call(d,k)},o=function(d,p){t&&p.name==="__proto__"?t(d,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):d[p.name]=p.newValue},c=function(d,p){if(p==="__proto__")if(n.call(d,p)){if(r)return r(d,p).value}else return;return d[p]};return xg=function h(){var d,p,g,k,w,A,E=arguments[0],j=1,D=arguments.length,U=!1;for(typeof E=="boolean"&&(U=E,E=arguments[1]||{},j=2),(E==null||typeof E!="object"&&typeof E!="function")&&(E={});j<D;++j)if(d=arguments[j],d!=null)for(p in d)g=c(E,p),k=c(d,p),E!==k&&(U&&k&&(s(k)||(w=a(k)))?(w?(w=!1,A=g&&a(g)?g:[]):A=g&&s(g)?g:{},o(E,{name:p,newValue:h(U,A,k)})):typeof k<"u"&&o(E,{name:p,newValue:k}));return E},xg}var eR=J6();const vg=Ed(eR);function B0(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function tR(){const n=[],e={run:t,use:r};return e;function t(...a){let s=-1;const o=a.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);c(null,...a);function c(h,...d){const p=n[++s];let g=-1;if(h){o(h);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,p?nR(p,c)(...d):o(null,...d)}}function r(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return n.push(a),e}}function nR(n,e){let t;return r;function r(...o){const c=n.length>o.length;let h;c&&o.push(a);try{h=n.apply(this,o)}catch(d){const p=d;if(c&&t)throw p;return a(p)}c||(h&&h.then&&typeof h.then=="function"?h.then(s,a):h instanceof Error?a(h):s(h))}function a(o,...c){t||(t=!0,e(o,...c))}function s(o){a(null,o)}}const $i={basename:rR,dirname:iR,extname:aR,join:lR,sep:"/"};function rR(n,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');nh(n);let t=0,r=-1,a=n.length,s;if(e===void 0||e.length===0||e.length>n.length){for(;a--;)if(n.codePointAt(a)===47){if(s){t=a+1;break}}else r<0&&(s=!0,r=a+1);return r<0?"":n.slice(t,r)}if(e===n)return"";let o=-1,c=e.length-1;for(;a--;)if(n.codePointAt(a)===47){if(s){t=a+1;break}}else o<0&&(s=!0,o=a+1),c>-1&&(n.codePointAt(a)===e.codePointAt(c--)?c<0&&(r=a):(c=-1,r=o));return t===r?r=o:r<0&&(r=n.length),n.slice(t,r)}function iR(n){if(nh(n),n.length===0)return".";let e=-1,t=n.length,r;for(;--t;)if(n.codePointAt(t)===47){if(r){e=t;break}}else r||(r=!0);return e<0?n.codePointAt(0)===47?"/":".":e===1&&n.codePointAt(0)===47?"//":n.slice(0,e)}function aR(n){nh(n);let e=n.length,t=-1,r=0,a=-1,s=0,o;for(;e--;){const c=n.codePointAt(e);if(c===47){if(o){r=e+1;break}continue}t<0&&(o=!0,t=e+1),c===46?a<0?a=e:s!==1&&(s=1):a>-1&&(s=-1)}return a<0||t<0||s===0||s===1&&a===t-1&&a===r+1?"":n.slice(a,t)}function lR(...n){let e=-1,t;for(;++e<n.length;)nh(n[e]),n[e]&&(t=t===void 0?n[e]:t+"/"+n[e]);return t===void 0?".":sR(t)}function sR(n){nh(n);const e=n.codePointAt(0)===47;let t=oR(n,!e);return t.length===0&&!e&&(t="."),t.length>0&&n.codePointAt(n.length-1)===47&&(t+="/"),e?"/"+t:t}function oR(n,e){let t="",r=0,a=-1,s=0,o=-1,c,h;for(;++o<=n.length;){if(o<n.length)c=n.codePointAt(o);else{if(c===47)break;c=47}if(c===47){if(!(a===o-1||s===1))if(a!==o-1&&s===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(h=t.lastIndexOf("/"),h!==t.length-1){h<0?(t="",r=0):(t=t.slice(0,h),r=t.length-1-t.lastIndexOf("/")),a=o,s=0;continue}}else if(t.length>0){t="",r=0,a=o,s=0;continue}}e&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+n.slice(a+1,o):t=n.slice(a+1,o),r=o-a-1;a=o,s=0}else c===46&&s>-1?s++:s=-1}return t}function nh(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}const uR={cwd:cR};function cR(){return"/"}function z0(n){return!!(n!==null&&typeof n=="object"&&"href"in n&&n.href&&"protocol"in n&&n.protocol&&n.auth===void 0)}function hR(n){if(typeof n=="string")n=new URL(n);else if(!z0(n)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+n+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(n.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return fR(n)}function fR(n){if(n.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=n.pathname;let t=-1;for(;++t<e.length;)if(e.codePointAt(t)===37&&e.codePointAt(t+1)===50){const r=e.codePointAt(t+2);if(r===70||r===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(e)}const bg=["history","path","basename","stem","extname","dirname"];class SC{constructor(e){let t;e?z0(e)?t={path:e}:typeof e=="string"||dR(e)?t={value:e}:t=e:t={},this.cwd="cwd"in t?"":uR.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<bg.length;){const s=bg[r];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let a;for(a in t)bg.includes(a)||(this[a]=t[a])}get basename(){return typeof this.path=="string"?$i.basename(this.path):void 0}set basename(e){wg(e,"basename"),kg(e,"basename"),this.path=$i.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?$i.dirname(this.path):void 0}set dirname(e){Qk(this.basename,"dirname"),this.path=$i.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?$i.extname(this.path):void 0}set extname(e){if(kg(e,"extname"),Qk(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=$i.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){z0(e)&&(e=hR(e)),wg(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?$i.basename(this.path,this.extname):void 0}set stem(e){wg(e,"stem"),kg(e,"stem"),this.path=$i.join(this.dirname||"",e+(this.extname||""))}fail(e,t,r){const a=this.message(e,t,r);throw a.fatal=!0,a}info(e,t,r){const a=this.message(e,t,r);return a.fatal=void 0,a}message(e,t,r){const a=new mr(e,t,r);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function kg(n,e){if(n&&n.includes($i.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+$i.sep+"`")}function wg(n,e){if(!n)throw new Error("`"+e+"` cannot be empty")}function Qk(n,e){if(!n)throw new Error("Setting `"+e+"` requires `path` to be set too")}function dR(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const pR=(function(n){const r=this.constructor.prototype,a=r[n],s=function(){return a.apply(s,arguments)};return Object.setPrototypeOf(s,r),s}),mR={}.hasOwnProperty;class By extends pR{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=tR()}copy(){const e=new By;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];e.use(...r)}return e.data(vg(!0,{},this.namespace)),e}data(e,t){return typeof e=="string"?arguments.length===2?(Ag("data",this.frozen),this.namespace[e]=t,this):mR.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Ag("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const a=t.call(e,...r);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=Pf(e),r=this.parser||this.Parser;return Sg("parse",r),r(String(t),t)}process(e,t){const r=this;return this.freeze(),Sg("process",this.parser||this.Parser),Cg("process",this.compiler||this.Compiler),t?a(void 0,t):new Promise(a);function a(s,o){const c=Pf(e),h=r.parse(c);r.run(h,c,function(p,g,k){if(p||!g||!k)return d(p);const w=g,A=r.stringify(w,k);xR(A)?k.value=A:k.result=A,d(p,k)});function d(p,g){p||!g?o(p):s?s(g):t(void 0,g)}}}processSync(e){let t=!1,r;return this.freeze(),Sg("processSync",this.parser||this.Parser),Cg("processSync",this.compiler||this.Compiler),this.process(e,a),Wk("processSync","process",t),r;function a(s,o){t=!0,Yk(s),r=o}}run(e,t,r){Xk(e),this.freeze();const a=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?s(void 0,r):new Promise(s);function s(o,c){const h=Pf(t);a.run(e,h,d);function d(p,g,k){const w=g||e;p?c(p):o?o(w):r(void 0,w,k)}}}runSync(e,t){let r=!1,a;return this.run(e,t,s),Wk("runSync","run",r),a;function s(o,c){Yk(o),a=c,r=!0}}stringify(e,t){this.freeze();const r=Pf(t),a=this.compiler||this.Compiler;return Cg("stringify",a),Xk(e),a(e,r)}use(e,...t){const r=this.attachers,a=this.namespace;if(Ag("use",this.frozen),e!=null)if(typeof e=="function")h(e,t);else if(typeof e=="object")Array.isArray(e)?c(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(d){if(typeof d=="function")h(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[p,...g]=d;h(p,g)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");c(d.plugins),d.settings&&(a.settings=vg(!0,a.settings,d.settings))}function c(d){let p=-1;if(d!=null)if(Array.isArray(d))for(;++p<d.length;){const g=d[p];s(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function h(d,p){let g=-1,k=-1;for(;++g<r.length;)if(r[g][0]===d){k=g;break}if(k===-1)r.push([d,...p]);else if(p.length>0){let[w,...A]=p;const E=r[k][1];B0(E)&&B0(w)&&(w=vg(!0,E,w)),r[k]=[d,w,...A]}}}}const gR=new By().freeze();function Sg(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `parser`")}function Cg(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `compiler`")}function Ag(n,e){if(e)throw new Error("Cannot call `"+n+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Xk(n){if(!B0(n)||typeof n.type!="string")throw new TypeError("Expected node, got `"+n+"`")}function Wk(n,e,t){if(!t)throw new Error("`"+n+"` finished async. Use `"+e+"` instead")}function Pf(n){return yR(n)?n:new SC(n)}function yR(n){return!!(n&&typeof n=="object"&&"message"in n&&"messages"in n)}function xR(n){return typeof n=="string"||vR(n)}function vR(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const bR="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Zk=[],Jk={allowDangerousHtml:!0},kR=/^(https?|ircs?|mailto|xmpp)$/i,wR=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function I0(n){const e=SR(n),t=CR(n);return AR(e.runSync(e.parse(t),t),n)}function SR(n){const e=n.rehypePlugins||Zk,t=n.remarkPlugins||Zk,r=n.remarkRehypeOptions?{...n.remarkRehypeOptions,...Jk}:Jk;return gR().use(i6).use(t).use(Z6,r).use(e)}function CR(n){const e=n.children||"",t=new SC;return typeof e=="string"&&(t.value=e),t}function AR(n,e){const t=e.allowedElements,r=e.allowElement,a=e.components,s=e.disallowedElements,o=e.skipHtml,c=e.unwrapDisallowed,h=e.urlTransform||TR;for(const p of wR)Object.hasOwn(e,p.from)&&(""+p.from+(p.to?"use `"+p.to+"` instead":"remove it")+bR+p.id,void 0);return Ly(n,d),q_(n,{Fragment:b.Fragment,components:a,ignoreInvalidStyle:!0,jsx:b.jsx,jsxs:b.jsxs,passKeys:!0,passNode:!0});function d(p,g,k){if(p.type==="raw"&&k&&typeof g=="number")return o?k.children.splice(g,1):k.children[g]={type:"text",value:p.value},g;if(p.type==="element"){let w;for(w in mg)if(Object.hasOwn(mg,w)&&Object.hasOwn(p.properties,w)){const A=p.properties[w],E=mg[w];(E===null||E.includes(p.tagName))&&(p.properties[w]=h(String(A||""),w,p))}}if(p.type==="element"){let w=t?!t.includes(p.tagName):s?s.includes(p.tagName):!1;if(!w&&r&&typeof g=="number"&&(w=!r(p,g,k)),w&&k&&typeof g=="number")return c&&p.children?k.children.splice(g,1,...p.children):k.children.splice(g,1),g}}}function TR(n){const e=n.indexOf(":"),t=n.indexOf("?"),r=n.indexOf("#"),a=n.indexOf("/");return e===-1||a!==-1&&e>a||t!==-1&&e>t||r!==-1&&e>r||kR.test(n.slice(0,e))?n:""}function ew(n,e){const t=String(n);if(typeof e!="string")throw new TypeError("Expected character");let r=0,a=t.indexOf(e);for(;a!==-1;)r++,a=t.indexOf(e,a+e.length);return r}function NR(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function ER(n,e,t){const a=Gd((t||{}).ignore||[]),s=MR(e);let o=-1;for(;++o<s.length;)wC(n,"text",c);function c(d,p){let g=-1,k;for(;++g<p.length;){const w=p[g],A=k?k.children:void 0;if(a(w,A?A.indexOf(w):void 0,k))return;k=w}if(k)return h(d,p)}function h(d,p){const g=p[p.length-1],k=s[o][0],w=s[o][1];let A=0;const j=g.children.indexOf(d);let D=!1,U=[];k.lastIndex=0;let O=k.exec(d.value);for(;O;){const J=O.index,ee={index:O.index,input:O.input,stack:[...p,d]};let H=w(...O,ee);if(typeof H=="string"&&(H=H.length>0?{type:"text",value:H}:void 0),H===!1?k.lastIndex=J+1:(A!==J&&U.push({type:"text",value:d.value.slice(A,J)}),Array.isArray(H)?U.push(...H):H&&U.push(H),A=J+O[0].length,D=!0),!k.global)break;O=k.exec(d.value)}return D?(A<d.value.length&&U.push({type:"text",value:d.value.slice(A)}),g.children.splice(j,1,...U)):U=[d],j+U.length}}function MR(n){const e=[];if(!Array.isArray(n))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!n[0]||Array.isArray(n[0])?n:[n];let r=-1;for(;++r<t.length;){const a=t[r];e.push([jR(a[0]),_R(a[1])])}return e}function jR(n){return typeof n=="string"?new RegExp(NR(n),"g"):n}function _R(n){return typeof n=="function"?n:function(){return n}}const Tg="phrasing",Ng=["autolink","link","image","label"];function DR(){return{transforms:[PR],enter:{literalAutolink:RR,literalAutolinkEmail:Eg,literalAutolinkHttp:Eg,literalAutolinkWww:Eg},exit:{literalAutolink:IR,literalAutolinkEmail:zR,literalAutolinkHttp:LR,literalAutolinkWww:BR}}}function OR(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Tg,notInConstruct:Ng},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Tg,notInConstruct:Ng},{character:":",before:"[ps]",after:"\\/",inConstruct:Tg,notInConstruct:Ng}]}}function RR(n){this.enter({type:"link",title:null,url:"",children:[]},n)}function Eg(n){this.config.enter.autolinkProtocol.call(this,n)}function LR(n){this.config.exit.autolinkProtocol.call(this,n)}function BR(n){this.config.exit.data.call(this,n);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(n)}function zR(n){this.config.exit.autolinkEmail.call(this,n)}function IR(n){this.exit(n)}function PR(n){ER(n,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,HR],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,qR]],{ignore:["link","linkReference"]})}function HR(n,e,t,r,a){let s="";if(!CC(a)||(/^w/i.test(e)&&(t=e+t,e="",s="http://"),!UR(t)))return!1;const o=VR(t+r);if(!o[0])return!1;const c={type:"link",title:null,url:s+e+o[0],children:[{type:"text",value:e+o[0]}]};return o[1]?[c,{type:"text",value:o[1]}]:c}function qR(n,e,t,r){return!CC(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+t,children:[{type:"text",value:e+"@"+t}]}}function UR(n){const e=n.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function VR(n){const e=/[!"&'),.:;<>?\]}]+$/.exec(n);if(!e)return[n,void 0];n=n.slice(0,e.index);let t=e[0],r=t.indexOf(")");const a=ew(n,"(");let s=ew(n,")");for(;r!==-1&&a>s;)n+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),s++;return[n,t]}function CC(n,e){const t=n.input.charCodeAt(n.index-1);return(n.index===0||Es(t)||Vd(t))&&(!e||t!==47)}AC.peek=ZR;function FR(){this.buffer()}function KR(n){this.enter({type:"footnoteReference",identifier:"",label:""},n)}function GR(){this.buffer()}function YR(n){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},n)}function $R(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Ai(this.sliceSerialize(n)).toLowerCase(),t.label=e}function QR(n){this.exit(n)}function XR(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=Ai(this.sliceSerialize(n)).toLowerCase(),t.label=e}function WR(n){this.exit(n)}function ZR(){return"["}function AC(n,e,t,r){const a=t.createTracker(r);let s=a.move("[^");const o=t.enter("footnoteReference"),c=t.enter("reference");return s+=a.move(t.safe(t.associationId(n),{after:"]",before:s})),c(),o(),s+=a.move("]"),s}function JR(){return{enter:{gfmFootnoteCallString:FR,gfmFootnoteCall:KR,gfmFootnoteDefinitionLabelString:GR,gfmFootnoteDefinition:YR},exit:{gfmFootnoteCallString:$R,gfmFootnoteCall:QR,gfmFootnoteDefinitionLabelString:XR,gfmFootnoteDefinition:WR}}}function e8(n){let e=!1;return n&&n.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:t,footnoteReference:AC},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,a,s,o){const c=s.createTracker(o);let h=c.move("[^");const d=s.enter("footnoteDefinition"),p=s.enter("label");return h+=c.move(s.safe(s.associationId(r),{before:h,after:"]"})),p(),h+=c.move("]:"),r.children&&r.children.length>0&&(c.shift(4),h+=c.move((e?`
`:" ")+s.indentLines(s.containerFlow(r,c.current()),e?TC:t8))),d(),h}}function t8(n,e,t){return e===0?n:TC(n,e,t)}function TC(n,e,t){return(t?"":"    ")+n}const n8=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];NC.peek=s8;function r8(){return{canContainEols:["delete"],enter:{strikethrough:a8},exit:{strikethrough:l8}}}function i8(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:n8}],handlers:{delete:NC}}}function a8(n){this.enter({type:"delete",children:[]},n)}function l8(n){this.exit(n)}function NC(n,e,t,r){const a=t.createTracker(r),s=t.enter("strikethrough");let o=a.move("~~");return o+=t.containerPhrasing(n,{...a.current(),before:o,after:"~"}),o+=a.move("~~"),s(),o}function s8(){return"~"}function o8(n){return n.length}function u8(n,e){const t=e||{},r=(t.align||[]).concat(),a=t.stringLength||o8,s=[],o=[],c=[],h=[];let d=0,p=-1;for(;++p<n.length;){const E=[],j=[];let D=-1;for(n[p].length>d&&(d=n[p].length);++D<n[p].length;){const U=c8(n[p][D]);if(t.alignDelimiters!==!1){const O=a(U);j[D]=O,(h[D]===void 0||O>h[D])&&(h[D]=O)}E.push(U)}o[p]=E,c[p]=j}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<d;)s[g]=tw(r[g]);else{const E=tw(r);for(;++g<d;)s[g]=E}g=-1;const k=[],w=[];for(;++g<d;){const E=s[g];let j="",D="";E===99?(j=":",D=":"):E===108?j=":":E===114&&(D=":");let U=t.alignDelimiters===!1?1:Math.max(1,h[g]-j.length-D.length);const O=j+"-".repeat(U)+D;t.alignDelimiters!==!1&&(U=j.length+U+D.length,U>h[g]&&(h[g]=U),w[g]=U),k[g]=O}o.splice(1,0,k),c.splice(1,0,w),p=-1;const A=[];for(;++p<o.length;){const E=o[p],j=c[p];g=-1;const D=[];for(;++g<d;){const U=E[g]||"";let O="",J="";if(t.alignDelimiters!==!1){const ee=h[g]-(j[g]||0),H=s[g];H===114?O=" ".repeat(ee):H===99?ee%2?(O=" ".repeat(ee/2+.5),J=" ".repeat(ee/2-.5)):(O=" ".repeat(ee/2),J=O):J=" ".repeat(ee)}t.delimiterStart!==!1&&!g&&D.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&U==="")&&(t.delimiterStart!==!1||g)&&D.push(" "),t.alignDelimiters!==!1&&D.push(O),D.push(U),t.alignDelimiters!==!1&&D.push(J),t.padding!==!1&&D.push(" "),(t.delimiterEnd!==!1||g!==d-1)&&D.push("|")}A.push(t.delimiterEnd===!1?D.join("").replace(/ +$/,""):D.join(""))}return A.join(`
`)}function c8(n){return n==null?"":String(n)}function tw(n){const e=typeof n=="string"?n.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function h8(n,e,t,r){const a=t.enter("blockquote"),s=t.createTracker(r);s.move("> "),s.shift(2);const o=t.indentLines(t.containerFlow(n,s.current()),f8);return a(),o}function f8(n,e,t){return">"+(t?"":" ")+n}function d8(n,e){return nw(n,e.inConstruct,!0)&&!nw(n,e.notInConstruct,!1)}function nw(n,e,t){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return t;let r=-1;for(;++r<e.length;)if(n.includes(e[r]))return!0;return!1}function rw(n,e,t,r){let a=-1;for(;++a<t.unsafe.length;)if(t.unsafe[a].character===`
`&&d8(t.stack,t.unsafe[a]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function p8(n,e){const t=String(n);let r=t.indexOf(e),a=r,s=0,o=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===a?++s>o&&(o=s):s=1,a=r+e.length,r=t.indexOf(e,a);return o}function m8(n,e){return!!(e.options.fences===!1&&n.value&&!n.lang&&/[^ \r\n]/.test(n.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(n.value))}function g8(n){const e=n.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function y8(n,e,t,r){const a=g8(t),s=n.value||"",o=a==="`"?"GraveAccent":"Tilde";if(m8(n,t)){const g=t.enter("codeIndented"),k=t.indentLines(s,x8);return g(),k}const c=t.createTracker(r),h=a.repeat(Math.max(p8(s,a)+1,3)),d=t.enter("codeFenced");let p=c.move(h);if(n.lang){const g=t.enter(`codeFencedLang${o}`);p+=c.move(t.safe(n.lang,{before:p,after:" ",encode:["`"],...c.current()})),g()}if(n.lang&&n.meta){const g=t.enter(`codeFencedMeta${o}`);p+=c.move(" "),p+=c.move(t.safe(n.meta,{before:p,after:`
`,encode:["`"],...c.current()})),g()}return p+=c.move(`
`),s&&(p+=c.move(s+`
`)),p+=c.move(h),d(),p}function x8(n,e,t){return(t?"":"    ")+n}function zy(n){const e=n.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function v8(n,e,t,r){const a=zy(t),s=a==='"'?"Quote":"Apostrophe",o=t.enter("definition");let c=t.enter("label");const h=t.createTracker(r);let d=h.move("[");return d+=h.move(t.safe(t.associationId(n),{before:d,after:"]",...h.current()})),d+=h.move("]: "),c(),!n.url||/[\0- \u007F]/.test(n.url)?(c=t.enter("destinationLiteral"),d+=h.move("<"),d+=h.move(t.safe(n.url,{before:d,after:">",...h.current()})),d+=h.move(">")):(c=t.enter("destinationRaw"),d+=h.move(t.safe(n.url,{before:d,after:n.title?" ":`
`,...h.current()}))),c(),n.title&&(c=t.enter(`title${s}`),d+=h.move(" "+a),d+=h.move(t.safe(n.title,{before:d,after:a,...h.current()})),d+=h.move(a),c()),o(),d}function b8(n){const e=n.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function Kc(n){return"&#x"+n.toString(16).toUpperCase()+";"}function Nd(n,e,t){const r=Xo(n),a=Xo(e);return r===void 0?a===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}EC.peek=k8;function EC(n,e,t,r){const a=b8(t),s=t.enter("emphasis"),o=t.createTracker(r),c=o.move(a);let h=o.move(t.containerPhrasing(n,{after:a,before:c,...o.current()}));const d=h.charCodeAt(0),p=Nd(r.before.charCodeAt(r.before.length-1),d,a);p.inside&&(h=Kc(d)+h.slice(1));const g=h.charCodeAt(h.length-1),k=Nd(r.after.charCodeAt(0),g,a);k.inside&&(h=h.slice(0,-1)+Kc(g));const w=o.move(a);return s(),t.attentionEncodeSurroundingInfo={after:k.outside,before:p.outside},c+h+w}function k8(n,e,t){return t.options.emphasis||"*"}function w8(n,e){let t=!1;return Ly(n,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,R0}),!!((!n.depth||n.depth<3)&&Ey(n)&&(e.options.setext||t))}function S8(n,e,t,r){const a=Math.max(Math.min(6,n.depth||1),1),s=t.createTracker(r);if(w8(n,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),k=t.containerPhrasing(n,{...s.current(),before:`
`,after:`
`});return g(),p(),k+`
`+(a===1?"=":"-").repeat(k.length-(Math.max(k.lastIndexOf("\r"),k.lastIndexOf(`
`))+1))}const o="#".repeat(a),c=t.enter("headingAtx"),h=t.enter("phrasing");s.move(o+" ");let d=t.containerPhrasing(n,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(d)&&(d=Kc(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,t.options.closeAtx&&(d+=" "+o),h(),c(),d}MC.peek=C8;function MC(n){return n.value||""}function C8(){return"<"}jC.peek=A8;function jC(n,e,t,r){const a=zy(t),s=a==='"'?"Quote":"Apostrophe",o=t.enter("image");let c=t.enter("label");const h=t.createTracker(r);let d=h.move("![");return d+=h.move(t.safe(n.alt,{before:d,after:"]",...h.current()})),d+=h.move("]("),c(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(c=t.enter("destinationLiteral"),d+=h.move("<"),d+=h.move(t.safe(n.url,{before:d,after:">",...h.current()})),d+=h.move(">")):(c=t.enter("destinationRaw"),d+=h.move(t.safe(n.url,{before:d,after:n.title?" ":")",...h.current()}))),c(),n.title&&(c=t.enter(`title${s}`),d+=h.move(" "+a),d+=h.move(t.safe(n.title,{before:d,after:a,...h.current()})),d+=h.move(a),c()),d+=h.move(")"),o(),d}function A8(){return"!"}_C.peek=T8;function _C(n,e,t,r){const a=n.referenceType,s=t.enter("imageReference");let o=t.enter("label");const c=t.createTracker(r);let h=c.move("![");const d=t.safe(n.alt,{before:h,after:"]",...c.current()});h+=c.move(d+"]["),o();const p=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(n),{before:h,after:"]",...c.current()});return o(),t.stack=p,s(),a==="full"||!d||d!==g?h+=c.move(g+"]"):a==="shortcut"?h=h.slice(0,-1):h+=c.move("]"),h}function T8(){return"!"}DC.peek=N8;function DC(n,e,t){let r=n.value||"",a="`",s=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(r);)a+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++s<t.unsafe.length;){const o=t.unsafe[s],c=t.compilePattern(o);let h;if(o.atBreak)for(;h=c.exec(r);){let d=h.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(h.index+1)}}return a+r+a}function N8(){return"`"}function OC(n,e){const t=Ey(n);return!!(!e.options.resourceLink&&n.url&&!n.title&&n.children&&n.children.length===1&&n.children[0].type==="text"&&(t===n.url||"mailto:"+t===n.url)&&/^[a-z][a-z+.-]+:/i.test(n.url)&&!/[\0- <>\u007F]/.test(n.url))}RC.peek=E8;function RC(n,e,t,r){const a=zy(t),s=a==='"'?"Quote":"Apostrophe",o=t.createTracker(r);let c,h;if(OC(n,t)){const p=t.stack;t.stack=[],c=t.enter("autolink");let g=o.move("<");return g+=o.move(t.containerPhrasing(n,{before:g,after:">",...o.current()})),g+=o.move(">"),c(),t.stack=p,g}c=t.enter("link"),h=t.enter("label");let d=o.move("[");return d+=o.move(t.containerPhrasing(n,{before:d,after:"](",...o.current()})),d+=o.move("]("),h(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(h=t.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(t.safe(n.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(h=t.enter("destinationRaw"),d+=o.move(t.safe(n.url,{before:d,after:n.title?" ":")",...o.current()}))),h(),n.title&&(h=t.enter(`title${s}`),d+=o.move(" "+a),d+=o.move(t.safe(n.title,{before:d,after:a,...o.current()})),d+=o.move(a),h()),d+=o.move(")"),c(),d}function E8(n,e,t){return OC(n,t)?"<":"["}LC.peek=M8;function LC(n,e,t,r){const a=n.referenceType,s=t.enter("linkReference");let o=t.enter("label");const c=t.createTracker(r);let h=c.move("[");const d=t.containerPhrasing(n,{before:h,after:"]",...c.current()});h+=c.move(d+"]["),o();const p=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(n),{before:h,after:"]",...c.current()});return o(),t.stack=p,s(),a==="full"||!d||d!==g?h+=c.move(g+"]"):a==="shortcut"?h=h.slice(0,-1):h+=c.move("]"),h}function M8(){return"["}function Iy(n){const e=n.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function j8(n){const e=Iy(n),t=n.options.bulletOther;if(!t)return e==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+t+"`) to be different");return t}function _8(n){const e=n.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function BC(n){const e=n.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function D8(n,e,t,r){const a=t.enter("list"),s=t.bulletCurrent;let o=n.ordered?_8(t):Iy(t);const c=n.ordered?o==="."?")":".":j8(t);let h=e&&t.bulletLastUsed?o===t.bulletLastUsed:!1;if(!n.ordered){const p=n.children?n.children[0]:void 0;if((o==="*"||o==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(h=!0),BC(t)===o&&p){let g=-1;for(;++g<n.children.length;){const k=n.children[g];if(k&&k.type==="listItem"&&k.children&&k.children[0]&&k.children[0].type==="thematicBreak"){h=!0;break}}}}h&&(o=c),t.bulletCurrent=o;const d=t.containerFlow(n,r);return t.bulletLastUsed=o,t.bulletCurrent=s,a(),d}function O8(n){const e=n.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function R8(n,e,t,r){const a=O8(t);let s=t.bulletCurrent||Iy(t);e&&e.type==="list"&&e.ordered&&(s=(typeof e.start=="number"&&e.start>-1?e.start:1)+(t.options.incrementListMarker===!1?0:e.children.indexOf(n))+s);let o=s.length+1;(a==="tab"||a==="mixed"&&(e&&e.type==="list"&&e.spread||n.spread))&&(o=Math.ceil(o/4)*4);const c=t.createTracker(r);c.move(s+" ".repeat(o-s.length)),c.shift(o);const h=t.enter("listItem"),d=t.indentLines(t.containerFlow(n,c.current()),p);return h(),d;function p(g,k,w){return k?(w?"":" ".repeat(o))+g:(w?s:s+" ".repeat(o-s.length))+g}}function L8(n,e,t,r){const a=t.enter("paragraph"),s=t.enter("phrasing"),o=t.containerPhrasing(n,r);return s(),a(),o}const B8=Gd(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function z8(n,e,t,r){return(n.children.some(function(o){return B8(o)})?t.containerPhrasing:t.containerFlow).call(t,n,r)}function I8(n){const e=n.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}zC.peek=P8;function zC(n,e,t,r){const a=I8(t),s=t.enter("strong"),o=t.createTracker(r),c=o.move(a+a);let h=o.move(t.containerPhrasing(n,{after:a,before:c,...o.current()}));const d=h.charCodeAt(0),p=Nd(r.before.charCodeAt(r.before.length-1),d,a);p.inside&&(h=Kc(d)+h.slice(1));const g=h.charCodeAt(h.length-1),k=Nd(r.after.charCodeAt(0),g,a);k.inside&&(h=h.slice(0,-1)+Kc(g));const w=o.move(a+a);return s(),t.attentionEncodeSurroundingInfo={after:k.outside,before:p.outside},c+h+w}function P8(n,e,t){return t.options.strong||"*"}function H8(n,e,t,r){return t.safe(n.value,r)}function q8(n){const e=n.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function U8(n,e,t){const r=(BC(t)+(t.options.ruleSpaces?" ":"")).repeat(q8(t));return t.options.ruleSpaces?r.slice(0,-1):r}const IC={blockquote:h8,break:rw,code:y8,definition:v8,emphasis:EC,hardBreak:rw,heading:S8,html:MC,image:jC,imageReference:_C,inlineCode:DC,link:RC,linkReference:LC,list:D8,listItem:R8,paragraph:L8,root:z8,strong:zC,text:H8,thematicBreak:U8};function V8(){return{enter:{table:F8,tableData:iw,tableHeader:iw,tableRow:G8},exit:{codeText:Y8,table:K8,tableData:Mg,tableHeader:Mg,tableRow:Mg}}}function F8(n){const e=n._align;this.enter({type:"table",align:e.map(function(t){return t==="none"?null:t}),children:[]},n),this.data.inTable=!0}function K8(n){this.exit(n),this.data.inTable=void 0}function G8(n){this.enter({type:"tableRow",children:[]},n)}function Mg(n){this.exit(n)}function iw(n){this.enter({type:"tableCell",children:[]},n)}function Y8(n){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,$8));const t=this.stack[this.stack.length-1];t.type,t.value=e,this.exit(n)}function $8(n,e){return e==="|"?e:n}function Q8(n){const e=n||{},t=e.tableCellPadding,r=e.tablePipeAlign,a=e.stringLength,s=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:k,table:o,tableCell:h,tableRow:c}};function o(w,A,E,j){return d(p(w,E,j),w.align)}function c(w,A,E,j){const D=g(w,E,j),U=d([D]);return U.slice(0,U.indexOf(`
`))}function h(w,A,E,j){const D=E.enter("tableCell"),U=E.enter("phrasing"),O=E.containerPhrasing(w,{...j,before:s,after:s});return U(),D(),O}function d(w,A){return u8(w,{align:A,alignDelimiters:r,padding:t,stringLength:a})}function p(w,A,E){const j=w.children;let D=-1;const U=[],O=A.enter("table");for(;++D<j.length;)U[D]=g(j[D],A,E);return O(),U}function g(w,A,E){const j=w.children;let D=-1;const U=[],O=A.enter("tableRow");for(;++D<j.length;)U[D]=h(j[D],w,A,E);return O(),U}function k(w,A,E){let j=IC.inlineCode(w,A,E);return E.stack.includes("tableCell")&&(j=j.replace(/\|/g,"\\$&")),j}}function X8(){return{exit:{taskListCheckValueChecked:aw,taskListCheckValueUnchecked:aw,paragraph:Z8}}}function W8(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:J8}}}function aw(n){const e=this.stack[this.stack.length-2];e.type,e.checked=n.type==="taskListCheckValueChecked"}function Z8(n){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const a=e.children;let s=-1,o;for(;++s<a.length;){const c=a[s];if(c.type==="paragraph"){o=c;break}}o===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(n)}function J8(n,e,t,r){const a=n.children[0],s=typeof n.checked=="boolean"&&a&&a.type==="paragraph",o="["+(n.checked?"x":" ")+"] ",c=t.createTracker(r);s&&c.move(o);let h=IC.listItem(n,e,t,{...r,...c.current()});return s&&(h=h.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),h;function d(p){return p+o}}function eL(){return[DR(),JR(),r8(),V8(),X8()]}function tL(n){return{extensions:[OR(),e8(n),i8(),Q8(n),W8()]}}const nL={tokenize:oL,partial:!0},PC={tokenize:uL,partial:!0},HC={tokenize:cL,partial:!0},qC={tokenize:hL,partial:!0},rL={tokenize:fL,partial:!0},UC={name:"wwwAutolink",tokenize:lL,previous:FC},VC={name:"protocolAutolink",tokenize:sL,previous:KC},Pa={name:"emailAutolink",tokenize:aL,previous:GC},ra={};function iL(){return{text:ra}}let ys=48;for(;ys<123;)ra[ys]=Pa,ys++,ys===58?ys=65:ys===91&&(ys=97);ra[43]=Pa;ra[45]=Pa;ra[46]=Pa;ra[95]=Pa;ra[72]=[Pa,VC];ra[104]=[Pa,VC];ra[87]=[Pa,UC];ra[119]=[Pa,UC];function aL(n,e,t){const r=this;let a,s;return o;function o(g){return!P0(g)||!GC.call(r,r.previous)||Py(r.events)?t(g):(n.enter("literalAutolink"),n.enter("literalAutolinkEmail"),c(g))}function c(g){return P0(g)?(n.consume(g),c):g===64?(n.consume(g),h):t(g)}function h(g){return g===46?n.check(rL,p,d)(g):g===45||g===95||dr(g)?(s=!0,n.consume(g),h):p(g)}function d(g){return n.consume(g),a=!0,h}function p(g){return s&&a&&br(r.previous)?(n.exit("literalAutolinkEmail"),n.exit("literalAutolink"),e(g)):t(g)}}function lL(n,e,t){const r=this;return a;function a(o){return o!==87&&o!==119||!FC.call(r,r.previous)||Py(r.events)?t(o):(n.enter("literalAutolink"),n.enter("literalAutolinkWww"),n.check(nL,n.attempt(PC,n.attempt(HC,s),t),t)(o))}function s(o){return n.exit("literalAutolinkWww"),n.exit("literalAutolink"),e(o)}}function sL(n,e,t){const r=this;let a="",s=!1;return o;function o(g){return(g===72||g===104)&&KC.call(r,r.previous)&&!Py(r.events)?(n.enter("literalAutolink"),n.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),n.consume(g),c):t(g)}function c(g){if(br(g)&&a.length<5)return a+=String.fromCodePoint(g),n.consume(g),c;if(g===58){const k=a.toLowerCase();if(k==="http"||k==="https")return n.consume(g),h}return t(g)}function h(g){return g===47?(n.consume(g),s?d:(s=!0,h)):t(g)}function d(g){return g===null||Cd(g)||rn(g)||Es(g)||Vd(g)?t(g):n.attempt(PC,n.attempt(HC,p),t)(g)}function p(g){return n.exit("literalAutolinkHttp"),n.exit("literalAutolink"),e(g)}}function oL(n,e,t){let r=0;return a;function a(o){return(o===87||o===119)&&r<3?(r++,n.consume(o),a):o===46&&r===3?(n.consume(o),s):t(o)}function s(o){return o===null?t(o):e(o)}}function uL(n,e,t){let r,a,s;return o;function o(d){return d===46||d===95?n.check(qC,h,c)(d):d===null||rn(d)||Es(d)||d!==45&&Vd(d)?h(d):(s=!0,n.consume(d),o)}function c(d){return d===95?r=!0:(a=r,r=void 0),n.consume(d),o}function h(d){return a||r||!s?t(d):e(d)}}function cL(n,e){let t=0,r=0;return a;function a(o){return o===40?(t++,n.consume(o),a):o===41&&r<t?s(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?n.check(qC,e,s)(o):o===null||rn(o)||Es(o)?e(o):(n.consume(o),a)}function s(o){return o===41&&r++,n.consume(o),a}}function hL(n,e,t){return r;function r(c){return c===33||c===34||c===39||c===41||c===42||c===44||c===46||c===58||c===59||c===63||c===95||c===126?(n.consume(c),r):c===38?(n.consume(c),s):c===93?(n.consume(c),a):c===60||c===null||rn(c)||Es(c)?e(c):t(c)}function a(c){return c===null||c===40||c===91||rn(c)||Es(c)?e(c):r(c)}function s(c){return br(c)?o(c):t(c)}function o(c){return c===59?(n.consume(c),r):br(c)?(n.consume(c),o):t(c)}}function fL(n,e,t){return r;function r(s){return n.consume(s),a}function a(s){return dr(s)?t(s):e(s)}}function FC(n){return n===null||n===40||n===42||n===95||n===91||n===93||n===126||rn(n)}function KC(n){return!br(n)}function GC(n){return!(n===47||P0(n))}function P0(n){return n===43||n===45||n===46||n===95||dr(n)}function Py(n){let e=n.length,t=!1;for(;e--;){const r=n[e][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return n.length>0&&!t&&(n[n.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const dL={tokenize:kL,partial:!0};function pL(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:xL,continuation:{tokenize:vL},exit:bL}},text:{91:{name:"gfmFootnoteCall",tokenize:yL},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:mL,resolveTo:gL}}}}function mL(n,e,t){const r=this;let a=r.events.length;const s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;a--;){const h=r.events[a][1];if(h.type==="labelImage"){o=h;break}if(h.type==="gfmFootnoteCall"||h.type==="labelLink"||h.type==="label"||h.type==="image"||h.type==="link")break}return c;function c(h){if(!o||!o._balanced)return t(h);const d=Ai(r.sliceSerialize({start:o.end,end:r.now()}));return d.codePointAt(0)!==94||!s.includes(d.slice(1))?t(h):(n.enter("gfmFootnoteCallLabelMarker"),n.consume(h),n.exit("gfmFootnoteCallLabelMarker"),e(h))}}function gL(n,e){let t=n.length;for(;t--;)if(n[t][1].type==="labelImage"&&n[t][0]==="enter"){n[t][1];break}n[t+1][1].type="data",n[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},n[t+3][1].start),end:Object.assign({},n[n.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},n[t+3][1].end),end:Object.assign({},n[t+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},n[n.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},c=[n[t+1],n[t+2],["enter",r,e],n[t+3],n[t+4],["enter",a,e],["exit",a,e],["enter",s,e],["enter",o,e],["exit",o,e],["exit",s,e],n[n.length-2],n[n.length-1],["exit",r,e]];return n.splice(t,n.length-t+1,...c),n}function yL(n,e,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s=0,o;return c;function c(g){return n.enter("gfmFootnoteCall"),n.enter("gfmFootnoteCallLabelMarker"),n.consume(g),n.exit("gfmFootnoteCallLabelMarker"),h}function h(g){return g!==94?t(g):(n.enter("gfmFootnoteCallMarker"),n.consume(g),n.exit("gfmFootnoteCallMarker"),n.enter("gfmFootnoteCallString"),n.enter("chunkString").contentType="string",d)}function d(g){if(s>999||g===93&&!o||g===null||g===91||rn(g))return t(g);if(g===93){n.exit("chunkString");const k=n.exit("gfmFootnoteCallString");return a.includes(Ai(r.sliceSerialize(k)))?(n.enter("gfmFootnoteCallLabelMarker"),n.consume(g),n.exit("gfmFootnoteCallLabelMarker"),n.exit("gfmFootnoteCall"),e):t(g)}return rn(g)||(o=!0),s++,n.consume(g),g===92?p:d}function p(g){return g===91||g===92||g===93?(n.consume(g),s++,d):d(g)}}function xL(n,e,t){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s,o=0,c;return h;function h(A){return n.enter("gfmFootnoteDefinition")._container=!0,n.enter("gfmFootnoteDefinitionLabel"),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(A),n.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(A){return A===94?(n.enter("gfmFootnoteDefinitionMarker"),n.consume(A),n.exit("gfmFootnoteDefinitionMarker"),n.enter("gfmFootnoteDefinitionLabelString"),n.enter("chunkString").contentType="string",p):t(A)}function p(A){if(o>999||A===93&&!c||A===null||A===91||rn(A))return t(A);if(A===93){n.exit("chunkString");const E=n.exit("gfmFootnoteDefinitionLabelString");return s=Ai(r.sliceSerialize(E)),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(A),n.exit("gfmFootnoteDefinitionLabelMarker"),n.exit("gfmFootnoteDefinitionLabel"),k}return rn(A)||(c=!0),o++,n.consume(A),A===92?g:p}function g(A){return A===91||A===92||A===93?(n.consume(A),o++,p):p(A)}function k(A){return A===58?(n.enter("definitionMarker"),n.consume(A),n.exit("definitionMarker"),a.includes(s)||a.push(s),_t(n,w,"gfmFootnoteDefinitionWhitespace")):t(A)}function w(A){return e(A)}}function vL(n,e,t){return n.check(th,e,n.attempt(dL,e,t))}function bL(n){n.exit("gfmFootnoteDefinition")}function kL(n,e,t){const r=this;return _t(n,a,"gfmFootnoteDefinitionIndent",5);function a(s){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?e(s):t(s)}}function wL(n){let t=(n||{}).singleTilde;const r={name:"strikethrough",tokenize:s,resolveAll:a};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(o,c){let h=-1;for(;++h<o.length;)if(o[h][0]==="enter"&&o[h][1].type==="strikethroughSequenceTemporary"&&o[h][1]._close){let d=h;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[h][1].end.offset-o[h][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[h][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const p={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[h][1].end)},g={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[h][1].start)},k=[["enter",p,c],["enter",o[d][1],c],["exit",o[d][1],c],["enter",g,c]],w=c.parser.constructs.insideSpan.null;w&&Gr(k,k.length,0,Fd(w,o.slice(d+1,h),c)),Gr(k,k.length,0,[["exit",g,c],["enter",o[h][1],c],["exit",o[h][1],c],["exit",p,c]]),Gr(o,d-1,h-d+3,k),h=d+k.length-2;break}}for(h=-1;++h<o.length;)o[h][1].type==="strikethroughSequenceTemporary"&&(o[h][1].type="data");return o}function s(o,c,h){const d=this.previous,p=this.events;let g=0;return k;function k(A){return d===126&&p[p.length-1][1].type!=="characterEscape"?h(A):(o.enter("strikethroughSequenceTemporary"),w(A))}function w(A){const E=Xo(d);if(A===126)return g>1?h(A):(o.consume(A),g++,w);if(g<2&&!t)return h(A);const j=o.exit("strikethroughSequenceTemporary"),D=Xo(A);return j._open=!D||D===2&&!!E,j._close=!E||E===2&&!!D,c(A)}}}class SL{constructor(){this.map=[]}add(e,t,r){CL(this,e,t,r)}consume(e){if(this.map.sort(function(s,o){return s[0]-o[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(e.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),e.length=this.map[t][0];r.push(e.slice()),e.length=0;let a=r.pop();for(;a;){for(const s of a)e.push(s);a=r.pop()}this.map.length=0}}function CL(n,e,t,r){let a=0;if(!(t===0&&r.length===0)){for(;a<n.map.length;){if(n.map[a][0]===e){n.map[a][1]+=t,n.map[a][2].push(...r);return}a+=1}n.map.push([e,t,r])}}function AL(n,e){let t=!1;const r=[];for(;e<n.length;){const a=n[e];if(t){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(n[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(n[e-1][1].type==="tableDelimiterMarker"){const s=r.length-1;r[s]=r[s]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(t=!0);e+=1}return r}function TL(){return{flow:{null:{name:"table",tokenize:NL,resolveAll:EL}}}}function NL(n,e,t){const r=this;let a=0,s=0,o;return c;function c(I){let te=r.events.length-1;for(;te>-1;){const ge=r.events[te][1].type;if(ge==="lineEnding"||ge==="linePrefix")te--;else break}const ne=te>-1?r.events[te][1].type:null,pe=ne==="tableHead"||ne==="tableRow"?H:h;return pe===H&&r.parser.lazy[r.now().line]?t(I):pe(I)}function h(I){return n.enter("tableHead"),n.enter("tableRow"),d(I)}function d(I){return I===124||(o=!0,s+=1),p(I)}function p(I){return I===null?t(I):ut(I)?s>1?(s=0,r.interrupt=!0,n.exit("tableRow"),n.enter("lineEnding"),n.consume(I),n.exit("lineEnding"),w):t(I):At(I)?_t(n,p,"whitespace")(I):(s+=1,o&&(o=!1,a+=1),I===124?(n.enter("tableCellDivider"),n.consume(I),n.exit("tableCellDivider"),o=!0,p):(n.enter("data"),g(I)))}function g(I){return I===null||I===124||rn(I)?(n.exit("data"),p(I)):(n.consume(I),I===92?k:g)}function k(I){return I===92||I===124?(n.consume(I),g):g(I)}function w(I){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(I):(n.enter("tableDelimiterRow"),o=!1,At(I)?_t(n,A,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(I):A(I))}function A(I){return I===45||I===58?j(I):I===124?(o=!0,n.enter("tableCellDivider"),n.consume(I),n.exit("tableCellDivider"),E):ee(I)}function E(I){return At(I)?_t(n,j,"whitespace")(I):j(I)}function j(I){return I===58?(s+=1,o=!0,n.enter("tableDelimiterMarker"),n.consume(I),n.exit("tableDelimiterMarker"),D):I===45?(s+=1,D(I)):I===null||ut(I)?J(I):ee(I)}function D(I){return I===45?(n.enter("tableDelimiterFiller"),U(I)):ee(I)}function U(I){return I===45?(n.consume(I),U):I===58?(o=!0,n.exit("tableDelimiterFiller"),n.enter("tableDelimiterMarker"),n.consume(I),n.exit("tableDelimiterMarker"),O):(n.exit("tableDelimiterFiller"),O(I))}function O(I){return At(I)?_t(n,J,"whitespace")(I):J(I)}function J(I){return I===124?A(I):I===null||ut(I)?!o||a!==s?ee(I):(n.exit("tableDelimiterRow"),n.exit("tableHead"),e(I)):ee(I)}function ee(I){return t(I)}function H(I){return n.enter("tableRow"),L(I)}function L(I){return I===124?(n.enter("tableCellDivider"),n.consume(I),n.exit("tableCellDivider"),L):I===null||ut(I)?(n.exit("tableRow"),e(I)):At(I)?_t(n,L,"whitespace")(I):(n.enter("data"),me(I))}function me(I){return I===null||I===124||rn(I)?(n.exit("data"),L(I)):(n.consume(I),I===92?he:me)}function he(I){return I===92||I===124?(n.consume(I),me):me(I)}}function EL(n,e){let t=-1,r=!0,a=0,s=[0,0,0,0],o=[0,0,0,0],c=!1,h=0,d,p,g;const k=new SL;for(;++t<n.length;){const w=n[t],A=w[1];w[0]==="enter"?A.type==="tableHead"?(c=!1,h!==0&&(lw(k,e,h,d,p),p=void 0,h=0),d={type:"table",start:Object.assign({},A.start),end:Object.assign({},A.end)},k.add(t,0,[["enter",d,e]])):A.type==="tableRow"||A.type==="tableDelimiterRow"?(r=!0,g=void 0,s=[0,0,0,0],o=[0,t+1,0,0],c&&(c=!1,p={type:"tableBody",start:Object.assign({},A.start),end:Object.assign({},A.end)},k.add(t,0,[["enter",p,e]])),a=A.type==="tableDelimiterRow"?2:p?3:1):a&&(A.type==="data"||A.type==="tableDelimiterMarker"||A.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(s[1]!==0&&(o[0]=o[1],g=Hf(k,e,s,a,void 0,g),s=[0,0,0,0]),o[2]=t)):A.type==="tableCellDivider"&&(r?r=!1:(s[1]!==0&&(o[0]=o[1],g=Hf(k,e,s,a,void 0,g)),s=o,o=[s[1],t,0,0])):A.type==="tableHead"?(c=!0,h=t):A.type==="tableRow"||A.type==="tableDelimiterRow"?(h=t,s[1]!==0?(o[0]=o[1],g=Hf(k,e,s,a,t,g)):o[1]!==0&&(g=Hf(k,e,o,a,t,g)),a=0):a&&(A.type==="data"||A.type==="tableDelimiterMarker"||A.type==="tableDelimiterFiller")&&(o[3]=t)}for(h!==0&&lw(k,e,h,d,p),k.consume(e.events),t=-1;++t<e.events.length;){const w=e.events[t];w[0]==="enter"&&w[1].type==="table"&&(w[1]._align=AL(e.events,t))}return n}function Hf(n,e,t,r,a,s){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",c="tableContent";t[0]!==0&&(s.end=Object.assign({},No(e.events,t[0])),n.add(t[0],0,[["exit",s,e]]));const h=No(e.events,t[1]);if(s={type:o,start:Object.assign({},h),end:Object.assign({},h)},n.add(t[1],0,[["enter",s,e]]),t[2]!==0){const d=No(e.events,t[2]),p=No(e.events,t[3]),g={type:c,start:Object.assign({},d),end:Object.assign({},p)};if(n.add(t[2],0,[["enter",g,e]]),r!==2){const k=e.events[t[2]],w=e.events[t[3]];if(k[1].end=Object.assign({},w[1].end),k[1].type="chunkText",k[1].contentType="text",t[3]>t[2]+1){const A=t[2]+1,E=t[3]-t[2]-1;n.add(A,E,[])}}n.add(t[3]+1,0,[["exit",g,e]])}return a!==void 0&&(s.end=Object.assign({},No(e.events,a)),n.add(a,0,[["exit",s,e]]),s=void 0),s}function lw(n,e,t,r,a){const s=[],o=No(e.events,t);a&&(a.end=Object.assign({},o),s.push(["exit",a,e])),r.end=Object.assign({},o),s.push(["exit",r,e]),n.add(t+1,0,s)}function No(n,e){const t=n[e],r=t[0]==="enter"?"start":"end";return t[1][r]}const ML={name:"tasklistCheck",tokenize:_L};function jL(){return{text:{91:ML}}}function _L(n,e,t){const r=this;return a;function a(h){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(h):(n.enter("taskListCheck"),n.enter("taskListCheckMarker"),n.consume(h),n.exit("taskListCheckMarker"),s)}function s(h){return rn(h)?(n.enter("taskListCheckValueUnchecked"),n.consume(h),n.exit("taskListCheckValueUnchecked"),o):h===88||h===120?(n.enter("taskListCheckValueChecked"),n.consume(h),n.exit("taskListCheckValueChecked"),o):t(h)}function o(h){return h===93?(n.enter("taskListCheckMarker"),n.consume(h),n.exit("taskListCheckMarker"),n.exit("taskListCheck"),c):t(h)}function c(h){return ut(h)?e(h):At(h)?n.check({tokenize:DL},e,t)(h):t(h)}}function DL(n,e,t){return _t(n,r,"whitespace");function r(a){return a===null?t(a):e(a)}}function OL(n){return rC([iL(),pL(),wL(n),TL(),jL()])}const RL={};function H0(n){const e=this,t=n||RL,r=e.data(),a=r.micromarkExtensions||(r.micromarkExtensions=[]),s=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);a.push(OL(t)),s.push(eL()),o.push(tL(t))}const YC={code({className:n,children:e,...t}){const r=!n?.includes("language-");return b.jsx("code",{className:`${n||""} ${r?"bg-vault-100 dark:bg-vault-700 px-1 py-0.5 rounded text-vault-800 dark:text-vault-200":"block bg-vault-900 text-vault-100 p-3 rounded-lg overflow-x-auto"} font-mono text-sm`,...t,children:e})},pre({children:n}){return b.jsx("pre",{className:"bg-vault-900 text-vault-100 p-3 rounded-lg overflow-x-auto my-2",children:n})},a({href:n,children:e,...t}){return b.jsx("a",{href:n,className:"text-vault-600 dark:text-vault-400 hover:underline",target:"_blank",rel:"noopener noreferrer",...t,children:e})},ul({children:n}){return b.jsx("ul",{className:"list-disc pl-5 my-2",children:n})},ol({children:n}){return b.jsx("ol",{className:"list-decimal pl-5 my-2",children:n})},blockquote({children:n}){return b.jsx("blockquote",{className:"border-l-4 border-vault-300 dark:border-vault-600 pl-4 italic my-2 text-vault-600 dark:text-vault-400",children:n})},hr(){return b.jsx("hr",{className:"border-vault-200 dark:border-vault-700 my-4"})},h1({children:n}){return b.jsx("h1",{className:"text-lg font-bold my-3",children:n})},h2({children:n}){return b.jsx("h2",{className:"text-base font-bold my-2",children:n})},h3({children:n}){return b.jsx("h3",{className:"text-sm font-bold my-2",children:n})},p({children:n}){return b.jsx("p",{className:"my-1.5",children:n})},table({children:n}){return b.jsx("div",{className:"overflow-x-auto my-4 rounded-lg border border-vault-200 dark:border-vault-700",children:b.jsx("table",{className:"min-w-full divide-y divide-vault-200 dark:divide-vault-700",children:n})})},thead({children:n}){return b.jsx("thead",{className:"bg-vault-100 dark:bg-vault-800",children:n})},tbody({children:n}){return b.jsx("tbody",{className:"divide-y divide-vault-200 dark:divide-vault-700",children:n})},tr({children:n}){return b.jsx("tr",{children:n})},th({children:n}){return b.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-vault-500 dark:text-vault-400 uppercase tracking-wider bg-vault-50 dark:bg-vault-900/50",children:n})},td({children:n}){return b.jsx("td",{className:"px-3 py-2 text-sm text-vault-700 dark:text-vault-300",children:n})}};function LL({content:n,isStreaming:e,showCursor:t=!1,className:r="",renderMarkdown:a=!1,components:s={}}){const[o,c]=z.useState({previous:"",new:n,key:0}),h=z.useRef(n),d=z.useRef(0);z.useEffect(()=>{const g=h.current;if(n!==g){const k=n.startsWith(g);if(e&&k&&g.length>0){const w=n.slice(g.length);d.current+=1,c({previous:g,new:w,key:d.current})}else c({previous:"",new:n,key:d.current});h.current=n}},[n,e]),z.useEffect(()=>{e&&(h.current="",c({previous:"",new:n,key:d.current}))},[e,n]);const p=t&&e?b.jsx("span",{className:"inline-block w-2 h-4 ml-1 bg-vault-600 animate-pulse"}):null;return a?b.jsxs("div",{className:r,children:[o.previous&&b.jsx(I0,{remarkPlugins:[H0],components:s,children:o.previous}),o.new&&b.jsx("span",{className:"animate-fade-in-fast",children:b.jsx(I0,{remarkPlugins:[H0],components:s,children:o.new})},o.key),p]}):b.jsxs("span",{className:r,children:[o.previous,o.new&&b.jsx("span",{className:"animate-fade-in-fast",children:o.new},o.key),p]})}function BL({content:n,isStreaming:e,showCursor:t=!1,className:r=""}){return b.jsx(LL,{content:n,isStreaming:e,showCursor:t,className:r,renderMarkdown:!0,components:YC})}const $C=z.memo(({reasoning:n,defaultExpanded:e=!1})=>{const[t,r]=z.useState(e),a=z.useRef(null);return z.useEffect(()=>{if(a.current&&n){const s=a.current;s.scrollHeight-s.scrollTop-s.clientHeight<50&&(s.scrollTop=s.scrollHeight)}},[n]),!n||n.trim().length===0?null:b.jsxs("div",{className:"mb-2 border border-vault-300 dark:border-vault-600 rounded-md overflow-hidden",children:[b.jsxs("button",{onClick:()=>r(!t),className:"w-full flex items-center justify-between px-2 py-1.5 bg-vault-100 dark:bg-vault-700/50 hover:bg-vault-200 dark:hover:bg-vault-700 transition-colors text-left",children:[b.jsxs("span",{className:"text-xs font-medium text-vault-600 dark:text-vault-400 flex items-center gap-1",children:[b.jsx(Ba,{className:"w-3 h-3"}),"Thinking process"]}),b.jsx("span",{className:"text-xs text-vault-500 dark:text-vault-500",children:t?"Hide":"Show"})]}),t&&b.jsx("div",{ref:a,className:"max-h-40 overflow-y-auto px-2 py-2 bg-vault-50 dark:bg-vault-800/50 border-t border-vault-200 dark:border-vault-700",children:b.jsx("pre",{className:"text-xs font-mono text-vault-700 dark:text-vault-300 whitespace-pre-wrap wrap-break-word leading-relaxed",children:n})})]})});$C.displayName="ReasoningSection";const QC=z.memo(({content:n})=>{const[e,t]=z.useState(!1),r=z.useCallback(async()=>{try{await navigator.clipboard.writeText(n),t(!0),setTimeout(()=>t(!1),2e3)}catch(a){console.error("Failed to copy:",a)}},[n]);return b.jsx("button",{onClick:r,className:"p-1.5 rounded-md text-vault-400 hover:text-vault-600 dark:hover:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-700/50 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100",title:e?"Copied!":"Copy to clipboard",children:e?b.jsx(U0,{className:"w-3.5 h-3.5 text-green-500"}):b.jsx(V0,{className:"w-3.5 h-3.5"})})});QC.displayName="CopyButton";const XC=z.memo(({messageIndex:n,chatHistoryLength:e,onRegenerate:t,isProcessing:r})=>n===e-1?b.jsx("button",{onClick:()=>{t()},disabled:r,className:"p-1.5 rounded-md text-vault-400 hover:text-vault-600 dark:hover:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-700/50 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100 disabled:opacity-50",title:"Regenerate response",children:b.jsx(vw,{className:"w-3.5 h-3.5"})}):null);XC.displayName="RegenerateButton";function zL(n){return new Date(n).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function jg(){return`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const WC=z.memo(({message:n,messageIndex:e,chatHistoryLength:t,showReasoning:r=!0,isProcessing:a,onRegenerate:s})=>{const o=n.role==="user";return b.jsx("div",{className:`flex ${o?"justify-end":"justify-start"}`,children:b.jsxs("div",{className:`relative max-w-[90%] rounded-lg px-3 py-2 group message-animate ${o?"bg-vault-600 text-white rounded-br-none":"bg-white dark:bg-vault-800 border border-vault-200 dark:border-vault-700 text-vault-900 dark:text-vault-100 rounded-bl-none"}`,children:[o?b.jsx("p",{className:"text-sm whitespace-pre-wrap",children:n.content}):b.jsxs("div",{className:"text-sm prose prose-sm dark:prose-invert max-w-none pb-6",children:[n.reasoning&&r!==!1&&b.jsx($C,{reasoning:n.reasoning}),b.jsx(I0,{remarkPlugins:[H0],components:YC,children:n.content}),b.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-1",children:[b.jsx(QC,{content:n.content}),b.jsx(XC,{messageIndex:e,chatHistoryLength:t,onRegenerate:s,isProcessing:a})]})]}),b.jsx("span",{className:`text-xs mt-1 block ${o?"text-vault-200":"text-vault-500 dark:text-vault-400"}`,children:zL(n.timestamp)})]})})});WC.displayName="ChatMessage";function IL(){const[n,e]=z.useState([]),[t,r]=z.useState([]),[a,s]=z.useState(""),[o,c]=z.useState(""),[h,d]=z.useState(!1),[p,g]=z.useState(!1),[k,w]=z.useState(!1),[A,E]=z.useState(""),[j,D]=z.useState(""),U=z.useRef([]),O=z.useRef([]),J=z.useRef(!1),ee=z.useRef(!1),H=z.useRef(!1);z.useEffect(()=>{U.current=n},[n]),z.useEffect(()=>{O.current=t},[t]),z.useEffect(()=>{J.current=p},[p]),z.useEffect(()=>{ee.current=k},[k]),z.useEffect(()=>{H.current=h},[h]),z.useEffect(()=>{const pe=setInterval(()=>{const ge=U.current.length>0,re=O.current.length>0;if(!ee.current&&!ge&&!re){H.current&&d(!1);return}if((ge||re)&&!H.current&&d(!0),O.current.length>0){const ve=O.current[0],Te=O.current.slice(1);O.current=Te,r(Te),c(Ee=>Ee+ve)}if(J.current&&O.current.length===0&&U.current.length>0){const ve=U.current[0],Te=U.current.slice(1);U.current=Te,e(Te),s(Ee=>Ee+ve)}},30);return()=>clearInterval(pe)},[]);const L=z.useCallback(pe=>{const ge=[...U.current,pe];U.current=ge,e(ge),E(re=>re+pe)},[]),me=z.useCallback(pe=>{const ge=[...O.current,pe];O.current=ge,r(ge),D(re=>re+pe)},[]),he=z.useCallback(()=>{J.current=!0,g(!0)},[]),I=z.useCallback(()=>{s(""),c(""),e([]),r([]),g(!1),E(""),D(""),d(!1),U.current=[],O.current=[],J.current=!1,w(!0)},[]),te=z.useCallback(()=>{w(!1)},[]),ne=z.useCallback(()=>{const pe=o,ge=A,re=j;if((pe||O.current.length>0)&&(J.current=!0,g(!0)),O.current.length>0){const X=O.current.join("");c(ve=>ve+X),O.current=[],r([])}if(U.current.length>0){const X=U.current.join("");s(ve=>ve+X),U.current=[],e([])}s(X=>X.length<ge.length?ge:X),c(X=>X.length<re.length?re:X),d(!1)},[o,A,j]);return{displayedContent:a,displayedReasoning:o,isTyping:h,isReasoningComplete:p,queueContentChunk:L,queueReasoningChunk:me,markReasoningComplete:he,startStreaming:I,stopStreaming:te,flushQueues:ne,streamingContent:A,streamingReasoning:j}}const PL=150;function HL(n){const{isStreaming:e,isTyping:t=!1,dependencies:r=[]}=n,a=z.useRef(null),s=z.useCallback((o="smooth")=>{a.current&&a.current.scrollTo({top:a.current.scrollHeight,behavior:o})},[]);return z.useEffect(()=>{if(a.current){const o=a.current;o.scrollHeight-o.scrollTop-o.clientHeight<PL&&o.scrollTo({top:o.scrollHeight,behavior:"smooth"})}},[e,t,...r]),{containerRef:a,scrollToBottom:s}}function qL(n){const{aiConfig:e,samplerSettings:t,promptSettings:r,resolvedContext:a,enableStreaming:s,typewriter:o}=n,[c,h]=z.useState([]),[d,p]=z.useState(!1),[g,k]=z.useState(null),[w,A]=z.useState(!1),E=z.useRef(null),j=z.useMemo(()=>typeof e.modelId=="string"&&e.modelId.trim().length>0,[e.modelId]),D=z.useCallback(()=>{k(null)},[]),U=z.useCallback(()=>{h([])},[]),O=z.useCallback(()=>{E.current&&E.current.abort()},[]),J=z.useCallback(async()=>{if(c.length===0)return;if(!j){k("Please configure AI settings first");return}const H=c.map((he,I)=>({...he,originalIndex:I})).reverse().find(he=>he.role==="user");if(!H)return;const L=c.slice(0,H.originalIndex+1),me=H.content;h(L),p(!0),k(null),await new Promise(he=>setTimeout(he,600)),A(s),o.startStreaming();try{const he=new Et(e,t,r);E.current=he;const I=L.map(re=>({role:re.role,content:re.content})),te=[];a.length>0&&te.push(...a);const ne=s?re=>{re.reasoning&&o.queueReasoningChunk(re.reasoning),re.content&&(o.markReasoningComplete(),o.queueContentChunk(re.content))}:void 0,pe=await he.askAIWithConversation(me,te,I,void 0,ne),ge={id:jg(),role:"assistant",content:pe.content,reasoning:pe.reasoning,timestamp:Date.now()};h(re=>[...re,ge])}catch(he){he instanceof En&&he.message==="Request was cancelled"?console.log("[useAIChat] AI request cancelled by user"):(console.error("AI regenerate failed:",he),he instanceof En?k(he.message):k("Failed to get AI response. Please try again."))}finally{o.flushQueues(),o.stopStreaming(),p(!1),A(!1),E.current=null}},[c,a,e,t,r,j,s,o]),ee=z.useCallback(async H=>{if(!H.trim()){if(c[c.length-1]?.role==="user"){await J();return}return}if(!j){k("Please configure AI settings first");return}const L=H.trim(),me={id:jg(),role:"user",content:L,timestamp:Date.now()};h(he=>[...he,me]),p(!0),k(null),await new Promise(he=>setTimeout(he,600)),A(s),o.startStreaming();try{const he=new Et(e,t,r);E.current=he;const I=c.map(re=>({role:re.role,content:re.content})),te=[];a.length>0&&te.push(...a);const ne=s?re=>{re.reasoning&&o.queueReasoningChunk(re.reasoning),re.content&&(o.markReasoningComplete(),o.queueContentChunk(re.content))}:void 0,pe=await he.askAIWithConversation(L,te,I,void 0,ne),ge={id:jg(),role:"assistant",content:pe.content,reasoning:pe.reasoning,timestamp:Date.now()};h(re=>[...re,ge])}catch(he){he instanceof En&&he.message==="Request was cancelled"?console.log("[useAIChat] AI request cancelled by user"):(console.error("AI ask failed:",he),he instanceof En?k(he.message):k("Failed to get AI response. Please try again."))}finally{o.flushQueues(),o.stopStreaming(),p(!1),A(!1),E.current=null}},[c,a,e,t,r,j,s,J,o]);return{chatHistory:c,isProcessing:d,error:g,isStreaming:w,handleAsk:ee,handleRegenerate:J,handleNewChat:U,handleAbort:O,clearError:D,isAIConfigured:j}}function UL({contextEntryIds:n,aiConfig:e,samplerSettings:t,promptSettings:r,getContextContent:a,onClose:s,isMobile:o=!1}){const[c,h]=z.useState(""),[d,p]=z.useState([]),[g,k]=z.useState(!1),w=z.useRef(null),A=z.useRef(null),E=z.useRef(!1),j=IL(),{chatHistory:D,isProcessing:U,error:O,isStreaming:J,handleAsk:ee,handleRegenerate:H,handleNewChat:L,handleAbort:me,clearError:he}=qL({aiConfig:e,samplerSettings:t,promptSettings:r,resolvedContext:d,enableStreaming:e.enableStreaming??!0,showReasoning:e.showReasoning??!0,typewriter:j}),{containerRef:I,scrollToBottom:te}=HL({isStreaming:J,isTyping:j.isTyping,dependencies:[D,j.displayedContent,j.displayedReasoning]});z.useEffect(()=>{(async()=>{if(a&&n.length>0)try{const ge=await a(n);p(ge)}catch(ge){console.error("Failed to resolve context:",ge),p([])}else p([])})()},[n,a]),z.useEffect(()=>{if(j.isReasoningComplete){const pe=I.current;pe&&pe.scrollHeight-pe.scrollTop-pe.clientHeight<150&&te("smooth")}},[j.isReasoningComplete,te,I]),z.useEffect(()=>{if(!j.isTyping&&E.current){const pe=I.current;pe&&pe.scrollHeight-pe.scrollTop-pe.clientHeight<150&&te("auto")}E.current=j.isTyping},[j.isTyping,te,I]),z.useEffect(()=>{if(A.current&&j.displayedReasoning){const pe=A.current;pe.scrollHeight-pe.scrollTop-pe.clientHeight<50&&pe.scrollTo({top:pe.scrollHeight,behavior:"smooth"})}},[j.displayedReasoning]);const ne=async()=>{if(!c.trim()){if(D[D.length-1]?.role==="user"){await H();return}return}const pe=c.trim();h(""),await ee(pe)};return b.jsxs("div",{className:"h-full flex flex-col bg-vault-50 dark:bg-vault-900 border-l border-vault-200 dark:border-vault-800 animate-fade-in-slow",children:[b.jsx("style",{children:`
        @keyframes message-appear {
          0% {
            opacity: 0;
            transform: translateY(8px) scale(0.98);
          }
          100% {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }
        .message-animate {
          animation: message-appear 0.25s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
      `}),b.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-vault-200 dark:border-vault-800 bg-vault-100 dark:bg-vault-800/50 shrink-0",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx(Do,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),b.jsx("h2",{className:"font-semibold text-vault-900 dark:text-vault-100",children:"Ask Zoggy"})]}),b.jsxs("div",{className:"flex items-center gap-1",children:[D.length>0&&b.jsx("button",{onClick:L,className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-800 rounded-lg transition-colors",title:"New Chat",children:b.jsx(Zo,{className:"w-4 h-4"})}),o&&s&&b.jsx("button",{onClick:s,className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-800 rounded-lg transition-colors ml-1",title:"Close AI Chat Panel",children:b.jsx(za,{className:"w-4 h-4"})})]})]}),O&&b.jsxs("div",{className:"mx-3 mt-3 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg flex items-start gap-2 text-red-600 dark:text-red-400 text-sm shrink-0",children:[b.jsx(Wi,{className:"w-4 h-4 shrink-0 mt-0.5"}),b.jsx("span",{className:"flex-1",children:O}),b.jsx("button",{onClick:he,className:"p-0.5 text-red-400 hover:text-red-600 dark:hover:text-red-300",children:b.jsx(za,{className:"w-3.5 h-3.5"})})]}),b.jsx("div",{className:"border-b border-vault-200 dark:border-vault-800 flex-1 flex flex-col min-h-0",children:b.jsxs("div",{ref:I,className:"px-4 pt-2 pb-4 space-y-4 overflow-y-auto flex-1 min-h-0",children:[D.length===0&&b.jsxs("div",{className:"text-center py-8 text-vault-400 dark:text-vault-500",children:[b.jsx(Do,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),b.jsx("p",{className:"text-sm",children:"Hi, I'm Zoggy!"}),b.jsx("p",{className:"text-xs mt-1",children:"Ask me anything about your character card, or just chat with me! Don't forget to add your context!"})]}),D.map((pe,ge)=>b.jsx(WC,{message:pe,messageIndex:ge,chatHistoryLength:D.length,showReasoning:e.showReasoning,isProcessing:U,onRegenerate:H},pe.id)),J&&(j.displayedContent||j.displayedReasoning)&&b.jsx("div",{className:"flex justify-start",children:b.jsxs("div",{className:"max-w-[90%] bg-white dark:bg-vault-800 border border-vault-200 dark:border-vault-700 rounded-lg rounded-bl-none px-3 py-2 message-animate",children:[j.displayedReasoning&&e.showReasoning!==!1&&b.jsxs("div",{className:"mb-2 border border-vault-300 dark:border-vault-600 rounded-md overflow-hidden",children:[b.jsxs("button",{onClick:()=>k(!g),className:"w-full flex items-center justify-between px-2 py-1.5 bg-vault-100 dark:bg-vault-700/50 hover:bg-vault-200 dark:hover:bg-vault-700 transition-colors text-left",children:[b.jsxs("span",{className:"text-xs font-medium text-vault-600 dark:text-vault-400 flex items-center gap-1",children:[b.jsx(Ba,{className:"w-3 h-3"}),"Thinking process"]}),b.jsx("span",{className:"text-xs text-vault-500 dark:text-vault-500",children:g?"Hide":"Show"})]}),g&&b.jsx("div",{ref:A,className:"max-h-40 overflow-y-auto px-2 py-2 bg-vault-50 dark:bg-vault-800/50 border-t border-vault-200 dark:border-vault-700",children:b.jsx("pre",{className:"text-xs font-mono text-vault-700 dark:text-vault-300 whitespace-pre-wrap wrap-break-word leading-relaxed",children:j.displayedReasoning})})]}),j.displayedContent&&b.jsx("div",{className:"text-sm prose prose-sm dark:prose-invert max-w-none text-vault-900 dark:text-vault-100",children:b.jsx(BL,{content:j.displayedContent,isStreaming:j.isTyping,showCursor:!0})})]})}),U&&(!J||!j.displayedContent&&!j.displayedReasoning)&&b.jsx("div",{className:"flex justify-start",children:b.jsxs("div",{className:"bg-white dark:bg-vault-800 border border-vault-200 dark:border-vault-700 rounded-lg rounded-bl-none px-3 py-2 flex items-center gap-2 message-animate",children:[b.jsx(bc,{className:"w-4 h-4 animate-spin text-vault-600 dark:text-vault-400"}),b.jsx("span",{className:"text-sm text-vault-600 dark:text-vault-400",children:"AI is thinking..."})]})})]})}),b.jsx("div",{className:"p-3 space-y-3 bg-vault-100 dark:bg-vault-800/50 shrink-0",children:b.jsxs("div",{className:"flex gap-2",children:[b.jsx("input",{ref:w,type:"text",value:c,onChange:pe=>h(pe.target.value),placeholder:"Ask a question...",className:"flex-1 px-3 py-2 text-sm border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-700 text-vault-900 dark:text-vault-100 placeholder-vault-400 focus:outline-none focus:ring-2 focus:ring-vault-500",onKeyDown:pe=>{pe.key==="Enter"&&!U&&c.trim()&&ne()},disabled:U}),b.jsx("button",{onClick:()=>{U?me():ne()},disabled:!U&&!c.trim()&&(!D.length||D[D.length-1]?.role!=="user"),className:`px-3 py-2 text-white text-sm rounded-lg transition-colors flex items-center gap-1.5 ${U?"bg-red-600 hover:bg-red-700":"bg-vault-600 hover:bg-vault-700 disabled:opacity-50"}`,children:U?b.jsx(EN,{className:"w-4 h-4"}):b.jsx(Ba,{className:"w-4 h-4"})})]})})]})}const Co=({id:n,label:e,icon:t,value:r,min:a,max:s,step:o,onChange:c,formatValue:h=g=>g.toString(),showWarning:d=!1,warningMessage:p=""})=>{const g=(r-a)/(s-a)*100;return b.jsxs("div",{className:"space-y-2",children:[b.jsxs("label",{htmlFor:n,className:"flex items-center gap-2 text-sm font-medium text-vault-700 dark:text-vault-300",children:[b.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:t}),e]}),b.jsxs("div",{className:"relative",children:[b.jsx("input",{id:n,type:"range",min:a,max:s,step:o,value:r,onChange:k=>c(parseFloat(k.target.value)),className:"w-full h-2 bg-vault-200 dark:bg-vault-700 rounded-lg appearance-none cursor-pointer accent-vault-600 dark:accent-vault-400 focus:outline-none focus:ring-2 focus:ring-vault-500/50",style:{background:`linear-gradient(to right, var(--color-vault-600) 0%, var(--color-vault-600) ${g}%, var(--color-vault-200) ${g}%, var(--color-vault-200) 100%)`}}),b.jsxs("div",{className:"flex justify-between items-center mt-1.5",children:[b.jsx("span",{className:"text-xs text-vault-500",children:h(a)}),b.jsx("span",{className:`text-sm font-semibold ${d?"text-amber-600 dark:text-amber-400":"text-vault-700 dark:text-vault-300"}`,children:h(r)}),b.jsx("span",{className:"text-xs text-vault-500",children:h(s)})]}),d&&p&&b.jsxs("div",{className:"mt-2 flex items-center gap-1.5 text-xs text-amber-600 dark:text-amber-400",children:[b.jsx(Wi,{className:"w-3.5 h-3.5"}),b.jsx("span",{children:p})]})]})]})},VL=({settings:n,onChange:e})=>{const t=a=>{e({...n,...{creative:{temperature:.9,minP:.05,topK:50,repetitionPenalty:1.05,topP:.95,contextLength:4096,maxTokens:2048},balanced:{temperature:.7,minP:.05,topK:40,repetitionPenalty:1.1,topP:1,contextLength:4096,maxTokens:2048},factual:{temperature:.3,minP:.1,topK:20,repetitionPenalty:1.2,topP:.5,contextLength:4096,maxTokens:1024}}[a]})},r=(a,s)=>{e({...n,[a]:s})};return b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-linear-to-br from-vault-50 to-vault-100 dark:from-vault-800/50 dark:to-vault-800 rounded-xl p-4 border border-vault-200 dark:border-vault-700",children:[b.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[b.jsx(Cw,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),b.jsx("span",{className:"text-sm font-semibold text-vault-700 dark:text-vault-300",children:"Quick Presets"})]}),b.jsx("div",{className:"flex gap-2",children:["creative","balanced","factual"].map(a=>b.jsx("button",{onClick:()=>t(a),className:"flex-1 px-3 py-2 text-sm font-medium bg-white dark:bg-vault-700 hover:bg-vault-50 dark:hover:bg-vault-600 text-vault-700 dark:text-vault-300 rounded-lg transition-all duration-200 border border-vault-200 dark:border-vault-600 hover:shadow-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50",children:b.jsx("span",{className:"capitalize",children:a})},a))})]}),b.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-4 border border-vault-200 dark:border-vault-700 shadow-sm",children:[b.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[b.jsx(kw,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),b.jsx("span",{className:"text-sm font-semibold text-vault-700 dark:text-vault-300",children:"Primary Samplers"})]}),b.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[b.jsx(Co,{id:"temperature",label:"Temperature",icon:b.jsx(PN,{className:"w-4 h-4"}),value:n.temperature,min:0,max:2,step:.1,onChange:a=>r("temperature",a),formatValue:a=>a.toFixed(1)}),b.jsx(Co,{id:"topP",label:"Top P",icon:b.jsx(nN,{className:"w-4 h-4"}),value:n.topP,min:0,max:1,step:.05,onChange:a=>r("topP",a),formatValue:a=>a.toFixed(2)}),b.jsx(Co,{id:"minP",label:"Min P",icon:b.jsx(CT,{className:"w-4 h-4"}),value:n.minP,min:0,max:1,step:.01,onChange:a=>r("minP",a),formatValue:a=>a.toFixed(2)}),b.jsx(Co,{id:"topK",label:"Top K",icon:b.jsx(RT,{className:"w-4 h-4"}),value:n.topK,min:1,max:100,step:1,onChange:a=>r("topK",a),formatValue:a=>Math.round(a).toString()})]})]}),b.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-4 border border-vault-200 dark:border-vault-700 shadow-sm",children:[b.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[b.jsx(ww,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),b.jsx("span",{className:"text-sm font-semibold text-vault-700 dark:text-vault-300",children:"Secondary Samplers"})]}),b.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[b.jsx(Co,{id:"repetitionPenalty",label:"Repetition Penalty",icon:b.jsx(cN,{className:"w-4 h-4"}),value:n.repetitionPenalty,min:1,max:2,step:.05,onChange:a=>r("repetitionPenalty",a),formatValue:a=>a.toFixed(2)}),b.jsx(Co,{id:"maxTokens",label:"Max Tokens",icon:b.jsx(TT,{className:"w-4 h-4"}),value:n.maxTokens,min:100,max:8192,step:100,onChange:a=>r("maxTokens",Math.round(a)),formatValue:a=>Math.round(a).toString()}),b.jsxs("div",{className:"sm:col-span-2",children:[b.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-vault-700 dark:text-vault-300 mb-2",children:[b.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:b.jsx(Zf,{className:"w-4 h-4"})}),"Context Length"]}),b.jsxs("select",{value:n.contextLength,onChange:a=>r("contextLength",parseInt(a.target.value)),className:"w-full px-3 py-2.5 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-vault-500/50 transition-all duration-200",children:[b.jsx("option",{value:2048,children:"2K tokens"}),b.jsx("option",{value:4096,children:"4K tokens"}),b.jsx("option",{value:8192,children:"8K tokens"}),b.jsx("option",{value:16384,children:"16K tokens"}),b.jsx("option",{value:32768,children:"32K tokens"}),b.jsx("option",{value:65536,children:"64K tokens"}),b.jsx("option",{value:128e3,children:"128K tokens"})]}),b.jsx("p",{className:"mt-2 text-xs text-vault-500",children:"Maximum context window for AI requests"})]})]})]})]})},FL=({models:n,selectedModelId:e,onSelect:t,onFetch:r,isFetching:a,disabled:s=!1})=>{const[o,c]=z.useState(!1),[h,d]=z.useState(""),p=z.useRef(null),g=z.useRef(null),k=n.find(j=>j.id===e),w=n.filter(j=>j.name.toLowerCase().includes(h.toLowerCase())||j.id.toLowerCase().includes(h.toLowerCase()));z.useEffect(()=>{const j=D=>{p.current&&!p.current.contains(D.target)&&c(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),z.useEffect(()=>{if(o&&g.current){g.current.focus();const j=p.current?.closest(".overflow-y-auto");if(j&&p.current){const D=p.current.getBoundingClientRect(),U=j.getBoundingClientRect(),O=256,J=U.bottom-D.bottom;if(J<O){const ee=O-J+16;j.scrollTo({top:j.scrollTop+ee,behavior:"smooth"})}}}},[o]);const A=j=>{t(j),c(!1),d("")},E=j=>{j.key==="Enter"&&w.length>0?A(w[0].id):j.key==="Escape"&&c(!1)};return b.jsxs("div",{className:"space-y-2",ref:p,children:[b.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-vault-800 dark:text-vault-200",children:[b.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:b.jsx(gw,{className:"w-4 h-4"})}),"Model"]}),b.jsxs("div",{className:"flex gap-2",children:[b.jsxs("div",{className:"flex-1 relative",children:[b.jsxs("button",{onClick:()=>!s&&c(!o),disabled:s,className:`w-full px-3 py-2.5 border rounded-lg text-left transition-all duration-200 flex items-center justify-between ${s?"bg-vault-100 dark:bg-vault-800 text-vault-400 cursor-not-allowed border-vault-200 dark:border-vault-700":"bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 border-vault-300 dark:border-vault-600 hover:border-vault-400 dark:hover:border-vault-500 focus:outline-none focus:ring-2 focus:ring-vault-500/50"}`,children:[b.jsx("span",{className:e?"font-medium":"text-vault-400",children:k?.name||"Select or type to search models..."}),b.jsx(La,{className:`w-4 h-4 text-vault-400 transition-transform duration-200 ${o?"rotate-180":""}`})]}),o&&b.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-vault-800 border border-vault-300 dark:border-vault-600 rounded-lg shadow-xl z-50 max-h-64 overflow-hidden",children:[b.jsx("div",{className:"p-2 border-b border-vault-200 dark:border-vault-700",children:b.jsxs("div",{className:"relative",children:[b.jsx(Jf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-vault-400"}),b.jsx("input",{ref:g,type:"text",value:h,onChange:j=>d(j.target.value),onKeyDown:E,placeholder:"Type to filter models...",className:"w-full pl-9 pr-3 py-2 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50"})]})}),b.jsx("div",{className:"overflow-y-auto max-h-48",children:w.length===0?b.jsxs("div",{className:"px-3 py-4 text-sm text-vault-500 text-center",children:['No models found matching "',h,'"']}):w.map(j=>b.jsxs("button",{onClick:()=>A(j.id),className:`w-full px-3 py-2 text-left text-sm transition-colors duration-150 ${j.id===e?"bg-vault-100 dark:bg-vault-700 text-vault-900 dark:text-vault-100 font-medium":"text-vault-700 dark:text-vault-300 hover:bg-vault-50 dark:hover:bg-vault-700/50"}`,children:[b.jsx("div",{className:"font-medium",children:j.name}),b.jsx("div",{className:"text-xs text-vault-500 truncate",children:j.id})]},j.id))})]})]}),b.jsxs("button",{onClick:r,disabled:a||s,className:"px-4 py-2 bg-vault-100 dark:bg-vault-800 hover:bg-vault-200 dark:hover:bg-vault-700 disabled:opacity-50 disabled:cursor-not-allowed text-vault-700 dark:text-vault-300 rounded-lg transition-all duration-200 flex items-center gap-2 font-medium focus:outline-none focus:ring-2 focus:ring-vault-500/50",children:[a?b.jsx(bc,{className:"w-4 h-4 animate-spin"}):b.jsx(xw,{className:"w-4 h-4"}),"Fetch"]})]})]})},KL=({toasts:n,onRemove:e})=>b.jsx("div",{className:"fixed top-4 right-4 z-100 space-y-2",children:n.map(t=>b.jsxs("div",{className:`flex items-center gap-2 px-4 py-3 rounded-lg shadow-lg transform transition-all duration-300 animate-in slide-in-from-right ${t.type==="success"?"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-400":t.type==="error"?"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400":"bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-800 text-amber-700 dark:text-amber-400"}`,children:[t.type==="success"?b.jsx(U0,{className:"w-4 h-4"}):t.type==="error"?b.jsx(Wi,{className:"w-4 h-4"}):b.jsx(Wi,{className:"w-4 h-4"}),b.jsx("span",{className:"text-sm font-medium",children:t.message}),b.jsx("button",{onClick:()=>e(t.id),className:"ml-2 p-1 hover:bg-black/5 dark:hover:bg-white/10 rounded",children:b.jsx(za,{className:"w-3 h-3"})})]},t.id))});function GL({isOpen:n,onClose:e}){const{reloadSettings:t}=Wo(),[r,a]=z.useState(!1),[s,o]=z.useState(!1),[c,h]=z.useState({baseUrl:"https://nano-gpt.com/api/v1",apiKey:"",modelId:"",availableModels:[],enableStreaming:!1,enableReasoning:!1,showReasoning:!1}),[d,p]=z.useState({temperature:.7,minP:.05,topK:40,repetitionPenalty:1.1,topP:1,contextLength:4096,maxTokens:2048}),[g,k]=z.useState(Bn.prompts),[w,A]=z.useState(!1),[E,j]=z.useState(!1),[D,U]=z.useState(!1),[O,J]=z.useState([]),[ee,H]=z.useState("ai"),[L,me]=z.useState({}),[he,I]=z.useState(!1),[te,ne]=z.useState(!1),pe=z.useRef(null),ge=z.useRef([]),re=z.useCallback((ye,Ce)=>{const B=Math.random().toString(36).substring(7);J(rt=>[...rt,{id:B,type:ye,message:Ce}]);const $e=window.setTimeout(()=>{J(rt=>rt.filter(Qe=>Qe.id!==B))},5e3);ge.current.push($e)},[]),X=z.useCallback(ye=>{J(Ce=>Ce.filter(B=>B.id!==ye))},[]);z.useEffect(()=>{n||(J([]),ge.current.forEach(ye=>window.clearTimeout(ye)),ge.current=[])},[n]),z.useEffect(()=>()=>{ge.current.forEach(ye=>window.clearTimeout(ye)),ge.current=[]},[]),z.useEffect(()=>{if(!n)return;(async()=>{A(!0);try{const[Ce,B,$e]=await Promise.all([rr.getAISettings(),rr.getSamplerSettings(),rr.getPromptSettings()]);h(rt=>({...rt,...Ce})),p({temperature:B?.temperature??.7,minP:B?.minP??.05,topK:B?.topK??40,repetitionPenalty:B?.repetitionPenalty??1.1,topP:B?.topP??1,contextLength:B?.contextLength??4096,maxTokens:Math.min(B?.maxTokens??2048,8192)}),k($e)}catch(Ce){console.error("Failed to load settings:",Ce),re("error","Failed to load settings")}finally{A(!1)}})()},[n,re]),z.useEffect(()=>{const ye=Ce=>{if(n&&(Ce.key==="Escape"&&e(),Ce.key==="ArrowLeft"||Ce.key==="ArrowRight")){const B=["ai","sampler","prompts"],$e=B.indexOf(ee);let rt;Ce.key==="ArrowLeft"?rt=$e>0?$e-1:B.length-1:rt=$e<B.length-1?$e+1:0,H(B[rt])}};return document.addEventListener("keydown",ye),()=>document.removeEventListener("keydown",ye)},[n,ee,e,re]),z.useEffect(()=>{if(!n||!pe.current)return;const Ce=pe.current.querySelectorAll('button, input, select, textarea, [tabindex]:not([tabindex="-1"])'),B=Ce[0],$e=Ce[Ce.length-1],rt=Qe=>{Qe.key==="Tab"&&(Qe.shiftKey?document.activeElement===B&&(Qe.preventDefault(),$e?.focus()):document.activeElement===$e&&(Qe.preventDefault(),B?.focus()))};return document.addEventListener("keydown",rt),B?.focus(),()=>document.removeEventListener("keydown",rt)},[n,ee]),z.useEffect(()=>{n?(o(!0),requestAnimationFrame(()=>a(!0))):(a(!1),setTimeout(()=>o(!1),300))},[n]);const ve=async()=>{U(!0);try{const Ce=await new Et(c,d).fetchModels();h(B=>({...B,availableModels:Ce})),re("success",`Fetched ${Ce.length} models`)}catch(ye){ye instanceof En?re("error",ye.message):re("error","Failed to fetch models")}finally{U(!1)}},Te=()=>{const ye=[];g.expand.includes("${text}")||ye.push("Expand prompt must contain ${text}"),g.rewrite.includes("${text}")||ye.push("Rewrite prompt must contain ${text}"),g.instruct.includes("${text}")||ye.push("Instruct prompt must contain ${text}"),g.instruct.includes("${instruction}")||ye.push("Instruct prompt must contain ${instruction}");const Ce=["shorten","lengthen","vivid","emotion","grammar"];for(const B of Ce)g[B].includes("${text}")||ye.push(`${B.charAt(0).toUpperCase()+B.slice(1)} prompt must contain \${text}`);return ye.length>0?ye.join(`
`):null},Ee=async()=>{j(!0);const ye=Te();if(ye){re("error",ye),j(!1);return}try{const Ce={...d,maxTokens:Math.min(d.maxTokens,8192)};await rr.saveAllAISettings(c,Ce,g),await t(),re("success","Settings saved successfully!")}catch{re("error","Failed to save settings")}finally{j(!1)}},q=async()=>{ne(!0);try{await rr.clearAISettings(),h({baseUrl:"https://nano-gpt.com/api/v1",apiKey:"",modelId:"",availableModels:[],enableStreaming:!1,enableReasoning:!1,showReasoning:!1}),await t(),re("success","AI settings cleared. Your characters are safe."),I(!1)}catch{re("error","Failed to clear AI settings")}finally{ne(!1)}};return s?b.jsxs(b.Fragment,{children:[b.jsx(KL,{toasts:O,onRemove:X}),b.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 transition-opacity duration-300 ${r?"opacity-100":"opacity-0"}`,children:b.jsxs("div",{ref:pe,className:`bg-vault-50 dark:bg-vault-900 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden ring-1 ring-vault-200 dark:ring-vault-800 transition-transform duration-300 scale-100 ${r?"scale-100":"scale-95"}`,role:"dialog","aria-modal":"true","aria-labelledby":"settings-title",children:[b.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-vault-200 dark:border-vault-800 bg-white dark:bg-vault-900",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"p-2 rounded-xl bg-linear-to-br from-vault-500 to-vault-600",children:b.jsx(bN,{className:"w-5 h-5 text-white"})}),b.jsxs("div",{children:[b.jsx("h2",{id:"settings-title",className:"text-lg font-bold text-vault-900 dark:text-vault-100",children:"AI Settings"}),b.jsx("p",{className:"text-xs text-vault-500",children:"Configure your AI generation preferences"})]})]}),b.jsx("button",{onClick:e,className:"p-2 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-vault-500/50","aria-label":"Close settings panel",children:b.jsx(za,{className:"w-5 h-5"})})]}),b.jsx("div",{className:"flex border-b border-vault-200 dark:border-vault-800 px-6 bg-vault-50 dark:bg-vault-900/50",children:["ai","sampler","prompts"].map(ye=>b.jsx("button",{onClick:()=>H(ye),className:`px-4 py-3 text-sm font-medium capitalize transition-all duration-200 border-b-2 -mb-px focus:outline-none focus:ring-2 focus:ring-vault-500/50 focus:ring-inset ${ee===ye?"border-vault-600 text-vault-600 dark:border-vault-400 dark:text-vault-400":"border-transparent text-vault-500 dark:text-vault-400 hover:text-vault-700 dark:hover:text-vault-300 hover:bg-vault-100/50 dark:hover:bg-vault-800/50"}`,"aria-selected":ee===ye,role:"tab",children:b.jsxs("span",{className:"flex items-center gap-2",children:[ye==="ai"&&b.jsx(gw,{className:"w-4 h-4"}),ye==="sampler"&&b.jsx(kw,{className:"w-4 h-4"}),ye==="prompts"&&b.jsx(Do,{className:"w-4 h-4"}),ye==="ai"?"AI Config":ye]})},ye))}),b.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 bg-vault-50/50 dark:bg-vault-900/50",children:[w&&ee!=="sampler"&&b.jsx("div",{className:"flex items-center justify-center py-12",children:b.jsxs("div",{className:"flex flex-col items-center gap-3",children:[b.jsx(bc,{className:"w-8 h-8 animate-spin text-vault-600"}),b.jsx("span",{className:"text-sm text-vault-500",children:"Loading settings..."})]})}),ee==="ai"&&!w&&b.jsxs("div",{className:"space-y-5",children:[b.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-xl p-4 border border-amber-200 dark:border-amber-800",children:b.jsxs("div",{className:"flex items-start gap-3",children:[b.jsx("div",{className:"p-1.5 rounded-md bg-amber-100 dark:bg-amber-800/50 text-amber-600 dark:text-amber-400 shrink-0",children:b.jsx(CN,{className:"w-4 h-4"})}),b.jsxs("div",{className:"flex-1 min-w-0",children:[b.jsx("h4",{className:"text-sm font-semibold text-amber-800 dark:text-amber-300 mb-1",children:"Security Notice"}),b.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-400 leading-relaxed",children:"Your API key is stored locally in your browser's IndexedDB. This is convenient but means the key could be accessed by malicious browser extensions or if someone gains physical access to your unlocked computer."}),b.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[b.jsxs("button",{onClick:()=>I(!0),className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-amber-700 dark:text-amber-300 bg-amber-100 dark:bg-amber-800/50 hover:bg-amber-200 dark:hover:bg-amber-800 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-amber-500/50",children:[b.jsx(_l,{className:"w-3.5 h-3.5"}),"Clear AI Settings"]}),b.jsx("span",{className:"text-xs text-amber-600 dark:text-amber-500",children:"(Your characters will not be affected)"})]})]})]})}),he&&b.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-4 border border-red-200 dark:border-red-800",children:b.jsxs("div",{className:"flex items-start gap-3",children:[b.jsx("div",{className:"p-1.5 rounded-md bg-red-100 dark:bg-red-800/50 text-red-600 dark:text-red-400 shrink-0",children:b.jsx(Wi,{className:"w-4 h-4"})}),b.jsxs("div",{className:"flex-1 min-w-0",children:[b.jsx("h4",{className:"text-sm font-semibold text-red-800 dark:text-red-300 mb-1",children:"Clear AI Settings?"}),b.jsx("p",{className:"text-xs text-red-700 dark:text-red-400 mb-3",children:"This will remove your API key, base URL, and model selection. Your characters and other data will remain untouched."}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsxs("button",{onClick:q,disabled:te,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-red-500/50",children:[te?b.jsx(bc,{className:"w-3.5 h-3.5 animate-spin"}):b.jsx(_l,{className:"w-3.5 h-3.5"}),te?"Clearing...":"Yes, Clear Settings"]}),b.jsx("button",{onClick:()=>I(!1),disabled:te,className:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-red-700 dark:text-red-300 hover:bg-red-100 dark:hover:bg-red-800/50 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-red-500/50",children:"Cancel"})]})]})]})}),b.jsx("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-5 border border-vault-200 dark:border-vault-700 shadow-sm",children:b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{children:[b.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-vault-800 dark:text-vault-200 mb-2",children:[b.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:b.jsx(xN,{className:"w-4 h-4"})}),"API Base URL"]}),b.jsx("input",{type:"text",value:c.baseUrl,onChange:ye=>h(Ce=>({...Ce,baseUrl:ye.target.value})),className:"w-full px-3 py-2.5 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50 transition-all duration-200",placeholder:"https://nano-gpt.com/api/v1"})]}),b.jsxs("div",{children:[b.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-vault-800 dark:text-vault-200 mb-2",children:[b.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:b.jsx(DT,{className:"w-4 h-4"})}),"API Key"]}),b.jsx("input",{type:"password",value:c.apiKey,onChange:ye=>h(Ce=>({...Ce,apiKey:ye.target.value})),className:"w-full px-3 py-2.5 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50 transition-all duration-200",placeholder:"Enter your API key"})]}),b.jsx(FL,{models:c.availableModels||[],selectedModelId:c.modelId,onSelect:ye=>h(Ce=>({...Ce,modelId:ye})),onFetch:ve,isFetching:D,disabled:!1})]})}),b.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-5 border border-vault-200 dark:border-vault-700 shadow-sm",children:[b.jsxs("h3",{className:"text-sm font-semibold text-vault-800 dark:text-vault-200 mb-4 flex items-center gap-2",children:[b.jsx(Ba,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),"Advanced Options"]}),b.jsxs("div",{className:"flex flex-wrap items-center gap-6",children:[b.jsxs("label",{className:"flex items-center gap-3 text-sm text-vault-700 dark:text-vault-300 cursor-pointer group",children:[b.jsxs("div",{className:"relative",children:[b.jsx("input",{type:"checkbox",checked:c.enableStreaming,onChange:ye=>h(Ce=>({...Ce,enableStreaming:ye.target.checked})),className:"peer sr-only"}),b.jsx("div",{className:"w-10 h-6 bg-vault-300 dark:bg-vault-700 rounded-full peer-checked:bg-vault-600 dark:peer-checked:bg-vault-500 transition-colors duration-200"}),b.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 peer-checked:translate-x-4"})]}),b.jsx("span",{className:"group-hover:text-vault-900 dark:group-hover:text-vault-100 transition-colors",children:"Enable streaming"})]}),b.jsxs("label",{className:"flex items-center gap-3 text-sm text-vault-700 dark:text-vault-300 cursor-pointer group",children:[b.jsxs("div",{className:"relative",children:[b.jsx("input",{type:"checkbox",checked:c.enableReasoning,onChange:ye=>h(Ce=>({...Ce,enableReasoning:ye.target.checked})),className:"peer sr-only"}),b.jsx("div",{className:"w-10 h-6 bg-vault-300 dark:bg-vault-700 rounded-full peer-checked:bg-vault-600 dark:peer-checked:bg-vault-500 transition-colors duration-200"}),b.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 peer-checked:translate-x-4"})]}),b.jsx("span",{className:"group-hover:text-vault-900 dark:group-hover:text-vault-100 transition-colors",children:"Enable reasoning"})]}),b.jsxs("label",{className:"flex items-center gap-3 text-sm text-vault-700 dark:text-vault-300 cursor-pointer group",children:[b.jsxs("div",{className:"relative",children:[b.jsx("input",{type:"checkbox",checked:c.showReasoning!==!1,onChange:ye=>h(Ce=>({...Ce,showReasoning:ye.target.checked})),className:"peer sr-only"}),b.jsx("div",{className:"w-10 h-6 bg-vault-300 dark:bg-vault-700 rounded-full peer-checked:bg-vault-600 dark:peer-checked:bg-vault-500 transition-colors duration-200"}),b.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 peer-checked:translate-x-4"})]}),b.jsx("span",{className:"group-hover:text-vault-900 dark:group-hover:text-vault-100 transition-colors",children:"Show reasoning"})]})]})]})]}),ee==="sampler"&&b.jsx(VL,{settings:d,onChange:p}),ee==="prompts"&&!w&&b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-4 border border-vault-200 dark:border-vault-700 shadow-sm",children:[b.jsxs("h3",{className:"text-xs font-bold text-vault-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[b.jsx(ww,{className:"w-4 h-4"}),"Primary Operations"]}),["expand","rewrite","instruct"].map(ye=>b.jsxs("div",{className:"border border-vault-200 dark:border-vault-700 rounded-lg overflow-hidden mb-3 last:mb-0",children:[b.jsxs("button",{onClick:()=>me(Ce=>({...Ce,[ye]:!Ce[ye]})),className:"w-full flex items-center justify-between px-4 py-3 bg-vault-50 dark:bg-vault-800/50 hover:bg-vault-100 dark:hover:bg-vault-800 transition-colors",children:[b.jsxs("span",{className:"flex items-center gap-2 text-sm font-semibold text-vault-700 dark:text-vault-300 capitalize",children:[b.jsx(Do,{className:"w-4 h-4 text-vault-500"}),ye==="expand"?"Enhance":ye==="rewrite"?"Rephrase":"Custom"," Prompt"]}),L[ye]?b.jsx(Po,{className:"w-4 h-4 text-vault-500"}):b.jsx(La,{className:"w-4 h-4 text-vault-500"})]}),L[ye]&&b.jsxs("div",{className:"p-4",children:[b.jsx("textarea",{value:g[ye],onChange:Ce=>k(B=>({...B,[ye]:Ce.target.value})),className:"w-full h-32 px-3 py-2 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50 resize-none transition-all duration-200",placeholder:`Enter ${ye} prompt...`}),b.jsx("div",{className:"mt-2 text-xs space-y-1",children:ye==="instruct"?b.jsxs("span",{className:"text-vault-600 dark:text-vault-400",children:[b.jsx("span",{className:"font-semibold text-red-500",children:"Required:"})," Must contain $","{text}"," and $","{instruction}"]}):b.jsxs("span",{className:"text-vault-600 dark:text-vault-400",children:[b.jsx("span",{className:"font-semibold text-red-500",children:"Required:"})," Must contain $","{text}"]})}),!g[ye].includes("${text}")&&b.jsxs("p",{className:"mt-2 text-xs text-red-500 flex items-center gap-1",children:[b.jsx(Wi,{className:"w-3 h-3"}),"Missing required $","{text}"," placeholder!"]}),ye==="instruct"&&!g[ye].includes("${instruction}")&&b.jsxs("p",{className:"mt-2 text-xs text-red-500 flex items-center gap-1",children:[b.jsx(Wi,{className:"w-3 h-3"}),"Missing required $","{instruction}"," placeholder!"]})]})]},ye))]}),b.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-4 border border-vault-200 dark:border-vault-700 shadow-sm",children:[b.jsxs("h3",{className:"text-xs font-bold text-vault-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[b.jsx(Ba,{className:"w-4 h-4"}),"Polish Operations (More Menu)"]}),["shorten","lengthen","vivid","emotion","grammar"].map(ye=>b.jsxs("div",{className:"border border-vault-200 dark:border-vault-700 rounded-lg overflow-hidden mb-3 last:mb-0",children:[b.jsxs("button",{onClick:()=>me(Ce=>({...Ce,[ye]:!Ce[ye]})),className:"w-full flex items-center justify-between px-4 py-3 bg-vault-50 dark:bg-vault-800/50 hover:bg-vault-100 dark:hover:bg-vault-800 transition-colors",children:[b.jsxs("span",{className:"flex items-center gap-2 text-sm font-semibold text-vault-700 dark:text-vault-300 capitalize",children:[b.jsx(Do,{className:"w-4 h-4 text-vault-500"}),ye==="grammar"?"Fix":ye," Prompt"]}),L[ye]?b.jsx(Po,{className:"w-4 h-4 text-vault-500"}):b.jsx(La,{className:"w-4 h-4 text-vault-500"})]}),L[ye]&&b.jsxs("div",{className:"p-4",children:[b.jsx("textarea",{value:g[ye],onChange:Ce=>k(B=>({...B,[ye]:Ce.target.value})),className:"w-full h-32 px-3 py-2 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50 resize-none transition-all duration-200",placeholder:`Enter ${ye} prompt...`}),b.jsx("div",{className:"mt-2 text-xs",children:b.jsxs("span",{className:"text-vault-600 dark:text-vault-400",children:[b.jsx("span",{className:"font-semibold text-red-500",children:"Required:"})," Must contain $","{text}"]})}),!g[ye].includes("${text}")&&b.jsxs("p",{className:"mt-2 text-xs text-red-500 flex items-center gap-1",children:[b.jsx(Wi,{className:"w-3 h-3"}),"Missing required $","{text}"," placeholder!"]})]})]},ye))]})]})]}),b.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-vault-200 dark:border-vault-800 bg-white dark:bg-vault-900",children:[b.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-vault-700 dark:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-vault-500/50",children:"Cancel"}),b.jsxs("button",{onClick:Ee,disabled:E,className:"flex items-center gap-2 px-4 py-2 bg-linear-to-r from-vault-600 to-vault-700 hover:from-vault-700 hover:to-vault-800 disabled:opacity-50 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-vault-500/50",children:[E?b.jsx(bc,{className:"w-4 h-4 animate-spin"}):b.jsx(bw,{className:"w-4 h-4"}),"Save Settings"]})]})]})})]}):null}class YL{async importFromFile(e){try{return console.log("Importing file:",e.name,"type:",e.type),e.type==="application/json"||e.name.endsWith(".json")?await this.importFromJSON(e):e.type.startsWith("image/")||e.name.endsWith(".png")?await this.importFromPNG(e):{success:!1,error:"Unsupported file type. Please upload a PNG or JSON file."}}catch(t){return console.error("Import error:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error during import"}}}async importFromJSON(e){const t=await e.text();let r;try{r=JSON.parse(t)}catch{return{success:!1,error:"Invalid JSON file"}}if(this.isCharacterVaultExport(r))return{success:!0,character:await this.createCharacterFromExport(r)};const a=this.extractV3Data(r);if(a)return{success:!0,character:await this.createCharacterFromV2(a,"")};if(this.isCharacterCardV2(r)){const s=r,o={name:String(s.name||""),description:String(s.description||""),personality:String(s.personality||""),scenario:String(s.scenario||""),first_mes:String(s.first_mes||""),mes_example:String(s.mes_example||""),system_prompt:String(s.system_prompt||""),post_history_instructions:String(s.post_history_instructions||""),alternate_greetings:Array.isArray(s.alternate_greetings)?s.alternate_greetings:[],extensions:s.extensions||{},character_book:s.character_book,creator:typeof s.creator=="string"?s.creator:void 0,character_version:typeof s.character_version=="string"?s.character_version:void 0,tags:Array.isArray(s.tags)?s.tags:void 0,creator_notes:typeof s.creator_notes=="string"?s.creator_notes:void 0,avatar:typeof s.avatar=="string"?s.avatar:void 0};return{success:!0,character:await this.createCharacterFromV2(o,"")}}return{success:!1,error:"Unrecognized JSON format. Expected Character Card V2, V3, or CharacterVault export."}}extractV3Data(e){if(!e||typeof e!="object")return null;const t=e,r=t.data&&typeof t.data=="object"?t.data:null,a=r&&typeof r.name=="string"?r.name:typeof t.name=="string"?t.name:null;if(!a)return null;const s=(h,d)=>{const p=r&&typeof r[h]=="string"?r[h]:typeof t[h]=="string"?t[h]:d&&r&&typeof r[d]=="string"?r[d]:d&&typeof t[d]=="string"?t[d]:"";return String(p||"")},o=h=>r&&Array.isArray(r[h])?r[h]:Array.isArray(t[h])?t[h]:void 0;return{name:a,description:s("description"),personality:s("personality"),scenario:s("scenario"),first_mes:s("first_mes"),mes_example:s("mes_example"),system_prompt:s("system_prompt"),post_history_instructions:s("post_history_instructions"),alternate_greetings:o("alternate_greetings")||[],extensions:r&&r.extensions||t.extensions||{},character_book:r&&r.character_book||t.character_book,creator:s("creator")||void 0,character_version:s("character_version","create_date")||void 0,tags:o("tags"),creator_notes:s("creator_notes","creatorcomment")||void 0,avatar:s("avatar")||void 0}}async importFromPNG(e){try{const t=await e.arrayBuffer(),r=this.extractCharaFromPNG(t);if(!r)return{success:!1,error:"No character data found in PNG. Make sure this is a valid character card."};let a;try{const h=atob(r),d=new Uint8Array(h.length);for(let g=0;g<h.length;g++)d[g]=h.charCodeAt(g);const p=new TextDecoder("utf-8").decode(d);a=JSON.parse(p)}catch(h){return console.error("Failed to decode/parse character data:",h),{success:!1,error:"Invalid character data in PNG file"}}const s=await this.fileToDataURL(e),o=this.extractV3Data(a);if(o)return{success:!0,character:await this.createCharacterFromV2(o,s)};let c=a;if(a&&typeof a=="object"){const h=a;h.data&&typeof h.data=="object"&&(c=h.data)}if(this.isCharacterCardV2(c)){const h=c,d={name:String(h.name||""),description:String(h.description||""),personality:String(h.personality||""),scenario:String(h.scenario||""),first_mes:String(h.first_mes||""),mes_example:String(h.mes_example||""),system_prompt:String(h.system_prompt||""),post_history_instructions:String(h.post_history_instructions||""),alternate_greetings:Array.isArray(h.alternate_greetings)?h.alternate_greetings:[],extensions:h.extensions||{},character_book:h.character_book,creator:typeof h.creator=="string"?h.creator:void 0,character_version:typeof h.character_version=="string"?h.character_version:void 0,tags:Array.isArray(h.tags)?h.tags:void 0,creator_notes:typeof h.creator_notes=="string"?h.creator_notes:void 0,avatar:typeof h.avatar=="string"?h.avatar:void 0};return{success:!0,character:await this.createCharacterFromV2(d,s)}}if(c&&typeof c=="object"){const h=c,d=typeof h.name=="string"?h.name:typeof h.char_name=="string"?h.char_name:"Imported Character",p={name:d,description:String(h.description||h.char_persona||""),personality:String(h.personality||""),scenario:String(h.scenario||h.world_scenario||""),first_mes:String(h.first_mes||h.first_message||""),mes_example:String(h.mes_example||""),system_prompt:String(h.system_prompt||""),post_history_instructions:String(h.post_history_instructions||""),alternate_greetings:Array.isArray(h.alternate_greetings)?h.alternate_greetings:[],physical_description:String(h.physical_description||""),creator:typeof h.creator=="string"?h.creator:void 0,character_version:typeof h.character_version=="string"?h.character_version:void 0,tags:Array.isArray(h.tags)?h.tags:void 0,creator_notes:typeof h.creator_notes=="string"?h.creator_notes:void 0,avatar:typeof h.avatar=="string"?h.avatar:void 0};return{success:!0,character:await zt.createCharacter({name:d,imageData:s,data:{spec:p,characterBook:h.character_book,extensions:h.extensions}})}}return{success:!1,error:"Invalid character card format in PNG"}}catch(t){return console.error("PNG import error:",t),{success:!1,error:t instanceof Error?t.message:"Error reading PNG file"}}}extractCharaFromPNG(e){const t=new DataView(e);let r=0;const a=new Uint8Array(e,0,8),s=[137,80,78,71,13,10,26,10];for(let o=0;o<8;o++)if(a[o]!==s[o])throw console.error("Invalid PNG signature"),new Error("Invalid PNG file signature");for(r=8;r<e.byteLength&&!(r+8>e.byteLength);){const o=t.getUint32(r),c=this.readChunkType(t,r+4);if(o>10*1024*1024){console.error("Chunk too large:",o);break}if(r+12+o>e.byteLength){console.error("Incomplete chunk at offset:",r);break}const h=new Uint8Array(e,r+8,o);if(c==="tEXt"){const d=this.readNullTerminatedString(h);if(d==="chara"){const p=new TextEncoder().encode(d),g=h.slice(p.length+1);return new TextDecoder().decode(g)}}if(c==="iTXt"){const d=this.parseITXtChunk(h);if(d.keyword==="chara")return d.text}if(c==="IEND")break;r+=12+o}return null}readChunkType(e,t){const r=[e.getUint8(t),e.getUint8(t+1),e.getUint8(t+2),e.getUint8(t+3)];return String.fromCharCode(...r)}readNullTerminatedString(e){let t=0;for(let r=0;r<e.length;r++)if(e[r]===0){t=r;break}return new TextDecoder("utf-8").decode(e.slice(0,t))}parseITXtChunk(e){let t=0,r=t;for(;r<e.length&&e[r]!==0;)r++;const a=new TextDecoder("utf-8").decode(e.slice(t,r));if(t=r+1,t>=e.length)return{keyword:a,text:""};const s=e[t];for(t++,t++;t<e.length&&e[t]!==0;)t++;for(t++;t<e.length&&e[t]!==0;)t++;t++;const o=new TextDecoder("utf-8").decode(e.slice(t));if(s===1)try{const c=new Uint8Array(e.slice(t)),h=this.inflate(c);return{keyword:a,text:new TextDecoder().decode(h)}}catch(c){return console.warn("Failed to decompress iTXt chunk:",c),{keyword:a,text:o}}return{keyword:a,text:o}}inflate(e){return e}fileToDataURL(e){return new Promise((t,r)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=r,a.readAsDataURL(e)})}isCharacterCardV2(e){return!e||typeof e!="object"?!1:typeof e.name=="string"}isCharacterVaultExport(e){if(!e||typeof e!="object")return!1;const t=e;return typeof t.id=="string"&&typeof t.name=="string"&&t.data!==void 0}async createCharacterFromV2(e,t){const r={name:e.name||"",description:e.description||"",personality:e.personality||"",scenario:e.scenario||"",first_mes:e.first_mes||"",mes_example:e.mes_example||"",system_prompt:e.system_prompt||"",post_history_instructions:e.post_history_instructions||"",alternate_greetings:e.alternate_greetings||[],physical_description:"",avatar:e.avatar,creator_notes:e.creator_notes,creator:e.creator,character_version:e.character_version,tags:e.tags};return await zt.createCharacter({name:e.name||"Imported Character",imageData:t,data:{spec:r,characterBook:e.character_book,extensions:e.extensions}})}async createCharacterFromExport(e){return await zt.createCharacter({name:e.name,imageData:e.imageData,data:e.data})}}const $L=new YL;class QL{async exportAsJSON(e){try{const t=this.characterToV3(e),r=JSON.stringify(t,null,2);return{success:!0,blob:new Blob([r],{type:"application/json"}),filename:`${this.sanitizeFilename(e.name)}.json`}}catch(t){return console.error("JSON export error:",t),{success:!1,error:t instanceof Error?t.message:"Error exporting character"}}}async exportAsV2(e){try{const t=this.characterToV2Full(e),r=JSON.stringify(t,null,2);return{success:!0,blob:new Blob([r],{type:"application/json"}),filename:`${this.sanitizeFilename(e.name)}_v2.json`}}catch(t){return console.error("V2 JSON export error:",t),{success:!1,error:t instanceof Error?t.message:"Error exporting character"}}}async exportAsPNG(e){try{if(!e.imageData)return{success:!1,error:"Character has no image. Please add an image before exporting as PNG."};const t=this.characterToV2Full(e),r=this.unicodeToBase64(JSON.stringify(t)),s=await(await this.dataURLToBlob(e.imageData)).arrayBuffer(),o=await this.embedCharaInPNG(s,r);return{success:!0,blob:new Blob([o],{type:"image/png"}),filename:`${this.sanitizeFilename(e.name)}.png`}}catch(t){return console.error("PNG export error:",t),{success:!1,error:t instanceof Error?t.message:"Error exporting character"}}}async exportAsCharacterVault(e){try{const t={...e,id:e.id,name:e.name,imageData:e.imageData,data:e.data,version:e.version,createdAt:e.createdAt,updatedAt:e.updatedAt,lastOpenedAt:e.lastOpenedAt},r=JSON.stringify(t,null,2);return{success:!0,blob:new Blob([r],{type:"application/json"}),filename:`${this.sanitizeFilename(e.name)}.charactervault.json`}}catch(t){return console.error("CharacterVault export error:",t),{success:!1,error:t instanceof Error?t.message:"Error exporting character"}}}characterToV3(e){return{spec:"chara_card_v3",spec_version:"3.0",data:this.characterDataToV2(e)}}characterToV2Full(e){return{spec:"chara_card_v2",spec_version:"2.0",data:this.characterDataToV2(e)}}characterDataToV2(e){const t=e.data.spec;return{name:this.normalizeCardName(t.name||e.name),description:t.description,personality:t.personality,scenario:t.scenario,first_mes:t.first_mes,mes_example:t.mes_example,system_prompt:t.system_prompt,post_history_instructions:t.post_history_instructions,alternate_greetings:t.alternate_greetings,character_book:e.data.characterBook,extensions:e.data.extensions||{},creator:t.creator||"",character_version:t.character_version||"1.0",tags:t.tags||[],creator_notes:t.creator_notes||"",avatar:t.avatar||""}}normalizeCardName(e){return Array.from(e).map(a=>{const s=a.charCodeAt(0);return s<32||s===127?" ":a}).join("").replace(/\s+/g," ").trim()||"Character"}async embedCharaInPNG(e,t){const r=new DataView(e);let a=0;const s=new Uint8Array(e,0,8),o=[137,80,78,71,13,10,26,10];for(let w=0;w<8;w++)if(s[w]!==o[w])throw new Error("Invalid PNG file signature");a=8;const c=[new Uint8Array(s)],h=this.createTextChunk("chara",t);let d=!1;for(;a<e.byteLength;){const w=r.getUint32(a),A=r.getUint32(a+4),E=new Uint8Array(e,a+8,w),j=new Uint8Array(e,a,12+w);if(this.isCardMetadataChunk(A,E)){a+=12+w;continue}if(c.push(j),A===1229472850&&!d&&(c.push(h),d=!0),A===1229278788)break;a+=12+w}const p=c.reduce((w,A)=>w+A.length,0),g=new Uint8Array(p);let k=0;for(const w of c)g.set(w,k),k+=w.length;return g.buffer}isCardMetadataChunk(e,t){return e===1950701684?this.isCardKeyword(this.readKeyword(t)):e===1767135348?this.isCardKeyword(this.readKeyword(t)):e===2052348020?this.isCardKeyword(this.readKeyword(t)):!1}isCardKeyword(e){const t=e.toLowerCase();return t==="chara"||t==="ccv3"}readKeyword(e){let t=e.length;for(let r=0;r<e.length;r++)if(e[r]===0){t=r;break}return new TextDecoder("utf-8").decode(e.slice(0,t))}createTextChunk(e,t){const r=new TextEncoder().encode(e),a=new TextEncoder().encode(t),s=new Uint8Array(r.length+1+a.length);s.set(r),s[r.length]=0,s.set(a,r.length+1);const o=new Uint8Array(12+s.length),c=new DataView(o.buffer);c.setUint32(0,s.length),o[4]=116,o[5]=69,o[6]=88,o[7]=116,o.set(s,8);const h=this.calculateCRC(o.slice(4,8+s.length));return c.setUint32(8+s.length,h),o}calculateCRC(e){const t=this.getCRCTable();let r=4294967295;for(let a=0;a<e.length;a++)r=t[(r^e[a])&255]^r>>>8;return(r^4294967295)>>>0}getCRCTable(){if(this.crcTable)return this.crcTable;const e=new Uint32Array(256);for(let t=0;t<256;t++){let r=t;for(let a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return this.crcTable=e,e}crcTable=null;async dataURLToBlob(e){return(await fetch(e)).blob()}sanitizeFilename(e){return e.replace(/[^a-z0-9]/gi,"_").toLowerCase()}unicodeToBase64(e){const t=new TextEncoder().encode(e);let r="";const a=t.byteLength;for(let s=0;s<a;s++)r+=String.fromCharCode(t[s]);return btoa(r)}}const sw=new QL;function ow(n){return typeof n=="string"?n:Array.isArray(n)?n.join(`
`):n==null?"":JSON.stringify(n,null,2)}function XL(n){return n.section==="image"}function WL(n,e){if(n===e)return n?[{text:n,changed:!1}]:[];if(!n)return[];if(!e)return[{text:n,changed:!0}];let t=0;for(;t<n.length&&t<e.length&&n[t]===e[t];)t+=1;let r=0;for(;r<n.length-t&&r<e.length-t&&n[n.length-1-r]===e[e.length-1-r];)r+=1;const a=n.slice(0,t),s=n.slice(t,n.length-r),o=r>0?n.slice(n.length-r):"";return[...a?[{text:a,changed:!1}]:[],...s?[{text:s,changed:!0}]:[],...o?[{text:o,changed:!1}]:[]]}function ZC(n,e){const t=n.split(`
`),r=e.split(`
`),a=Math.max(t.length,r.length),s=[];for(let o=0;o<a;o+=1){const c=t[o]??"",h=r[o]??"";s.push({value:c,compareValue:h,changed:c!==h})}return s}function ZL(n,e){return ZC(n,e).filter(t=>t.changed).length}function JL(n){return String(n+1).padStart(2,"0")}function eB({value:n,compareValue:e,tone:t}){const r=z.useMemo(()=>ZC(n,e),[e,n]),a=t==="snapshot"?"bg-rose-200/90 text-rose-950 dark:bg-rose-700/50 dark:text-rose-50":"bg-emerald-200/90 text-emerald-950 dark:bg-emerald-700/50 dark:text-emerald-50",s=t==="snapshot"?"border-l-2 border-rose-500 bg-rose-50/70 dark:bg-rose-950/20":"border-l-2 border-emerald-500 bg-emerald-50/70 dark:bg-emerald-950/20";return b.jsx("div",{className:"space-y-1 font-mono text-sm",children:r.length>0?r.map((o,c)=>{const h=WL(o.value,o.compareValue);return b.jsxs("div",{className:`grid grid-cols-[auto_1fr] gap-3 rounded-md px-2 py-1 ${o.changed?s:""}`,children:[b.jsx("span",{className:"select-none text-[11px] font-semibold tracking-wide text-vault-400 dark:text-vault-500",children:JL(c)}),b.jsx("pre",{className:"whitespace-pre-wrap break-words text-sm text-vault-800 dark:text-vault-200",children:h.length>0?h.map((d,p)=>b.jsx("span",{className:d.changed?`rounded px-0.5 ${a}`:void 0,children:d.text||" "},`${t}-${c}-${p}`)):b.jsx("span",{className:"text-vault-400 dark:text-vault-500",children:" "})})]},`${t}-${c}`)}):b.jsx("pre",{className:"text-sm text-vault-800 dark:text-vault-200",children:"Empty"})})}function uw({title:n,value:e,compareValue:t,tone:r}){const a=ow(e),s=ow(t),[o,c]=z.useState(!1),h=a.length>900||a.split(`
`).length>18,d=z.useMemo(()=>ZL(a,s),[s,a]),p=o||!h?a:a.split(`
`).slice(0,18).join(`
`),g=o||!h?s:s.split(`
`).slice(0,18).join(`
`);return b.jsxs("div",{className:"space-y-2",children:[b.jsxs("div",{className:"flex items-center justify-between gap-3",children:[b.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-vault-500 dark:text-vault-400",children:n}),b.jsxs("span",{className:`rounded-full px-2 py-1 text-[11px] font-semibold ${r==="snapshot"?"bg-rose-100 text-rose-800 dark:bg-rose-900/40 dark:text-rose-200":"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/40 dark:text-emerald-200"}`,children:[d," ",d===1?"line changed":"lines changed"]})]}),b.jsx("div",{className:"rounded-xl border border-vault-200 bg-white/90 p-3 dark:border-vault-700 dark:bg-vault-950/60",children:b.jsx(eB,{value:p,compareValue:g,tone:r})}),h&&b.jsx("button",{type:"button",onClick:()=>c(k=>!k),className:"text-xs font-medium text-vault-600 hover:text-vault-800 dark:text-vault-300 dark:hover:text-vault-100",children:o?"Show less":"Show more"})]})}function tB({isOpen:n,onClose:e}){const{currentCharacter:t,activeSection:r,snapshots:a,isSnapshotsLoading:s,restoreSnapshot:o,getSnapshotDiff:c}=Wo(),[h,d]=z.useState(null),[p,g]=z.useState(!1),[k,w]=z.useState("history"),[A,E]=z.useState({});z.useEffect(()=>{if(!n){d(null),w("history"),E({});return}d(L=>L&&a.some(me=>me.id===L)?L:a[0]?.id??null)},[n,a]),z.useEffect(()=>{E({})},[h]),z.useEffect(()=>{if(!n)return;const L=window.matchMedia("(max-width: 639px)"),me=()=>{L.matches?h||w("history"):w("diff")};return me(),L.addEventListener("change",me),()=>L.removeEventListener("change",me)},[n,h]),z.useEffect(()=>{if(!n)return;const L=me=>{me.key==="Escape"&&e()};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[n,e]);const j=z.useMemo(()=>a.find(L=>L.id===h)??null,[h,a]),D=z.useMemo(()=>j?c(j.id).filter(L=>L.changed):[],[c,j]),U=D.find(L=>L.section===r),O=D.length>0;if(!n||!t)return b.jsx(b.Fragment,{});const J=async L=>{if(!(!j||!window.confirm(L==="whole"?"Restore the entire card from this snapshot?":"Restore the current section from this snapshot?"))){g(!0);try{await o(j.id,L),e()}finally{g(!1)}}},ee=L=>{d(L),window.matchMedia("(max-width: 639px)").matches&&w("diff")},H=L=>{E(me=>({...me,[L]:!me[L]}))};return b.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/60 p-0 backdrop-blur-sm sm:items-center sm:p-4",onClick:e,children:b.jsxs("div",{className:"flex h-[92vh] w-full flex-col overflow-hidden rounded-t-3xl border border-vault-200 bg-white shadow-2xl dark:border-vault-800 dark:bg-vault-900 sm:h-[min(85vh,720px)] sm:max-w-7xl sm:rounded-3xl lg:flex-row",onClick:L=>L.stopPropagation(),children:[b.jsxs("div",{className:"grid grid-cols-2 gap-2 border-b border-vault-200 px-4 py-3 dark:border-vault-800 sm:hidden",children:[b.jsx("button",{type:"button",onClick:()=>w("history"),className:`rounded-xl px-4 py-2 text-sm font-medium transition-colors ${k==="history"?"bg-vault-700 text-white":"bg-vault-100 text-vault-700 dark:bg-vault-800 dark:text-vault-200"}`,children:"History"}),b.jsx("button",{type:"button",onClick:()=>w("diff"),className:`rounded-xl px-4 py-2 text-sm font-medium transition-colors ${k==="diff"?"bg-vault-700 text-white":"bg-vault-100 text-vault-700 dark:bg-vault-800 dark:text-vault-200"}`,children:"Diff"})]}),b.jsxs("aside",{className:`${k==="history"?"flex":"hidden"} min-h-0 w-full flex-col border-b border-vault-200 bg-vault-50/80 dark:border-vault-800 dark:bg-vault-950/70 sm:flex sm:max-h-[38vh] lg:max-h-none lg:max-w-sm lg:border-b-0 lg:border-r`,children:[b.jsxs("div",{className:"flex items-center justify-between border-b border-vault-200 px-5 py-4 dark:border-vault-800",children:[b.jsxs("div",{children:[b.jsx("h2",{className:"text-lg font-semibold text-vault-900 dark:text-vault-100",children:"Snapshot History"}),b.jsx("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:t.name})]}),b.jsx("button",{type:"button",onClick:e,className:"rounded-xl p-2 text-vault-500 transition-colors hover:bg-vault-100 hover:text-vault-800 dark:text-vault-400 dark:hover:bg-vault-800 dark:hover:text-vault-100",title:"Close history",children:b.jsx(za,{className:"h-5 w-5"})})]}),b.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:s?b.jsx("div",{className:"px-3 py-6 text-sm text-vault-500 dark:text-vault-400",children:"Loading snapshots..."}):a.length===0?b.jsx("div",{className:"px-3 py-6 text-sm text-vault-500 dark:text-vault-400",children:"No snapshots available."}):b.jsx("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-1",children:a.map(L=>{const me=L.id===h;return b.jsxs("button",{type:"button",onClick:()=>ee(L.id),className:`w-full rounded-2xl border p-3 text-left transition-colors ${me?"border-vault-500 bg-white shadow-sm dark:border-vault-400 dark:bg-vault-900":"border-vault-200 bg-white/70 hover:border-vault-300 dark:border-vault-800 dark:bg-vault-900/50 dark:hover:border-vault-700"}`,children:[b.jsxs("div",{className:"flex items-start justify-between gap-3",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-sm font-semibold text-vault-900 dark:text-vault-100",children:Tl.formatSnapshotSource(L.source)}),b.jsx("p",{className:"text-xs text-vault-500 dark:text-vault-400",children:Tl.describeSnapshotSource(L.source)})]}),b.jsx(F0,{className:"h-4 w-4 shrink-0 text-vault-400"})]}),b.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-vault-500 dark:text-vault-400",children:[b.jsx(mT,{className:"h-3.5 w-3.5"}),new Date(L.createdAt).toLocaleString()]})]},L.id)})})})]}),b.jsxs("section",{className:`${k==="diff"?"flex":"hidden"} min-h-0 min-w-0 flex-1 flex-col sm:flex`,children:[b.jsxs("div",{className:"flex flex-col gap-3 border-b border-vault-200 px-4 py-4 dark:border-vault-800 sm:px-5 lg:flex-row lg:items-center lg:justify-between",children:[b.jsxs("div",{children:[b.jsx("h3",{className:"text-lg font-semibold text-vault-900 dark:text-vault-100",children:"Snapshot Diff"}),b.jsx("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:"Comparing selected snapshot against the current card"})]}),b.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 lg:flex",children:[b.jsx("button",{type:"button",onClick:()=>{J("section")},disabled:!j||!U||p,className:"rounded-xl border border-vault-300 px-4 py-2 text-sm font-medium text-vault-700 transition-colors hover:bg-vault-100 disabled:cursor-not-allowed disabled:opacity-50 dark:border-vault-700 dark:text-vault-200 dark:hover:bg-vault-800",children:"Restore This Section"}),b.jsxs("button",{type:"button",onClick:()=>{J("whole")},disabled:!j||!O||p,className:"inline-flex items-center gap-2 rounded-xl bg-vault-700 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-vault-800 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-vault-100 dark:text-vault-900 dark:hover:bg-white",children:[b.jsx(vw,{className:"h-4 w-4"}),"Restore Whole Card"]})]})]}),b.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-5",children:j?D.length===0?b.jsx("div",{className:"text-sm text-vault-500 dark:text-vault-400",children:"This snapshot matches the current card."}):b.jsx("div",{className:"space-y-4",children:D.map(L=>b.jsxs("div",{className:"rounded-2xl border border-vault-200 bg-white/80 p-4 dark:border-vault-800 dark:bg-vault-950/40",children:[b.jsxs("div",{className:"mb-3 flex items-center justify-between gap-3",children:[b.jsxs("button",{type:"button",onClick:()=>H(L.section),className:"flex min-w-0 flex-1 items-center gap-3 text-left",children:[b.jsx(La,{className:`h-4 w-4 shrink-0 text-vault-500 transition-transform ${A[L.section]?"-rotate-90":"rotate-0"}`}),b.jsxs("div",{className:"min-w-0",children:[b.jsx("h4",{className:"font-semibold text-vault-900 dark:text-vault-100",children:L.label}),b.jsx("p",{className:"text-xs text-vault-500 dark:text-vault-400",children:L.section===r?"Current editor section":"Changed section"})]})]}),b.jsx("span",{className:"rounded-full bg-amber-100 px-2.5 py-1 text-xs font-semibold text-amber-800 dark:bg-amber-900/40 dark:text-amber-200",children:A[L.section]?"Collapsed":"Changed"})]}),!A[L.section]&&(XL(L)?b.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[b.jsxs("div",{className:"space-y-2",children:[b.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-vault-500 dark:text-vault-400",children:"Snapshot"}),b.jsx("div",{className:"flex min-h-48 items-center justify-center rounded-xl border border-vault-200 bg-vault-50 p-3 dark:border-vault-700 dark:bg-vault-950/60",children:typeof L.snapshotValue=="string"&&L.snapshotValue?b.jsx("img",{src:L.snapshotValue,alt:"Snapshot",className:"max-h-48 rounded-lg object-contain"}):b.jsx("span",{className:"text-sm text-vault-500 dark:text-vault-400",children:"No image"})})]}),b.jsxs("div",{className:"space-y-2",children:[b.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-vault-500 dark:text-vault-400",children:"Current"}),b.jsx("div",{className:"flex min-h-48 items-center justify-center rounded-xl border border-vault-200 bg-vault-50 p-3 dark:border-vault-700 dark:bg-vault-950/60",children:typeof L.currentValue=="string"&&L.currentValue?b.jsx("img",{src:L.currentValue,alt:"Current",className:"max-h-48 rounded-lg object-contain"}):b.jsx("span",{className:"text-sm text-vault-500 dark:text-vault-400",children:"No image"})})]})]}):b.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[b.jsx(uw,{title:"Snapshot",value:L.snapshotValue,compareValue:L.currentValue,tone:"snapshot"}),b.jsx(uw,{title:"Current",value:L.currentValue,compareValue:L.snapshotValue,tone:"current"})]}))]},L.section))}):b.jsx("div",{className:"text-sm text-vault-500 dark:text-vault-400",children:"Select a snapshot to inspect changes."})})]})]})})}function nB({toasts:n,onRemove:e}){return b.jsx("div",{className:"pointer-events-none fixed right-4 bottom-4 z-100 flex w-[min(24rem,calc(100vw-2rem))] flex-col gap-2",children:n.map(t=>b.jsxs("div",{className:`pointer-events-auto flex items-start gap-3 rounded-2xl border px-4 py-3 shadow-xl ring-1 ring-black/5 transition-all duration-300 animate-in slide-in-from-right backdrop-blur-sm ${t.type==="success"?"border-green-300 bg-green-100/95 text-green-950 dark:border-green-700 dark:bg-green-950/95 dark:text-green-100":"border-amber-300 bg-amber-100/95 text-amber-950 dark:border-amber-700 dark:bg-amber-950/95 dark:text-amber-100"}`,children:[b.jsx("div",{className:`mt-0.5 rounded-full p-1 ${t.type==="success"?"bg-green-200/90 text-green-800 dark:bg-green-900/80 dark:text-green-200":"bg-amber-200/90 text-amber-800 dark:bg-amber-900/80 dark:text-amber-200"}`,children:t.type==="success"?b.jsx(U0,{className:"h-3.5 w-3.5"}):b.jsx(Wi,{className:"h-3.5 w-3.5"})}),b.jsxs("div",{className:"min-w-0 flex-1",children:[b.jsx("p",{className:"text-sm font-semibold",children:t.type==="success"?"Snapshot":"Snapshot unchanged"}),b.jsx("p",{className:"text-sm opacity-90",children:t.message})]}),b.jsx("button",{type:"button",onClick:()=>e(t.id),className:"rounded p-1 hover:bg-black/5 dark:hover:bg-white/10",children:b.jsx(za,{className:"h-3.5 w-3.5"})})]},t.id))})}const _g={Image:K0,Type:Sw,FileText:Eo,User:G0,Map:PT,MessageCircle:Rg,MessagesSquare:VT,Terminal:zN,History:F0,Eye:kT,Puzzle:sN,Link:BT,NotebookPen:YT,UserCircle:dT,Tag:DN,Tags:RN,Book:q0};function rB({activeSection:n,onSectionChange:e}){const[t,r]=z.useState(!1),a=Ci.useRef(null),s=Ci.useRef(null),o=Ci.useRef(null);z.useEffect(()=>{const d=o.current;if(!d)return;const p=g=>{if(d.scrollWidth<=d.clientWidth)return;const k=Math.abs(g.deltaX)>Math.abs(g.deltaY)?g.deltaX:g.deltaY;k!==0&&(g.preventDefault(),d.scrollLeft+=k)};return d.addEventListener("wheel",p,{passive:!1}),()=>d.removeEventListener("wheel",p)},[]),z.useEffect(()=>{const d=p=>{const g=p.target,k=a.current?.contains(g),w=s.current?.contains(g);!k&&!w&&r(!1)};return t&&document.addEventListener("click",d),()=>document.removeEventListener("click",d)},[t]);const c=ws.find(d=>d.id===n),h=c&&_g[c.icon]||Eo;return b.jsxs("div",{className:"border-b border-vault-200 dark:border-vault-800 bg-white/60 dark:bg-vault-900/60 backdrop-blur-xl shrink-0",children:[b.jsx("div",{ref:o,className:"hidden md:flex items-center gap-1 px-4 py-2 overflow-x-auto scrollbar-thin",children:ws.map(d=>{const p=_g[d.icon]||Eo,g=n===d.id;return b.jsxs("button",{onClick:()=>e(d.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all whitespace-nowrap
                ${g?"bg-vault-600 text-white shadow-sm":"text-vault-600 dark:text-vault-400 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,children:[b.jsx(p,{className:"w-4 h-4"}),d.label]},d.id)})}),b.jsxs("div",{className:"md:hidden relative",ref:a,children:[b.jsxs("button",{onClick:()=>r(!t),className:"flex items-center justify-between w-full px-4 py-3 text-left hover:bg-vault-50 dark:hover:bg-vault-800/50 transition-colors",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx(h,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),b.jsx("span",{className:"font-medium text-vault-900 dark:text-vault-100",children:c?.label||"Select Section"})]}),b.jsx(La,{className:`w-4 h-4 text-vault-500 transition-transform ${t?"rotate-180":""}`})]}),t&&F4.createPortal(b.jsx("div",{ref:s,className:"fixed inset-x-0 top-26.25 z-9999 bg-white dark:bg-vault-900 border-b border-vault-200 dark:border-vault-800 shadow-lg max-h-[50vh] overflow-y-auto md:hidden",children:ws.map(d=>{const p=_g[d.icon]||Eo,g=n===d.id;return b.jsxs("button",{type:"button",onClick:k=>{k.preventDefault(),k.stopPropagation(),e(d.id),r(!1)},className:`flex items-center gap-2 w-full px-4 py-3 text-sm transition-colors
                    ${g?"bg-vault-100 dark:bg-vault-800 text-vault-900 dark:text-vault-100 font-medium":"text-vault-600 dark:text-vault-400 hover:bg-vault-50 dark:hover:bg-vault-800/50"}`,children:[b.jsx(p,{className:`w-4 h-4 ${g?"text-vault-600 dark:text-vault-400":""}`}),d.label]},d.id)})}),document.body)]})]})}function iB(){const{currentCharacter:n,updateCharacter:e}=Wo(),[t,r]=Ci.useState(!1),a=async d=>{if(!d.type.startsWith("image/")){alert("Please select an image file");return}const p=new FileReader;p.onload=g=>{const k=g.target?.result;n&&k&&e({imageData:k})},p.readAsDataURL(d)},s=d=>{d.preventDefault(),r(!1);const p=d.dataTransfer.files[0];p&&a(p)},o=d=>{d.preventDefault(),r(!0)},c=()=>{r(!1)},h=d=>{const p=d.target.files?.[0];p&&a(p)};return b.jsxs("div",{className:"space-y-6",children:[b.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:"Character Image"}),b.jsx("div",{className:"flex justify-center",children:n?.imageData?b.jsxs("div",{className:"relative group",children:[b.jsx("img",{src:n.imageData,alt:n.name,className:"w-96 h-96 max-w-full max-h-[60vh] object-contain rounded-2xl border-2 border-vault-200 dark:border-vault-700 shadow-lg"}),b.jsx("button",{onClick:()=>n&&void e({imageData:""}),className:`absolute top-2 right-2 p-2 bg-red-500 hover:bg-red-600 text-white rounded-lg\r
                opacity-0 group-hover:opacity-100 transition-opacity duration-200 shadow-lg`,children:b.jsx(_l,{className:"w-4 h-4"})})]}):b.jsxs("div",{onDrop:s,onDragOver:o,onDragLeave:c,className:`w-96 h-96 max-w-full max-h-[60vh] rounded-2xl border-2 border-dashed 
              ${t?"border-vault-500 bg-vault-100 dark:bg-vault-800/50":"border-vault-300 dark:border-vault-700 bg-vault-50 dark:bg-vault-900/30"}
              flex flex-col items-center justify-center gap-3 transition-colors duration-200`,children:[b.jsx(K0,{className:"w-16 h-16 text-vault-400 dark:text-vault-600"}),b.jsxs("p",{className:"text-sm text-vault-500 dark:text-vault-400 text-center px-4",children:["Drag and drop an image here",b.jsx("br",{}),"or click to browse"]})]})}),b.jsx("div",{className:"flex justify-center",children:b.jsxs("label",{className:"cursor-pointer",children:[b.jsx("input",{type:"file",accept:"image/*",onChange:h,className:"hidden"}),b.jsxs("span",{className:`inline-flex items-center gap-2 px-4 py-2 bg-vault-600 hover:bg-vault-700 \r
            text-white rounded-xl font-medium transition-colors duration-200 cursor-pointer`,children:[b.jsx(Rc,{className:"w-4 h-4"}),n?.imageData?"Change Image":"Upload Image"]})]})})]})}function aB({onOpenSettings:n,onOpenHistory:e,onCreateSnapshot:t,isContextOpen:r,isChatOpen:a,onToggleContext:s,onToggleChat:o,isMobile:c}){const{currentCharacter:h,closeCharacter:d}=Gc();if(!h)return b.jsx(b.Fragment,{});const p=async()=>{if(!h)return;const k=await sw.exportAsJSON(h);if(k.success&&k.blob){const w=URL.createObjectURL(k.blob),A=document.createElement("a");A.href=w,A.download=k.filename||`${h.name}.json`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(w)}else alert(k.error||"Failed to export character")},g=async()=>{if(!h)return;const k=await sw.exportAsPNG(h);if(k.success&&k.blob){const w=URL.createObjectURL(k.blob),A=document.createElement("a");A.href=w,A.download=k.filename||`${h.name}.png`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(w)}else alert(k.error||"Failed to export character")};return b.jsxs("header",{className:`h-16 flex items-center justify-between px-4 md:px-6\r
      bg-white/60 dark:bg-vault-900/60 backdrop-blur-xl\r
      border-b border-vault-200/60 dark:border-vault-800/50 shrink-0`,children:[b.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[b.jsx("button",{onClick:d,className:`p-2 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200\r
            hover:bg-vault-100 dark:hover:bg-vault-800/50 rounded-xl transition-all duration-200\r
            focus:outline-none focus:ring-2 focus:ring-vault-500 active:scale-95 shrink-0`,title:"Back to characters",children:b.jsx(W4,{className:"w-5 h-5"})}),b.jsxs("div",{className:"flex items-center gap-2 md:gap-3 min-w-0",children:[h.imageData?b.jsx("img",{src:h.imageData,alt:h.name,className:"w-8 h-8 md:w-10 md:h-10 rounded-lg object-cover border border-vault-200 dark:border-vault-700 shrink-0"}):b.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-vault-200 dark:bg-vault-800 flex items-center justify-center shrink-0",children:b.jsx(G0,{className:"w-4 h-4 md:w-5 md:h-5 text-vault-500 dark:text-vault-400"})}),b.jsxs("div",{className:"min-w-0",children:[b.jsx("h1",{className:"font-semibold text-vault-900 dark:text-vault-50 text-sm md:text-base truncate",children:h.name}),b.jsx("p",{className:"text-xs text-vault-500 dark:text-vault-400 hidden sm:block",children:"Editing character"})]})]})]}),b.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[c&&b.jsxs(b.Fragment,{children:[b.jsx("button",{onClick:s,className:`p-2 rounded-lg transition-colors ${r?"bg-vault-600 text-white":"text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,title:"Toggle AI Context Panel",children:b.jsx(Ba,{className:"w-4 h-4 md:w-5 md:h-5"})}),b.jsx("button",{onClick:o,className:`p-2 rounded-lg transition-colors ${a?"bg-vault-600 text-white":"text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,title:"Toggle Ask AI Panel",children:b.jsx(Do,{className:"w-4 h-4 md:w-5 md:h-5"})})]}),!c&&b.jsxs(b.Fragment,{children:[b.jsx("button",{onClick:s,className:`hidden lg:flex p-2 rounded-lg transition-colors ${r?"bg-vault-200 dark:bg-vault-700 text-vault-700 dark:text-vault-200":"text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,title:r?"Hide AI Context Panel":"Show AI Context Panel",children:b.jsx(WT,{className:"w-5 h-5"})}),b.jsx("button",{onClick:o,className:`hidden lg:flex p-2 rounded-lg transition-colors ${a?"bg-vault-200 dark:bg-vault-700 text-vault-700 dark:text-vault-200":"text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,title:a?"Hide Ask AI Panel":"Show Ask AI Panel",children:b.jsx(JT,{className:"w-5 h-5"})})]}),b.jsx("div",{className:"h-6 w-px bg-vault-200 dark:bg-vault-800 mx-1 hidden sm:block"}),b.jsxs("button",{onClick:e,className:`flex items-center gap-2 px-3 py-2 text-sm font-medium\r
            text-vault-700 dark:text-vault-300\r
            hover:bg-vault-100 dark:hover:bg-vault-800/50 rounded-xl\r
            transition-colors duration-200`,title:"Snapshot History",children:[b.jsx(F0,{className:"w-5 h-5"}),b.jsx("span",{className:"hidden md:inline",children:"Snapshot History"})]}),b.jsxs("button",{onClick:t,className:`hidden sm:flex items-center gap-2 px-3 py-2 text-sm font-medium\r
            text-vault-700 dark:text-vault-300\r
            hover:bg-vault-100 dark:hover:bg-vault-800/50 rounded-xl\r
            transition-colors duration-200`,children:[b.jsx(e1,{className:"w-4 h-4"}),b.jsx("span",{className:"hidden md:inline",children:"Create Snapshot"})]}),b.jsx("button",{onClick:t,className:`p-2 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200\r
            hover:bg-vault-100 dark:hover:bg-vault-800/50 rounded-xl transition-colors sm:hidden`,title:"Create Snapshot",children:b.jsx(e1,{className:"w-5 h-5"})}),b.jsx("button",{onClick:n,className:`p-2 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200\r
            hover:bg-vault-100 dark:hover:bg-vault-800/50 rounded-xl transition-colors`,title:"AI Settings",children:b.jsx(wN,{className:"w-5 h-5"})}),b.jsxs("button",{onClick:p,className:`hidden sm:flex items-center gap-2 px-3 py-2 text-sm font-medium\r
            text-vault-700 dark:text-vault-300\r
            hover:bg-vault-100 dark:hover:bg-vault-800/50 rounded-xl\r
            transition-colors duration-200`,children:[b.jsx(bw,{className:"w-4 h-4"}),b.jsx("span",{className:"hidden md:inline",children:"Export JSON"})]}),b.jsxs("button",{onClick:g,className:`flex items-center gap-2 px-3 py-2 text-sm font-medium\r
            bg-vault-600 hover:bg-vault-700 text-white rounded-xl\r
            transition-colors duration-200`,children:[b.jsx(yw,{className:"w-4 h-4"}),b.jsx("span",{className:"hidden md:inline",children:"Export PNG"})]})]})]})}function lB({isOpen:n,onClick:e}){return n?b.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-30 lg:hidden",onClick:e}):b.jsx(b.Fragment,{})}function sB(){const{currentCharacter:n}=Gc(),[e,t]=z.useState(!1),[r,a]=z.useState(!0),[s,o]=z.useState(!0),[c,h]=z.useState(!1);return z.useEffect(()=>{const d=()=>{const p=window.innerWidth<1024;h(p),p?(a(!1),o(!1)):(a(!0),o(!0))};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]),n?b.jsx(V4,{children:b.jsx(oB,{isSettingsOpen:e,setIsSettingsOpen:t,isContextOpen:r,isChatOpen:s,setIsContextOpen:a,setIsChatOpen:o,isMobile:c})}):b.jsx("div",{className:"h-screen w-full flex items-center justify-center",children:b.jsx("div",{className:"text-center",children:b.jsx("p",{className:"text-vault-500",children:"No character selected"})})})}function oB({isSettingsOpen:n,setIsSettingsOpen:e,isContextOpen:t,isChatOpen:r,setIsContextOpen:a,setIsChatOpen:s,isMobile:o}){const{activeSection:c,setActiveSection:h,selectedText:d,contextSectionIds:p,aiConfig:g,samplerSettings:k,promptSettings:w,isHistoryOpen:A,setIsHistoryOpen:E,createManualSnapshot:j,handleAIOperation:D,getContextContent:U}=Wo(),O=()=>a(!t),J=()=>s(!r),[ee,H]=z.useState([]),L=Ci.useRef([]),me=!o,he=me&&t&&r,I=me&&(!t||!r),te=()=>{o&&(a(!1),s(!1))},ne=re=>{H(X=>X.filter(ve=>ve.id!==re))},pe=(re,X)=>{const ve=Math.random().toString(36).slice(2);H(Ee=>[...Ee,{id:ve,type:re,message:X}]);const Te=window.setTimeout(()=>{H(Ee=>Ee.filter(q=>q.id!==ve))},3500);L.current.push(Te)};z.useEffect(()=>()=>{L.current.forEach(re=>window.clearTimeout(re)),L.current=[]},[]);const ge=async()=>{if(await j()==="created"){pe("success","Manual snapshot created.");return}pe("info","No changes since the latest snapshot.")};return b.jsxs("div",{className:`h-screen w-full flex flex-col bg-linear-to-br from-vault-50 via-vault-50 to-vault-100/50 \r
      dark:from-vault-950 dark:via-vault-950 dark:to-vault-900/50 overflow-hidden`,children:[b.jsx(aB,{onOpenSettings:()=>e(!0),onOpenHistory:()=>E(!0),onCreateSnapshot:()=>{ge()},isContextOpen:t,isChatOpen:r,onToggleContext:O,onToggleChat:J,isMobile:o}),b.jsx(lB,{isOpen:o&&(t||r),onClick:te}),b.jsx(rB,{activeSection:c,onSectionChange:h}),b.jsxs("div",{className:"flex-1 flex overflow-hidden relative",children:[b.jsx("aside",{className:`
            ${t&&o?"fixed inset-y-0 left-0 z-40 w-80 shadow-2xl translate-x-0":""}
            ${!t&&o?"fixed inset-y-0 left-0 z-40 w-80 shadow-2xl -translate-x-full":""}
            ${t&&!o?"lg:w-72 xl:w-80 translate-x-0":""}
            ${!t&&!o?"lg:w-0 lg:opacity-0 lg:overflow-hidden":""}
            transition-all duration-300 ease-in-out
            bg-vault-50 dark:bg-vault-900
            border-r border-vault-200 dark:border-vault-800
            flex flex-col
            shrink-0
          `,children:b.jsx(f_,{onClose:()=>a(!1),isMobile:o})}),b.jsx("main",{className:"flex-1 flex flex-col min-w-0 relative z-0 overflow-hidden",children:b.jsx("div",{className:`flex-1 min-h-0 ${he||I?"p-0":"p-3 md:p-4 lg:p-6"}`,children:b.jsx("div",{className:`h-full w-full bg-white/60 dark:bg-vault-900/60 backdrop-blur-xl
              border border-vault-200/60 dark:border-vault-800/50 shadow-lg overflow-hidden
              ${he?"rounded-none p-2 md:p-3 border-l-0 border-r-0":I?`rounded-none p-3 md:p-4 ${t?"":"border-l-0"} ${r?"":"border-r-0"}`:"rounded-2xl p-4 md:p-6"}`,children:c==="image"?b.jsx(iB,{}):b.jsx(h_,{section:c})})})}),b.jsx("aside",{className:`
            ${r&&o?"fixed inset-y-0 right-0 z-40 w-80 shadow-2xl translate-x-0":""}
            ${!r&&o?"fixed inset-y-0 right-0 z-40 w-80 shadow-2xl translate-x-full":""}
            ${r&&!o?"lg:w-80 xl:w-96 translate-x-0":""}
            ${!r&&!o?"lg:w-0 lg:opacity-0 lg:overflow-hidden":""}
            transition-all duration-300 ease-in-out
            bg-vault-50 dark:bg-vault-900
            border-l border-vault-200 dark:border-vault-800
            flex flex-col
            shrink-0
          `,children:b.jsx(UL,{selectedText:d,contextEntryIds:p,aiConfig:g,samplerSettings:k,promptSettings:w,onComplete:re=>D(re,"ask",d),getContextContent:async re=>U(re),activeSection:c,onClose:()=>s(!1),isMobile:o})})]}),b.jsx(GL,{isOpen:n,onClose:()=>e(!1)}),b.jsx(tB,{isOpen:A,onClose:()=>E(!1)}),b.jsx(nB,{toasts:ee,onRemove:ne})]})}function uB(){return b.jsx(sB,{})}const qf=[{id:0,title:"Welcome to CharacterVault",subtitle:"Your distraction-free character card workshop",description:"CharacterVault is your all-in-one workspace for creating, editing, and managing character spec cards. Built for SillyTavern and compatible platforms  supporting both V2 and V3 card formats out of the box.",features:[{icon:Bg,label:"Your Library",detail:"Manage your entire character collection in one place, stored locally in your browser"},{icon:t1,label:"Full-Featured Editor",detail:"Section-based editing with dedicated tabs for every card field"},{icon:Ba,label:"AI-Powered Tools",detail:"Built-in AI toolbar and chat assistant to help craft your characters"}],accentIcon:Zf},{id:1,title:"Import or Create",subtitle:"Start with what you have  or from scratch",description:'Bring in your existing character cards or start fresh. CharacterVault reads V2 and V3 PNG cards with embedded metadata, as well as raw JSON files. Click "Import" in the header or the "+ New" button to get started.',features:[{icon:Rc,label:"Import Cards",detail:"Import PNG cards with embedded data or raw JSON character files"},{icon:Zo,label:"Create New",detail:"Start fresh with a blank character template and build from scratch"},{icon:Eo,label:"V2 & V3 Support",detail:"Full compatibility with both character card specifications"}],accentIcon:Rc},{id:2,title:"Edit Your Character",subtitle:"Every field organized in dedicated sections",description:"Navigate through tabs for each part of your character card. Every section has a focused CodeMirror editor with search & replace so you can work without distractions.",features:[{icon:Sw,label:"Core Sections",detail:"Name, Description, Personality, Scenario, First Message, Example Messages, System Prompt, and more"},{icon:K0,label:"Image",detail:"Upload or drag & drop your character's portrait image directly"},{icon:q0,label:"Lorebook",detail:"Built-in lorebook editor  manage entries with trigger keys, priority, position, and AI-assisted content"}],accentIcon:t1},{id:3,title:"AI Writing Tools",subtitle:"Your editing suite, supercharged",description:"Select any text in the editor to reveal the AI toolbar. Use one-click operations to transform your writing, or give custom instructions. All AI results stream in real-time and can be accepted or rejected.",features:[{icon:$N,label:"Enhance & Rephrase",detail:"Expand your text with more depth, or rephrase for better clarity and flow"},{icon:QT,label:"Style Polish",detail:"Make text more Vivid, add Emotion, Shorten, Lengthen, or Fix Grammar  all one click"},{icon:Cw,label:"Custom Instructions",detail:"Type any instruction and the AI applies it to your selected text"}],accentIcon:Ba},{id:4,title:"Zoggy & Export",subtitle:"Chat with your AI assistant  and ship your cards",description:"Zoggy is CharacterVault's built-in chat assistant. Add sections to the AI Context panel so Zoggy can read your card and give tailored advice. When you're done, export as PNG with embedded data or raw JSON.",features:[{icon:Rg,label:"Ask Zoggy",detail:"Chat about best practices, get help writing sections, or brainstorm character ideas"},{icon:mN,label:"AI Context",detail:"Pin card sections to context so the AI has full awareness of your character"},{icon:yw,label:"Export",detail:"Save as a PNG with embedded card data, or export the raw JSON file"}],accentIcon:Rg},{id:5,title:"You're All Set!",subtitle:"Start building your characters",description:"That's everything you need to know. Your characters are stored locally in your browser  private and always available. You can replay this tutorial anytime by clicking the help icon in the header bar.",features:[{icon:Lg,label:"Get Started",detail:"Create your first character or import an existing card"},{icon:Zf,label:"Replay Tutorial",detail:"Click the help icon (?) in the header bar anytime"},{icon:Bg,label:"Your Data, Your Control",detail:"Everything stays local in your browser  no servers, no sign-up required"}],accentIcon:Lg}],Hy="charactervault-tutorial-completed";function Oc({onComplete:n}){const[e,t]=z.useState(0),[r,a]=z.useState("next"),[s,o]=z.useState(!1),[c,h]=z.useState(!1);z.useEffect(()=>{const O=setTimeout(()=>h(!0),50);return()=>clearTimeout(O)},[]);const d=qf[e],p=e===0,g=e===qf.length-1,k=z.useCallback((O,J)=>{s||(o(!0),a(J),setTimeout(()=>{t(O),o(!1)},250))},[s]),w=z.useCallback(()=>{g||k(e+1,"next")},[e,g,k]),A=z.useCallback(()=>{p||k(e-1,"prev")},[e,p,k]),E=z.useCallback(()=>{localStorage.setItem(Hy,"true"),h(!1),setTimeout(n,400)},[n]),j=z.useCallback(()=>{E()},[E]);z.useEffect(()=>{const O=J=>{(J.key==="ArrowRight"||J.key==="Enter")&&(g?E():w()),J.key==="ArrowLeft"&&A(),J.key==="Escape"&&j()};return window.addEventListener("keydown",O),()=>window.removeEventListener("keydown",O)},[w,A,E,j,g]);const D=d.accentIcon,U=s?r==="next"?"tutorial-step-exiting-next":"tutorial-step-exiting-prev":"tutorial-step-entering";return b.jsxs("div",{className:`fixed inset-0 z-100 flex items-center justify-center transition-all duration-500
        ${c?"opacity-100":"opacity-0 pointer-events-none"}`,children:[b.jsx("div",{className:"absolute inset-0 bg-vault-950/80 dark:bg-black/85 tutorial-backdrop",onClick:j}),b.jsxs("div",{className:`relative z-10 w-full max-w-2xl mx-4 transition-all duration-500 ease-out
          ${c?"scale-100 translate-y-0 opacity-100":"scale-95 translate-y-8 opacity-0"}`,children:[!g&&b.jsxs("button",{onClick:j,className:`absolute -top-10 sm:-top-12 right-0 flex items-center gap-1.5 px-3 py-1.5 text-xs sm:text-sm font-medium\r
              text-vault-400 hover:text-white transition-colors rounded-lg hover:bg-white/10`,children:[b.jsx("span",{children:"Skip tutorial"}),b.jsx(za,{className:"w-3.5 h-3.5"})]}),b.jsxs("div",{className:"bg-white dark:bg-vault-900 rounded-2xl shadow-2xl border border-vault-200 dark:border-vault-800 overflow-hidden tutorial-card-enter",children:[b.jsxs("div",{className:"relative px-5 pt-6 pb-4 sm:px-8 sm:pt-8 sm:pb-6 overflow-hidden",children:[b.jsx("div",{className:"absolute -top-2 -right-1 w-24 h-24 sm:w-40 sm:h-40 opacity-[0.06] dark:opacity-[0.08] tutorial-float rotate-15 pointer-events-none",style:{animationDelay:"1.2s"},children:b.jsx(D,{className:"w-full h-full",strokeWidth:1.5})}),b.jsx("div",{className:"absolute inset-0 tutorial-shimmer pointer-events-none"}),b.jsxs("div",{className:"flex items-center gap-1.5 mb-6 relative",children:[qf.map((O,J)=>b.jsx("div",{className:`h-1.5 rounded-full tutorial-dot
                    ${J===e?"w-8 bg-vault-900 dark:bg-vault-100":J<e?"w-3 bg-vault-400 dark:bg-vault-500":"w-3 bg-vault-200 dark:bg-vault-700"}`},J)),b.jsxs("span",{className:"ml-auto text-xs font-medium text-vault-400 dark:text-vault-500 tabular-nums",children:[e+1," / ",qf.length]})]}),b.jsxs("div",{className:`tutorial-step-content ${U}`,children:[b.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-vault-400 dark:text-vault-500 mb-2",children:d.subtitle}),b.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-vault-900 dark:text-vault-50 tracking-tight",children:d.title})]})]}),b.jsx("div",{className:"px-5 pb-5 sm:px-8 sm:pb-6",children:b.jsxs("div",{className:`tutorial-step-content ${U}`,children:[b.jsx("p",{className:"text-vault-600 dark:text-vault-400 text-[15px] leading-relaxed mb-6",children:d.description}),b.jsx("div",{className:"grid gap-3",children:d.features.map((O,J)=>{const ee=O.icon;return b.jsxs("div",{className:`tutorial-feature-card group flex items-start gap-3 sm:gap-4 p-3 sm:p-4 rounded-xl\r
                        bg-vault-50 dark:bg-vault-800/60\r
                        border border-vault-100 dark:border-vault-800\r
                        hover:border-vault-300 dark:hover:border-vault-600`,style:{opacity:s?0:1,transform:s?"translateY(8px)":"translateY(0)"},children:[b.jsx("div",{className:`shrink-0 p-2.5 rounded-lg bg-vault-200/70 dark:bg-vault-700/50\r
                        group-hover:bg-vault-900 dark:group-hover:bg-vault-100\r
                        transition-colors duration-200`,children:b.jsx(ee,{className:`w-4 h-4 text-vault-600 dark:text-vault-300\r
                          group-hover:text-white dark:group-hover:text-vault-900\r
                          transition-colors duration-200`})}),b.jsxs("div",{className:"min-w-0",children:[b.jsx("h4",{className:"text-sm font-semibold text-vault-900 dark:text-vault-100 mb-0.5",children:O.label}),b.jsx("p",{className:"text-xs text-vault-500 dark:text-vault-400 leading-relaxed",children:O.detail})]})]},`${d.id}-${J}`)})})]})}),b.jsxs("div",{className:"px-5 py-4 sm:px-8 sm:py-5 border-t border-vault-100 dark:border-vault-800 bg-vault-50/50 dark:bg-vault-800/30 flex items-center justify-between",children:[b.jsxs("button",{onClick:A,disabled:p,className:`flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200
                ${p?"text-vault-300 dark:text-vault-700 cursor-not-allowed":"text-vault-600 dark:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-800 active:scale-95"}`,children:[b.jsx(aT,{className:"w-4 h-4"}),"Back"]}),b.jsx("button",{onClick:g?E:w,className:`flex items-center gap-2 px-6 py-2.5 text-sm font-semibold rounded-lg\r
                bg-vault-900 dark:bg-vault-100 text-white dark:text-vault-900\r
                hover:opacity-90 active:scale-95\r
                shadow-sm hover:shadow-md transition-all duration-200`,children:g?b.jsxs(b.Fragment,{children:["Get Started",b.jsx(Lg,{className:"w-4 h-4"})]}):b.jsxs(b.Fragment,{children:["Next",b.jsx(sT,{className:"w-4 h-4"})]})})]})]})]})]})}Oc.isCompleted=()=>localStorage.getItem(Hy)==="true";Oc.reset=()=>{localStorage.removeItem(Hy)};const cB="./CharacterVaultLogo.svg",Dg=({icon:n,onClick:e,title:t,variant:r="ghost",className:a="",type:s="button"})=>{const o="p-2 rounded-lg transition-all duration-200 active:scale-95",c={ghost:"text-vault-500 hover:text-vault-900 dark:text-vault-400 dark:hover:text-vault-100 hover:bg-vault-100 dark:hover:bg-vault-800",primary:"bg-vault-900 dark:bg-vault-50 text-white dark:text-vault-900 hover:opacity-90 shadow-sm",danger:"text-vault-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20"};return b.jsx("button",{type:s,onClick:e,title:t,className:`${o} ${c[r]} ${a}`,children:b.jsx(n,{className:"w-4 h-4"})})};function hB({character:n,onOpen:e,onDuplicate:t,onDelete:r}){const a=s=>{if(!s)return"New";const o=new Date().getTime()-new Date(s).getTime(),c=Math.floor(o/(1e3*60*60*24));return c===0?"Today":c===1?"Yesterday":`${c}d ago`};return b.jsxs("div",{className:`group relative flex flex-col bg-white dark:bg-vault-900 rounded-xl border border-vault-200 dark:border-vault-800 \r
      hover:border-vault-300 dark:hover:border-vault-700 shadow-xs hover:shadow-lg\r
      transition-all duration-300 overflow-hidden cursor-pointer`,onClick:()=>e(n.id),children:[b.jsxs("div",{className:"relative aspect-3/4 w-full overflow-hidden bg-vault-100 dark:bg-vault-800",children:[n.imageData?b.jsx("img",{src:n.imageData,alt:n.name,className:"w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105 will-change-transform",loading:"lazy"}):b.jsx("div",{className:"flex items-center justify-center w-full h-full text-vault-300 dark:text-vault-700",children:b.jsx(G0,{className:"w-16 h-16"})}),b.jsx("div",{className:"absolute inset-0 bg-linear-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),b.jsxs("div",{className:`absolute top-2 right-2 flex gap-1 transition-all duration-200 \r
          opacity-100 translate-y-0 \r
          sm:opacity-0 sm:-translate-y-2 \r
          sm:group-hover:opacity-100 sm:group-hover:translate-y-0`,children:[b.jsx("button",{onClick:s=>{s.stopPropagation(),t(n.id,n.name)},className:"p-1.5 bg-white/90 dark:bg-vault-900/90 backdrop-blur-sm rounded-md text-vault-600 dark:text-vault-300 hover:text-vault-900 hover:bg-white shadow-sm",title:"Duplicate",children:b.jsx(V0,{className:"w-3.5 h-3.5"})}),b.jsx("button",{onClick:s=>{s.stopPropagation(),r(n.id,n.name)},className:"p-1.5 bg-white/90 dark:bg-vault-900/90 backdrop-blur-sm rounded-md text-red-500 hover:text-red-600 hover:bg-white shadow-sm",title:"Delete",children:b.jsx(_l,{className:"w-3.5 h-3.5"})})]})]}),b.jsxs("div",{className:"p-4 flex flex-col gap-1",children:[b.jsx("div",{className:"flex items-start justify-between gap-2",children:b.jsx("h3",{className:"font-semibold text-vault-900 dark:text-vault-50 truncate text-sm leading-tight",children:n.name})}),b.jsx("div",{className:"flex items-center justify-between mt-2",children:b.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-vault-500 dark:text-vault-400",children:[b.jsx(yT,{className:"w-3 h-3"}),b.jsx("span",{children:a(n.lastOpenedAt)})]})})]})]})}function fB({onReplayTutorial:n}){const{characters:e,isLoading:t,createCharacter:r,openCharacter:a,deleteCharacter:s,duplicateCharacter:o,refreshCharacters:c}=Gc(),[h,d]=z.useState(""),[p,g]=z.useState(!1),[k,w]=z.useState(""),[A,E]=z.useState(null),[j,D]=z.useState(null),U=z.useRef(null),O=()=>typeof window<"u"&&window.innerWidth<640?12:18,[J,ee]=z.useState(O);z.useEffect(()=>{const Ee=setTimeout(()=>{ee(O())},0);return()=>clearTimeout(Ee)},[h]);const[H,L]=Ci.useState(()=>typeof document>"u"?!0:document.documentElement.classList.contains("dark")),me=()=>{const Ee=!H;L(Ee),document.documentElement.classList.toggle("dark",Ee),localStorage.setItem("theme",Ee?"dark":"light")},he=z.useMemo(()=>{let Ee=[...e];return h&&(Ee=Ee.filter(q=>q.name.toLowerCase().includes(h.toLowerCase()))),Ee.sort((q,ye)=>{const Ce=q.lastOpenedAt?new Date(q.lastOpenedAt).getTime():0;return(ye.lastOpenedAt?new Date(ye.lastOpenedAt).getTime():0)-Ce})},[e,h]),I=he[0],te=async Ee=>{if(Ee.preventDefault(),!!k.trim())try{await r({name:k.trim()}),w(""),g(!1)}catch{alert("Failed to create character")}},ne=async Ee=>{const q=Ee.target.files?.[0];if(q){try{const ye=await $L.importFromFile(q);ye.success&&ye.character?await c():alert(ye.error)}catch{alert("Import failed")}Ee.target.value=""}},pe=(Ee,q)=>{E({id:Ee,name:q})},ge=async()=>{A&&(await s(A.id),E(null))},re=()=>{E(null)},X=(Ee,q)=>{D({id:Ee,name:q})},ve=async()=>{j&&(await o(j.id,`${j.name} (Copy)`),D(null))},Te=()=>{D(null)};return b.jsxs("div",{className:"h-screen overflow-y-auto bg-vault-50 dark:bg-vault-950 text-vault-900 dark:text-vault-100 transition-colors duration-500 animate-fade-in-slow",children:[b.jsx("header",{className:"sticky top-0 z-30 w-full backdrop-blur-xl bg-white/80 dark:bg-vault-950/80 border-b border-vault-200 dark:border-vault-800",children:b.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between gap-4",children:[b.jsx("div",{className:"flex items-center gap-2",children:b.jsx("img",{src:cB,alt:"Character Vault Logo",className:"shrink-0 h-8 w-auto sm:h-10 md:h-12 lg:h-14 transition-[filter] dark:grayscale"})}),b.jsx("div",{className:"flex-1 max-w-md hidden sm:block",children:b.jsxs("div",{className:"relative group",children:[b.jsx(Jf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-vault-400 group-focus-within:text-vault-600 dark:group-focus-within:text-vault-300 transition-colors"}),b.jsx("input",{type:"text",placeholder:"Search characters...",value:h,onChange:Ee=>d(Ee.target.value),className:"w-full bg-vault-100 dark:bg-vault-900 border border-transparent focus:bg-white dark:focus:bg-vault-800 focus:border-vault-300 dark:focus:border-vault-700 rounded-full py-1.5 pl-9 pr-4 text-sm transition-all outline-none"})]})}),b.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[b.jsx("input",{ref:U,type:"file",accept:".png,.json,image/png,application/json",onChange:ne,className:"hidden"}),b.jsxs("button",{onClick:()=>U.current?.click(),className:"hidden sm:flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-vault-600 dark:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-colors",children:[b.jsx(Rc,{className:"w-4 h-4"}),"Import"]}),b.jsx("button",{onClick:()=>U.current?.click(),className:"sm:hidden p-2 text-vault-600 dark:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-colors",title:"Import",children:b.jsx(Rc,{className:"w-4 h-4"})}),b.jsx("div",{className:"h-6 w-px bg-vault-200 dark:bg-vault-800 mx-1 hidden sm:block"}),b.jsx(Dg,{icon:H?jN:KT,onClick:me,title:"Toggle Theme"}),b.jsx(Dg,{icon:hT,onClick:n,title:"Replay Tutorial"}),b.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-vault-900 dark:bg-vault-700 text-white dark:text-vault-100 text-sm font-medium rounded-lg hover:opacity-90 transition-opacity ml-2",children:[b.jsx(Zo,{className:"w-4 h-4"}),b.jsx("span",{className:"hidden sm:inline",children:"New"})]})]})]})}),b.jsx("div",{className:"sm:hidden px-4 pt-3",children:b.jsxs("div",{className:"relative group",children:[b.jsx(Jf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-vault-400 group-focus-within:text-vault-600 dark:group-focus-within:text-vault-300 transition-colors"}),b.jsx("input",{type:"text",placeholder:"Search characters...",value:h,onChange:Ee=>d(Ee.target.value),className:"w-full bg-vault-100 dark:bg-vault-900 border border-transparent focus:bg-white dark:focus:bg-vault-800 focus:border-vault-300 dark:focus:border-vault-700 rounded-full py-2 pl-9 pr-4 text-sm transition-all outline-none"})]})}),b.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[p&&b.jsx("div",{className:"mb-8 animate-in fade-in slide-in-from-top-2",children:b.jsxs("form",{onSubmit:te,className:"bg-white dark:bg-vault-900 p-4 rounded-2xl border border-vault-200 dark:border-vault-800 shadow-lg max-w-lg mx-auto flex gap-2 items-center",children:[b.jsx("input",{autoFocus:!0,type:"text",placeholder:"Character Name...",value:k,onChange:Ee=>w(Ee.target.value),className:"flex-1 bg-transparent border-none focus:ring-0 text-lg font-medium placeholder:text-vault-300 dark:placeholder:text-vault-700"}),b.jsxs("div",{className:"flex gap-2",children:[b.jsx(Dg,{icon:za,onClick:()=>g(!1),title:"Cancel"}),b.jsx("button",{type:"submit",disabled:!k.trim(),className:"px-4 py-2 bg-vault-900 dark:bg-vault-50 text-white dark:text-vault-900 rounded-lg text-sm font-medium disabled:opacity-50",children:"Create"})]})]})}),e.length>0&&!h&&b.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center justify-between gap-4 mb-8",children:[b.jsxs("div",{children:[b.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Library"}),b.jsxs("p",{className:"text-vault-500 dark:text-vault-400 text-sm mt-1",children:[e.length," ",e.length===1?"character":"characters"," stored locally"]})]}),I&&b.jsxs("button",{onClick:()=>a(I.id),className:"group flex items-center gap-3 pl-4 pr-3 py-2 bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-800 rounded-full hover:border-vault-300 dark:hover:border-vault-700 hover:shadow-md transition-all",children:[b.jsxs("div",{className:"text-right",children:[b.jsx("p",{className:"text-[10px] font-bold text-vault-400 uppercase tracking-wider",children:"Continue"}),b.jsx("p",{className:"text-sm font-semibold max-w-37.5 truncate",children:I.name})]}),b.jsx("div",{className:"w-8 h-8 rounded-full bg-vault-100 dark:bg-vault-800 flex items-center justify-center group-hover:bg-vault-900 group-hover:text-white dark:group-hover:bg-vault-50 dark:group-hover:text-vault-900 transition-colors",children:b.jsx(iN,{className:"w-4 h-4 fill-current"})})]})]}),t?b.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6",children:[...Array(5)].map((Ee,q)=>b.jsx("div",{className:"aspect-3/4 rounded-xl bg-vault-100 dark:bg-vault-800/50 animate-pulse"},q))}):he.length===0?b.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center",children:[b.jsx("div",{className:"w-24 h-24 bg-vault-100 dark:bg-vault-900 rounded-full flex items-center justify-center mb-6",children:b.jsx(Bg,{className:"w-10 h-10 text-vault-300 dark:text-vault-700"})}),b.jsx("h3",{className:"text-lg font-medium",children:"No characters found"}),b.jsx("p",{className:"text-vault-500 dark:text-vault-400 mt-2 mb-8 max-w-sm",children:h?`No results for "${h}"`:"Get started by creating a new character or importing a card."}),!h&&b.jsx("button",{onClick:()=>U.current?.click(),className:"px-6 py-2.5 border border-vault-300 dark:border-vault-700 rounded-xl hover:bg-vault-50 dark:hover:bg-vault-900 transition-colors font-medium",children:"Import Card"})]}):b.jsxs(b.Fragment,{children:[b.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 sm:gap-6",children:he.slice(0,J).map(Ee=>b.jsx(hB,{character:Ee,onOpen:a,onDuplicate:X,onDelete:pe},Ee.id))}),J<he.length&&b.jsx("div",{className:"flex justify-center pt-8 pb-20",children:b.jsxs("button",{onClick:()=>ee(Ee=>Ee+O()),className:"group flex items-center gap-2 px-8 py-3 bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-800 rounded-full hover:border-vault-400 dark:hover:border-vault-600 hover:shadow-md transition-all text-sm font-medium text-vault-600 dark:text-vault-300",children:["Load More",b.jsxs("span",{className:"text-xs text-vault-400 dark:text-vault-500",children:["(",he.length-J," remaining)"]})]})}),J>=he.length&&b.jsx("div",{className:"pb-20"})]})]}),A&&b.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 dark:bg-black/70 backdrop-blur-sm animate-in fade-in",children:b.jsxs("div",{className:"bg-white dark:bg-vault-900 rounded-2xl shadow-2xl max-w-sm w-full p-6 animate-in zoom-in-95",children:[b.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[b.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-full",children:b.jsx(_l,{className:"w-6 h-6 text-red-500"})}),b.jsx("h3",{className:"text-lg font-semibold text-vault-900 dark:text-vault-100",children:"Delete Character?"})]}),b.jsxs("p",{className:"text-vault-600 dark:text-vault-400 mb-6",children:["Are you sure you want to delete ",b.jsx("span",{className:"font-medium text-vault-900 dark:text-vault-100",children:A.name}),"? This action cannot be undone."]}),b.jsxs("div",{className:"flex gap-3 justify-end",children:[b.jsx("button",{onClick:re,className:"px-4 py-2 text-sm font-medium text-vault-600 dark:text-vault-400 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-colors",children:"Cancel"}),b.jsx("button",{onClick:ge,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Delete"})]})]})}),j&&b.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 dark:bg-black/70 backdrop-blur-sm animate-in fade-in",children:b.jsxs("div",{className:"bg-white dark:bg-vault-900 rounded-2xl shadow-2xl max-w-sm w-full p-6 animate-in zoom-in-95",children:[b.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[b.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full",children:b.jsx(V0,{className:"w-6 h-6 text-blue-500"})}),b.jsx("h3",{className:"text-lg font-semibold text-vault-900 dark:text-vault-100",children:"Copy Character?"})]}),b.jsxs("p",{className:"text-vault-600 dark:text-vault-400 mb-6",children:["Are you sure you want to create a copy of ",b.jsx("span",{className:"font-medium text-vault-900 dark:text-vault-100",children:j.name}),"?"]}),b.jsxs("div",{className:"flex gap-3 justify-end",children:[b.jsx("button",{onClick:Te,className:"px-4 py-2 text-sm font-medium text-vault-600 dark:text-vault-400 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-colors",children:"Cancel"}),b.jsx("button",{onClick:ve,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"Copy"})]})]})})]})}function dB(){const{isCharacterOpen:n}=Gc(),[e,t]=z.useState(()=>!(Oc.isCompleted?.()??!1)),r=z.useCallback(()=>{t(!1)},[]),a=z.useCallback(()=>{Oc.reset?.(),t(!0)},[]);return b.jsxs(b.Fragment,{children:[e&&b.jsx(Oc,{onComplete:r}),n?b.jsx(uB,{}):b.jsx(fB,{onReplayTutorial:a})]})}function pB(){return b.jsx(H4,{children:b.jsx(dB,{})})}const JC=document.getElementById("root");if(!JC)throw new Error("Root element not found");C4.createRoot(JC).render(b.jsx(z.StrictMode,{children:b.jsx(pB,{})}));
//# sourceMappingURL=index-DSvbynAc.js.map
