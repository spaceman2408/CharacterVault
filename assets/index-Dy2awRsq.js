import{r as Vk,g as vd,a as Kk,c as UA}from"./ui-C6Febm84.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(l){if(l.ep)return;l.ep=!0;const s=t(l);fetch(l.href,s)}})();var Rm={exports:{}},tc={};var Mb;function FA(){if(Mb)return tc;Mb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,l,s){var o=null;if(s!==void 0&&(o=""+s),l.key!==void 0&&(o=""+l.key),"key"in l){s={};for(var c in l)c!=="key"&&(s[c]=l[c])}else s=l;return l=s.ref,{$$typeof:n,type:r,key:o,ref:l!==void 0?l:null,props:s}}return tc.Fragment=e,tc.jsx=t,tc.jsxs=t,tc}var _b;function VA(){return _b||(_b=1,Rm.exports=FA()),Rm.exports}var k=VA(),$=Vk();const Zi=vd($);var Bm={exports:{}},nc={},Lm={exports:{}},zm={};var Db;function KA(){return Db||(Db=1,(function(n){function e(q,le){var Ae=q.length;q.push(le);e:for(;0<Ae;){var Se=Ae-1>>>1,B=q[Se];if(0<l(B,le))q[Se]=le,q[Ae]=B,Ae=Se;else break e}}function t(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var le=q[0],Ae=q.pop();if(Ae!==le){q[0]=Ae;e:for(var Se=0,B=q.length,Pe=B>>>1;Se<Pe;){var qe=2*(Se+1)-1,R=q[qe],je=qe+1,Ee=q[je];if(0>l(R,Ae))je<B&&0>l(Ee,R)?(q[Se]=Ee,q[je]=Ae,Se=je):(q[Se]=R,q[qe]=Ae,Se=qe);else if(je<B&&0>l(Ee,Ae))q[Se]=Ee,q[je]=Ae,Se=je;else break e}}return le}function l(q,le){var Ae=q.sortIndex-le.sortIndex;return Ae!==0?Ae:q.id-le.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var h=[],d=[],p=1,g=null,b=3,w=!1,T=!1,N=!1,D=!1,j=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function ce(q){for(var le=t(d);le!==null;){if(le.callback===null)r(d);else if(le.startTime<=q)r(d),le.sortIndex=le.expirationTime,e(h,le);else break;le=t(d)}}function F(q){if(N=!1,ce(q),!T)if(t(h)!==null)T=!0,z||(z=!0,fe());else{var le=t(d);le!==null&&J(F,le.startTime-q)}}var z=!1,ee=-1,ye=5,Ce=-1;function P(){return D?!0:!(n.unstable_now()-Ce<ye)}function pe(){if(D=!1,z){var q=n.unstable_now();Ce=q;var le=!0;try{e:{T=!1,N&&(N=!1,U(ee),ee=-1),w=!0;var Ae=b;try{t:{for(ce(q),g=t(h);g!==null&&!(g.expirationTime>q&&P());){var Se=g.callback;if(typeof Se=="function"){g.callback=null,b=g.priorityLevel;var B=Se(g.expirationTime<=q);if(q=n.unstable_now(),typeof B=="function"){g.callback=B,ce(q),le=!0;break t}g===t(h)&&r(h),ce(q)}else r(h);g=t(h)}if(g!==null)le=!0;else{var Pe=t(d);Pe!==null&&J(F,Pe.startTime-q),le=!1}}break e}finally{g=null,b=Ae,w=!1}le=void 0}}finally{le?fe():z=!1}}}var fe;if(typeof I=="function")fe=function(){I(pe)};else if(typeof MessageChannel<"u"){var De=new MessageChannel,ke=De.port2;De.port1.onmessage=pe,fe=function(){ke.postMessage(null)}}else fe=function(){j(pe,0)};function J(q,le){ee=j(function(){q(n.unstable_now())},le)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ye=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(q){switch(b){case 1:case 2:case 3:var le=3;break;default:le=b}var Ae=b;b=le;try{return q()}finally{b=Ae}},n.unstable_requestPaint=function(){D=!0},n.unstable_runWithPriority=function(q,le){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Ae=b;b=q;try{return le()}finally{b=Ae}},n.unstable_scheduleCallback=function(q,le,Ae){var Se=n.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?Se+Ae:Se):Ae=Se,q){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Ae+B,q={id:p++,callback:le,priorityLevel:q,startTime:Ae,expirationTime:B,sortIndex:-1},Ae>Se?(q.sortIndex=Ae,e(d,q),t(h)===null&&q===t(d)&&(N?(U(ee),ee=-1):N=!0,J(F,Ae-Se))):(q.sortIndex=B,e(h,q),T||w||(T=!0,z||(z=!0,fe()))),q},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(q){var le=b;return function(){var Ae=b;b=le;try{return q.apply(this,arguments)}finally{b=Ae}}}})(zm)),zm}var jb;function GA(){return jb||(jb=1,Lm.exports=KA()),Lm.exports}var Ob;function YA(){if(Ob)return nc;Ob=1;var n=GA(),e=Vk(),t=Kk();function r(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var a=i,u=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(u=a.return),i=a.return;while(i)}return a.tag===3?u:null}function o(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function c(i){if(i.tag===31){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function h(i){if(s(i)!==i)throw Error(r(188))}function d(i){var a=i.alternate;if(!a){if(a=s(i),a===null)throw Error(r(188));return a!==i?null:i}for(var u=i,f=a;;){var y=u.return;if(y===null)break;var x=y.alternate;if(x===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===x.child){for(x=y.child;x;){if(x===u)return h(y),i;if(x===f)return h(y),a;x=x.sibling}throw Error(r(188))}if(u.return!==f.return)u=y,f=x;else{for(var A=!1,_=y.child;_;){if(_===u){A=!0,u=y,f=x;break}if(_===f){A=!0,f=y,u=x;break}_=_.sibling}if(!A){for(_=x.child;_;){if(_===u){A=!0,u=x,f=y;break}if(_===f){A=!0,f=x,u=y;break}_=_.sibling}if(!A)throw Error(r(189))}}if(u.alternate!==f)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?i:a}function p(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=p(i),a!==null)return a;i=i.sibling}return null}var g=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),I=Symbol.for("react.context"),ce=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),Ce=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),pe=Symbol.iterator;function fe(i){return i===null||typeof i!="object"?null:(i=pe&&i[pe]||i["@@iterator"],typeof i=="function"?i:null)}var De=Symbol.for("react.client.reference");function ke(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===De?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case N:return"Fragment";case j:return"Profiler";case D:return"StrictMode";case F:return"Suspense";case z:return"SuspenseList";case Ce:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case T:return"Portal";case I:return i.displayName||"Context";case U:return(i._context.displayName||"Context")+".Consumer";case ce:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ee:return a=i.displayName||null,a!==null?a:ke(i.type)||"Memo";case ye:a=i._payload,i=i._init;try{return ke(i(a))}catch{}}return null}var J=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae={pending:!1,data:null,method:null,action:null},Se=[],B=-1;function Pe(i){return{current:i}}function qe(i){0>B||(i.current=Se[B],Se[B]=null,B--)}function R(i,a){B++,Se[B]=i.current,i.current=a}var je=Pe(null),Ee=Pe(null),Ke=Pe(null),$e=Pe(null);function ft(i,a){switch(R(Ke,a),R(Ee,i),R(je,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?Zv(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=Zv(a),i=Jv(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}qe(je),R(je,i)}function et(){qe(je),qe(Ee),qe(Ke)}function ve(i){i.memoizedState!==null&&R($e,i);var a=je.current,u=Jv(a,i.type);a!==u&&(R(Ee,i),R(je,u))}function gt(i){Ee.current===i&&(qe(je),qe(Ee)),$e.current===i&&(qe($e),Wu._currentValue=Ae)}var nt,Gt;function yn(i){if(nt===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);nt=a&&a[1]||"",Gt=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+nt+i+Gt}var wt=!1;function dn(i,a){if(!i||wt)return"";wt=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(a){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(de){var he=de}Reflect.construct(i,[],we)}else{try{we.call()}catch(de){he=de}i.call(we.prototype)}}else{try{throw Error()}catch(de){he=de}(we=i())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(de){if(de&&he&&typeof de.stack=="string")return[de.stack,he.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),A=x[0],_=x[1];if(A&&_){var H=A.split(`
`),se=_.split(`
`);for(y=f=0;f<H.length&&!H[f].includes("DetermineComponentFrameRoot");)f++;for(;y<se.length&&!se[y].includes("DetermineComponentFrameRoot");)y++;if(f===H.length||y===se.length)for(f=H.length-1,y=se.length-1;1<=f&&0<=y&&H[f]!==se[y];)y--;for(;1<=f&&0<=y;f--,y--)if(H[f]!==se[y]){if(f!==1||y!==1)do if(f--,y--,0>y||H[f]!==se[y]){var ge=`
`+H[f].replace(" at new "," at ");return i.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",i.displayName)),ge}while(1<=f&&0<=y);break}}}finally{wt=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?yn(u):""}function Ye(i,a){switch(i.tag){case 26:case 27:case 5:return yn(i.type);case 16:return yn("Lazy");case 13:return i.child!==a&&a!==null?yn("Suspense Fallback"):yn("Suspense");case 19:return yn("SuspenseList");case 0:case 15:return dn(i.type,!1);case 11:return dn(i.type.render,!1);case 1:return dn(i.type,!0);case 31:return yn("Activity");default:return""}}function He(i){try{var a="",u=null;do a+=Ye(i,u),u=i,i=i.return;while(i);return a}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var at=Object.prototype.hasOwnProperty,be=n.unstable_scheduleCallback,Ge=n.unstable_cancelCallback,zt=n.unstable_shouldYield,Jt=n.unstable_requestPaint,Yt=n.unstable_now,vt=n.unstable_getCurrentPriorityLevel,ue=n.unstable_ImmediatePriority,Ne=n.unstable_UserBlockingPriority,rt=n.unstable_NormalPriority,pt=n.unstable_LowPriority,Dt=n.unstable_IdlePriority,Fn=n.log,Qn=n.unstable_setDisableYieldValue,Mn=null,mn=null;function gn(i){if(typeof Fn=="function"&&Qn(i),mn&&typeof mn.setStrictMode=="function")try{mn.setStrictMode(Mn,i)}catch{}}var Le=Math.clz32?Math.clz32:Ts,kr=Math.log,In=Math.LN2;function Ts(i){return i>>>=0,i===0?32:31-(kr(i)/In|0)|0}var Ue=256,Ll=262144,La=4194304;function pi(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function za(i,a,u){var f=i.pendingLanes;if(f===0)return 0;var y=0,x=i.suspendedLanes,A=i.pingedLanes;i=i.warmLanes;var _=f&134217727;return _!==0?(f=_&~x,f!==0?y=pi(f):(A&=_,A!==0?y=pi(A):u||(u=_&~i,u!==0&&(y=pi(u))))):(_=f&~x,_!==0?y=pi(_):A!==0?y=pi(A):u||(u=f&~i,u!==0&&(y=pi(u)))),y===0?0:a!==0&&a!==y&&(a&x)===0&&(x=y&-y,u=a&-a,x>=u||x===32&&(u&4194048)!==0)?a:y}function nl(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function qd(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qc(){var i=La;return La<<=1,(La&62914560)===0&&(La=4194304),i}function Ei(i){for(var a=[],u=0;31>u;u++)a.push(i);return a}function Gr(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function tu(i,a,u,f,y,x){var A=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var _=i.entanglements,H=i.expirationTimes,se=i.hiddenUpdates;for(u=A&~u;0<u;){var ge=31-Le(u),we=1<<ge;_[ge]=0,H[ge]=-1;var he=se[ge];if(he!==null)for(se[ge]=null,ge=0;ge<he.length;ge++){var de=he[ge];de!==null&&(de.lane&=-536870913)}u&=~we}f!==0&&Ia(i,f,0),x!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=x&~(A&~a))}function Ia(i,a,u){i.pendingLanes|=a,i.suspendedLanes&=~a;var f=31-Le(a);i.entangledLanes|=a,i.entanglements[f]=i.entanglements[f]|1073741824|u&261930}function en(i,a){var u=i.entangledLanes|=a;for(i=i.entanglements;u;){var f=31-Le(u),y=1<<f;y&a|i[f]&a&&(i[f]|=a),u&=~y}}function bn(i,a){var u=a&-a;return u=(u&42)!==0?1:nu(u),(u&(i.suspendedLanes|a))!==0?0:u}function nu(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function zl(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Pa(){var i=le.p;return i!==0?i:(i=window.event,i===void 0?32:wb(i.type))}function Ha(i,a){var u=le.p;try{return le.p=i,a()}finally{le.p=u}}var Ni=Math.random().toString(36).slice(2),ln="__reactFiber$"+Ni,kn="__reactProps$"+Ni,mr="__reactContainer$"+Ni,Il="__reactEvents$"+Ni,Ud="__reactListeners$"+Ni,Mi="__reactHandles$"+Ni,ru="__reactResources$"+Ni,jr="__reactMarker$"+Ni;function Es(i){delete i[ln],delete i[kn],delete i[Il],delete i[Ud],delete i[Mi]}function _i(i){var a=i[ln];if(a)return a;for(var u=i.parentNode;u;){if(a=u[mr]||u[ln]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(i=ab(i);i!==null;){if(u=i[ln])return u;i=ab(i)}return a}i=u,u=i.parentNode}return null}function Qt(i){if(i=i[ln]||i[mr]){var a=i.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return i}return null}function Or(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(r(33))}function ar(i){var a=i[ru];return a||(a=i[ru]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function wn(i){i[jr]=!0}var rl=new Set,qa={};function mi(i,a){Di(i,a),Di(i+"Capture",a)}function Di(i,a){for(qa[i]=a,i=0;i<a.length;i++)rl.add(a[i])}var il=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),iu={},Ua={};function Xc(i){return at.call(Ua,i)?!0:at.call(iu,i)?!1:il.test(i)?Ua[i]=!0:(iu[i]=!0,!1)}function bt(i,a,u){if(Xc(a))if(u===null)i.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var f=a.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+u)}}function Fa(i,a,u){if(u===null)i.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+u)}}function Yr(i,a,u,f){if(f===null)i.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(a,u,""+f)}}function Xn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Pl(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function $c(i,a,u){var f=Object.getOwnPropertyDescriptor(i.constructor.prototype,a);if(!i.hasOwnProperty(a)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var y=f.get,x=f.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return y.call(this)},set:function(A){u=""+A,x.call(this,A)}}),Object.defineProperty(i,a,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(A){u=""+A},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function Ns(i){if(!i._valueTracker){var a=Pl(i)?"checked":"value";i._valueTracker=$c(i,a,""+i[a])}}function lu(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var u=a.getValue(),f="";return i&&(f=Pl(i)?i.checked?"true":"false":i.value),i=f,i!==u?(a.setValue(i),!0):!1}function It(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Va=/[\n"\\]/g;function Vn(i){return i.replace(Va,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ji(i,a,u,f,y,x,A,_){i.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.type=A:i.removeAttribute("type"),a!=null?A==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+Xn(a)):i.value!==""+Xn(a)&&(i.value=""+Xn(a)):A!=="submit"&&A!=="reset"||i.removeAttribute("value"),a!=null?Ka(i,A,Xn(a)):u!=null?Ka(i,A,Xn(u)):f!=null&&i.removeAttribute("value"),y==null&&x!=null&&(i.defaultChecked=!!x),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?i.name=""+Xn(_):i.removeAttribute("name")}function Ms(i,a,u,f,y,x,A,_){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.type=x),a!=null||u!=null){if(!(x!=="submit"&&x!=="reset"||a!=null)){Ns(i);return}u=u!=null?""+Xn(u):"",a=a!=null?""+Xn(a):u,_||a===i.value||(i.value=a),i.defaultValue=a}f=f??y,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=_?i.checked:!!f,i.defaultChecked=!!f,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.name=A),Ns(i)}function Ka(i,a,u){a==="number"&&It(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function gi(i,a,u,f){if(i=i.options,a){a={};for(var y=0;y<u.length;y++)a["$"+u[y]]=!0;for(u=0;u<i.length;u++)y=a.hasOwnProperty("$"+i[u].value),i[u].selected!==y&&(i[u].selected=y),y&&f&&(i[u].defaultSelected=!0)}else{for(u=""+Xn(u),a=null,y=0;y<i.length;y++){if(i[y].value===u){i[y].selected=!0,f&&(i[y].defaultSelected=!0);return}a!==null||i[y].disabled||(a=i[y])}a!==null&&(a.selected=!0)}}function au(i,a,u){if(a!=null&&(a=""+Xn(a),a!==i.value&&(i.value=a),u==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=u!=null?""+Xn(u):""}function Ga(i,a,u,f){if(a==null){if(f!=null){if(u!=null)throw Error(r(92));if(J(f)){if(1<f.length)throw Error(r(93));f=f[0]}u=f}u==null&&(u=""),a=u}u=Xn(a),i.defaultValue=u,f=i.textContent,f===u&&f!==""&&f!==null&&(i.value=f),Ns(i)}function ll(i,a){if(a){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=a;return}}i.textContent=a}var Fd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mt(i,a,u){var f=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":f?i.setProperty(a,u):typeof u!="number"||u===0||Fd.has(a)?a==="float"?i.cssFloat=u:i[a]=(""+u).trim():i[a]=u+"px"}function su(i,a,u){if(a!=null&&typeof a!="object")throw Error(r(62));if(i=i.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||a!=null&&a.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var y in a)f=a[y],a.hasOwnProperty(y)&&u[y]!==f&&Mt(i,y,f)}else for(var x in a)a.hasOwnProperty(x)&&Mt(i,x,a[x])}function ou(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),gr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yi(i){return gr.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function wr(){}var Qr=null;function _s(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var al=null,on=null;function Rr(i){var a=Qt(i);if(a&&(i=a.stateNode)){var u=i[kn]||null;e:switch(i=a.stateNode,a.type){case"input":if(ji(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Vn(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var f=u[a];if(f!==i&&f.form===i.form){var y=f[kn]||null;if(!y)throw Error(r(90));ji(f,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(a=0;a<u.length;a++)f=u[a],f.form===i.form&&lu(f)}break e;case"textarea":au(i,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&gi(i,!!u.multiple,a,!1)}}}var sl=!1;function Hl(i,a,u){if(sl)return i(a,u);sl=!0;try{var f=i(a);return f}finally{if(sl=!1,(al!==null||on!==null)&&(Ph(),al&&(a=al,i=on,on=al=null,Rr(a),i)))for(a=0;a<i.length;a++)Rr(i[a])}}function ol(i,a){var u=i.stateNode;if(u===null)return null;var f=u[kn]||null;if(f===null)return null;u=f[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(r(231,a,typeof u));return u}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uu=!1;if(Kn)try{var sr={};Object.defineProperty(sr,"passive",{get:function(){uu=!0}}),window.addEventListener("test",sr,sr),window.removeEventListener("test",sr,sr)}catch{uu=!1}var Xr=null,Ds=null,ql=null;function Ul(){if(ql)return ql;var i,a=Ds,u=a.length,f,y="value"in Xr?Xr.value:Xr.textContent,x=y.length;for(i=0;i<u&&a[i]===y[i];i++);var A=u-i;for(f=1;f<=A&&a[u-f]===y[x-f];f++);return ql=y.slice(i,1<f?1-f:void 0)}function Fl(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function Ya(){return!0}function Wc(){return!1}function _n(i){function a(u,f,y,x,A){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=x,this.target=A,this.currentTarget=null;for(var _ in i)i.hasOwnProperty(_)&&(u=i[_],this[_]=u?u(x):x[_]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Ya:Wc,this.isPropagationStopped=Wc,this}return g(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ya)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ya)},persist:function(){},isPersistent:Ya}),a}var ul={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},js=_n(ul),Oi=g({},ul,{view:0,detail:0}),Os=_n(Oi),Qa,cu,Xa,Rs=g({},Oi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cl,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Xa&&(Xa&&i.type==="mousemove"?(Qa=i.screenX-Xa.screenX,cu=i.screenY-Xa.screenY):cu=Qa=0,Xa=i),Qa)},movementY:function(i){return"movementY"in i?i.movementY:cu}}),Bs=_n(Rs),hu=g({},Rs,{dataTransfer:0}),Zc=_n(hu),Ls=g({},Oi,{relatedTarget:0}),Vl=_n(Ls),zs=g({},ul,{animationName:0,elapsedTime:0,pseudoElement:0}),Jc=_n(zs),Kd=g({},ul,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Kl=_n(Kd),fu=g({},ul,{data:0}),Is=_n(fu),du={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $a(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=Gn[i])?!!a[i]:!1}function cl(){return $a}var eh=g({},Oi,{key:function(i){if(i.key){var a=du[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=Fl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?pu[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cl,charCode:function(i){return i.type==="keypress"?Fl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Fl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Ps=_n(eh),th=g({},Rs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mu=_n(th),Hs=g({},Oi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cl}),gu=_n(Hs),hl=g({},ul,{propertyName:0,elapsedTime:0,pseudoElement:0}),yu=_n(hl),xu=g({},Rs,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),qs=_n(xu),vu=g({},ul,{newState:0,oldState:0}),nh=_n(vu),Gd=[9,13,27,32],Wa=Kn&&"CompositionEvent"in window,Ri=null;Kn&&"documentMode"in document&&(Ri=document.documentMode);var Yd=Kn&&"TextEvent"in window&&!Ri,Us=Kn&&(!Wa||Ri&&8<Ri&&11>=Ri),Fs=" ",rh=!1;function bu(i,a){switch(i){case"keyup":return Gd.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ih(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var fl=!1;function lh(i,a){switch(i){case"compositionend":return ih(a);case"keypress":return a.which!==32?null:(rh=!0,Fs);case"textInput":return i=a.data,i===Fs&&rh?null:i;default:return null}}function Qd(i,a){if(fl)return i==="compositionend"||!Wa&&bu(i,a)?(i=Ul(),ql=Ds=Xr=null,fl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Us&&a.locale!=="ko"?null:a.data;default:return null}}var ah={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vs(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!ah[i.type]:a==="textarea"}function ku(i,a,u,f){al?on?on.push(f):on=[f]:al=f,a=Gh(a,"onChange"),0<a.length&&(u=new js("onChange","change",null,u,f),i.push({event:u,listeners:a}))}var Gl=null,Za=null;function Xd(i){Gv(i,0)}function Ks(i){var a=Or(i);if(lu(a))return i}function Ja(i,a){if(i==="change")return a}var $r=!1;if(Kn){var un;if(Kn){var Yl="oninput"in document;if(!Yl){var dl=document.createElement("div");dl.setAttribute("oninput","return;"),Yl=typeof dl.oninput=="function"}un=Yl}else un=!1;$r=un&&(!document.documentMode||9<document.documentMode)}function sh(){Gl&&(Gl.detachEvent("onpropertychange",Gs),Za=Gl=null)}function Gs(i){if(i.propertyName==="value"&&Ks(Za)){var a=[];ku(a,Za,i,_s(i)),Hl(Xd,a)}}function oh(i,a,u){i==="focusin"?(sh(),Gl=a,Za=u,Gl.attachEvent("onpropertychange",Gs)):i==="focusout"&&sh()}function pl(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ks(Za)}function wu(i,a){if(i==="click")return Ks(a)}function Ql(i,a){if(i==="input"||i==="change")return Ks(a)}function Bi(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var or=typeof Object.is=="function"?Object.is:Bi;function m(i,a){if(or(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var u=Object.keys(i),f=Object.keys(a);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!at.call(a,y)||!or(i[y],a[y]))return!1}return!0}function v(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function S(i,a){var u=v(i);i=0;for(var f;u;){if(u.nodeType===3){if(f=i+u.textContent.length,i<=a&&f>=a)return{node:u,offset:a-i};i=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=v(u)}}function C(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?C(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function E(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=It(i.document);a instanceof i.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)i=a.contentWindow;else break;a=It(i.document)}return a}function M(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var O=Kn&&"documentMode"in document&&11>=document.documentMode,L=null,K=null,ne=null,G=!1;function V(i,a,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;G||L==null||L!==It(f)||(f=L,"selectionStart"in f&&M(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ne&&m(ne,f)||(ne=f,f=Gh(K,"onSelect"),0<f.length&&(a=new js("onSelect","select",null,a,u),i.push({event:a,listeners:f}),a.target=L)))}function X(i,a){var u={};return u[i.toLowerCase()]=a.toLowerCase(),u["Webkit"+i]="webkit"+a,u["Moz"+i]="moz"+a,u}var Z={animationend:X("Animation","AnimationEnd"),animationiteration:X("Animation","AnimationIteration"),animationstart:X("Animation","AnimationStart"),transitionrun:X("Transition","TransitionRun"),transitionstart:X("Transition","TransitionStart"),transitioncancel:X("Transition","TransitionCancel"),transitionend:X("Transition","TransitionEnd")},Y={},Q={};Kn&&(Q=document.createElement("div").style,"AnimationEvent"in window||(delete Z.animationend.animation,delete Z.animationiteration.animation,delete Z.animationstart.animation),"TransitionEvent"in window||delete Z.transitionend.transition);function ie(i){if(Y[i])return Y[i];if(!Z[i])return i;var a=Z[i],u;for(u in a)if(a.hasOwnProperty(u)&&u in Q)return Y[i]=a[u];return i}var oe=ie("animationend"),re=ie("animationiteration"),me=ie("animationstart"),Te=ie("transitionrun"),ze=ie("transitionstart"),Ie=ie("transitioncancel"),Me=ie("transitionend"),Qe=new Map,Ve="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ve.push("scrollEnd");function _e(i,a){Qe.set(i,a),mi(a,[i])}var Xe=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},ht=[],kt=0,it=0;function dt(){for(var i=kt,a=it=kt=0;a<i;){var u=ht[a];ht[a++]=null;var f=ht[a];ht[a++]=null;var y=ht[a];ht[a++]=null;var x=ht[a];if(ht[a++]=null,f!==null&&y!==null){var A=f.pending;A===null?y.next=y:(y.next=A.next,A.next=y),f.pending=y}x!==0&&Li(u,y,x)}}function Xt(i,a,u,f){ht[kt++]=i,ht[kt++]=a,ht[kt++]=u,ht[kt++]=f,it|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function ur(i,a,u,f){return Xt(i,a,u,f),Xl(i)}function qt(i,a){return Xt(i,null,null,a),Xl(i)}function Li(i,a,u){i.lanes|=u;var f=i.alternate;f!==null&&(f.lanes|=u);for(var y=!1,x=i.return;x!==null;)x.childLanes|=u,f=x.alternate,f!==null&&(f.childLanes|=u),x.tag===22&&(i=x.stateNode,i===null||i._visibility&1||(y=!0)),i=x,x=x.return;return i.tag===3?(x=i.stateNode,y&&a!==null&&(y=31-Le(u),i=x.hiddenUpdates,f=i[y],f===null?i[y]=[a]:f.push(a),a.lane=u|536870912),x):null}function Xl(i){if(50<Vu)throw Vu=0,im=null,Error(r(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var Ys={};function AC(i,a,u,f){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Br(i,a,u,f){return new AC(i,a,u,f)}function $d(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ml(i,a){var u=i.alternate;return u===null?(u=Br(i.tag,a,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=a,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&65011712,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,a=i.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function Ny(i,a){i.flags&=65011714;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,a=u.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function uh(i,a,u,f,y,x){var A=0;if(f=i,typeof i=="function")$d(i)&&(A=1);else if(typeof i=="string")A=_A(i,u,je.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case Ce:return i=Br(31,u,a,y),i.elementType=Ce,i.lanes=x,i;case N:return es(u.children,y,x,a);case D:A=8,y|=24;break;case j:return i=Br(12,u,a,y|2),i.elementType=j,i.lanes=x,i;case F:return i=Br(13,u,a,y),i.elementType=F,i.lanes=x,i;case z:return i=Br(19,u,a,y),i.elementType=z,i.lanes=x,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case I:A=10;break e;case U:A=9;break e;case ce:A=11;break e;case ee:A=14;break e;case ye:A=16,f=null;break e}A=29,u=Error(r(130,i===null?"null":typeof i,"")),f=null}return a=Br(A,u,a,y),a.elementType=i,a.type=f,a.lanes=x,a}function es(i,a,u,f){return i=Br(7,i,f,a),i.lanes=u,i}function Wd(i,a,u){return i=Br(6,i,null,a),i.lanes=u,i}function My(i){var a=Br(18,null,null,0);return a.stateNode=i,a}function Zd(i,a,u){return a=Br(4,i.children!==null?i.children:[],i.key,a),a.lanes=u,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var _y=new WeakMap;function Wr(i,a){if(typeof i=="object"&&i!==null){var u=_y.get(i);return u!==void 0?u:(a={value:i,source:a,stack:He(a)},_y.set(i,a),a)}return{value:i,source:a,stack:He(a)}}var Qs=[],Xs=0,ch=null,Su=0,Zr=[],Jr=0,$l=null,zi=1,Ii="";function gl(i,a){Qs[Xs++]=Su,Qs[Xs++]=ch,ch=i,Su=a}function Dy(i,a,u){Zr[Jr++]=zi,Zr[Jr++]=Ii,Zr[Jr++]=$l,$l=i;var f=zi;i=Ii;var y=32-Le(f)-1;f&=~(1<<y),u+=1;var x=32-Le(a)+y;if(30<x){var A=y-y%5;x=(f&(1<<A)-1).toString(32),f>>=A,y-=A,zi=1<<32-Le(a)+y|u<<y|f,Ii=x+i}else zi=1<<x|u<<y|f,Ii=i}function Jd(i){i.return!==null&&(gl(i,1),Dy(i,1,0))}function ep(i){for(;i===ch;)ch=Qs[--Xs],Qs[Xs]=null,Su=Qs[--Xs],Qs[Xs]=null;for(;i===$l;)$l=Zr[--Jr],Zr[Jr]=null,Ii=Zr[--Jr],Zr[Jr]=null,zi=Zr[--Jr],Zr[Jr]=null}function jy(i,a){Zr[Jr++]=zi,Zr[Jr++]=Ii,Zr[Jr++]=$l,zi=a.id,Ii=a.overflow,$l=i}var $n=null,cn=null,_t=!1,Wl=null,ei=!1,tp=Error(r(519));function Zl(i){var a=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Cu(Wr(a,i)),tp}function Oy(i){var a=i.stateNode,u=i.type,f=i.memoizedProps;switch(a[ln]=i,a[kn]=f,u){case"dialog":Ct("cancel",a),Ct("close",a);break;case"iframe":case"object":case"embed":Ct("load",a);break;case"video":case"audio":for(u=0;u<Gu.length;u++)Ct(Gu[u],a);break;case"source":Ct("error",a);break;case"img":case"image":case"link":Ct("error",a),Ct("load",a);break;case"details":Ct("toggle",a);break;case"input":Ct("invalid",a),Ms(a,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ct("invalid",a);break;case"textarea":Ct("invalid",a),Ga(a,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||f.suppressHydrationWarning===!0||$v(a.textContent,u)?(f.popover!=null&&(Ct("beforetoggle",a),Ct("toggle",a)),f.onScroll!=null&&Ct("scroll",a),f.onScrollEnd!=null&&Ct("scrollend",a),f.onClick!=null&&(a.onclick=wr),a=!0):a=!1,a||Zl(i,!0)}function Ry(i){for($n=i.return;$n;)switch($n.tag){case 5:case 31:case 13:ei=!1;return;case 27:case 3:ei=!0;return;default:$n=$n.return}}function $s(i){if(i!==$n)return!1;if(!_t)return Ry(i),_t=!0,!1;var a=i.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||vm(i.type,i.memoizedProps)),u=!u),u&&cn&&Zl(i),Ry(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));cn=lb(i)}else if(a===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));cn=lb(i)}else a===27?(a=cn,fa(i.type)?(i=Cm,Cm=null,cn=i):cn=a):cn=$n?ni(i.stateNode.nextSibling):null;return!0}function ts(){cn=$n=null,_t=!1}function np(){var i=Wl;return i!==null&&(Tr===null?Tr=i:Tr.push.apply(Tr,i),Wl=null),i}function Cu(i){Wl===null?Wl=[i]:Wl.push(i)}var rp=Pe(null),ns=null,yl=null;function Jl(i,a,u){R(rp,a._currentValue),a._currentValue=u}function xl(i){i._currentValue=rp.current,qe(rp)}function ip(i,a,u){for(;i!==null;){var f=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,f!==null&&(f.childLanes|=a)):f!==null&&(f.childLanes&a)!==a&&(f.childLanes|=a),i===u)break;i=i.return}}function lp(i,a,u,f){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var x=y.dependencies;if(x!==null){var A=y.child;x=x.firstContext;e:for(;x!==null;){var _=x;x=y;for(var H=0;H<a.length;H++)if(_.context===a[H]){x.lanes|=u,_=x.alternate,_!==null&&(_.lanes|=u),ip(x.return,u,i),f||(A=null);break e}x=_.next}}else if(y.tag===18){if(A=y.return,A===null)throw Error(r(341));A.lanes|=u,x=A.alternate,x!==null&&(x.lanes|=u),ip(A,u,i),A=null}else A=y.child;if(A!==null)A.return=y;else for(A=y;A!==null;){if(A===i){A=null;break}if(y=A.sibling,y!==null){y.return=A.return,A=y;break}A=A.return}y=A}}function Ws(i,a,u,f){i=null;for(var y=a,x=!1;y!==null;){if(!x){if((y.flags&524288)!==0)x=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var A=y.alternate;if(A===null)throw Error(r(387));if(A=A.memoizedProps,A!==null){var _=y.type;or(y.pendingProps.value,A.value)||(i!==null?i.push(_):i=[_])}}else if(y===$e.current){if(A=y.alternate,A===null)throw Error(r(387));A.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(Wu):i=[Wu])}y=y.return}i!==null&&lp(a,i,u,f),a.flags|=262144}function hh(i){for(i=i.firstContext;i!==null;){if(!or(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function rs(i){ns=i,yl=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Wn(i){return By(ns,i)}function fh(i,a){return ns===null&&rs(i),By(i,a)}function By(i,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},yl===null){if(i===null)throw Error(r(308));yl=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else yl=yl.next=a;return u}var TC=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(u,f){i.push(f)}};this.abort=function(){a.aborted=!0,i.forEach(function(u){return u()})}},EC=n.unstable_scheduleCallback,NC=n.unstable_NormalPriority,Dn={$$typeof:I,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ap(){return{controller:new TC,data:new Map,refCount:0}}function Au(i){i.refCount--,i.refCount===0&&EC(NC,function(){i.controller.abort()})}var Tu=null,sp=0,Zs=0,Js=null;function MC(i,a){if(Tu===null){var u=Tu=[];sp=0,Zs=cm(),Js={status:"pending",value:void 0,then:function(f){u.push(f)}}}return sp++,a.then(Ly,Ly),a}function Ly(){if(--sp===0&&Tu!==null){Js!==null&&(Js.status="fulfilled");var i=Tu;Tu=null,Zs=0,Js=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function _C(i,a){var u=[],f={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return i.then(function(){f.status="fulfilled",f.value=a;for(var y=0;y<u.length;y++)(0,u[y])(a)},function(y){for(f.status="rejected",f.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),f}var zy=q.S;q.S=function(i,a){bv=Yt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&MC(i,a),zy!==null&&zy(i,a)};var is=Pe(null);function op(){var i=is.current;return i!==null?i:tn.pooledCache}function dh(i,a){a===null?R(is,is.current):R(is,a.pool)}function Iy(){var i=op();return i===null?null:{parent:Dn._currentValue,pool:i}}var eo=Error(r(460)),up=Error(r(474)),ph=Error(r(542)),mh={then:function(){}};function Py(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Hy(i,a,u){switch(u=i[u],u===void 0?i.push(a):u!==a&&(a.then(wr,wr),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Uy(i),i;default:if(typeof a.status=="string")a.then(wr,wr);else{if(i=tn,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=a,i.status="pending",i.then(function(f){if(a.status==="pending"){var y=a;y.status="fulfilled",y.value=f}},function(f){if(a.status==="pending"){var y=a;y.status="rejected",y.reason=f}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Uy(i),i}throw as=a,eo}}function ls(i){try{var a=i._init;return a(i._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(as=u,eo):u}}var as=null;function qy(){if(as===null)throw Error(r(459));var i=as;return as=null,i}function Uy(i){if(i===eo||i===ph)throw Error(r(483))}var to=null,Eu=0;function gh(i){var a=Eu;return Eu+=1,to===null&&(to=[]),Hy(to,i,a)}function Nu(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function yh(i,a){throw a.$$typeof===b?Error(r(525)):(i=Object.prototype.toString.call(a),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function Fy(i){function a(te,W){if(i){var ae=te.deletions;ae===null?(te.deletions=[W],te.flags|=16):ae.push(W)}}function u(te,W){if(!i)return null;for(;W!==null;)a(te,W),W=W.sibling;return null}function f(te){for(var W=new Map;te!==null;)te.key!==null?W.set(te.key,te):W.set(te.index,te),te=te.sibling;return W}function y(te,W){return te=ml(te,W),te.index=0,te.sibling=null,te}function x(te,W,ae){return te.index=ae,i?(ae=te.alternate,ae!==null?(ae=ae.index,ae<W?(te.flags|=67108866,W):ae):(te.flags|=67108866,W)):(te.flags|=1048576,W)}function A(te){return i&&te.alternate===null&&(te.flags|=67108866),te}function _(te,W,ae,xe){return W===null||W.tag!==6?(W=Wd(ae,te.mode,xe),W.return=te,W):(W=y(W,ae),W.return=te,W)}function H(te,W,ae,xe){var lt=ae.type;return lt===N?ge(te,W,ae.props.children,xe,ae.key):W!==null&&(W.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===ye&&ls(lt)===W.type)?(W=y(W,ae.props),Nu(W,ae),W.return=te,W):(W=uh(ae.type,ae.key,ae.props,null,te.mode,xe),Nu(W,ae),W.return=te,W)}function se(te,W,ae,xe){return W===null||W.tag!==4||W.stateNode.containerInfo!==ae.containerInfo||W.stateNode.implementation!==ae.implementation?(W=Zd(ae,te.mode,xe),W.return=te,W):(W=y(W,ae.children||[]),W.return=te,W)}function ge(te,W,ae,xe,lt){return W===null||W.tag!==7?(W=es(ae,te.mode,xe,lt),W.return=te,W):(W=y(W,ae),W.return=te,W)}function we(te,W,ae){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Wd(""+W,te.mode,ae),W.return=te,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case w:return ae=uh(W.type,W.key,W.props,null,te.mode,ae),Nu(ae,W),ae.return=te,ae;case T:return W=Zd(W,te.mode,ae),W.return=te,W;case ye:return W=ls(W),we(te,W,ae)}if(J(W)||fe(W))return W=es(W,te.mode,ae,null),W.return=te,W;if(typeof W.then=="function")return we(te,gh(W),ae);if(W.$$typeof===I)return we(te,fh(te,W),ae);yh(te,W)}return null}function he(te,W,ae,xe){var lt=W!==null?W.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return lt!==null?null:_(te,W,""+ae,xe);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case w:return ae.key===lt?H(te,W,ae,xe):null;case T:return ae.key===lt?se(te,W,ae,xe):null;case ye:return ae=ls(ae),he(te,W,ae,xe)}if(J(ae)||fe(ae))return lt!==null?null:ge(te,W,ae,xe,null);if(typeof ae.then=="function")return he(te,W,gh(ae),xe);if(ae.$$typeof===I)return he(te,W,fh(te,ae),xe);yh(te,ae)}return null}function de(te,W,ae,xe,lt){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return te=te.get(ae)||null,_(W,te,""+xe,lt);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case w:return te=te.get(xe.key===null?ae:xe.key)||null,H(W,te,xe,lt);case T:return te=te.get(xe.key===null?ae:xe.key)||null,se(W,te,xe,lt);case ye:return xe=ls(xe),de(te,W,ae,xe,lt)}if(J(xe)||fe(xe))return te=te.get(ae)||null,ge(W,te,xe,lt,null);if(typeof xe.then=="function")return de(te,W,ae,gh(xe),lt);if(xe.$$typeof===I)return de(te,W,ae,fh(W,xe),lt);yh(W,xe)}return null}function Je(te,W,ae,xe){for(var lt=null,Rt=null,tt=W,yt=W=0,Et=null;tt!==null&&yt<ae.length;yt++){tt.index>yt?(Et=tt,tt=null):Et=tt.sibling;var Bt=he(te,tt,ae[yt],xe);if(Bt===null){tt===null&&(tt=Et);break}i&&tt&&Bt.alternate===null&&a(te,tt),W=x(Bt,W,yt),Rt===null?lt=Bt:Rt.sibling=Bt,Rt=Bt,tt=Et}if(yt===ae.length)return u(te,tt),_t&&gl(te,yt),lt;if(tt===null){for(;yt<ae.length;yt++)tt=we(te,ae[yt],xe),tt!==null&&(W=x(tt,W,yt),Rt===null?lt=tt:Rt.sibling=tt,Rt=tt);return _t&&gl(te,yt),lt}for(tt=f(tt);yt<ae.length;yt++)Et=de(tt,te,yt,ae[yt],xe),Et!==null&&(i&&Et.alternate!==null&&tt.delete(Et.key===null?yt:Et.key),W=x(Et,W,yt),Rt===null?lt=Et:Rt.sibling=Et,Rt=Et);return i&&tt.forEach(function(ya){return a(te,ya)}),_t&&gl(te,yt),lt}function ut(te,W,ae,xe){if(ae==null)throw Error(r(151));for(var lt=null,Rt=null,tt=W,yt=W=0,Et=null,Bt=ae.next();tt!==null&&!Bt.done;yt++,Bt=ae.next()){tt.index>yt?(Et=tt,tt=null):Et=tt.sibling;var ya=he(te,tt,Bt.value,xe);if(ya===null){tt===null&&(tt=Et);break}i&&tt&&ya.alternate===null&&a(te,tt),W=x(ya,W,yt),Rt===null?lt=ya:Rt.sibling=ya,Rt=ya,tt=Et}if(Bt.done)return u(te,tt),_t&&gl(te,yt),lt;if(tt===null){for(;!Bt.done;yt++,Bt=ae.next())Bt=we(te,Bt.value,xe),Bt!==null&&(W=x(Bt,W,yt),Rt===null?lt=Bt:Rt.sibling=Bt,Rt=Bt);return _t&&gl(te,yt),lt}for(tt=f(tt);!Bt.done;yt++,Bt=ae.next())Bt=de(tt,te,yt,Bt.value,xe),Bt!==null&&(i&&Bt.alternate!==null&&tt.delete(Bt.key===null?yt:Bt.key),W=x(Bt,W,yt),Rt===null?lt=Bt:Rt.sibling=Bt,Rt=Bt);return i&&tt.forEach(function(qA){return a(te,qA)}),_t&&gl(te,yt),lt}function Zt(te,W,ae,xe){if(typeof ae=="object"&&ae!==null&&ae.type===N&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case w:e:{for(var lt=ae.key;W!==null;){if(W.key===lt){if(lt=ae.type,lt===N){if(W.tag===7){u(te,W.sibling),xe=y(W,ae.props.children),xe.return=te,te=xe;break e}}else if(W.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===ye&&ls(lt)===W.type){u(te,W.sibling),xe=y(W,ae.props),Nu(xe,ae),xe.return=te,te=xe;break e}u(te,W);break}else a(te,W);W=W.sibling}ae.type===N?(xe=es(ae.props.children,te.mode,xe,ae.key),xe.return=te,te=xe):(xe=uh(ae.type,ae.key,ae.props,null,te.mode,xe),Nu(xe,ae),xe.return=te,te=xe)}return A(te);case T:e:{for(lt=ae.key;W!==null;){if(W.key===lt)if(W.tag===4&&W.stateNode.containerInfo===ae.containerInfo&&W.stateNode.implementation===ae.implementation){u(te,W.sibling),xe=y(W,ae.children||[]),xe.return=te,te=xe;break e}else{u(te,W);break}else a(te,W);W=W.sibling}xe=Zd(ae,te.mode,xe),xe.return=te,te=xe}return A(te);case ye:return ae=ls(ae),Zt(te,W,ae,xe)}if(J(ae))return Je(te,W,ae,xe);if(fe(ae)){if(lt=fe(ae),typeof lt!="function")throw Error(r(150));return ae=lt.call(ae),ut(te,W,ae,xe)}if(typeof ae.then=="function")return Zt(te,W,gh(ae),xe);if(ae.$$typeof===I)return Zt(te,W,fh(te,ae),xe);yh(te,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,W!==null&&W.tag===6?(u(te,W.sibling),xe=y(W,ae),xe.return=te,te=xe):(u(te,W),xe=Wd(ae,te.mode,xe),xe.return=te,te=xe),A(te)):u(te,W)}return function(te,W,ae,xe){try{Eu=0;var lt=Zt(te,W,ae,xe);return to=null,lt}catch(tt){if(tt===eo||tt===ph)throw tt;var Rt=Br(29,tt,null,te.mode);return Rt.lanes=xe,Rt.return=te,Rt}}}var ss=Fy(!0),Vy=Fy(!1),ea=!1;function cp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hp(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function ta(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function na(i,a,u){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(Pt&2)!==0){var y=f.pending;return y===null?a.next=a:(a.next=y.next,y.next=a),f.pending=a,a=Xl(i),Li(i,null,u),a}return Xt(i,f,a,u),Xl(i)}function Mu(i,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var f=a.lanes;f&=i.pendingLanes,u|=f,a.lanes=u,en(i,u)}}function fp(i,a){var u=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,x=null;if(u=u.firstBaseUpdate,u!==null){do{var A={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};x===null?y=x=A:x=x.next=A,u=u.next}while(u!==null);x===null?y=x=a:x=x.next=a}else y=x=a;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=a:i.next=a,u.lastBaseUpdate=a}var dp=!1;function _u(){if(dp){var i=Js;if(i!==null)throw i}}function Du(i,a,u,f){dp=!1;var y=i.updateQueue;ea=!1;var x=y.firstBaseUpdate,A=y.lastBaseUpdate,_=y.shared.pending;if(_!==null){y.shared.pending=null;var H=_,se=H.next;H.next=null,A===null?x=se:A.next=se,A=H;var ge=i.alternate;ge!==null&&(ge=ge.updateQueue,_=ge.lastBaseUpdate,_!==A&&(_===null?ge.firstBaseUpdate=se:_.next=se,ge.lastBaseUpdate=H))}if(x!==null){var we=y.baseState;A=0,ge=se=H=null,_=x;do{var he=_.lane&-536870913,de=he!==_.lane;if(de?(Tt&he)===he:(f&he)===he){he!==0&&he===Zs&&(dp=!0),ge!==null&&(ge=ge.next={lane:0,tag:_.tag,payload:_.payload,callback:null,next:null});e:{var Je=i,ut=_;he=a;var Zt=u;switch(ut.tag){case 1:if(Je=ut.payload,typeof Je=="function"){we=Je.call(Zt,we,he);break e}we=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=ut.payload,he=typeof Je=="function"?Je.call(Zt,we,he):Je,he==null)break e;we=g({},we,he);break e;case 2:ea=!0}}he=_.callback,he!==null&&(i.flags|=64,de&&(i.flags|=8192),de=y.callbacks,de===null?y.callbacks=[he]:de.push(he))}else de={lane:he,tag:_.tag,payload:_.payload,callback:_.callback,next:null},ge===null?(se=ge=de,H=we):ge=ge.next=de,A|=he;if(_=_.next,_===null){if(_=y.shared.pending,_===null)break;de=_,_=de.next,de.next=null,y.lastBaseUpdate=de,y.shared.pending=null}}while(!0);ge===null&&(H=we),y.baseState=H,y.firstBaseUpdate=se,y.lastBaseUpdate=ge,x===null&&(y.shared.lanes=0),sa|=A,i.lanes=A,i.memoizedState=we}}function Ky(i,a){if(typeof i!="function")throw Error(r(191,i));i.call(a)}function Gy(i,a){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)Ky(u[i],a)}var no=Pe(null),xh=Pe(0);function Yy(i,a){i=El,R(xh,i),R(no,a),El=i|a.baseLanes}function pp(){R(xh,El),R(no,no.current)}function mp(){El=xh.current,qe(no),qe(xh)}var Lr=Pe(null),ti=null;function ra(i){var a=i.alternate;R(Sn,Sn.current&1),R(Lr,i),ti===null&&(a===null||no.current!==null||a.memoizedState!==null)&&(ti=i)}function gp(i){R(Sn,Sn.current),R(Lr,i),ti===null&&(ti=i)}function Qy(i){i.tag===22?(R(Sn,Sn.current),R(Lr,i),ti===null&&(ti=i)):ia()}function ia(){R(Sn,Sn.current),R(Lr,Lr.current)}function zr(i){qe(Lr),ti===i&&(ti=null),qe(Sn)}var Sn=Pe(0);function vh(i){for(var a=i;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||wm(u)||Sm(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var vl=0,mt=null,$t=null,jn=null,bh=!1,ro=!1,os=!1,kh=0,ju=0,io=null,DC=0;function xn(){throw Error(r(321))}function yp(i,a){if(a===null)return!1;for(var u=0;u<a.length&&u<i.length;u++)if(!or(i[u],a[u]))return!1;return!0}function xp(i,a,u,f,y,x){return vl=x,mt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,q.H=i===null||i.memoizedState===null?Dx:Op,os=!1,x=u(f,y),os=!1,ro&&(x=$y(a,u,f,y)),Xy(i),x}function Xy(i){q.H=Bu;var a=$t!==null&&$t.next!==null;if(vl=0,jn=$t=mt=null,bh=!1,ju=0,io=null,a)throw Error(r(300));i===null||On||(i=i.dependencies,i!==null&&hh(i)&&(On=!0))}function $y(i,a,u,f){mt=i;var y=0;do{if(ro&&(io=null),ju=0,ro=!1,25<=y)throw Error(r(301));if(y+=1,jn=$t=null,i.updateQueue!=null){var x=i.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}q.H=jx,x=a(u,f)}while(ro);return x}function jC(){var i=q.H,a=i.useState()[0];return a=typeof a.then=="function"?Ou(a):a,i=i.useState()[0],($t!==null?$t.memoizedState:null)!==i&&(mt.flags|=1024),a}function vp(){var i=kh!==0;return kh=0,i}function bp(i,a,u){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~u}function kp(i){if(bh){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}bh=!1}vl=0,jn=$t=mt=null,ro=!1,ju=kh=0,io=null}function yr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jn===null?mt.memoizedState=jn=i:jn=jn.next=i,jn}function Cn(){if($t===null){var i=mt.alternate;i=i!==null?i.memoizedState:null}else i=$t.next;var a=jn===null?mt.memoizedState:jn.next;if(a!==null)jn=a,$t=i;else{if(i===null)throw mt.alternate===null?Error(r(467)):Error(r(310));$t=i,i={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},jn===null?mt.memoizedState=jn=i:jn=jn.next=i}return jn}function wh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ou(i){var a=ju;return ju+=1,io===null&&(io=[]),i=Hy(io,i,a),a=mt,(jn===null?a.memoizedState:jn.next)===null&&(a=a.alternate,q.H=a===null||a.memoizedState===null?Dx:Op),i}function Sh(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Ou(i);if(i.$$typeof===I)return Wn(i)}throw Error(r(438,String(i)))}function wp(i){var a=null,u=mt.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var f=mt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(a={data:f.data.map(function(y){return y.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=wh(),mt.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(i),f=0;f<i;f++)u[f]=P;return a.index++,u}function bl(i,a){return typeof a=="function"?a(i):a}function Ch(i){var a=Cn();return Sp(a,$t,i)}function Sp(i,a,u){var f=i.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=u;var y=i.baseQueue,x=f.pending;if(x!==null){if(y!==null){var A=y.next;y.next=x.next,x.next=A}a.baseQueue=y=x,f.pending=null}if(x=i.baseState,y===null)i.memoizedState=x;else{a=y.next;var _=A=null,H=null,se=a,ge=!1;do{var we=se.lane&-536870913;if(we!==se.lane?(Tt&we)===we:(vl&we)===we){var he=se.revertLane;if(he===0)H!==null&&(H=H.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),we===Zs&&(ge=!0);else if((vl&he)===he){se=se.next,he===Zs&&(ge=!0);continue}else we={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},H===null?(_=H=we,A=x):H=H.next=we,mt.lanes|=he,sa|=he;we=se.action,os&&u(x,we),x=se.hasEagerState?se.eagerState:u(x,we)}else he={lane:we,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},H===null?(_=H=he,A=x):H=H.next=he,mt.lanes|=we,sa|=we;se=se.next}while(se!==null&&se!==a);if(H===null?A=x:H.next=_,!or(x,i.memoizedState)&&(On=!0,ge&&(u=Js,u!==null)))throw u;i.memoizedState=x,i.baseState=A,i.baseQueue=H,f.lastRenderedState=x}return y===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function Cp(i){var a=Cn(),u=a.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var f=u.dispatch,y=u.pending,x=a.memoizedState;if(y!==null){u.pending=null;var A=y=y.next;do x=i(x,A.action),A=A.next;while(A!==y);or(x,a.memoizedState)||(On=!0),a.memoizedState=x,a.baseQueue===null&&(a.baseState=x),u.lastRenderedState=x}return[x,f]}function Wy(i,a,u){var f=mt,y=Cn(),x=_t;if(x){if(u===void 0)throw Error(r(407));u=u()}else u=a();var A=!or(($t||y).memoizedState,u);if(A&&(y.memoizedState=u,On=!0),y=y.queue,Ep(ex.bind(null,f,y,i),[i]),y.getSnapshot!==a||A||jn!==null&&jn.memoizedState.tag&1){if(f.flags|=2048,lo(9,{destroy:void 0},Jy.bind(null,f,y,u,a),null),tn===null)throw Error(r(349));x||(vl&127)!==0||Zy(f,a,u)}return u}function Zy(i,a,u){i.flags|=16384,i={getSnapshot:a,value:u},a=mt.updateQueue,a===null?(a=wh(),mt.updateQueue=a,a.stores=[i]):(u=a.stores,u===null?a.stores=[i]:u.push(i))}function Jy(i,a,u,f){a.value=u,a.getSnapshot=f,tx(a)&&nx(i)}function ex(i,a,u){return u(function(){tx(a)&&nx(i)})}function tx(i){var a=i.getSnapshot;i=i.value;try{var u=a();return!or(i,u)}catch{return!0}}function nx(i){var a=qt(i,2);a!==null&&Er(a,i,2)}function Ap(i){var a=yr();if(typeof i=="function"){var u=i;if(i=u(),os){gn(!0);try{u()}finally{gn(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:i},a}function rx(i,a,u,f){return i.baseState=u,Sp(i,$t,typeof f=="function"?f:bl)}function OC(i,a,u,f,y){if(Eh(i))throw Error(r(485));if(i=a.action,i!==null){var x={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){x.listeners.push(A)}};q.T!==null?u(!0):x.isTransition=!1,f(x),u=a.pending,u===null?(x.next=a.pending=x,ix(a,x)):(x.next=u.next,a.pending=u.next=x)}}function ix(i,a){var u=a.action,f=a.payload,y=i.state;if(a.isTransition){var x=q.T,A={};q.T=A;try{var _=u(y,f),H=q.S;H!==null&&H(A,_),lx(i,a,_)}catch(se){Tp(i,a,se)}finally{x!==null&&A.types!==null&&(x.types=A.types),q.T=x}}else try{x=u(y,f),lx(i,a,x)}catch(se){Tp(i,a,se)}}function lx(i,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){ax(i,a,f)},function(f){return Tp(i,a,f)}):ax(i,a,u)}function ax(i,a,u){a.status="fulfilled",a.value=u,sx(a),i.state=u,a=i.pending,a!==null&&(u=a.next,u===a?i.pending=null:(u=u.next,a.next=u,ix(i,u)))}function Tp(i,a,u){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do a.status="rejected",a.reason=u,sx(a),a=a.next;while(a!==f)}i.action=null}function sx(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function ox(i,a){return a}function ux(i,a){if(_t){var u=tn.formState;if(u!==null){e:{var f=mt;if(_t){if(cn){t:{for(var y=cn,x=ei;y.nodeType!==8;){if(!x){y=null;break t}if(y=ni(y.nextSibling),y===null){y=null;break t}}x=y.data,y=x==="F!"||x==="F"?y:null}if(y){cn=ni(y.nextSibling),f=y.data==="F!";break e}}Zl(f)}f=!1}f&&(a=u[0])}}return u=yr(),u.memoizedState=u.baseState=a,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ox,lastRenderedState:a},u.queue=f,u=Nx.bind(null,mt,f),f.dispatch=u,f=Ap(!1),x=jp.bind(null,mt,!1,f.queue),f=yr(),y={state:a,dispatch:null,action:i,pending:null},f.queue=y,u=OC.bind(null,mt,y,x,u),y.dispatch=u,f.memoizedState=i,[a,u,!1]}function cx(i){var a=Cn();return hx(a,$t,i)}function hx(i,a,u){if(a=Sp(i,a,ox)[0],i=Ch(bl)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var f=Ou(a)}catch(A){throw A===eo?ph:A}else f=a;a=Cn();var y=a.queue,x=y.dispatch;return u!==a.memoizedState&&(mt.flags|=2048,lo(9,{destroy:void 0},RC.bind(null,y,u),null)),[f,x,i]}function RC(i,a){i.action=a}function fx(i){var a=Cn(),u=$t;if(u!==null)return hx(a,u,i);Cn(),a=a.memoizedState,u=Cn();var f=u.queue.dispatch;return u.memoizedState=i,[a,f,!1]}function lo(i,a,u,f){return i={tag:i,create:u,deps:f,inst:a,next:null},a=mt.updateQueue,a===null&&(a=wh(),mt.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=i.next=i:(f=u.next,u.next=i,i.next=f,a.lastEffect=i),i}function dx(){return Cn().memoizedState}function Ah(i,a,u,f){var y=yr();mt.flags|=i,y.memoizedState=lo(1|a,{destroy:void 0},u,f===void 0?null:f)}function Th(i,a,u,f){var y=Cn();f=f===void 0?null:f;var x=y.memoizedState.inst;$t!==null&&f!==null&&yp(f,$t.memoizedState.deps)?y.memoizedState=lo(a,x,u,f):(mt.flags|=i,y.memoizedState=lo(1|a,x,u,f))}function px(i,a){Ah(8390656,8,i,a)}function Ep(i,a){Th(2048,8,i,a)}function BC(i){mt.flags|=4;var a=mt.updateQueue;if(a===null)a=wh(),mt.updateQueue=a,a.events=[i];else{var u=a.events;u===null?a.events=[i]:u.push(i)}}function mx(i){var a=Cn().memoizedState;return BC({ref:a,nextImpl:i}),function(){if((Pt&2)!==0)throw Error(r(440));return a.impl.apply(void 0,arguments)}}function gx(i,a){return Th(4,2,i,a)}function yx(i,a){return Th(4,4,i,a)}function xx(i,a){if(typeof a=="function"){i=i();var u=a(i);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function vx(i,a,u){u=u!=null?u.concat([i]):null,Th(4,4,xx.bind(null,a,i),u)}function Np(){}function bx(i,a){var u=Cn();a=a===void 0?null:a;var f=u.memoizedState;return a!==null&&yp(a,f[1])?f[0]:(u.memoizedState=[i,a],i)}function kx(i,a){var u=Cn();a=a===void 0?null:a;var f=u.memoizedState;if(a!==null&&yp(a,f[1]))return f[0];if(f=i(),os){gn(!0);try{i()}finally{gn(!1)}}return u.memoizedState=[f,a],f}function Mp(i,a,u){return u===void 0||(vl&1073741824)!==0&&(Tt&261930)===0?i.memoizedState=a:(i.memoizedState=u,i=wv(),mt.lanes|=i,sa|=i,u)}function wx(i,a,u,f){return or(u,a)?u:no.current!==null?(i=Mp(i,u,f),or(i,a)||(On=!0),i):(vl&42)===0||(vl&1073741824)!==0&&(Tt&261930)===0?(On=!0,i.memoizedState=u):(i=wv(),mt.lanes|=i,sa|=i,a)}function Sx(i,a,u,f,y){var x=le.p;le.p=x!==0&&8>x?x:8;var A=q.T,_={};q.T=_,jp(i,!1,a,u);try{var H=y(),se=q.S;if(se!==null&&se(_,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var ge=_C(H,f);Ru(i,a,ge,Hr(i))}else Ru(i,a,f,Hr(i))}catch(we){Ru(i,a,{then:function(){},status:"rejected",reason:we},Hr())}finally{le.p=x,A!==null&&_.types!==null&&(A.types=_.types),q.T=A}}function LC(){}function _p(i,a,u,f){if(i.tag!==5)throw Error(r(476));var y=Cx(i).queue;Sx(i,y,a,Ae,u===null?LC:function(){return Ax(i),u(f)})}function Cx(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:Ae,baseState:Ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:Ae},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:u},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function Ax(i){var a=Cx(i);a.next===null&&(a=i.alternate.memoizedState),Ru(i,a.next.queue,{},Hr())}function Dp(){return Wn(Wu)}function Tx(){return Cn().memoizedState}function Ex(){return Cn().memoizedState}function zC(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var u=Hr();i=ta(u);var f=na(a,i,u);f!==null&&(Er(f,a,u),Mu(f,a,u)),a={cache:ap()},i.payload=a;return}a=a.return}}function IC(i,a,u){var f=Hr();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Eh(i)?Mx(a,u):(u=ur(i,a,u,f),u!==null&&(Er(u,i,f),_x(u,a,f)))}function Nx(i,a,u){var f=Hr();Ru(i,a,u,f)}function Ru(i,a,u,f){var y={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Eh(i))Mx(a,y);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=a.lastRenderedReducer,x!==null))try{var A=a.lastRenderedState,_=x(A,u);if(y.hasEagerState=!0,y.eagerState=_,or(_,A))return Xt(i,a,y,0),tn===null&&dt(),!1}catch{}if(u=ur(i,a,y,f),u!==null)return Er(u,i,f),_x(u,a,f),!0}return!1}function jp(i,a,u,f){if(f={lane:2,revertLane:cm(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Eh(i)){if(a)throw Error(r(479))}else a=ur(i,u,f,2),a!==null&&Er(a,i,2)}function Eh(i){var a=i.alternate;return i===mt||a!==null&&a===mt}function Mx(i,a){ro=bh=!0;var u=i.pending;u===null?a.next=a:(a.next=u.next,u.next=a),i.pending=a}function _x(i,a,u){if((u&4194048)!==0){var f=a.lanes;f&=i.pendingLanes,u|=f,a.lanes=u,en(i,u)}}var Bu={readContext:Wn,use:Sh,useCallback:xn,useContext:xn,useEffect:xn,useImperativeHandle:xn,useLayoutEffect:xn,useInsertionEffect:xn,useMemo:xn,useReducer:xn,useRef:xn,useState:xn,useDebugValue:xn,useDeferredValue:xn,useTransition:xn,useSyncExternalStore:xn,useId:xn,useHostTransitionStatus:xn,useFormState:xn,useActionState:xn,useOptimistic:xn,useMemoCache:xn,useCacheRefresh:xn};Bu.useEffectEvent=xn;var Dx={readContext:Wn,use:Sh,useCallback:function(i,a){return yr().memoizedState=[i,a===void 0?null:a],i},useContext:Wn,useEffect:px,useImperativeHandle:function(i,a,u){u=u!=null?u.concat([i]):null,Ah(4194308,4,xx.bind(null,a,i),u)},useLayoutEffect:function(i,a){return Ah(4194308,4,i,a)},useInsertionEffect:function(i,a){Ah(4,2,i,a)},useMemo:function(i,a){var u=yr();a=a===void 0?null:a;var f=i();if(os){gn(!0);try{i()}finally{gn(!1)}}return u.memoizedState=[f,a],f},useReducer:function(i,a,u){var f=yr();if(u!==void 0){var y=u(a);if(os){gn(!0);try{u(a)}finally{gn(!1)}}}else y=a;return f.memoizedState=f.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},f.queue=i,i=i.dispatch=IC.bind(null,mt,i),[f.memoizedState,i]},useRef:function(i){var a=yr();return i={current:i},a.memoizedState=i},useState:function(i){i=Ap(i);var a=i.queue,u=Nx.bind(null,mt,a);return a.dispatch=u,[i.memoizedState,u]},useDebugValue:Np,useDeferredValue:function(i,a){var u=yr();return Mp(u,i,a)},useTransition:function(){var i=Ap(!1);return i=Sx.bind(null,mt,i.queue,!0,!1),yr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,u){var f=mt,y=yr();if(_t){if(u===void 0)throw Error(r(407));u=u()}else{if(u=a(),tn===null)throw Error(r(349));(Tt&127)!==0||Zy(f,a,u)}y.memoizedState=u;var x={value:u,getSnapshot:a};return y.queue=x,px(ex.bind(null,f,x,i),[i]),f.flags|=2048,lo(9,{destroy:void 0},Jy.bind(null,f,x,u,a),null),u},useId:function(){var i=yr(),a=tn.identifierPrefix;if(_t){var u=Ii,f=zi;u=(f&~(1<<32-Le(f)-1)).toString(32)+u,a="_"+a+"R_"+u,u=kh++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=DC++,a="_"+a+"r_"+u.toString(32)+"_";return i.memoizedState=a},useHostTransitionStatus:Dp,useFormState:ux,useActionState:ux,useOptimistic:function(i){var a=yr();a.memoizedState=a.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=jp.bind(null,mt,!0,u),u.dispatch=a,[i,a]},useMemoCache:wp,useCacheRefresh:function(){return yr().memoizedState=zC.bind(null,mt)},useEffectEvent:function(i){var a=yr(),u={impl:i};return a.memoizedState=u,function(){if((Pt&2)!==0)throw Error(r(440));return u.impl.apply(void 0,arguments)}}},Op={readContext:Wn,use:Sh,useCallback:bx,useContext:Wn,useEffect:Ep,useImperativeHandle:vx,useInsertionEffect:gx,useLayoutEffect:yx,useMemo:kx,useReducer:Ch,useRef:dx,useState:function(){return Ch(bl)},useDebugValue:Np,useDeferredValue:function(i,a){var u=Cn();return wx(u,$t.memoizedState,i,a)},useTransition:function(){var i=Ch(bl)[0],a=Cn().memoizedState;return[typeof i=="boolean"?i:Ou(i),a]},useSyncExternalStore:Wy,useId:Tx,useHostTransitionStatus:Dp,useFormState:cx,useActionState:cx,useOptimistic:function(i,a){var u=Cn();return rx(u,$t,i,a)},useMemoCache:wp,useCacheRefresh:Ex};Op.useEffectEvent=mx;var jx={readContext:Wn,use:Sh,useCallback:bx,useContext:Wn,useEffect:Ep,useImperativeHandle:vx,useInsertionEffect:gx,useLayoutEffect:yx,useMemo:kx,useReducer:Cp,useRef:dx,useState:function(){return Cp(bl)},useDebugValue:Np,useDeferredValue:function(i,a){var u=Cn();return $t===null?Mp(u,i,a):wx(u,$t.memoizedState,i,a)},useTransition:function(){var i=Cp(bl)[0],a=Cn().memoizedState;return[typeof i=="boolean"?i:Ou(i),a]},useSyncExternalStore:Wy,useId:Tx,useHostTransitionStatus:Dp,useFormState:fx,useActionState:fx,useOptimistic:function(i,a){var u=Cn();return $t!==null?rx(u,$t,i,a):(u.baseState=i,[i,u.queue.dispatch])},useMemoCache:wp,useCacheRefresh:Ex};jx.useEffectEvent=mx;function Rp(i,a,u,f){a=i.memoizedState,u=u(f,a),u=u==null?a:g({},a,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Bp={enqueueSetState:function(i,a,u){i=i._reactInternals;var f=Hr(),y=ta(f);y.payload=a,u!=null&&(y.callback=u),a=na(i,y,f),a!==null&&(Er(a,i,f),Mu(a,i,f))},enqueueReplaceState:function(i,a,u){i=i._reactInternals;var f=Hr(),y=ta(f);y.tag=1,y.payload=a,u!=null&&(y.callback=u),a=na(i,y,f),a!==null&&(Er(a,i,f),Mu(a,i,f))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var u=Hr(),f=ta(u);f.tag=2,a!=null&&(f.callback=a),a=na(i,f,u),a!==null&&(Er(a,i,u),Mu(a,i,u))}};function Ox(i,a,u,f,y,x,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,x,A):a.prototype&&a.prototype.isPureReactComponent?!m(u,f)||!m(y,x):!0}function Rx(i,a,u,f){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,f),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,f),a.state!==i&&Bp.enqueueReplaceState(a,a.state,null)}function us(i,a){var u=a;if("ref"in a){u={};for(var f in a)f!=="ref"&&(u[f]=a[f])}if(i=i.defaultProps){u===a&&(u=g({},u));for(var y in i)u[y]===void 0&&(u[y]=i[y])}return u}function Bx(i){Xe(i)}function Lx(i){console.error(i)}function zx(i){Xe(i)}function Nh(i,a){try{var u=i.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(f){setTimeout(function(){throw f})}}function Ix(i,a,u){try{var f=i.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Lp(i,a,u){return u=ta(u),u.tag=3,u.payload={element:null},u.callback=function(){Nh(i,a)},u}function Px(i){return i=ta(i),i.tag=3,i}function Hx(i,a,u,f){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var x=f.value;i.payload=function(){return y(x)},i.callback=function(){Ix(a,u,f)}}var A=u.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(i.callback=function(){Ix(a,u,f),typeof y!="function"&&(oa===null?oa=new Set([this]):oa.add(this));var _=f.stack;this.componentDidCatch(f.value,{componentStack:_!==null?_:""})})}function PC(i,a,u,f,y){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(a=u.alternate,a!==null&&Ws(a,u,y,!0),u=Lr.current,u!==null){switch(u.tag){case 31:case 13:return ti===null?Hh():u.alternate===null&&vn===0&&(vn=3),u.flags&=-257,u.flags|=65536,u.lanes=y,f===mh?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([f]):a.add(f),sm(i,f,y)),!1;case 22:return u.flags|=65536,f===mh?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([f]):u.add(f)),sm(i,f,y)),!1}throw Error(r(435,u.tag))}return sm(i,f,y),Hh(),!1}if(_t)return a=Lr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=y,f!==tp&&(i=Error(r(422),{cause:f}),Cu(Wr(i,u)))):(f!==tp&&(a=Error(r(423),{cause:f}),Cu(Wr(a,u))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,f=Wr(f,u),y=Lp(i.stateNode,f,y),fp(i,y),vn!==4&&(vn=2)),!1;var x=Error(r(520),{cause:f});if(x=Wr(x,u),Fu===null?Fu=[x]:Fu.push(x),vn!==4&&(vn=2),a===null)return!0;f=Wr(f,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,i=y&-y,u.lanes|=i,i=Lp(u.stateNode,f,i),fp(u,i),!1;case 1:if(a=u.type,x=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(oa===null||!oa.has(x))))return u.flags|=65536,y&=-y,u.lanes|=y,y=Px(y),Hx(y,i,u,f),fp(u,y),!1}u=u.return}while(u!==null);return!1}var zp=Error(r(461)),On=!1;function Zn(i,a,u,f){a.child=i===null?Vy(a,null,u,f):ss(a,i.child,u,f)}function qx(i,a,u,f,y){u=u.render;var x=a.ref;if("ref"in f){var A={};for(var _ in f)_!=="ref"&&(A[_]=f[_])}else A=f;return rs(a),f=xp(i,a,u,A,x,y),_=vp(),i!==null&&!On?(bp(i,a,y),kl(i,a,y)):(_t&&_&&Jd(a),a.flags|=1,Zn(i,a,f,y),a.child)}function Ux(i,a,u,f,y){if(i===null){var x=u.type;return typeof x=="function"&&!$d(x)&&x.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=x,Fx(i,a,x,f,y)):(i=uh(u.type,null,f,a,a.mode,y),i.ref=a.ref,i.return=a,a.child=i)}if(x=i.child,!Kp(i,y)){var A=x.memoizedProps;if(u=u.compare,u=u!==null?u:m,u(A,f)&&i.ref===a.ref)return kl(i,a,y)}return a.flags|=1,i=ml(x,f),i.ref=a.ref,i.return=a,a.child=i}function Fx(i,a,u,f,y){if(i!==null){var x=i.memoizedProps;if(m(x,f)&&i.ref===a.ref)if(On=!1,a.pendingProps=f=x,Kp(i,y))(i.flags&131072)!==0&&(On=!0);else return a.lanes=i.lanes,kl(i,a,y)}return Ip(i,a,u,f,y)}function Vx(i,a,u,f){var y=f.children,x=i!==null?i.memoizedState:null;if(i===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((a.flags&128)!==0){if(x=x!==null?x.baseLanes|u:u,i!==null){for(f=a.child=i.child,y=0;f!==null;)y=y|f.lanes|f.childLanes,f=f.sibling;f=y&~x}else f=0,a.child=null;return Kx(i,a,x,u,f)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&dh(a,x!==null?x.cachePool:null),x!==null?Yy(a,x):pp(),Qy(a);else return f=a.lanes=536870912,Kx(i,a,x!==null?x.baseLanes|u:u,u,f)}else x!==null?(dh(a,x.cachePool),Yy(a,x),ia(),a.memoizedState=null):(i!==null&&dh(a,null),pp(),ia());return Zn(i,a,y,u),a.child}function Lu(i,a){return i!==null&&i.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Kx(i,a,u,f,y){var x=op();return x=x===null?null:{parent:Dn._currentValue,pool:x},a.memoizedState={baseLanes:u,cachePool:x},i!==null&&dh(a,null),pp(),Qy(a),i!==null&&Ws(i,a,f,!0),a.childLanes=y,null}function Mh(i,a){return a=Dh({mode:a.mode,children:a.children},i.mode),a.ref=i.ref,i.child=a,a.return=i,a}function Gx(i,a,u){return ss(a,i.child,null,u),i=Mh(a,a.pendingProps),i.flags|=2,zr(a),a.memoizedState=null,i}function HC(i,a,u){var f=a.pendingProps,y=(a.flags&128)!==0;if(a.flags&=-129,i===null){if(_t){if(f.mode==="hidden")return i=Mh(a,f),a.lanes=536870912,Lu(null,i);if(gp(a),(i=cn)?(i=ib(i,ei),i=i!==null&&i.data==="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:$l!==null?{id:zi,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},u=My(i),u.return=a,a.child=u,$n=a,cn=null)):i=null,i===null)throw Zl(a);return a.lanes=536870912,null}return Mh(a,f)}var x=i.memoizedState;if(x!==null){var A=x.dehydrated;if(gp(a),y)if(a.flags&256)a.flags&=-257,a=Gx(i,a,u);else if(a.memoizedState!==null)a.child=i.child,a.flags|=128,a=null;else throw Error(r(558));else if(On||Ws(i,a,u,!1),y=(u&i.childLanes)!==0,On||y){if(f=tn,f!==null&&(A=bn(f,u),A!==0&&A!==x.retryLane))throw x.retryLane=A,qt(i,A),Er(f,i,A),zp;Hh(),a=Gx(i,a,u)}else i=x.treeContext,cn=ni(A.nextSibling),$n=a,_t=!0,Wl=null,ei=!1,i!==null&&jy(a,i),a=Mh(a,f),a.flags|=4096;return a}return i=ml(i.child,{mode:f.mode,children:f.children}),i.ref=a.ref,a.child=i,i.return=a,i}function _h(i,a){var u=a.ref;if(u===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(i===null||i.ref!==u)&&(a.flags|=4194816)}}function Ip(i,a,u,f,y){return rs(a),u=xp(i,a,u,f,void 0,y),f=vp(),i!==null&&!On?(bp(i,a,y),kl(i,a,y)):(_t&&f&&Jd(a),a.flags|=1,Zn(i,a,u,y),a.child)}function Yx(i,a,u,f,y,x){return rs(a),a.updateQueue=null,u=$y(a,f,u,y),Xy(i),f=vp(),i!==null&&!On?(bp(i,a,x),kl(i,a,x)):(_t&&f&&Jd(a),a.flags|=1,Zn(i,a,u,x),a.child)}function Qx(i,a,u,f,y){if(rs(a),a.stateNode===null){var x=Ys,A=u.contextType;typeof A=="object"&&A!==null&&(x=Wn(A)),x=new u(f,x),a.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Bp,a.stateNode=x,x._reactInternals=a,x=a.stateNode,x.props=f,x.state=a.memoizedState,x.refs={},cp(a),A=u.contextType,x.context=typeof A=="object"&&A!==null?Wn(A):Ys,x.state=a.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(Rp(a,u,A,f),x.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(A=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),A!==x.state&&Bp.enqueueReplaceState(x,x.state,null),Du(a,f,x,y),_u(),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308),f=!0}else if(i===null){x=a.stateNode;var _=a.memoizedProps,H=us(u,_);x.props=H;var se=x.context,ge=u.contextType;A=Ys,typeof ge=="object"&&ge!==null&&(A=Wn(ge));var we=u.getDerivedStateFromProps;ge=typeof we=="function"||typeof x.getSnapshotBeforeUpdate=="function",_=a.pendingProps!==_,ge||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(_||se!==A)&&Rx(a,x,f,A),ea=!1;var he=a.memoizedState;x.state=he,Du(a,f,x,y),_u(),se=a.memoizedState,_||he!==se||ea?(typeof we=="function"&&(Rp(a,u,we,f),se=a.memoizedState),(H=ea||Ox(a,u,H,f,he,se,A))?(ge||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(a.flags|=4194308)):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=f,a.memoizedState=se),x.props=f,x.state=se,x.context=A,f=H):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),f=!1)}else{x=a.stateNode,hp(i,a),A=a.memoizedProps,ge=us(u,A),x.props=ge,we=a.pendingProps,he=x.context,se=u.contextType,H=Ys,typeof se=="object"&&se!==null&&(H=Wn(se)),_=u.getDerivedStateFromProps,(se=typeof _=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(A!==we||he!==H)&&Rx(a,x,f,H),ea=!1,he=a.memoizedState,x.state=he,Du(a,f,x,y),_u();var de=a.memoizedState;A!==we||he!==de||ea||i!==null&&i.dependencies!==null&&hh(i.dependencies)?(typeof _=="function"&&(Rp(a,u,_,f),de=a.memoizedState),(ge=ea||Ox(a,u,ge,f,he,de,H)||i!==null&&i.dependencies!==null&&hh(i.dependencies))?(se||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,de,H),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,de,H)),typeof x.componentDidUpdate=="function"&&(a.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof x.componentDidUpdate!="function"||A===i.memoizedProps&&he===i.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&he===i.memoizedState||(a.flags|=1024),a.memoizedProps=f,a.memoizedState=de),x.props=f,x.state=de,x.context=H,f=ge):(typeof x.componentDidUpdate!="function"||A===i.memoizedProps&&he===i.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&he===i.memoizedState||(a.flags|=1024),f=!1)}return x=f,_h(i,a),f=(a.flags&128)!==0,x||f?(x=a.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:x.render(),a.flags|=1,i!==null&&f?(a.child=ss(a,i.child,null,y),a.child=ss(a,null,u,y)):Zn(i,a,u,y),a.memoizedState=x.state,i=a.child):i=kl(i,a,y),i}function Xx(i,a,u,f){return ts(),a.flags|=256,Zn(i,a,u,f),a.child}var Pp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Hp(i){return{baseLanes:i,cachePool:Iy()}}function qp(i,a,u){return i=i!==null?i.childLanes&~u:0,a&&(i|=Pr),i}function $x(i,a,u){var f=a.pendingProps,y=!1,x=(a.flags&128)!==0,A;if((A=x)||(A=i!==null&&i.memoizedState===null?!1:(Sn.current&2)!==0),A&&(y=!0,a.flags&=-129),A=(a.flags&32)!==0,a.flags&=-33,i===null){if(_t){if(y?ra(a):ia(),(i=cn)?(i=ib(i,ei),i=i!==null&&i.data!=="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:$l!==null?{id:zi,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},u=My(i),u.return=a,a.child=u,$n=a,cn=null)):i=null,i===null)throw Zl(a);return Sm(i)?a.lanes=32:a.lanes=536870912,null}var _=f.children;return f=f.fallback,y?(ia(),y=a.mode,_=Dh({mode:"hidden",children:_},y),f=es(f,y,u,null),_.return=a,f.return=a,_.sibling=f,a.child=_,f=a.child,f.memoizedState=Hp(u),f.childLanes=qp(i,A,u),a.memoizedState=Pp,Lu(null,f)):(ra(a),Up(a,_))}var H=i.memoizedState;if(H!==null&&(_=H.dehydrated,_!==null)){if(x)a.flags&256?(ra(a),a.flags&=-257,a=Fp(i,a,u)):a.memoizedState!==null?(ia(),a.child=i.child,a.flags|=128,a=null):(ia(),_=f.fallback,y=a.mode,f=Dh({mode:"visible",children:f.children},y),_=es(_,y,u,null),_.flags|=2,f.return=a,_.return=a,f.sibling=_,a.child=f,ss(a,i.child,null,u),f=a.child,f.memoizedState=Hp(u),f.childLanes=qp(i,A,u),a.memoizedState=Pp,a=Lu(null,f));else if(ra(a),Sm(_)){if(A=_.nextSibling&&_.nextSibling.dataset,A)var se=A.dgst;A=se,f=Error(r(419)),f.stack="",f.digest=A,Cu({value:f,source:null,stack:null}),a=Fp(i,a,u)}else if(On||Ws(i,a,u,!1),A=(u&i.childLanes)!==0,On||A){if(A=tn,A!==null&&(f=bn(A,u),f!==0&&f!==H.retryLane))throw H.retryLane=f,qt(i,f),Er(A,i,f),zp;wm(_)||Hh(),a=Fp(i,a,u)}else wm(_)?(a.flags|=192,a.child=i.child,a=null):(i=H.treeContext,cn=ni(_.nextSibling),$n=a,_t=!0,Wl=null,ei=!1,i!==null&&jy(a,i),a=Up(a,f.children),a.flags|=4096);return a}return y?(ia(),_=f.fallback,y=a.mode,H=i.child,se=H.sibling,f=ml(H,{mode:"hidden",children:f.children}),f.subtreeFlags=H.subtreeFlags&65011712,se!==null?_=ml(se,_):(_=es(_,y,u,null),_.flags|=2),_.return=a,f.return=a,f.sibling=_,a.child=f,Lu(null,f),f=a.child,_=i.child.memoizedState,_===null?_=Hp(u):(y=_.cachePool,y!==null?(H=Dn._currentValue,y=y.parent!==H?{parent:H,pool:H}:y):y=Iy(),_={baseLanes:_.baseLanes|u,cachePool:y}),f.memoizedState=_,f.childLanes=qp(i,A,u),a.memoizedState=Pp,Lu(i.child,f)):(ra(a),u=i.child,i=u.sibling,u=ml(u,{mode:"visible",children:f.children}),u.return=a,u.sibling=null,i!==null&&(A=a.deletions,A===null?(a.deletions=[i],a.flags|=16):A.push(i)),a.child=u,a.memoizedState=null,u)}function Up(i,a){return a=Dh({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function Dh(i,a){return i=Br(22,i,null,a),i.lanes=0,i}function Fp(i,a,u){return ss(a,i.child,null,u),i=Up(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function Wx(i,a,u){i.lanes|=a;var f=i.alternate;f!==null&&(f.lanes|=a),ip(i.return,a,u)}function Vp(i,a,u,f,y,x){var A=i.memoizedState;A===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y,treeForkCount:x}:(A.isBackwards=a,A.rendering=null,A.renderingStartTime=0,A.last=f,A.tail=u,A.tailMode=y,A.treeForkCount=x)}function Zx(i,a,u){var f=a.pendingProps,y=f.revealOrder,x=f.tail;f=f.children;var A=Sn.current,_=(A&2)!==0;if(_?(A=A&1|2,a.flags|=128):A&=1,R(Sn,A),Zn(i,a,f,u),f=_t?Su:0,!_&&i!==null&&(i.flags&128)!==0)e:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Wx(i,u,a);else if(i.tag===19)Wx(i,u,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(u=a.child,y=null;u!==null;)i=u.alternate,i!==null&&vh(i)===null&&(y=u),u=u.sibling;u=y,u===null?(y=a.child,a.child=null):(y=u.sibling,u.sibling=null),Vp(a,!1,y,u,x,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=a.child,a.child=null;y!==null;){if(i=y.alternate,i!==null&&vh(i)===null){a.child=y;break}i=y.sibling,y.sibling=u,u=y,y=i}Vp(a,!0,u,null,x,f);break;case"together":Vp(a,!1,null,null,void 0,f);break;default:a.memoizedState=null}return a.child}function kl(i,a,u){if(i!==null&&(a.dependencies=i.dependencies),sa|=a.lanes,(u&a.childLanes)===0)if(i!==null){if(Ws(i,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(r(153));if(a.child!==null){for(i=a.child,u=ml(i,i.pendingProps),a.child=u,u.return=a;i.sibling!==null;)i=i.sibling,u=u.sibling=ml(i,i.pendingProps),u.return=a;u.sibling=null}return a.child}function Kp(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&hh(i)))}function qC(i,a,u){switch(a.tag){case 3:ft(a,a.stateNode.containerInfo),Jl(a,Dn,i.memoizedState.cache),ts();break;case 27:case 5:ve(a);break;case 4:ft(a,a.stateNode.containerInfo);break;case 10:Jl(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,gp(a),null;break;case 13:var f=a.memoizedState;if(f!==null)return f.dehydrated!==null?(ra(a),a.flags|=128,null):(u&a.child.childLanes)!==0?$x(i,a,u):(ra(a),i=kl(i,a,u),i!==null?i.sibling:null);ra(a);break;case 19:var y=(i.flags&128)!==0;if(f=(u&a.childLanes)!==0,f||(Ws(i,a,u,!1),f=(u&a.childLanes)!==0),y){if(f)return Zx(i,a,u);a.flags|=128}if(y=a.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),R(Sn,Sn.current),f)break;return null;case 22:return a.lanes=0,Vx(i,a,u,a.pendingProps);case 24:Jl(a,Dn,i.memoizedState.cache)}return kl(i,a,u)}function Jx(i,a,u){if(i!==null)if(i.memoizedProps!==a.pendingProps)On=!0;else{if(!Kp(i,u)&&(a.flags&128)===0)return On=!1,qC(i,a,u);On=(i.flags&131072)!==0}else On=!1,_t&&(a.flags&1048576)!==0&&Dy(a,Su,a.index);switch(a.lanes=0,a.tag){case 16:e:{var f=a.pendingProps;if(i=ls(a.elementType),a.type=i,typeof i=="function")$d(i)?(f=us(i,f),a.tag=1,a=Qx(null,a,i,f,u)):(a.tag=0,a=Ip(null,a,i,f,u));else{if(i!=null){var y=i.$$typeof;if(y===ce){a.tag=11,a=qx(null,a,i,f,u);break e}else if(y===ee){a.tag=14,a=Ux(null,a,i,f,u);break e}}throw a=ke(i)||i,Error(r(306,a,""))}}return a;case 0:return Ip(i,a,a.type,a.pendingProps,u);case 1:return f=a.type,y=us(f,a.pendingProps),Qx(i,a,f,y,u);case 3:e:{if(ft(a,a.stateNode.containerInfo),i===null)throw Error(r(387));f=a.pendingProps;var x=a.memoizedState;y=x.element,hp(i,a),Du(a,f,null,u);var A=a.memoizedState;if(f=A.cache,Jl(a,Dn,f),f!==x.cache&&lp(a,[Dn],u,!0),_u(),f=A.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:A.cache},a.updateQueue.baseState=x,a.memoizedState=x,a.flags&256){a=Xx(i,a,f,u);break e}else if(f!==y){y=Wr(Error(r(424)),a),Cu(y),a=Xx(i,a,f,u);break e}else for(i=a.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,cn=ni(i.firstChild),$n=a,_t=!0,Wl=null,ei=!0,u=Vy(a,null,f,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(ts(),f===y){a=kl(i,a,u);break e}Zn(i,a,f,u)}a=a.child}return a;case 26:return _h(i,a),i===null?(u=cb(a.type,null,a.pendingProps,null))?a.memoizedState=u:_t||(u=a.type,i=a.pendingProps,f=Yh(Ke.current).createElement(u),f[ln]=a,f[kn]=i,Jn(f,u,i),wn(f),a.stateNode=f):a.memoizedState=cb(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return ve(a),i===null&&_t&&(f=a.stateNode=sb(a.type,a.pendingProps,Ke.current),$n=a,ei=!0,y=cn,fa(a.type)?(Cm=y,cn=ni(f.firstChild)):cn=y),Zn(i,a,a.pendingProps.children,u),_h(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&_t&&((y=f=cn)&&(f=yA(f,a.type,a.pendingProps,ei),f!==null?(a.stateNode=f,$n=a,cn=ni(f.firstChild),ei=!1,y=!0):y=!1),y||Zl(a)),ve(a),y=a.type,x=a.pendingProps,A=i!==null?i.memoizedProps:null,f=x.children,vm(y,x)?f=null:A!==null&&vm(y,A)&&(a.flags|=32),a.memoizedState!==null&&(y=xp(i,a,jC,null,null,u),Wu._currentValue=y),_h(i,a),Zn(i,a,f,u),a.child;case 6:return i===null&&_t&&((i=u=cn)&&(u=xA(u,a.pendingProps,ei),u!==null?(a.stateNode=u,$n=a,cn=null,i=!0):i=!1),i||Zl(a)),null;case 13:return $x(i,a,u);case 4:return ft(a,a.stateNode.containerInfo),f=a.pendingProps,i===null?a.child=ss(a,null,f,u):Zn(i,a,f,u),a.child;case 11:return qx(i,a,a.type,a.pendingProps,u);case 7:return Zn(i,a,a.pendingProps,u),a.child;case 8:return Zn(i,a,a.pendingProps.children,u),a.child;case 12:return Zn(i,a,a.pendingProps.children,u),a.child;case 10:return f=a.pendingProps,Jl(a,a.type,f.value),Zn(i,a,f.children,u),a.child;case 9:return y=a.type._context,f=a.pendingProps.children,rs(a),y=Wn(y),f=f(y),a.flags|=1,Zn(i,a,f,u),a.child;case 14:return Ux(i,a,a.type,a.pendingProps,u);case 15:return Fx(i,a,a.type,a.pendingProps,u);case 19:return Zx(i,a,u);case 31:return HC(i,a,u);case 22:return Vx(i,a,u,a.pendingProps);case 24:return rs(a),f=Wn(Dn),i===null?(y=op(),y===null&&(y=tn,x=ap(),y.pooledCache=x,x.refCount++,x!==null&&(y.pooledCacheLanes|=u),y=x),a.memoizedState={parent:f,cache:y},cp(a),Jl(a,Dn,y)):((i.lanes&u)!==0&&(hp(i,a),Du(a,null,null,u),_u()),y=i.memoizedState,x=a.memoizedState,y.parent!==f?(y={parent:f,cache:f},a.memoizedState=y,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=y),Jl(a,Dn,f)):(f=x.cache,Jl(a,Dn,f),f!==y.cache&&lp(a,[Dn],u,!0))),Zn(i,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}function wl(i){i.flags|=4}function Gp(i,a,u,f,y){if((a=(i.mode&32)!==0)&&(a=!1),a){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(Tv())i.flags|=8192;else throw as=mh,up}else i.flags&=-16777217}function ev(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!mb(a))if(Tv())i.flags|=8192;else throw as=mh,up}function jh(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?Qc():536870912,i.lanes|=a,uo|=a)}function zu(i,a){if(!_t)switch(i.tailMode){case"hidden":a=i.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function hn(i){var a=i.alternate!==null&&i.alternate.child===i.child,u=0,f=0;if(a)for(var y=i.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&65011712,f|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=f,i.childLanes=u,a}function UC(i,a,u){var f=a.pendingProps;switch(ep(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(a),null;case 1:return hn(a),null;case 3:return u=a.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),a.memoizedState.cache!==f&&(a.flags|=2048),xl(Dn),et(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&($s(a)?wl(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,np())),hn(a),null;case 26:var y=a.type,x=a.memoizedState;return i===null?(wl(a),x!==null?(hn(a),ev(a,x)):(hn(a),Gp(a,y,null,f,u))):x?x!==i.memoizedState?(wl(a),hn(a),ev(a,x)):(hn(a),a.flags&=-16777217):(i=i.memoizedProps,i!==f&&wl(a),hn(a),Gp(a,y,i,f,u)),null;case 27:if(gt(a),u=Ke.current,y=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==f&&wl(a);else{if(!f){if(a.stateNode===null)throw Error(r(166));return hn(a),null}i=je.current,$s(a)?Oy(a):(i=sb(y,f,u),a.stateNode=i,wl(a))}return hn(a),null;case 5:if(gt(a),y=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==f&&wl(a);else{if(!f){if(a.stateNode===null)throw Error(r(166));return hn(a),null}if(x=je.current,$s(a))Oy(a);else{var A=Yh(Ke.current);switch(x){case 1:x=A.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:x=A.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":x=A.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":x=A.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":x=A.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof f.is=="string"?A.createElement("select",{is:f.is}):A.createElement("select"),f.multiple?x.multiple=!0:f.size&&(x.size=f.size);break;default:x=typeof f.is=="string"?A.createElement(y,{is:f.is}):A.createElement(y)}}x[ln]=a,x[kn]=f;e:for(A=a.child;A!==null;){if(A.tag===5||A.tag===6)x.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===a)break e;for(;A.sibling===null;){if(A.return===null||A.return===a)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}a.stateNode=x;e:switch(Jn(x,y,f),y){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&wl(a)}}return hn(a),Gp(a,a.type,i===null?null:i.memoizedProps,a.pendingProps,u),null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==f&&wl(a);else{if(typeof f!="string"&&a.stateNode===null)throw Error(r(166));if(i=Ke.current,$s(a)){if(i=a.stateNode,u=a.memoizedProps,f=null,y=$n,y!==null)switch(y.tag){case 27:case 5:f=y.memoizedProps}i[ln]=a,i=!!(i.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||$v(i.nodeValue,u)),i||Zl(a,!0)}else i=Yh(i).createTextNode(f),i[ln]=a,a.stateNode=i}return hn(a),null;case 31:if(u=a.memoizedState,i===null||i.memoizedState!==null){if(f=$s(a),u!==null){if(i===null){if(!f)throw Error(r(318));if(i=a.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(557));i[ln]=a}else ts(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;hn(a),i=!1}else u=np(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=u),i=!0;if(!i)return a.flags&256?(zr(a),a):(zr(a),null);if((a.flags&128)!==0)throw Error(r(558))}return hn(a),null;case 13:if(f=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=$s(a),f!==null&&f.dehydrated!==null){if(i===null){if(!y)throw Error(r(318));if(y=a.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[ln]=a}else ts(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;hn(a),y=!1}else y=np(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return a.flags&256?(zr(a),a):(zr(a),null)}return zr(a),(a.flags&128)!==0?(a.lanes=u,a):(u=f!==null,i=i!==null&&i.memoizedState!==null,u&&(f=a.child,y=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(y=f.alternate.memoizedState.cachePool.pool),x=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==y&&(f.flags|=2048)),u!==i&&u&&(a.child.flags|=8192),jh(a,a.updateQueue),hn(a),null);case 4:return et(),i===null&&pm(a.stateNode.containerInfo),hn(a),null;case 10:return xl(a.type),hn(a),null;case 19:if(qe(Sn),f=a.memoizedState,f===null)return hn(a),null;if(y=(a.flags&128)!==0,x=f.rendering,x===null)if(y)zu(f,!1);else{if(vn!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(x=vh(i),x!==null){for(a.flags|=128,zu(f,!1),i=x.updateQueue,a.updateQueue=i,jh(a,i),a.subtreeFlags=0,i=u,u=a.child;u!==null;)Ny(u,i),u=u.sibling;return R(Sn,Sn.current&1|2),_t&&gl(a,f.treeForkCount),a.child}i=i.sibling}f.tail!==null&&Yt()>zh&&(a.flags|=128,y=!0,zu(f,!1),a.lanes=4194304)}else{if(!y)if(i=vh(x),i!==null){if(a.flags|=128,y=!0,i=i.updateQueue,a.updateQueue=i,jh(a,i),zu(f,!0),f.tail===null&&f.tailMode==="hidden"&&!x.alternate&&!_t)return hn(a),null}else 2*Yt()-f.renderingStartTime>zh&&u!==536870912&&(a.flags|=128,y=!0,zu(f,!1),a.lanes=4194304);f.isBackwards?(x.sibling=a.child,a.child=x):(i=f.last,i!==null?i.sibling=x:a.child=x,f.last=x)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Yt(),i.sibling=null,u=Sn.current,R(Sn,y?u&1|2:u&1),_t&&gl(a,f.treeForkCount),i):(hn(a),null);case 22:case 23:return zr(a),mp(),f=a.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(a.flags|=8192):f&&(a.flags|=8192),f?(u&536870912)!==0&&(a.flags&128)===0&&(hn(a),a.subtreeFlags&6&&(a.flags|=8192)):hn(a),u=a.updateQueue,u!==null&&jh(a,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),f=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(f=a.memoizedState.cachePool.pool),f!==u&&(a.flags|=2048),i!==null&&qe(is),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),xl(Dn),hn(a),null;case 25:return null;case 30:return null}throw Error(r(156,a.tag))}function FC(i,a){switch(ep(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return xl(Dn),et(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return gt(a),null;case 31:if(a.memoizedState!==null){if(zr(a),a.alternate===null)throw Error(r(340));ts()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 13:if(zr(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(r(340));ts()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return qe(Sn),null;case 4:return et(),null;case 10:return xl(a.type),null;case 22:case 23:return zr(a),mp(),i!==null&&qe(is),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return xl(Dn),null;case 25:return null;default:return null}}function tv(i,a){switch(ep(a),a.tag){case 3:xl(Dn),et();break;case 26:case 27:case 5:gt(a);break;case 4:et();break;case 31:a.memoizedState!==null&&zr(a);break;case 13:zr(a);break;case 19:qe(Sn);break;case 10:xl(a.type);break;case 22:case 23:zr(a),mp(),i!==null&&qe(is);break;case 24:xl(Dn)}}function Iu(i,a){try{var u=a.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var y=f.next;u=y;do{if((u.tag&i)===i){f=void 0;var x=u.create,A=u.inst;f=x(),A.destroy=f}u=u.next}while(u!==y)}}catch(_){Ft(a,a.return,_)}}function la(i,a,u){try{var f=a.updateQueue,y=f!==null?f.lastEffect:null;if(y!==null){var x=y.next;f=x;do{if((f.tag&i)===i){var A=f.inst,_=A.destroy;if(_!==void 0){A.destroy=void 0,y=a;var H=u,se=_;try{se()}catch(ge){Ft(y,H,ge)}}}f=f.next}while(f!==x)}}catch(ge){Ft(a,a.return,ge)}}function nv(i){var a=i.updateQueue;if(a!==null){var u=i.stateNode;try{Gy(a,u)}catch(f){Ft(i,i.return,f)}}}function rv(i,a,u){u.props=us(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(f){Ft(i,a,f)}}function Pu(i,a){try{var u=i.ref;if(u!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof u=="function"?i.refCleanup=u(f):u.current=f}}catch(y){Ft(i,a,y)}}function Pi(i,a){var u=i.ref,f=i.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(y){Ft(i,a,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){Ft(i,a,y)}else u.current=null}function iv(i){var a=i.type,u=i.memoizedProps,f=i.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(y){Ft(i,i.return,y)}}function Yp(i,a,u){try{var f=i.stateNode;hA(f,i.type,u,a),f[kn]=a}catch(y){Ft(i,i.return,y)}}function lv(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&fa(i.type)||i.tag===4}function Qp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||lv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&fa(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Xp(i,a,u){var f=i.tag;if(f===5||f===6)i=i.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(i,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(i),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=wr));else if(f!==4&&(f===27&&fa(i.type)&&(u=i.stateNode,a=null),i=i.child,i!==null))for(Xp(i,a,u),i=i.sibling;i!==null;)Xp(i,a,u),i=i.sibling}function Oh(i,a,u){var f=i.tag;if(f===5||f===6)i=i.stateNode,a?u.insertBefore(i,a):u.appendChild(i);else if(f!==4&&(f===27&&fa(i.type)&&(u=i.stateNode),i=i.child,i!==null))for(Oh(i,a,u),i=i.sibling;i!==null;)Oh(i,a,u),i=i.sibling}function av(i){var a=i.stateNode,u=i.memoizedProps;try{for(var f=i.type,y=a.attributes;y.length;)a.removeAttributeNode(y[0]);Jn(a,f,u),a[ln]=i,a[kn]=u}catch(x){Ft(i,i.return,x)}}var Sl=!1,Rn=!1,$p=!1,sv=typeof WeakSet=="function"?WeakSet:Set,Yn=null;function VC(i,a){if(i=i.containerInfo,ym=ef,i=E(i),M(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{u.nodeType,x.nodeType}catch{u=null;break e}var A=0,_=-1,H=-1,se=0,ge=0,we=i,he=null;t:for(;;){for(var de;we!==u||y!==0&&we.nodeType!==3||(_=A+y),we!==x||f!==0&&we.nodeType!==3||(H=A+f),we.nodeType===3&&(A+=we.nodeValue.length),(de=we.firstChild)!==null;)he=we,we=de;for(;;){if(we===i)break t;if(he===u&&++se===y&&(_=A),he===x&&++ge===f&&(H=A),(de=we.nextSibling)!==null)break;we=he,he=we.parentNode}we=de}u=_===-1||H===-1?null:{start:_,end:H}}else u=null}u=u||{start:0,end:0}}else u=null;for(xm={focusedElem:i,selectionRange:u},ef=!1,Yn=a;Yn!==null;)if(a=Yn,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,Yn=i;else for(;Yn!==null;){switch(a=Yn,x=a.alternate,i=a.flags,a.tag){case 0:if((i&4)!==0&&(i=a.updateQueue,i=i!==null?i.events:null,i!==null))for(u=0;u<i.length;u++)y=i[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&x!==null){i=void 0,u=a,y=x.memoizedProps,x=x.memoizedState,f=u.stateNode;try{var Je=us(u.type,y);i=f.getSnapshotBeforeUpdate(Je,x),f.__reactInternalSnapshotBeforeUpdate=i}catch(ut){Ft(u,u.return,ut)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,u=i.nodeType,u===9)km(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":km(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=a.sibling,i!==null){i.return=a.return,Yn=i;break}Yn=a.return}}function ov(i,a,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:Al(i,u),f&4&&Iu(5,u);break;case 1:if(Al(i,u),f&4)if(i=u.stateNode,a===null)try{i.componentDidMount()}catch(A){Ft(u,u.return,A)}else{var y=us(u.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(y,a,i.__reactInternalSnapshotBeforeUpdate)}catch(A){Ft(u,u.return,A)}}f&64&&nv(u),f&512&&Pu(u,u.return);break;case 3:if(Al(i,u),f&64&&(i=u.updateQueue,i!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{Gy(i,a)}catch(A){Ft(u,u.return,A)}}break;case 27:a===null&&f&4&&av(u);case 26:case 5:Al(i,u),a===null&&f&4&&iv(u),f&512&&Pu(u,u.return);break;case 12:Al(i,u);break;case 31:Al(i,u),f&4&&hv(i,u);break;case 13:Al(i,u),f&4&&fv(i,u),f&64&&(i=u.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(u=JC.bind(null,u),vA(i,u))));break;case 22:if(f=u.memoizedState!==null||Sl,!f){a=a!==null&&a.memoizedState!==null||Rn,y=Sl;var x=Rn;Sl=f,(Rn=a)&&!x?Tl(i,u,(u.subtreeFlags&8772)!==0):Al(i,u),Sl=y,Rn=x}break;case 30:break;default:Al(i,u)}}function uv(i){var a=i.alternate;a!==null&&(i.alternate=null,uv(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&Es(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var pn=null,Sr=!1;function Cl(i,a,u){for(u=u.child;u!==null;)cv(i,a,u),u=u.sibling}function cv(i,a,u){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(Mn,u)}catch{}switch(u.tag){case 26:Rn||Pi(u,a),Cl(i,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Rn||Pi(u,a);var f=pn,y=Sr;fa(u.type)&&(pn=u.stateNode,Sr=!1),Cl(i,a,u),Qu(u.stateNode),pn=f,Sr=y;break;case 5:Rn||Pi(u,a);case 6:if(f=pn,y=Sr,pn=null,Cl(i,a,u),pn=f,Sr=y,pn!==null)if(Sr)try{(pn.nodeType===9?pn.body:pn.nodeName==="HTML"?pn.ownerDocument.body:pn).removeChild(u.stateNode)}catch(x){Ft(u,a,x)}else try{pn.removeChild(u.stateNode)}catch(x){Ft(u,a,x)}break;case 18:pn!==null&&(Sr?(i=pn,nb(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,u.stateNode),xo(i)):nb(pn,u.stateNode));break;case 4:f=pn,y=Sr,pn=u.stateNode.containerInfo,Sr=!0,Cl(i,a,u),pn=f,Sr=y;break;case 0:case 11:case 14:case 15:la(2,u,a),Rn||la(4,u,a),Cl(i,a,u);break;case 1:Rn||(Pi(u,a),f=u.stateNode,typeof f.componentWillUnmount=="function"&&rv(u,a,f)),Cl(i,a,u);break;case 21:Cl(i,a,u);break;case 22:Rn=(f=Rn)||u.memoizedState!==null,Cl(i,a,u),Rn=f;break;default:Cl(i,a,u)}}function hv(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{xo(i)}catch(u){Ft(a,a.return,u)}}}function fv(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{xo(i)}catch(u){Ft(a,a.return,u)}}function KC(i){switch(i.tag){case 31:case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new sv),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new sv),a;default:throw Error(r(435,i.tag))}}function Rh(i,a){var u=KC(i);a.forEach(function(f){if(!u.has(f)){u.add(f);var y=eA.bind(null,i,f);f.then(y,y)}})}function Cr(i,a){var u=a.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f],x=i,A=a,_=A;e:for(;_!==null;){switch(_.tag){case 27:if(fa(_.type)){pn=_.stateNode,Sr=!1;break e}break;case 5:pn=_.stateNode,Sr=!1;break e;case 3:case 4:pn=_.stateNode.containerInfo,Sr=!0;break e}_=_.return}if(pn===null)throw Error(r(160));cv(x,A,y),pn=null,Sr=!1,x=y.alternate,x!==null&&(x.return=null),y.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)dv(a,i),a=a.sibling}var xi=null;function dv(i,a){var u=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Cr(a,i),Ar(i),f&4&&(la(3,i,i.return),Iu(3,i),la(5,i,i.return));break;case 1:Cr(a,i),Ar(i),f&512&&(Rn||u===null||Pi(u,u.return)),f&64&&Sl&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var y=xi;if(Cr(a,i),Ar(i),f&512&&(Rn||u===null||Pi(u,u.return)),f&4){var x=u!==null?u.memoizedState:null;if(f=i.memoizedState,u===null)if(f===null)if(i.stateNode===null){e:{f=i.type,u=i.memoizedProps,y=y.ownerDocument||y;t:switch(f){case"title":x=y.getElementsByTagName("title")[0],(!x||x[jr]||x[ln]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=y.createElement(f),y.head.insertBefore(x,y.querySelector("head > title"))),Jn(x,f,u),x[ln]=i,wn(x),f=x;break e;case"link":var A=db("link","href",y).get(f+(u.href||""));if(A){for(var _=0;_<A.length;_++)if(x=A[_],x.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&x.getAttribute("rel")===(u.rel==null?null:u.rel)&&x.getAttribute("title")===(u.title==null?null:u.title)&&x.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){A.splice(_,1);break t}}x=y.createElement(f),Jn(x,f,u),y.head.appendChild(x);break;case"meta":if(A=db("meta","content",y).get(f+(u.content||""))){for(_=0;_<A.length;_++)if(x=A[_],x.getAttribute("content")===(u.content==null?null:""+u.content)&&x.getAttribute("name")===(u.name==null?null:u.name)&&x.getAttribute("property")===(u.property==null?null:u.property)&&x.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&x.getAttribute("charset")===(u.charSet==null?null:u.charSet)){A.splice(_,1);break t}}x=y.createElement(f),Jn(x,f,u),y.head.appendChild(x);break;default:throw Error(r(468,f))}x[ln]=i,wn(x),f=x}i.stateNode=f}else pb(y,i.type,i.stateNode);else i.stateNode=fb(y,f,i.memoizedProps);else x!==f?(x===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):x.count--,f===null?pb(y,i.type,i.stateNode):fb(y,f,i.memoizedProps)):f===null&&i.stateNode!==null&&Yp(i,i.memoizedProps,u.memoizedProps)}break;case 27:Cr(a,i),Ar(i),f&512&&(Rn||u===null||Pi(u,u.return)),u!==null&&f&4&&Yp(i,i.memoizedProps,u.memoizedProps);break;case 5:if(Cr(a,i),Ar(i),f&512&&(Rn||u===null||Pi(u,u.return)),i.flags&32){y=i.stateNode;try{ll(y,"")}catch(Je){Ft(i,i.return,Je)}}f&4&&i.stateNode!=null&&(y=i.memoizedProps,Yp(i,y,u!==null?u.memoizedProps:y)),f&1024&&($p=!0);break;case 6:if(Cr(a,i),Ar(i),f&4){if(i.stateNode===null)throw Error(r(162));f=i.memoizedProps,u=i.stateNode;try{u.nodeValue=f}catch(Je){Ft(i,i.return,Je)}}break;case 3:if($h=null,y=xi,xi=Qh(a.containerInfo),Cr(a,i),xi=y,Ar(i),f&4&&u!==null&&u.memoizedState.isDehydrated)try{xo(a.containerInfo)}catch(Je){Ft(i,i.return,Je)}$p&&($p=!1,pv(i));break;case 4:f=xi,xi=Qh(i.stateNode.containerInfo),Cr(a,i),Ar(i),xi=f;break;case 12:Cr(a,i),Ar(i);break;case 31:Cr(a,i),Ar(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Rh(i,f)));break;case 13:Cr(a,i),Ar(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Lh=Yt()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Rh(i,f)));break;case 22:y=i.memoizedState!==null;var H=u!==null&&u.memoizedState!==null,se=Sl,ge=Rn;if(Sl=se||y,Rn=ge||H,Cr(a,i),Rn=ge,Sl=se,Ar(i),f&8192)e:for(a=i.stateNode,a._visibility=y?a._visibility&-2:a._visibility|1,y&&(u===null||H||Sl||Rn||cs(i)),u=null,a=i;;){if(a.tag===5||a.tag===26){if(u===null){H=u=a;try{if(x=H.stateNode,y)A=x.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{_=H.stateNode;var we=H.memoizedProps.style,he=we!=null&&we.hasOwnProperty("display")?we.display:null;_.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(Je){Ft(H,H.return,Je)}}}else if(a.tag===6){if(u===null){H=a;try{H.stateNode.nodeValue=y?"":H.memoizedProps}catch(Je){Ft(H,H.return,Je)}}}else if(a.tag===18){if(u===null){H=a;try{var de=H.stateNode;y?rb(de,!0):rb(H.stateNode,!1)}catch(Je){Ft(H,H.return,Je)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}f&4&&(f=i.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,Rh(i,u))));break;case 19:Cr(a,i),Ar(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,Rh(i,f)));break;case 30:break;case 21:break;default:Cr(a,i),Ar(i)}}function Ar(i){var a=i.flags;if(a&2){try{for(var u,f=i.return;f!==null;){if(lv(f)){u=f;break}f=f.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var y=u.stateNode,x=Qp(i);Oh(i,x,y);break;case 5:var A=u.stateNode;u.flags&32&&(ll(A,""),u.flags&=-33);var _=Qp(i);Oh(i,_,A);break;case 3:case 4:var H=u.stateNode.containerInfo,se=Qp(i);Xp(i,se,H);break;default:throw Error(r(161))}}catch(ge){Ft(i,i.return,ge)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function pv(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;pv(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function Al(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)ov(i,a.alternate,a),a=a.sibling}function cs(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:la(4,a,a.return),cs(a);break;case 1:Pi(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&rv(a,a.return,u),cs(a);break;case 27:Qu(a.stateNode);case 26:case 5:Pi(a,a.return),cs(a);break;case 22:a.memoizedState===null&&cs(a);break;case 30:cs(a);break;default:cs(a)}i=i.sibling}}function Tl(i,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var f=a.alternate,y=i,x=a,A=x.flags;switch(x.tag){case 0:case 11:case 15:Tl(y,x,u),Iu(4,x);break;case 1:if(Tl(y,x,u),f=x,y=f.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(se){Ft(f,f.return,se)}if(f=x,y=f.updateQueue,y!==null){var _=f.stateNode;try{var H=y.shared.hiddenCallbacks;if(H!==null)for(y.shared.hiddenCallbacks=null,y=0;y<H.length;y++)Ky(H[y],_)}catch(se){Ft(f,f.return,se)}}u&&A&64&&nv(x),Pu(x,x.return);break;case 27:av(x);case 26:case 5:Tl(y,x,u),u&&f===null&&A&4&&iv(x),Pu(x,x.return);break;case 12:Tl(y,x,u);break;case 31:Tl(y,x,u),u&&A&4&&hv(y,x);break;case 13:Tl(y,x,u),u&&A&4&&fv(y,x);break;case 22:x.memoizedState===null&&Tl(y,x,u),Pu(x,x.return);break;case 30:break;default:Tl(y,x,u)}a=a.sibling}}function Wp(i,a){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&Au(u))}function Zp(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&Au(i))}function vi(i,a,u,f){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)mv(i,a,u,f),a=a.sibling}function mv(i,a,u,f){var y=a.flags;switch(a.tag){case 0:case 11:case 15:vi(i,a,u,f),y&2048&&Iu(9,a);break;case 1:vi(i,a,u,f);break;case 3:vi(i,a,u,f),y&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&Au(i)));break;case 12:if(y&2048){vi(i,a,u,f),i=a.stateNode;try{var x=a.memoizedProps,A=x.id,_=x.onPostCommit;typeof _=="function"&&_(A,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(H){Ft(a,a.return,H)}}else vi(i,a,u,f);break;case 31:vi(i,a,u,f);break;case 13:vi(i,a,u,f);break;case 23:break;case 22:x=a.stateNode,A=a.alternate,a.memoizedState!==null?x._visibility&2?vi(i,a,u,f):Hu(i,a):x._visibility&2?vi(i,a,u,f):(x._visibility|=2,ao(i,a,u,f,(a.subtreeFlags&10256)!==0||!1)),y&2048&&Wp(A,a);break;case 24:vi(i,a,u,f),y&2048&&Zp(a.alternate,a);break;default:vi(i,a,u,f)}}function ao(i,a,u,f,y){for(y=y&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var x=i,A=a,_=u,H=f,se=A.flags;switch(A.tag){case 0:case 11:case 15:ao(x,A,_,H,y),Iu(8,A);break;case 23:break;case 22:var ge=A.stateNode;A.memoizedState!==null?ge._visibility&2?ao(x,A,_,H,y):Hu(x,A):(ge._visibility|=2,ao(x,A,_,H,y)),y&&se&2048&&Wp(A.alternate,A);break;case 24:ao(x,A,_,H,y),y&&se&2048&&Zp(A.alternate,A);break;default:ao(x,A,_,H,y)}a=a.sibling}}function Hu(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=i,f=a,y=f.flags;switch(f.tag){case 22:Hu(u,f),y&2048&&Wp(f.alternate,f);break;case 24:Hu(u,f),y&2048&&Zp(f.alternate,f);break;default:Hu(u,f)}a=a.sibling}}var qu=8192;function so(i,a,u){if(i.subtreeFlags&qu)for(i=i.child;i!==null;)gv(i,a,u),i=i.sibling}function gv(i,a,u){switch(i.tag){case 26:so(i,a,u),i.flags&qu&&i.memoizedState!==null&&DA(u,xi,i.memoizedState,i.memoizedProps);break;case 5:so(i,a,u);break;case 3:case 4:var f=xi;xi=Qh(i.stateNode.containerInfo),so(i,a,u),xi=f;break;case 22:i.memoizedState===null&&(f=i.alternate,f!==null&&f.memoizedState!==null?(f=qu,qu=16777216,so(i,a,u),qu=f):so(i,a,u));break;default:so(i,a,u)}}function yv(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function Uu(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var f=a[u];Yn=f,vv(f,i)}yv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)xv(i),i=i.sibling}function xv(i){switch(i.tag){case 0:case 11:case 15:Uu(i),i.flags&2048&&la(9,i,i.return);break;case 3:Uu(i);break;case 12:Uu(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,Bh(i)):Uu(i);break;default:Uu(i)}}function Bh(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var f=a[u];Yn=f,vv(f,i)}yv(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:la(8,a,a.return),Bh(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,Bh(a));break;default:Bh(a)}i=i.sibling}}function vv(i,a){for(;Yn!==null;){var u=Yn;switch(u.tag){case 0:case 11:case 15:la(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Au(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,Yn=f;else e:for(u=i;Yn!==null;){f=Yn;var y=f.sibling,x=f.return;if(uv(f),f===u){Yn=null;break e}if(y!==null){y.return=x,Yn=y;break e}Yn=x}}}var GC={getCacheForType:function(i){var a=Wn(Dn),u=a.data.get(i);return u===void 0&&(u=i(),a.data.set(i,u)),u},cacheSignal:function(){return Wn(Dn).controller.signal}},YC=typeof WeakMap=="function"?WeakMap:Map,Pt=0,tn=null,St=null,Tt=0,Ut=0,Ir=null,aa=!1,oo=!1,Jp=!1,El=0,vn=0,sa=0,hs=0,em=0,Pr=0,uo=0,Fu=null,Tr=null,tm=!1,Lh=0,bv=0,zh=1/0,Ih=null,oa=null,Pn=0,ua=null,co=null,Nl=0,nm=0,rm=null,kv=null,Vu=0,im=null;function Hr(){return(Pt&2)!==0&&Tt!==0?Tt&-Tt:q.T!==null?cm():Pa()}function wv(){if(Pr===0)if((Tt&536870912)===0||_t){var i=Ll;Ll<<=1,(Ll&3932160)===0&&(Ll=262144),Pr=i}else Pr=536870912;return i=Lr.current,i!==null&&(i.flags|=32),Pr}function Er(i,a,u){(i===tn&&(Ut===2||Ut===9)||i.cancelPendingCommit!==null)&&(ho(i,0),ca(i,Tt,Pr,!1)),Gr(i,u),((Pt&2)===0||i!==tn)&&(i===tn&&((Pt&2)===0&&(hs|=u),vn===4&&ca(i,Tt,Pr,!1)),Hi(i))}function Sv(i,a,u){if((Pt&6)!==0)throw Error(r(327));var f=!u&&(a&127)===0&&(a&i.expiredLanes)===0||nl(i,a),y=f?$C(i,a):am(i,a,!0),x=f;do{if(y===0){oo&&!f&&ca(i,a,0,!1);break}else{if(u=i.current.alternate,x&&!QC(u)){y=am(i,a,!1),x=!1;continue}if(y===2){if(x=a,i.errorRecoveryDisabledLanes&x)var A=0;else A=i.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){a=A;e:{var _=i;y=Fu;var H=_.current.memoizedState.isDehydrated;if(H&&(ho(_,A).flags|=256),A=am(_,A,!1),A!==2){if(Jp&&!H){_.errorRecoveryDisabledLanes|=x,hs|=x,y=4;break e}x=Tr,Tr=y,x!==null&&(Tr===null?Tr=x:Tr.push.apply(Tr,x))}y=A}if(x=!1,y!==2)continue}}if(y===1){ho(i,0),ca(i,a,0,!0);break}e:{switch(f=i,x=y,x){case 0:case 1:throw Error(r(345));case 4:if((a&4194048)!==a)break;case 6:ca(f,a,Pr,!aa);break e;case 2:Tr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((a&62914560)===a&&(y=Lh+300-Yt(),10<y)){if(ca(f,a,Pr,!aa),za(f,0,!0)!==0)break e;Nl=a,f.timeoutHandle=eb(Cv.bind(null,f,u,Tr,Ih,tm,a,Pr,hs,uo,aa,x,"Throttled",-0,0),y);break e}Cv(f,u,Tr,Ih,tm,a,Pr,hs,uo,aa,x,null,-0,0)}}break}while(!0);Hi(i)}function Cv(i,a,u,f,y,x,A,_,H,se,ge,we,he,de){if(i.timeoutHandle=-1,we=a.subtreeFlags,we&8192||(we&16785408)===16785408){we={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:wr},gv(a,x,we);var Je=(x&62914560)===x?Lh-Yt():(x&4194048)===x?bv-Yt():0;if(Je=jA(we,Je),Je!==null){Nl=x,i.cancelPendingCommit=Je(jv.bind(null,i,a,x,u,f,y,A,_,H,ge,we,null,he,de)),ca(i,x,A,!se);return}}jv(i,a,x,u,f,y,A,_,H)}function QC(i){for(var a=i;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var y=u[f],x=y.getSnapshot;y=y.value;try{if(!or(x(),y))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ca(i,a,u,f){a&=~em,a&=~hs,i.suspendedLanes|=a,i.pingedLanes&=~a,f&&(i.warmLanes|=a),f=i.expirationTimes;for(var y=a;0<y;){var x=31-Le(y),A=1<<x;f[x]=-1,y&=~A}u!==0&&Ia(i,u,a)}function Ph(){return(Pt&6)===0?(Ku(0),!1):!0}function lm(){if(St!==null){if(Ut===0)var i=St.return;else i=St,yl=ns=null,kp(i),to=null,Eu=0,i=St;for(;i!==null;)tv(i.alternate,i),i=i.return;St=null}}function ho(i,a){var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,pA(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),Nl=0,lm(),tn=i,St=u=ml(i.current,null),Tt=a,Ut=0,Ir=null,aa=!1,oo=nl(i,a),Jp=!1,uo=Pr=em=hs=sa=vn=0,Tr=Fu=null,tm=!1,(a&8)!==0&&(a|=a&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=a;0<f;){var y=31-Le(f),x=1<<y;a|=i[y],f&=~x}return El=a,dt(),u}function Av(i,a){mt=null,q.H=Bu,a===eo||a===ph?(a=qy(),Ut=3):a===up?(a=qy(),Ut=4):Ut=a===zp?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ir=a,St===null&&(vn=1,Nh(i,Wr(a,i.current)))}function Tv(){var i=Lr.current;return i===null?!0:(Tt&4194048)===Tt?ti===null:(Tt&62914560)===Tt||(Tt&536870912)!==0?i===ti:!1}function Ev(){var i=q.H;return q.H=Bu,i===null?Bu:i}function Nv(){var i=q.A;return q.A=GC,i}function Hh(){vn=4,aa||(Tt&4194048)!==Tt&&Lr.current!==null||(oo=!0),(sa&134217727)===0&&(hs&134217727)===0||tn===null||ca(tn,Tt,Pr,!1)}function am(i,a,u){var f=Pt;Pt|=2;var y=Ev(),x=Nv();(tn!==i||Tt!==a)&&(Ih=null,ho(i,a)),a=!1;var A=vn;e:do try{if(Ut!==0&&St!==null){var _=St,H=Ir;switch(Ut){case 8:lm(),A=6;break e;case 3:case 2:case 9:case 6:Lr.current===null&&(a=!0);var se=Ut;if(Ut=0,Ir=null,fo(i,_,H,se),u&&oo){A=0;break e}break;default:se=Ut,Ut=0,Ir=null,fo(i,_,H,se)}}XC(),A=vn;break}catch(ge){Av(i,ge)}while(!0);return a&&i.shellSuspendCounter++,yl=ns=null,Pt=f,q.H=y,q.A=x,St===null&&(tn=null,Tt=0,dt()),A}function XC(){for(;St!==null;)Mv(St)}function $C(i,a){var u=Pt;Pt|=2;var f=Ev(),y=Nv();tn!==i||Tt!==a?(Ih=null,zh=Yt()+500,ho(i,a)):oo=nl(i,a);e:do try{if(Ut!==0&&St!==null){a=St;var x=Ir;t:switch(Ut){case 1:Ut=0,Ir=null,fo(i,a,x,1);break;case 2:case 9:if(Py(x)){Ut=0,Ir=null,_v(a);break}a=function(){Ut!==2&&Ut!==9||tn!==i||(Ut=7),Hi(i)},x.then(a,a);break e;case 3:Ut=7;break e;case 4:Ut=5;break e;case 7:Py(x)?(Ut=0,Ir=null,_v(a)):(Ut=0,Ir=null,fo(i,a,x,7));break;case 5:var A=null;switch(St.tag){case 26:A=St.memoizedState;case 5:case 27:var _=St;if(A?mb(A):_.stateNode.complete){Ut=0,Ir=null;var H=_.sibling;if(H!==null)St=H;else{var se=_.return;se!==null?(St=se,qh(se)):St=null}break t}}Ut=0,Ir=null,fo(i,a,x,5);break;case 6:Ut=0,Ir=null,fo(i,a,x,6);break;case 8:lm(),vn=6;break e;default:throw Error(r(462))}}WC();break}catch(ge){Av(i,ge)}while(!0);return yl=ns=null,q.H=f,q.A=y,Pt=u,St!==null?0:(tn=null,Tt=0,dt(),vn)}function WC(){for(;St!==null&&!zt();)Mv(St)}function Mv(i){var a=Jx(i.alternate,i,El);i.memoizedProps=i.pendingProps,a===null?qh(i):St=a}function _v(i){var a=i,u=a.alternate;switch(a.tag){case 15:case 0:a=Yx(u,a,a.pendingProps,a.type,void 0,Tt);break;case 11:a=Yx(u,a,a.pendingProps,a.type.render,a.ref,Tt);break;case 5:kp(a);default:tv(u,a),a=St=Ny(a,El),a=Jx(u,a,El)}i.memoizedProps=i.pendingProps,a===null?qh(i):St=a}function fo(i,a,u,f){yl=ns=null,kp(a),to=null,Eu=0;var y=a.return;try{if(PC(i,y,a,u,Tt)){vn=1,Nh(i,Wr(u,i.current)),St=null;return}}catch(x){if(y!==null)throw St=y,x;vn=1,Nh(i,Wr(u,i.current)),St=null;return}a.flags&32768?(_t||f===1?i=!0:oo||(Tt&536870912)!==0?i=!1:(aa=i=!0,(f===2||f===9||f===3||f===6)&&(f=Lr.current,f!==null&&f.tag===13&&(f.flags|=16384))),Dv(a,i)):qh(a)}function qh(i){var a=i;do{if((a.flags&32768)!==0){Dv(a,aa);return}i=a.return;var u=UC(a.alternate,a,El);if(u!==null){St=u;return}if(a=a.sibling,a!==null){St=a;return}St=a=i}while(a!==null);vn===0&&(vn=5)}function Dv(i,a){do{var u=FC(i.alternate,i);if(u!==null){u.flags&=32767,St=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(i=i.sibling,i!==null)){St=i;return}St=i=u}while(i!==null);vn=6,St=null}function jv(i,a,u,f,y,x,A,_,H){i.cancelPendingCommit=null;do Uh();while(Pn!==0);if((Pt&6)!==0)throw Error(r(327));if(a!==null){if(a===i.current)throw Error(r(177));if(x=a.lanes|a.childLanes,x|=it,tu(i,u,x,A,_,H),i===tn&&(St=tn=null,Tt=0),co=a,ua=i,Nl=u,nm=x,rm=y,kv=f,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,tA(rt,function(){return zv(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||f){f=q.T,q.T=null,y=le.p,le.p=2,A=Pt,Pt|=4;try{VC(i,a,u)}finally{Pt=A,le.p=y,q.T=f}}Pn=1,Ov(),Rv(),Bv()}}function Ov(){if(Pn===1){Pn=0;var i=ua,a=co,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=q.T,q.T=null;var f=le.p;le.p=2;var y=Pt;Pt|=4;try{dv(a,i);var x=xm,A=E(i.containerInfo),_=x.focusedElem,H=x.selectionRange;if(A!==_&&_&&_.ownerDocument&&C(_.ownerDocument.documentElement,_)){if(H!==null&&M(_)){var se=H.start,ge=H.end;if(ge===void 0&&(ge=se),"selectionStart"in _)_.selectionStart=se,_.selectionEnd=Math.min(ge,_.value.length);else{var we=_.ownerDocument||document,he=we&&we.defaultView||window;if(he.getSelection){var de=he.getSelection(),Je=_.textContent.length,ut=Math.min(H.start,Je),Zt=H.end===void 0?ut:Math.min(H.end,Je);!de.extend&&ut>Zt&&(A=Zt,Zt=ut,ut=A);var te=S(_,ut),W=S(_,Zt);if(te&&W&&(de.rangeCount!==1||de.anchorNode!==te.node||de.anchorOffset!==te.offset||de.focusNode!==W.node||de.focusOffset!==W.offset)){var ae=we.createRange();ae.setStart(te.node,te.offset),de.removeAllRanges(),ut>Zt?(de.addRange(ae),de.extend(W.node,W.offset)):(ae.setEnd(W.node,W.offset),de.addRange(ae))}}}}for(we=[],de=_;de=de.parentNode;)de.nodeType===1&&we.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<we.length;_++){var xe=we[_];xe.element.scrollLeft=xe.left,xe.element.scrollTop=xe.top}}ef=!!ym,xm=ym=null}finally{Pt=y,le.p=f,q.T=u}}i.current=a,Pn=2}}function Rv(){if(Pn===2){Pn=0;var i=ua,a=co,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=q.T,q.T=null;var f=le.p;le.p=2;var y=Pt;Pt|=4;try{ov(i,a.alternate,a)}finally{Pt=y,le.p=f,q.T=u}}Pn=3}}function Bv(){if(Pn===4||Pn===3){Pn=0,Jt();var i=ua,a=co,u=Nl,f=kv;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Pn=5:(Pn=0,co=ua=null,Lv(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(oa=null),zl(u),a=a.stateNode,mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(Mn,a,void 0,(a.current.flags&128)===128)}catch{}if(f!==null){a=q.T,y=le.p,le.p=2,q.T=null;try{for(var x=i.onRecoverableError,A=0;A<f.length;A++){var _=f[A];x(_.value,{componentStack:_.stack})}}finally{q.T=a,le.p=y}}(Nl&3)!==0&&Uh(),Hi(i),y=i.pendingLanes,(u&261930)!==0&&(y&42)!==0?i===im?Vu++:(Vu=0,im=i):Vu=0,Ku(0)}}function Lv(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,Au(a)))}function Uh(){return Ov(),Rv(),Bv(),zv()}function zv(){if(Pn!==5)return!1;var i=ua,a=nm;nm=0;var u=zl(Nl),f=q.T,y=le.p;try{le.p=32>u?32:u,q.T=null,u=rm,rm=null;var x=ua,A=Nl;if(Pn=0,co=ua=null,Nl=0,(Pt&6)!==0)throw Error(r(331));var _=Pt;if(Pt|=4,xv(x.current),mv(x,x.current,A,u),Pt=_,Ku(0,!1),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(Mn,x)}catch{}return!0}finally{le.p=y,q.T=f,Lv(i,a)}}function Iv(i,a,u){a=Wr(u,a),a=Lp(i.stateNode,a,2),i=na(i,a,2),i!==null&&(Gr(i,2),Hi(i))}function Ft(i,a,u){if(i.tag===3)Iv(i,i,u);else for(;a!==null;){if(a.tag===3){Iv(a,i,u);break}else if(a.tag===1){var f=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(oa===null||!oa.has(f))){i=Wr(u,i),u=Px(2),f=na(a,u,2),f!==null&&(Hx(u,f,a,i),Gr(f,2),Hi(f));break}}a=a.return}}function sm(i,a,u){var f=i.pingCache;if(f===null){f=i.pingCache=new YC;var y=new Set;f.set(a,y)}else y=f.get(a),y===void 0&&(y=new Set,f.set(a,y));y.has(u)||(Jp=!0,y.add(u),i=ZC.bind(null,i,a,u),a.then(i,i))}function ZC(i,a,u){var f=i.pingCache;f!==null&&f.delete(a),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,tn===i&&(Tt&u)===u&&(vn===4||vn===3&&(Tt&62914560)===Tt&&300>Yt()-Lh?(Pt&2)===0&&ho(i,0):em|=u,uo===Tt&&(uo=0)),Hi(i)}function Pv(i,a){a===0&&(a=Qc()),i=qt(i,a),i!==null&&(Gr(i,a),Hi(i))}function JC(i){var a=i.memoizedState,u=0;a!==null&&(u=a.retryLane),Pv(i,u)}function eA(i,a){var u=0;switch(i.tag){case 31:case 13:var f=i.stateNode,y=i.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(a),Pv(i,u)}function tA(i,a){return be(i,a)}var Fh=null,po=null,om=!1,Vh=!1,um=!1,ha=0;function Hi(i){i!==po&&i.next===null&&(po===null?Fh=po=i:po=po.next=i),Vh=!0,om||(om=!0,rA())}function Ku(i,a){if(!um&&Vh){um=!0;do for(var u=!1,f=Fh;f!==null;){if(i!==0){var y=f.pendingLanes;if(y===0)var x=0;else{var A=f.suspendedLanes,_=f.pingedLanes;x=(1<<31-Le(42|i)+1)-1,x&=y&~(A&~_),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(u=!0,Fv(f,x))}else x=Tt,x=za(f,f===tn?x:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(x&3)===0||nl(f,x)||(u=!0,Fv(f,x));f=f.next}while(u);um=!1}}function nA(){Hv()}function Hv(){Vh=om=!1;var i=0;ha!==0&&dA()&&(i=ha);for(var a=Yt(),u=null,f=Fh;f!==null;){var y=f.next,x=qv(f,a);x===0?(f.next=null,u===null?Fh=y:u.next=y,y===null&&(po=u)):(u=f,(i!==0||(x&3)!==0)&&(Vh=!0)),f=y}Pn!==0&&Pn!==5||Ku(i),ha!==0&&(ha=0)}function qv(i,a){for(var u=i.suspendedLanes,f=i.pingedLanes,y=i.expirationTimes,x=i.pendingLanes&-62914561;0<x;){var A=31-Le(x),_=1<<A,H=y[A];H===-1?((_&u)===0||(_&f)!==0)&&(y[A]=qd(_,a)):H<=a&&(i.expiredLanes|=_),x&=~_}if(a=tn,u=Tt,u=za(i,i===a?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,u===0||i===a&&(Ut===2||Ut===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&Ge(f),i.callbackNode=null,i.callbackPriority=0;if((u&3)===0||nl(i,u)){if(a=u&-u,a===i.callbackPriority)return a;switch(f!==null&&Ge(f),zl(u)){case 2:case 8:u=Ne;break;case 32:u=rt;break;case 268435456:u=Dt;break;default:u=rt}return f=Uv.bind(null,i),u=be(u,f),i.callbackPriority=a,i.callbackNode=u,a}return f!==null&&f!==null&&Ge(f),i.callbackPriority=2,i.callbackNode=null,2}function Uv(i,a){if(Pn!==0&&Pn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var u=i.callbackNode;if(Uh()&&i.callbackNode!==u)return null;var f=Tt;return f=za(i,i===tn?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(Sv(i,f,a),qv(i,Yt()),i.callbackNode!=null&&i.callbackNode===u?Uv.bind(null,i):null)}function Fv(i,a){if(Uh())return null;Sv(i,a,!0)}function rA(){mA(function(){(Pt&6)!==0?be(ue,nA):Hv()})}function cm(){if(ha===0){var i=Zs;i===0&&(i=Ue,Ue<<=1,(Ue&261888)===0&&(Ue=256)),ha=i}return ha}function Vv(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:yi(""+i)}function Kv(i,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,i.id&&u.setAttribute("form",i.id),a.parentNode.insertBefore(u,a),i=new FormData(i),u.parentNode.removeChild(u),i}function iA(i,a,u,f,y){if(a==="submit"&&u&&u.stateNode===y){var x=Vv((y[kn]||null).action),A=f.submitter;A&&(a=(a=A[kn]||null)?Vv(a.formAction):A.getAttribute("formAction"),a!==null&&(x=a,A=null));var _=new js("action","action",null,f,y);i.push({event:_,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(ha!==0){var H=A?Kv(y,A):new FormData(y);_p(u,{pending:!0,data:H,method:y.method,action:x},null,H)}}else typeof x=="function"&&(_.preventDefault(),H=A?Kv(y,A):new FormData(y),_p(u,{pending:!0,data:H,method:y.method,action:x},x,H))},currentTarget:y}]})}}for(var hm=0;hm<Ve.length;hm++){var fm=Ve[hm],lA=fm.toLowerCase(),aA=fm[0].toUpperCase()+fm.slice(1);_e(lA,"on"+aA)}_e(oe,"onAnimationEnd"),_e(re,"onAnimationIteration"),_e(me,"onAnimationStart"),_e("dblclick","onDoubleClick"),_e("focusin","onFocus"),_e("focusout","onBlur"),_e(Te,"onTransitionRun"),_e(ze,"onTransitionStart"),_e(Ie,"onTransitionCancel"),_e(Me,"onTransitionEnd"),Di("onMouseEnter",["mouseout","mouseover"]),Di("onMouseLeave",["mouseout","mouseover"]),Di("onPointerEnter",["pointerout","pointerover"]),Di("onPointerLeave",["pointerout","pointerover"]),mi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),mi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),mi("onBeforeInput",["compositionend","keypress","textInput","paste"]),mi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),mi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),mi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gu));function Gv(i,a){a=(a&4)!==0;for(var u=0;u<i.length;u++){var f=i[u],y=f.event;f=f.listeners;e:{var x=void 0;if(a)for(var A=f.length-1;0<=A;A--){var _=f[A],H=_.instance,se=_.currentTarget;if(_=_.listener,H!==x&&y.isPropagationStopped())break e;x=_,y.currentTarget=se;try{x(y)}catch(ge){Xe(ge)}y.currentTarget=null,x=H}else for(A=0;A<f.length;A++){if(_=f[A],H=_.instance,se=_.currentTarget,_=_.listener,H!==x&&y.isPropagationStopped())break e;x=_,y.currentTarget=se;try{x(y)}catch(ge){Xe(ge)}y.currentTarget=null,x=H}}}}function Ct(i,a){var u=a[Il];u===void 0&&(u=a[Il]=new Set);var f=i+"__bubble";u.has(f)||(Yv(a,i,2,!1),u.add(f))}function dm(i,a,u){var f=0;a&&(f|=4),Yv(u,i,f,a)}var Kh="_reactListening"+Math.random().toString(36).slice(2);function pm(i){if(!i[Kh]){i[Kh]=!0,rl.forEach(function(u){u!=="selectionchange"&&(sA.has(u)||dm(u,!1,i),dm(u,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[Kh]||(a[Kh]=!0,dm("selectionchange",!1,a))}}function Yv(i,a,u,f){switch(wb(a)){case 2:var y=BA;break;case 8:y=LA;break;default:y=Mm}u=y.bind(null,a,u,i),y=void 0,!uu||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(y=!0),f?y!==void 0?i.addEventListener(a,u,{capture:!0,passive:y}):i.addEventListener(a,u,!0):y!==void 0?i.addEventListener(a,u,{passive:y}):i.addEventListener(a,u,!1)}function mm(i,a,u,f,y){var x=f;if((a&1)===0&&(a&2)===0&&f!==null)e:for(;;){if(f===null)return;var A=f.tag;if(A===3||A===4){var _=f.stateNode.containerInfo;if(_===y)break;if(A===4)for(A=f.return;A!==null;){var H=A.tag;if((H===3||H===4)&&A.stateNode.containerInfo===y)return;A=A.return}for(;_!==null;){if(A=_i(_),A===null)return;if(H=A.tag,H===5||H===6||H===26||H===27){f=x=A;continue e}_=_.parentNode}}f=f.return}Hl(function(){var se=x,ge=_s(u),we=[];e:{var he=Qe.get(i);if(he!==void 0){var de=js,Je=i;switch(i){case"keypress":if(Fl(u)===0)break e;case"keydown":case"keyup":de=Ps;break;case"focusin":Je="focus",de=Vl;break;case"focusout":Je="blur",de=Vl;break;case"beforeblur":case"afterblur":de=Vl;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=Bs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=Zc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=gu;break;case oe:case re:case me:de=Jc;break;case Me:de=yu;break;case"scroll":case"scrollend":de=Os;break;case"wheel":de=qs;break;case"copy":case"cut":case"paste":de=Kl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=mu;break;case"toggle":case"beforetoggle":de=nh}var ut=(a&4)!==0,Zt=!ut&&(i==="scroll"||i==="scrollend"),te=ut?he!==null?he+"Capture":null:he;ut=[];for(var W=se,ae;W!==null;){var xe=W;if(ae=xe.stateNode,xe=xe.tag,xe!==5&&xe!==26&&xe!==27||ae===null||te===null||(xe=ol(W,te),xe!=null&&ut.push(Yu(W,xe,ae))),Zt)break;W=W.return}0<ut.length&&(he=new de(he,Je,null,u,ge),we.push({event:he,listeners:ut}))}}if((a&7)===0){e:{if(he=i==="mouseover"||i==="pointerover",de=i==="mouseout"||i==="pointerout",he&&u!==Qr&&(Je=u.relatedTarget||u.fromElement)&&(_i(Je)||Je[mr]))break e;if((de||he)&&(he=ge.window===ge?ge:(he=ge.ownerDocument)?he.defaultView||he.parentWindow:window,de?(Je=u.relatedTarget||u.toElement,de=se,Je=Je?_i(Je):null,Je!==null&&(Zt=s(Je),ut=Je.tag,Je!==Zt||ut!==5&&ut!==27&&ut!==6)&&(Je=null)):(de=null,Je=se),de!==Je)){if(ut=Bs,xe="onMouseLeave",te="onMouseEnter",W="mouse",(i==="pointerout"||i==="pointerover")&&(ut=mu,xe="onPointerLeave",te="onPointerEnter",W="pointer"),Zt=de==null?he:Or(de),ae=Je==null?he:Or(Je),he=new ut(xe,W+"leave",de,u,ge),he.target=Zt,he.relatedTarget=ae,xe=null,_i(ge)===se&&(ut=new ut(te,W+"enter",Je,u,ge),ut.target=ae,ut.relatedTarget=Zt,xe=ut),Zt=xe,de&&Je)t:{for(ut=oA,te=de,W=Je,ae=0,xe=te;xe;xe=ut(xe))ae++;xe=0;for(var lt=W;lt;lt=ut(lt))xe++;for(;0<ae-xe;)te=ut(te),ae--;for(;0<xe-ae;)W=ut(W),xe--;for(;ae--;){if(te===W||W!==null&&te===W.alternate){ut=te;break t}te=ut(te),W=ut(W)}ut=null}else ut=null;de!==null&&Qv(we,he,de,ut,!1),Je!==null&&Zt!==null&&Qv(we,Zt,Je,ut,!0)}}e:{if(he=se?Or(se):window,de=he.nodeName&&he.nodeName.toLowerCase(),de==="select"||de==="input"&&he.type==="file")var Rt=Ja;else if(Vs(he))if($r)Rt=Ql;else{Rt=pl;var tt=oh}else de=he.nodeName,!de||de.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?se&&ou(se.elementType)&&(Rt=Ja):Rt=wu;if(Rt&&(Rt=Rt(i,se))){ku(we,Rt,u,ge);break e}tt&&tt(i,he,se),i==="focusout"&&se&&he.type==="number"&&se.memoizedProps.value!=null&&Ka(he,"number",he.value)}switch(tt=se?Or(se):window,i){case"focusin":(Vs(tt)||tt.contentEditable==="true")&&(L=tt,K=se,ne=null);break;case"focusout":ne=K=L=null;break;case"mousedown":G=!0;break;case"contextmenu":case"mouseup":case"dragend":G=!1,V(we,u,ge);break;case"selectionchange":if(O)break;case"keydown":case"keyup":V(we,u,ge)}var yt;if(Wa)e:{switch(i){case"compositionstart":var Et="onCompositionStart";break e;case"compositionend":Et="onCompositionEnd";break e;case"compositionupdate":Et="onCompositionUpdate";break e}Et=void 0}else fl?bu(i,u)&&(Et="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Et="onCompositionStart");Et&&(Us&&u.locale!=="ko"&&(fl||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&fl&&(yt=Ul()):(Xr=ge,Ds="value"in Xr?Xr.value:Xr.textContent,fl=!0)),tt=Gh(se,Et),0<tt.length&&(Et=new Is(Et,i,null,u,ge),we.push({event:Et,listeners:tt}),yt?Et.data=yt:(yt=ih(u),yt!==null&&(Et.data=yt)))),(yt=Yd?lh(i,u):Qd(i,u))&&(Et=Gh(se,"onBeforeInput"),0<Et.length&&(tt=new Is("onBeforeInput","beforeinput",null,u,ge),we.push({event:tt,listeners:Et}),tt.data=yt)),iA(we,i,se,u,ge)}Gv(we,a)})}function Yu(i,a,u){return{instance:i,listener:a,currentTarget:u}}function Gh(i,a){for(var u=a+"Capture",f=[];i!==null;){var y=i,x=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||x===null||(y=ol(i,u),y!=null&&f.unshift(Yu(i,y,x)),y=ol(i,a),y!=null&&f.push(Yu(i,y,x))),i.tag===3)return f;i=i.return}return[]}function oA(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Qv(i,a,u,f,y){for(var x=a._reactName,A=[];u!==null&&u!==f;){var _=u,H=_.alternate,se=_.stateNode;if(_=_.tag,H!==null&&H===f)break;_!==5&&_!==26&&_!==27||se===null||(H=se,y?(se=ol(u,x),se!=null&&A.unshift(Yu(u,se,H))):y||(se=ol(u,x),se!=null&&A.push(Yu(u,se,H)))),u=u.return}A.length!==0&&i.push({event:a,listeners:A})}var uA=/\r\n?/g,cA=/\u0000|\uFFFD/g;function Xv(i){return(typeof i=="string"?i:""+i).replace(uA,`
`).replace(cA,"")}function $v(i,a){return a=Xv(a),Xv(i)===a}function Wt(i,a,u,f,y,x){switch(u){case"children":typeof f=="string"?a==="body"||a==="textarea"&&f===""||ll(i,f):(typeof f=="number"||typeof f=="bigint")&&a!=="body"&&ll(i,""+f);break;case"className":Fa(i,"class",f);break;case"tabIndex":Fa(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Fa(i,u,f);break;case"style":su(i,f,x);break;case"data":if(a!=="object"){Fa(i,"data",f);break}case"src":case"href":if(f===""&&(a!=="a"||u!=="href")){i.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(u);break}f=yi(""+f),i.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(u==="formAction"?(a!=="input"&&Wt(i,a,"name",y.name,y,null),Wt(i,a,"formEncType",y.formEncType,y,null),Wt(i,a,"formMethod",y.formMethod,y,null),Wt(i,a,"formTarget",y.formTarget,y,null)):(Wt(i,a,"encType",y.encType,y,null),Wt(i,a,"method",y.method,y,null),Wt(i,a,"target",y.target,y,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(u);break}f=yi(""+f),i.setAttribute(u,f);break;case"onClick":f!=null&&(i.onclick=wr);break;case"onScroll":f!=null&&Ct("scroll",i);break;case"onScrollEnd":f!=null&&Ct("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}u=yi(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,""+f):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":f===!0?i.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(u,f):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(u,f):i.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(u):i.setAttribute(u,f);break;case"popover":Ct("beforetoggle",i),Ct("toggle",i),bt(i,"popover",f);break;case"xlinkActuate":Yr(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Yr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Yr(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Yr(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Yr(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Yr(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Yr(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Yr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Yr(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":bt(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Vd.get(u)||u,bt(i,u,f))}}function gm(i,a,u,f,y,x){switch(u){case"style":su(i,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(u=f.__html,u!=null){if(y.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"children":typeof f=="string"?ll(i,f):(typeof f=="number"||typeof f=="bigint")&&ll(i,""+f);break;case"onScroll":f!=null&&Ct("scroll",i);break;case"onScrollEnd":f!=null&&Ct("scrollend",i);break;case"onClick":f!=null&&(i.onclick=wr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qa.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),a=u.slice(2,y?u.length-7:void 0),x=i[kn]||null,x=x!=null?x[u]:null,typeof x=="function"&&i.removeEventListener(a,x,y),typeof f=="function")){typeof x!="function"&&x!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(a,f,y);break e}u in i?i[u]=f:f===!0?i.setAttribute(u,""):bt(i,u,f)}}}function Jn(i,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ct("error",i),Ct("load",i);var f=!1,y=!1,x;for(x in u)if(u.hasOwnProperty(x)){var A=u[x];if(A!=null)switch(x){case"src":f=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Wt(i,a,x,A,u,null)}}y&&Wt(i,a,"srcSet",u.srcSet,u,null),f&&Wt(i,a,"src",u.src,u,null);return;case"input":Ct("invalid",i);var _=x=A=y=null,H=null,se=null;for(f in u)if(u.hasOwnProperty(f)){var ge=u[f];if(ge!=null)switch(f){case"name":y=ge;break;case"type":A=ge;break;case"checked":H=ge;break;case"defaultChecked":se=ge;break;case"value":x=ge;break;case"defaultValue":_=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,a));break;default:Wt(i,a,f,ge,u,null)}}Ms(i,x,_,H,se,A,y,!1);return;case"select":Ct("invalid",i),f=A=x=null;for(y in u)if(u.hasOwnProperty(y)&&(_=u[y],_!=null))switch(y){case"value":x=_;break;case"defaultValue":A=_;break;case"multiple":f=_;default:Wt(i,a,y,_,u,null)}a=x,u=A,i.multiple=!!f,a!=null?gi(i,!!f,a,!1):u!=null&&gi(i,!!f,u,!0);return;case"textarea":Ct("invalid",i),x=y=f=null;for(A in u)if(u.hasOwnProperty(A)&&(_=u[A],_!=null))switch(A){case"value":f=_;break;case"defaultValue":y=_;break;case"children":x=_;break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(r(91));break;default:Wt(i,a,A,_,u,null)}Ga(i,f,y,x);return;case"option":for(H in u)u.hasOwnProperty(H)&&(f=u[H],f!=null)&&(H==="selected"?i.selected=f&&typeof f!="function"&&typeof f!="symbol":Wt(i,a,H,f,u,null));return;case"dialog":Ct("beforetoggle",i),Ct("toggle",i),Ct("cancel",i),Ct("close",i);break;case"iframe":case"object":Ct("load",i);break;case"video":case"audio":for(f=0;f<Gu.length;f++)Ct(Gu[f],i);break;case"image":Ct("error",i),Ct("load",i);break;case"details":Ct("toggle",i);break;case"embed":case"source":case"link":Ct("error",i),Ct("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in u)if(u.hasOwnProperty(se)&&(f=u[se],f!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Wt(i,a,se,f,u,null)}return;default:if(ou(a)){for(ge in u)u.hasOwnProperty(ge)&&(f=u[ge],f!==void 0&&gm(i,a,ge,f,u,void 0));return}}for(_ in u)u.hasOwnProperty(_)&&(f=u[_],f!=null&&Wt(i,a,_,f,u,null))}function hA(i,a,u,f){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,x=null,A=null,_=null,H=null,se=null,ge=null;for(de in u){var we=u[de];if(u.hasOwnProperty(de)&&we!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":H=we;default:f.hasOwnProperty(de)||Wt(i,a,de,null,f,we)}}for(var he in f){var de=f[he];if(we=u[he],f.hasOwnProperty(he)&&(de!=null||we!=null))switch(he){case"type":x=de;break;case"name":y=de;break;case"checked":se=de;break;case"defaultChecked":ge=de;break;case"value":A=de;break;case"defaultValue":_=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,a));break;default:de!==we&&Wt(i,a,he,de,f,we)}}ji(i,A,_,H,se,ge,x,y);return;case"select":de=A=_=he=null;for(x in u)if(H=u[x],u.hasOwnProperty(x)&&H!=null)switch(x){case"value":break;case"multiple":de=H;default:f.hasOwnProperty(x)||Wt(i,a,x,null,f,H)}for(y in f)if(x=f[y],H=u[y],f.hasOwnProperty(y)&&(x!=null||H!=null))switch(y){case"value":he=x;break;case"defaultValue":_=x;break;case"multiple":A=x;default:x!==H&&Wt(i,a,y,x,f,H)}a=_,u=A,f=de,he!=null?gi(i,!!u,he,!1):!!f!=!!u&&(a!=null?gi(i,!!u,a,!0):gi(i,!!u,u?[]:"",!1));return;case"textarea":de=he=null;for(_ in u)if(y=u[_],u.hasOwnProperty(_)&&y!=null&&!f.hasOwnProperty(_))switch(_){case"value":break;case"children":break;default:Wt(i,a,_,null,f,y)}for(A in f)if(y=f[A],x=u[A],f.hasOwnProperty(A)&&(y!=null||x!=null))switch(A){case"value":he=y;break;case"defaultValue":de=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==x&&Wt(i,a,A,y,f,x)}au(i,he,de);return;case"option":for(var Je in u)he=u[Je],u.hasOwnProperty(Je)&&he!=null&&!f.hasOwnProperty(Je)&&(Je==="selected"?i.selected=!1:Wt(i,a,Je,null,f,he));for(H in f)he=f[H],de=u[H],f.hasOwnProperty(H)&&he!==de&&(he!=null||de!=null)&&(H==="selected"?i.selected=he&&typeof he!="function"&&typeof he!="symbol":Wt(i,a,H,he,f,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ut in u)he=u[ut],u.hasOwnProperty(ut)&&he!=null&&!f.hasOwnProperty(ut)&&Wt(i,a,ut,null,f,he);for(se in f)if(he=f[se],de=u[se],f.hasOwnProperty(se)&&he!==de&&(he!=null||de!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(r(137,a));break;default:Wt(i,a,se,he,f,de)}return;default:if(ou(a)){for(var Zt in u)he=u[Zt],u.hasOwnProperty(Zt)&&he!==void 0&&!f.hasOwnProperty(Zt)&&gm(i,a,Zt,void 0,f,he);for(ge in f)he=f[ge],de=u[ge],!f.hasOwnProperty(ge)||he===de||he===void 0&&de===void 0||gm(i,a,ge,he,f,de);return}}for(var te in u)he=u[te],u.hasOwnProperty(te)&&he!=null&&!f.hasOwnProperty(te)&&Wt(i,a,te,null,f,he);for(we in f)he=f[we],de=u[we],!f.hasOwnProperty(we)||he===de||he==null&&de==null||Wt(i,a,we,he,f,de)}function Wv(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function fA(){if(typeof performance.getEntriesByType=="function"){for(var i=0,a=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var y=u[f],x=y.transferSize,A=y.initiatorType,_=y.duration;if(x&&_&&Wv(A)){for(A=0,_=y.responseEnd,f+=1;f<u.length;f++){var H=u[f],se=H.startTime;if(se>_)break;var ge=H.transferSize,we=H.initiatorType;ge&&Wv(we)&&(H=H.responseEnd,A+=ge*(H<_?1:(_-se)/(H-se)))}if(--f,a+=8*(x+A)/(y.duration/1e3),i++,10<i)break}}if(0<i)return a/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var ym=null,xm=null;function Yh(i){return i.nodeType===9?i:i.ownerDocument}function Zv(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jv(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function vm(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var bm=null;function dA(){var i=window.event;return i&&i.type==="popstate"?i===bm?!1:(bm=i,!0):(bm=null,!1)}var eb=typeof setTimeout=="function"?setTimeout:void 0,pA=typeof clearTimeout=="function"?clearTimeout:void 0,tb=typeof Promise=="function"?Promise:void 0,mA=typeof queueMicrotask=="function"?queueMicrotask:typeof tb<"u"?function(i){return tb.resolve(null).then(i).catch(gA)}:eb;function gA(i){setTimeout(function(){throw i})}function fa(i){return i==="head"}function nb(i,a){var u=a,f=0;do{var y=u.nextSibling;if(i.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(f===0){i.removeChild(y),xo(a);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")Qu(i.ownerDocument.documentElement);else if(u==="head"){u=i.ownerDocument.head,Qu(u);for(var x=u.firstChild;x;){var A=x.nextSibling,_=x.nodeName;x[jr]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&x.rel.toLowerCase()==="stylesheet"||u.removeChild(x),x=A}}else u==="body"&&Qu(i.ownerDocument.body);u=y}while(u);xo(a)}function rb(i,a){var u=i;i=0;do{var f=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(i===0)break;i--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||i++;u=f}while(u)}function km(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":km(u),Es(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function yA(i,a,u,f){for(;i.nodeType===1;){var y=u;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[jr])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(x=i.getAttribute("rel"),x==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(x!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(x=i.getAttribute("src"),(x!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&x&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var x=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===x)return i}else return i;if(i=ni(i.nextSibling),i===null)break}return null}function xA(i,a,u){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=ni(i.nextSibling),i===null))return null;return i}function ib(i,a){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=ni(i.nextSibling),i===null))return null;return i}function wm(i){return i.data==="$?"||i.data==="$~"}function Sm(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function vA(i,a){var u=i.ownerDocument;if(i.data==="$~")i._reactRetry=a;else if(i.data!=="$?"||u.readyState!=="loading")a();else{var f=function(){a(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function ni(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return i}var Cm=null;function lb(i){i=i.nextSibling;for(var a=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"||u==="/&"){if(a===0)return ni(i.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}i=i.nextSibling}return null}function ab(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return i;a--}else u!=="/$"&&u!=="/&"||a++}i=i.previousSibling}return null}function sb(i,a,u){switch(a=Yh(u),i){case"html":if(i=a.documentElement,!i)throw Error(r(452));return i;case"head":if(i=a.head,!i)throw Error(r(453));return i;case"body":if(i=a.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function Qu(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);Es(i)}var ri=new Map,ob=new Set;function Qh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ml=le.d;le.d={f:bA,r:kA,D:wA,C:SA,L:CA,m:AA,X:EA,S:TA,M:NA};function bA(){var i=Ml.f(),a=Ph();return i||a}function kA(i){var a=Qt(i);a!==null&&a.tag===5&&a.type==="form"?Ax(a):Ml.r(i)}var mo=typeof document>"u"?null:document;function ub(i,a,u){var f=mo;if(f&&typeof a=="string"&&a){var y=Vn(a);y='link[rel="'+i+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),ob.has(y)||(ob.add(y),i={rel:i,crossOrigin:u,href:a},f.querySelector(y)===null&&(a=f.createElement("link"),Jn(a,"link",i),wn(a),f.head.appendChild(a)))}}function wA(i){Ml.D(i),ub("dns-prefetch",i,null)}function SA(i,a){Ml.C(i,a),ub("preconnect",i,a)}function CA(i,a,u){Ml.L(i,a,u);var f=mo;if(f&&i&&a){var y='link[rel="preload"][as="'+Vn(a)+'"]';a==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+Vn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+Vn(u.imageSizes)+'"]')):y+='[href="'+Vn(i)+'"]';var x=y;switch(a){case"style":x=go(i);break;case"script":x=yo(i)}ri.has(x)||(i=g({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:i,as:a},u),ri.set(x,i),f.querySelector(y)!==null||a==="style"&&f.querySelector(Xu(x))||a==="script"&&f.querySelector($u(x))||(a=f.createElement("link"),Jn(a,"link",i),wn(a),f.head.appendChild(a)))}}function AA(i,a){Ml.m(i,a);var u=mo;if(u&&i){var f=a&&typeof a.as=="string"?a.as:"script",y='link[rel="modulepreload"][as="'+Vn(f)+'"][href="'+Vn(i)+'"]',x=y;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=yo(i)}if(!ri.has(x)&&(i=g({rel:"modulepreload",href:i},a),ri.set(x,i),u.querySelector(y)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector($u(x)))return}f=u.createElement("link"),Jn(f,"link",i),wn(f),u.head.appendChild(f)}}}function TA(i,a,u){Ml.S(i,a,u);var f=mo;if(f&&i){var y=ar(f).hoistableStyles,x=go(i);a=a||"default";var A=y.get(x);if(!A){var _={loading:0,preload:null};if(A=f.querySelector(Xu(x)))_.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":a},u),(u=ri.get(x))&&Am(i,u);var H=A=f.createElement("link");wn(H),Jn(H,"link",i),H._p=new Promise(function(se,ge){H.onload=se,H.onerror=ge}),H.addEventListener("load",function(){_.loading|=1}),H.addEventListener("error",function(){_.loading|=2}),_.loading|=4,Xh(A,a,f)}A={type:"stylesheet",instance:A,count:1,state:_},y.set(x,A)}}}function EA(i,a){Ml.X(i,a);var u=mo;if(u&&i){var f=ar(u).hoistableScripts,y=yo(i),x=f.get(y);x||(x=u.querySelector($u(y)),x||(i=g({src:i,async:!0},a),(a=ri.get(y))&&Tm(i,a),x=u.createElement("script"),wn(x),Jn(x,"link",i),u.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(y,x))}}function NA(i,a){Ml.M(i,a);var u=mo;if(u&&i){var f=ar(u).hoistableScripts,y=yo(i),x=f.get(y);x||(x=u.querySelector($u(y)),x||(i=g({src:i,async:!0,type:"module"},a),(a=ri.get(y))&&Tm(i,a),x=u.createElement("script"),wn(x),Jn(x,"link",i),u.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(y,x))}}function cb(i,a,u,f){var y=(y=Ke.current)?Qh(y):null;if(!y)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=go(u.href),u=ar(y).hoistableStyles,f=u.get(a),f||(f={type:"style",instance:null,count:0,state:null},u.set(a,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=go(u.href);var x=ar(y).hoistableStyles,A=x.get(i);if(A||(y=y.ownerDocument||y,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(i,A),(x=y.querySelector(Xu(i)))&&!x._p&&(A.instance=x,A.state.loading=5),ri.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},ri.set(i,u),x||MA(y,i,u,A.state))),a&&f===null)throw Error(r(528,""));return A}if(a&&f!==null)throw Error(r(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=yo(u),u=ar(y).hoistableScripts,f=u.get(a),f||(f={type:"script",instance:null,count:0,state:null},u.set(a,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function go(i){return'href="'+Vn(i)+'"'}function Xu(i){return'link[rel="stylesheet"]['+i+"]"}function hb(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function MA(i,a,u,f){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?f.loading=1:(a=i.createElement("link"),f.preload=a,a.addEventListener("load",function(){return f.loading|=1}),a.addEventListener("error",function(){return f.loading|=2}),Jn(a,"link",u),wn(a),i.head.appendChild(a))}function yo(i){return'[src="'+Vn(i)+'"]'}function $u(i){return"script[async]"+i}function fb(i,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var f=i.querySelector('style[data-href~="'+Vn(u.href)+'"]');if(f)return a.instance=f,wn(f),f;var y=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),wn(f),Jn(f,"style",y),Xh(f,u.precedence,i),a.instance=f;case"stylesheet":y=go(u.href);var x=i.querySelector(Xu(y));if(x)return a.state.loading|=4,a.instance=x,wn(x),x;f=hb(u),(y=ri.get(y))&&Am(f,y),x=(i.ownerDocument||i).createElement("link"),wn(x);var A=x;return A._p=new Promise(function(_,H){A.onload=_,A.onerror=H}),Jn(x,"link",f),a.state.loading|=4,Xh(x,u.precedence,i),a.instance=x;case"script":return x=yo(u.src),(y=i.querySelector($u(x)))?(a.instance=y,wn(y),y):(f=u,(y=ri.get(x))&&(f=g({},u),Tm(f,y)),i=i.ownerDocument||i,y=i.createElement("script"),wn(y),Jn(y,"link",f),i.head.appendChild(y),a.instance=y);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(f=a.instance,a.state.loading|=4,Xh(f,u.precedence,i));return a.instance}function Xh(i,a,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=f.length?f[f.length-1]:null,x=y,A=0;A<f.length;A++){var _=f[A];if(_.dataset.precedence===a)x=_;else if(x!==y)break}x?x.parentNode.insertBefore(i,x.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(i,a.firstChild))}function Am(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function Tm(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var $h=null;function db(i,a,u){if($h===null){var f=new Map,y=$h=new Map;y.set(u,f)}else y=$h,f=y.get(u),f||(f=new Map,y.set(u,f));if(f.has(i))return f;for(f.set(i,null),u=u.getElementsByTagName(i),y=0;y<u.length;y++){var x=u[y];if(!(x[jr]||x[ln]||i==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var A=x.getAttribute(a)||"";A=i+A;var _=f.get(A);_?_.push(x):f.set(A,[x])}}return f}function pb(i,a,u){i=i.ownerDocument||i,i.head.insertBefore(u,a==="title"?i.querySelector("head > title"):null)}function _A(i,a,u){if(u===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(i=a.disabled,typeof a.precedence=="string"&&i==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function mb(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function DA(i,a,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=go(f.href),x=a.querySelector(Xu(y));if(x){a=x._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(i.count++,i=Wh.bind(i),a.then(i,i)),u.state.loading|=4,u.instance=x,wn(x);return}x=a.ownerDocument||a,f=hb(f),(y=ri.get(y))&&Am(f,y),x=x.createElement("link"),wn(x);var A=x;A._p=new Promise(function(_,H){A.onload=_,A.onerror=H}),Jn(x,"link",f),u.instance=x}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(i.count++,u=Wh.bind(i),a.addEventListener("load",u),a.addEventListener("error",u))}}var Em=0;function jA(i,a){return i.stylesheets&&i.count===0&&Jh(i,i.stylesheets),0<i.count||0<i.imgCount?function(u){var f=setTimeout(function(){if(i.stylesheets&&Jh(i,i.stylesheets),i.unsuspend){var x=i.unsuspend;i.unsuspend=null,x()}},6e4+a);0<i.imgBytes&&Em===0&&(Em=62500*fA());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Jh(i,i.stylesheets),i.unsuspend)){var x=i.unsuspend;i.unsuspend=null,x()}},(i.imgBytes>Em?50:800)+a);return i.unsuspend=u,function(){i.unsuspend=null,clearTimeout(f),clearTimeout(y)}}:null}function Wh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Jh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Zh=null;function Jh(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Zh=new Map,a.forEach(OA,i),Zh=null,Wh.call(i))}function OA(i,a){if(!(a.state.loading&4)){var u=Zh.get(i);if(u)var f=u.get(null);else{u=new Map,Zh.set(i,u);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<y.length;x++){var A=y[x];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(u.set(A.dataset.precedence,A),f=A)}f&&u.set(null,f)}y=a.instance,A=y.getAttribute("data-precedence"),x=u.get(A)||f,x===f&&u.set(null,y),u.set(A,y),this.count++,f=Wh.bind(this),y.addEventListener("load",f),y.addEventListener("error",f),x?x.parentNode.insertBefore(y,x.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),a.state.loading|=4}}var Wu={$$typeof:I,Provider:null,Consumer:null,_currentValue:Ae,_currentValue2:Ae,_threadCount:0};function RA(i,a,u,f,y,x,A,_,H){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ei(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ei(0),this.hiddenUpdates=Ei(null),this.identifierPrefix=f,this.onUncaughtError=y,this.onCaughtError=x,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function gb(i,a,u,f,y,x,A,_,H,se,ge,we){return i=new RA(i,a,u,A,H,se,ge,we,_),a=1,x===!0&&(a|=24),x=Br(3,null,null,a),i.current=x,x.stateNode=i,a=ap(),a.refCount++,i.pooledCache=a,a.refCount++,x.memoizedState={element:f,isDehydrated:u,cache:a},cp(x),i}function yb(i){return i?(i=Ys,i):Ys}function xb(i,a,u,f,y,x){y=yb(y),f.context===null?f.context=y:f.pendingContext=y,f=ta(a),f.payload={element:u},x=x===void 0?null:x,x!==null&&(f.callback=x),u=na(i,f,a),u!==null&&(Er(u,i,a),Mu(u,i,a))}function vb(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<a?u:a}}function Nm(i,a){vb(i,a),(i=i.alternate)&&vb(i,a)}function bb(i){if(i.tag===13||i.tag===31){var a=qt(i,67108864);a!==null&&Er(a,i,67108864),Nm(i,67108864)}}function kb(i){if(i.tag===13||i.tag===31){var a=Hr();a=nu(a);var u=qt(i,a);u!==null&&Er(u,i,a),Nm(i,a)}}var ef=!0;function BA(i,a,u,f){var y=q.T;q.T=null;var x=le.p;try{le.p=2,Mm(i,a,u,f)}finally{le.p=x,q.T=y}}function LA(i,a,u,f){var y=q.T;q.T=null;var x=le.p;try{le.p=8,Mm(i,a,u,f)}finally{le.p=x,q.T=y}}function Mm(i,a,u,f){if(ef){var y=_m(f);if(y===null)mm(i,a,f,tf,u),Sb(i,f);else if(IA(y,i,a,u,f))f.stopPropagation();else if(Sb(i,f),a&4&&-1<zA.indexOf(i)){for(;y!==null;){var x=Qt(y);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var A=pi(x.pendingLanes);if(A!==0){var _=x;for(_.pendingLanes|=2,_.entangledLanes|=2;A;){var H=1<<31-Le(A);_.entanglements[1]|=H,A&=~H}Hi(x),(Pt&6)===0&&(zh=Yt()+500,Ku(0))}}break;case 31:case 13:_=qt(x,2),_!==null&&Er(_,x,2),Ph(),Nm(x,2)}if(x=_m(f),x===null&&mm(i,a,f,tf,u),x===y)break;y=x}y!==null&&f.stopPropagation()}else mm(i,a,f,null,u)}}function _m(i){return i=_s(i),Dm(i)}var tf=null;function Dm(i){if(tf=null,i=_i(i),i!==null){var a=s(i);if(a===null)i=null;else{var u=a.tag;if(u===13){if(i=o(a),i!==null)return i;i=null}else if(u===31){if(i=c(a),i!==null)return i;i=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return tf=i,null}function wb(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(vt()){case ue:return 2;case Ne:return 8;case rt:case pt:return 32;case Dt:return 268435456;default:return 32}default:return 32}}var jm=!1,da=null,pa=null,ma=null,Zu=new Map,Ju=new Map,ga=[],zA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Sb(i,a){switch(i){case"focusin":case"focusout":da=null;break;case"dragenter":case"dragleave":pa=null;break;case"mouseover":case"mouseout":ma=null;break;case"pointerover":case"pointerout":Zu.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ju.delete(a.pointerId)}}function ec(i,a,u,f,y,x){return i===null||i.nativeEvent!==x?(i={blockedOn:a,domEventName:u,eventSystemFlags:f,nativeEvent:x,targetContainers:[y]},a!==null&&(a=Qt(a),a!==null&&bb(a)),i):(i.eventSystemFlags|=f,a=i.targetContainers,y!==null&&a.indexOf(y)===-1&&a.push(y),i)}function IA(i,a,u,f,y){switch(a){case"focusin":return da=ec(da,i,a,u,f,y),!0;case"dragenter":return pa=ec(pa,i,a,u,f,y),!0;case"mouseover":return ma=ec(ma,i,a,u,f,y),!0;case"pointerover":var x=y.pointerId;return Zu.set(x,ec(Zu.get(x)||null,i,a,u,f,y)),!0;case"gotpointercapture":return x=y.pointerId,Ju.set(x,ec(Ju.get(x)||null,i,a,u,f,y)),!0}return!1}function Cb(i){var a=_i(i.target);if(a!==null){var u=s(a);if(u!==null){if(a=u.tag,a===13){if(a=o(u),a!==null){i.blockedOn=a,Ha(i.priority,function(){kb(u)});return}}else if(a===31){if(a=c(u),a!==null){i.blockedOn=a,Ha(i.priority,function(){kb(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function nf(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var u=_m(i.nativeEvent);if(u===null){u=i.nativeEvent;var f=new u.constructor(u.type,u);Qr=f,u.target.dispatchEvent(f),Qr=null}else return a=Qt(u),a!==null&&bb(a),i.blockedOn=u,!1;a.shift()}return!0}function Ab(i,a,u){nf(i)&&u.delete(a)}function PA(){jm=!1,da!==null&&nf(da)&&(da=null),pa!==null&&nf(pa)&&(pa=null),ma!==null&&nf(ma)&&(ma=null),Zu.forEach(Ab),Ju.forEach(Ab)}function rf(i,a){i.blockedOn===a&&(i.blockedOn=null,jm||(jm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,PA)))}var lf=null;function Tb(i){lf!==i&&(lf=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){lf===i&&(lf=null);for(var a=0;a<i.length;a+=3){var u=i[a],f=i[a+1],y=i[a+2];if(typeof f!="function"){if(Dm(f||u)===null)continue;break}var x=Qt(u);x!==null&&(i.splice(a,3),a-=3,_p(x,{pending:!0,data:y,method:u.method,action:f},f,y))}}))}function xo(i){function a(H){return rf(H,i)}da!==null&&rf(da,i),pa!==null&&rf(pa,i),ma!==null&&rf(ma,i),Zu.forEach(a),Ju.forEach(a);for(var u=0;u<ga.length;u++){var f=ga[u];f.blockedOn===i&&(f.blockedOn=null)}for(;0<ga.length&&(u=ga[0],u.blockedOn===null);)Cb(u),u.blockedOn===null&&ga.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var y=u[f],x=u[f+1],A=y[kn]||null;if(typeof x=="function")A||Tb(u);else if(A){var _=null;if(x&&x.hasAttribute("formAction")){if(y=x,A=x[kn]||null)_=A.formAction;else if(Dm(y)!==null)continue}else _=A.action;typeof _=="function"?u[f+1]=_:(u.splice(f,3),f-=3),Tb(u)}}}function Eb(){function i(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(A){return y=A})},focusReset:"manual",scroll:"manual"})}function a(){y!==null&&(y(),y=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),y!==null&&(y(),y=null)}}}function Om(i){this._internalRoot=i}af.prototype.render=Om.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(r(409));var u=a.current,f=Hr();xb(u,f,i,a,null,null)},af.prototype.unmount=Om.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;xb(i.current,2,null,i,null,null),Ph(),a[mr]=null}};function af(i){this._internalRoot=i}af.prototype.unstable_scheduleHydration=function(i){if(i){var a=Pa();i={blockedOn:null,target:i,priority:a};for(var u=0;u<ga.length&&a!==0&&a<ga[u].priority;u++);ga.splice(u,0,i),u===0&&Cb(i)}};var Nb=e.version;if(Nb!=="19.2.4")throw Error(r(527,Nb,"19.2.4"));le.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=d(a),i=i!==null?p(i):null,i=i===null?null:i.stateNode,i};var HA={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sf.isDisabled&&sf.supportsFiber)try{Mn=sf.inject(HA),mn=sf}catch{}}return nc.createRoot=function(i,a){if(!l(i))throw Error(r(299));var u=!1,f="",y=Bx,x=Lx,A=zx;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(f=a.identifierPrefix),a.onUncaughtError!==void 0&&(y=a.onUncaughtError),a.onCaughtError!==void 0&&(x=a.onCaughtError),a.onRecoverableError!==void 0&&(A=a.onRecoverableError)),a=gb(i,1,!1,null,null,u,f,null,y,x,A,Eb),i[mr]=a.current,pm(i),new Om(a)},nc.hydrateRoot=function(i,a,u){if(!l(i))throw Error(r(299));var f=!1,y="",x=Bx,A=Lx,_=zx,H=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(x=u.onUncaughtError),u.onCaughtError!==void 0&&(A=u.onCaughtError),u.onRecoverableError!==void 0&&(_=u.onRecoverableError),u.formState!==void 0&&(H=u.formState)),a=gb(i,1,!0,a,u??null,f,y,H,x,A,_,Eb),a.context=yb(null),u=a.current,f=Hr(),f=nu(f),y=ta(f),y.callback=null,na(u,y,f),u=f,a.current.lanes=u,Gr(a,u),Hi(a),i[mr]=a.current,pm(i),new af(a)},nc.version="19.2.4",nc}var Rb;function QA(){if(Rb)return Bm.exports;Rb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Bm.exports=YA(),Bm.exports}var XA=QA();$.createContext(null);var jf={exports:{}},$A=jf.exports,Bb;function WA(){return Bb||(Bb=1,(function(n,e){((t,r)=>{n.exports=r()})($A,function(){var t=function(m,v){return(t=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(S,C){S.__proto__=C}:function(S,C){for(var E in C)Object.prototype.hasOwnProperty.call(C,E)&&(S[E]=C[E])}))(m,v)},r=function(){return(r=Object.assign||function(m){for(var v,S=1,C=arguments.length;S<C;S++)for(var E in v=arguments[S])Object.prototype.hasOwnProperty.call(v,E)&&(m[E]=v[E]);return m}).apply(this,arguments)};function l(m,v,S){for(var C,E=0,M=v.length;E<M;E++)!C&&E in v||((C=C||Array.prototype.slice.call(v,0,E))[E]=v[E]);return m.concat(C||Array.prototype.slice.call(v))}var s=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:UA,o=Object.keys,c=Array.isArray;function h(m,v){return typeof v=="object"&&o(v).forEach(function(S){m[S]=v[S]}),m}typeof Promise>"u"||s.Promise||(s.Promise=Promise);var d=Object.getPrototypeOf,p={}.hasOwnProperty;function g(m,v){return p.call(m,v)}function b(m,v){typeof v=="function"&&(v=v(d(m))),(typeof Reflect>"u"?o:Reflect.ownKeys)(v).forEach(function(S){T(m,S,v[S])})}var w=Object.defineProperty;function T(m,v,S,C){w(m,v,h(S&&g(S,"get")&&typeof S.get=="function"?{get:S.get,set:S.set,configurable:!0}:{value:S,configurable:!0,writable:!0},C))}function N(m){return{from:function(v){return m.prototype=Object.create(v.prototype),T(m.prototype,"constructor",m),{extend:b.bind(null,m.prototype)}}}}var D=Object.getOwnPropertyDescriptor,j=[].slice;function U(m,v,S){return j.call(m,v,S)}function I(m,v){return v(m)}function ce(m){if(!m)throw new Error("Assertion Failed")}function F(m){s.setImmediate?setImmediate(m):setTimeout(m,0)}function z(m,v){if(typeof v=="string"&&g(m,v))return m[v];if(!v)return m;if(typeof v!="string"){for(var S=[],C=0,E=v.length;C<E;++C){var M=z(m,v[C]);S.push(M)}return S}var O,L=v.indexOf(".");return L===-1||(O=m[v.substr(0,L)])==null?void 0:z(O,v.substr(L+1))}function ee(m,v,S){if(m&&v!==void 0&&!("isFrozen"in Object&&Object.isFrozen(m)))if(typeof v!="string"&&"length"in v){ce(typeof S!="string"&&"length"in S);for(var C=0,E=v.length;C<E;++C)ee(m,v[C],S[C])}else{var M,O,L=v.indexOf(".");L!==-1?(M=v.substr(0,L),(L=v.substr(L+1))===""?S===void 0?c(m)&&!isNaN(parseInt(M))?m.splice(M,1):delete m[M]:m[M]=S:ee(O=(O=m[M])&&g(m,M)?O:m[M]={},L,S)):S===void 0?c(m)&&!isNaN(parseInt(v))?m.splice(v,1):delete m[v]:m[v]=S}}function ye(m){var v,S={};for(v in m)g(m,v)&&(S[v]=m[v]);return S}var Ce=[].concat;function P(m){return Ce.apply([],m)}var qe="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(P([8,16,32,64].map(function(m){return["Int","Uint","Float"].map(function(v){return v+m+"Array"})}))).filter(function(m){return s[m]}),pe=new Set(qe.map(function(m){return s[m]})),fe=null;function De(m){return fe=new WeakMap,m=(function v(S){if(!S||typeof S!="object")return S;var C=fe.get(S);if(C)return C;if(c(S)){C=[],fe.set(S,C);for(var E=0,M=S.length;E<M;++E)C.push(v(S[E]))}else if(pe.has(S.constructor))C=S;else{var O,L=d(S);for(O in C=L===Object.prototype?{}:Object.create(L),fe.set(S,C),S)g(S,O)&&(C[O]=v(S[O]))}return C})(m),fe=null,m}var ke={}.toString;function J(m){return ke.call(m).slice(8,-1)}var q=typeof Symbol<"u"?Symbol.iterator:"@@iterator",le=typeof q=="symbol"?function(m){var v;return m!=null&&(v=m[q])&&v.apply(m)}:function(){return null};function Ae(m,v){v=m.indexOf(v),0<=v&&m.splice(v,1)}var Se={};function B(m){var v,S,C,E;if(arguments.length===1){if(c(m))return m.slice();if(this===Se&&typeof m=="string")return[m];if(E=le(m))for(S=[];!(C=E.next()).done;)S.push(C.value);else{if(m==null)return[m];if(typeof(v=m.length)!="number")return[m];for(S=new Array(v);v--;)S[v]=m[v]}}else for(v=arguments.length,S=new Array(v);v--;)S[v]=arguments[v];return S}var Pe=typeof Symbol<"u"?function(m){return m[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},qe=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ue=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(qe),R={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function je(m,v){this.name=m,this.message=v}function Ee(m,v){return m+". Errors: "+Object.keys(v).map(function(S){return v[S].toString()}).filter(function(S,C,E){return E.indexOf(S)===C}).join(`
`)}function Ke(m,v,S,C){this.failures=v,this.failedKeys=C,this.successCount=S,this.message=Ee(m,v)}function $e(m,v){this.name="BulkError",this.failures=Object.keys(v).map(function(S){return v[S]}),this.failuresByPos=v,this.message=Ee(m,this.failures)}N(je).from(Error).extend({toString:function(){return this.name+": "+this.message}}),N(Ke).from(je),N($e).from(je);var ft=ue.reduce(function(m,v){return m[v]=v+"Error",m},{}),et=je,ve=ue.reduce(function(m,v){var S=v+"Error";function C(E,M){this.name=S,E?typeof E=="string"?(this.message="".concat(E).concat(M?`
 `+M:""),this.inner=M||null):typeof E=="object"&&(this.message="".concat(E.name," ").concat(E.message),this.inner=E):(this.message=R[v]||S,this.inner=null)}return N(C).from(et),m[v]=C,m},{}),gt=(ve.Syntax=SyntaxError,ve.Type=TypeError,ve.Range=RangeError,qe.reduce(function(m,v){return m[v+"Error"]=ve[v],m},{}));qe=ue.reduce(function(m,v){return["Syntax","Type","Range"].indexOf(v)===-1&&(m[v+"Error"]=ve[v]),m},{});function nt(){}function Gt(m){return m}function yn(m,v){return m==null||m===Gt?v:function(S){return v(m(S))}}function wt(m,v){return function(){m.apply(this,arguments),v.apply(this,arguments)}}function dn(m,v){return m===nt?v:function(){var S=m.apply(this,arguments),C=(S!==void 0&&(arguments[0]=S),this.onsuccess),E=this.onerror,M=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return C&&(this.onsuccess=this.onsuccess?wt(C,this.onsuccess):C),E&&(this.onerror=this.onerror?wt(E,this.onerror):E),M!==void 0?M:S}}function Ye(m,v){return m===nt?v:function(){m.apply(this,arguments);var S=this.onsuccess,C=this.onerror;this.onsuccess=this.onerror=null,v.apply(this,arguments),S&&(this.onsuccess=this.onsuccess?wt(S,this.onsuccess):S),C&&(this.onerror=this.onerror?wt(C,this.onerror):C)}}function He(m,v){return m===nt?v:function(E){var C=m.apply(this,arguments),E=(h(E,C),this.onsuccess),M=this.onerror,O=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return E&&(this.onsuccess=this.onsuccess?wt(E,this.onsuccess):E),M&&(this.onerror=this.onerror?wt(M,this.onerror):M),C===void 0?O===void 0?void 0:O:h(C,O)}}function at(m,v){return m===nt?v:function(){return v.apply(this,arguments)!==!1&&m.apply(this,arguments)}}function be(m,v){return m===nt?v:function(){var S=m.apply(this,arguments);if(S&&typeof S.then=="function"){for(var C=this,E=arguments.length,M=new Array(E);E--;)M[E]=arguments[E];return S.then(function(){return v.apply(C,M)})}return v.apply(this,arguments)}}qe.ModifyError=Ke,qe.DexieError=je,qe.BulkError=$e;var Ge=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function zt(m){Ge=m}var Jt={},Yt=100,vt=typeof Promise>"u"?[]:(ue=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[vt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),d(vt),ue]:[ue,d(ue),ue]),ue=vt[0],dl=vt[1],dl=dl&&dl.then,Ne=ue&&ue.constructor,rt=!!vt[2],pt=function(m,v){kr.push([m,v]),Fn&&(queueMicrotask(Qc),Fn=!1)},Dt=!0,Fn=!0,Qn=[],Mn=[],mn=Gt,gn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:nt,pgp:!1,env:{},finalize:nt},Le=gn,kr=[],In=0,Ts=[];function Ue(m){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var v=this._PSD=Le;if(typeof m!="function"){if(m!==Jt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&pi(this,this._value)}else this._state=null,this._value=null,++v.ref,(function S(C,E){try{E(function(M){if(C._state===null){if(M===C)throw new TypeError("A promise cannot be resolved with itself.");var O=C._lib&&Ei();M&&typeof M.then=="function"?S(C,function(L,K){M instanceof Ue?M._then(L,K):M.then(L,K)}):(C._state=!0,C._value=M,za(C)),O&&Gr()}},pi.bind(null,C))}catch(M){pi(C,M)}})(this,m)}var Ll={get:function(){var m=Le,v=Ha;function S(C,E){var M=this,O=!m.global&&(m!==Le||v!==Ha),L=O&&!mr(),K=new Ue(function(ne,G){nl(M,new La(Es(C,m,O,L),Es(E,m,O,L),ne,G,m))});return this._consoleTask&&(K._consoleTask=this._consoleTask),K}return S.prototype=Jt,S},set:function(m){T(this,"then",m&&m.prototype===Jt?Ll:{get:function(){return m},set:Ll.set})}};function La(m,v,S,C,E){this.onFulfilled=typeof m=="function"?m:null,this.onRejected=typeof v=="function"?v:null,this.resolve=S,this.reject=C,this.psd=E}function pi(m,v){var S,C;Mn.push(v),m._state===null&&(S=m._lib&&Ei(),v=mn(v),m._state=!1,m._value=v,C=m,Qn.some(function(E){return E._value===C._value})||Qn.push(C),za(m),S)&&Gr()}function za(m){var v=m._listeners;m._listeners=[];for(var S=0,C=v.length;S<C;++S)nl(m,v[S]);var E=m._PSD;--E.ref||E.finalize(),In===0&&(++In,pt(function(){--In==0&&tu()},[]))}function nl(m,v){if(m._state===null)m._listeners.push(v);else{var S=m._state?v.onFulfilled:v.onRejected;if(S===null)return(m._state?v.resolve:v.reject)(m._value);++v.psd.ref,++In,pt(qd,[S,m,v])}}function qd(m,v,S){try{var C,E=v._value;!v._state&&Mn.length&&(Mn=[]),C=Ge&&v._consoleTask?v._consoleTask.run(function(){return m(E)}):m(E),v._state||Mn.indexOf(E)!==-1||(M=>{for(var O=Qn.length;O;)if(Qn[--O]._value===M._value)return Qn.splice(O,1)})(v),S.resolve(C)}catch(M){S.reject(M)}finally{--In==0&&tu(),--S.psd.ref||S.psd.finalize()}}function Qc(){jr(gn,function(){Ei()&&Gr()})}function Ei(){var m=Dt;return Fn=Dt=!1,m}function Gr(){var m,v,S;do for(;0<kr.length;)for(m=kr,kr=[],S=m.length,v=0;v<S;++v){var C=m[v];C[0].apply(null,C[1])}while(0<kr.length);Fn=Dt=!0}function tu(){for(var m=Qn,v=(Qn=[],m.forEach(function(C){C._PSD.onunhandled.call(null,C._value,C)}),Ts.slice(0)),S=v.length;S;)v[--S]()}function Ia(m){return new Ue(Jt,!1,m)}function en(m,v){var S=Le;return function(){var C=Ei(),E=Le;try{return Mi(S,!0),m.apply(this,arguments)}catch(M){v&&v(M)}finally{Mi(E,!1),C&&Gr()}}}b(Ue.prototype,{then:Ll,_then:function(m,v){nl(this,new La(null,null,m,v,Le))},catch:function(m){var v,S;return arguments.length===1?this.then(null,m):(v=m,S=arguments[1],typeof v=="function"?this.then(null,function(C){return(C instanceof v?S:Ia)(C)}):this.then(null,function(C){return(C&&C.name===v?S:Ia)(C)}))},finally:function(m){return this.then(function(v){return Ue.resolve(m()).then(function(){return v})},function(v){return Ue.resolve(m()).then(function(){return Ia(v)})})},timeout:function(m,v){var S=this;return m<1/0?new Ue(function(C,E){var M=setTimeout(function(){return E(new ve.Timeout(v))},m);S.then(C,E).finally(clearTimeout.bind(null,M))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&T(Ue.prototype,Symbol.toStringTag,"Dexie.Promise"),gn.env=ru(),b(Ue,{all:function(){var m=B.apply(null,arguments).map(Il);return new Ue(function(v,S){m.length===0&&v([]);var C=m.length;m.forEach(function(E,M){return Ue.resolve(E).then(function(O){m[M]=O,--C||v(m)},S)})})},resolve:function(m){return m instanceof Ue?m:m&&typeof m.then=="function"?new Ue(function(v,S){m.then(v,S)}):new Ue(Jt,!0,m)},reject:Ia,race:function(){var m=B.apply(null,arguments).map(Il);return new Ue(function(v,S){m.map(function(C){return Ue.resolve(C).then(v,S)})})},PSD:{get:function(){return Le},set:function(m){return Le=m}},totalEchoes:{get:function(){return Ha}},newPSD:ln,usePSD:jr,scheduler:{get:function(){return pt},set:function(m){pt=m}},rejectionMapper:{get:function(){return mn},set:function(m){mn=m}},follow:function(m,v){return new Ue(function(S,C){return ln(function(E,M){var O=Le;O.unhandleds=[],O.onunhandled=M,O.finalize=wt(function(){var L,K=this;L=function(){K.unhandleds.length===0?E():M(K.unhandleds[0])},Ts.push(function ne(){L(),Ts.splice(Ts.indexOf(ne),1)}),++In,pt(function(){--In==0&&tu()},[])},O.finalize),m()},v,S,C)})}}),Ne&&(Ne.allSettled&&T(Ue,"allSettled",function(){var m=B.apply(null,arguments).map(Il);return new Ue(function(v){m.length===0&&v([]);var S=m.length,C=new Array(S);m.forEach(function(E,M){return Ue.resolve(E).then(function(O){return C[M]={status:"fulfilled",value:O}},function(O){return C[M]={status:"rejected",reason:O}}).then(function(){return--S||v(C)})})})}),Ne.any&&typeof AggregateError<"u"&&T(Ue,"any",function(){var m=B.apply(null,arguments).map(Il);return new Ue(function(v,S){m.length===0&&S(new AggregateError([]));var C=m.length,E=new Array(C);m.forEach(function(M,O){return Ue.resolve(M).then(function(L){return v(L)},function(L){E[O]=L,--C||S(new AggregateError(E))})})})}),Ne.withResolvers)&&(Ue.withResolvers=Ne.withResolvers);var bn={awaits:0,echoes:0,id:0},nu=0,zl=[],Pa=0,Ha=0,Ni=0;function ln(m,O,S,C){var E=Le,M=Object.create(E),O=(M.parent=E,M.ref=0,M.global=!1,M.id=++Ni,gn.env,M.env=rt?{Promise:Ue,PromiseProp:{value:Ue,configurable:!0,writable:!0},all:Ue.all,race:Ue.race,allSettled:Ue.allSettled,any:Ue.any,resolve:Ue.resolve,reject:Ue.reject}:{},O&&h(M,O),++E.ref,M.finalize=function(){--this.parent.ref||this.parent.finalize()},jr(M,m,S,C));return M.ref===0&&M.finalize(),O}function kn(){return bn.id||(bn.id=++nu),++bn.awaits,bn.echoes+=Yt,bn.id}function mr(){return!!bn.awaits&&(--bn.awaits==0&&(bn.id=0),bn.echoes=bn.awaits*Yt,!0)}function Il(m){return bn.echoes&&m&&m.constructor===Ne?(kn(),m.then(function(v){return mr(),v},function(v){return mr(),Qt(v)})):m}function Ud(){var m=zl[zl.length-1];zl.pop(),Mi(m,!1)}function Mi(m,v){var S,C,E=Le;(v?!bn.echoes||Pa++&&m===Le:!Pa||--Pa&&m===Le)||queueMicrotask(v?function(M){++Ha,bn.echoes&&--bn.echoes!=0||(bn.echoes=bn.awaits=bn.id=0),zl.push(Le),Mi(M,!0)}.bind(null,m):Ud),m!==Le&&(Le=m,E===gn&&(gn.env=ru()),rt)&&(S=gn.env.Promise,C=m.env,E.global||m.global)&&(Object.defineProperty(s,"Promise",C.PromiseProp),S.all=C.all,S.race=C.race,S.resolve=C.resolve,S.reject=C.reject,C.allSettled&&(S.allSettled=C.allSettled),C.any)&&(S.any=C.any)}function ru(){var m=s.Promise;return rt?{Promise:m,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:m.all,race:m.race,allSettled:m.allSettled,any:m.any,resolve:m.resolve,reject:m.reject}:{}}function jr(m,v,S,C,E){var M=Le;try{return Mi(m,!0),v(S,C,E)}finally{Mi(M,!1)}}function Es(m,v,S,C){return typeof m!="function"?m:function(){var E=Le;S&&kn(),Mi(v,!0);try{return m.apply(this,arguments)}finally{Mi(E,!1),C&&queueMicrotask(mr)}}}function _i(m){Promise===Ne&&bn.echoes===0?Pa===0?m():enqueueNativeMicroTask(m):setTimeout(m,0)}(""+dl).indexOf("[native code]")===-1&&(kn=mr=nt);var Qt=Ue.reject,Or="",ar="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",wn="String expected.",rl=[],qa="__dbnames",mi="readonly",Di="readwrite";function il(m,v){return m?v?function(){return m.apply(this,arguments)&&v.apply(this,arguments)}:m:v}var iu={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ua(m){return typeof m!="string"||/\./.test(m)?function(v){return v}:function(v){return v[m]===void 0&&m in v&&delete(v=De(v))[m],v}}function Xc(){throw ve.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function bt(m,v){try{var S=Fa(m),C=Fa(v);if(S!==C)return S==="Array"?1:C==="Array"?-1:S==="binary"?1:C==="binary"?-1:S==="string"?1:C==="string"?-1:S==="Date"?1:C!=="Date"?NaN:-1;switch(S){case"number":case"Date":case"string":return v<m?1:m<v?-1:0;case"binary":for(var E=Yr(m),M=Yr(v),O=E.length,L=M.length,K=O<L?O:L,ne=0;ne<K;++ne)if(E[ne]!==M[ne])return E[ne]<M[ne]?-1:1;return O===L?0:O<L?-1:1;case"Array":for(var G=m,V=v,X=G.length,Z=V.length,Y=X<Z?X:Z,Q=0;Q<Y;++Q){var ie=bt(G[Q],V[Q]);if(ie!==0)return ie}return X===Z?0:X<Z?-1:1}}catch{}return NaN}function Fa(m){var v=typeof m;return v=="object"&&(ArrayBuffer.isView(m)||(v=J(m))==="ArrayBuffer")?"binary":v}function Yr(m){return m instanceof Uint8Array?m:ArrayBuffer.isView(m)?new Uint8Array(m.buffer,m.byteOffset,m.byteLength):new Uint8Array(m)}function Xn(m,v,S){var C=m.schema.yProps;return C?(v&&0<S.numFailures&&(v=v.filter(function(E,M){return!S.failures[M]})),Promise.all(C.map(function(E){return E=E.updatesTable,v?m.db.table(E).where("k").anyOf(v).delete():m.db.table(E).clear()})).then(function(){return S})):S}$c.prototype.execute=function(m){var v=this["@@propmod"];if(v.add!==void 0){var S=v.add;if(c(S))return l(l([],c(m)?m:[],!0),S).sort();if(typeof S=="number")return(Number(m)||0)+S;if(typeof S=="bigint")try{return BigInt(m)+S}catch{return BigInt(0)+S}throw new TypeError("Invalid term ".concat(S))}if(v.remove!==void 0){var C=v.remove;if(c(C))return c(m)?m.filter(function(E){return!C.includes(E)}).sort():[];if(typeof C=="number")return Number(m)-C;if(typeof C=="bigint")try{return BigInt(m)-C}catch{return BigInt(0)-C}throw new TypeError("Invalid subtrahend ".concat(C))}return S=(S=v.replacePrefix)==null?void 0:S[0],S&&typeof m=="string"&&m.startsWith(S)?v.replacePrefix[1]+m.substring(S.length):m};var Pl=$c;function $c(m){this["@@propmod"]=m}function Ns(m,v){for(var S=o(v),C=S.length,E=!1,M=0;M<C;++M){var O=S[M],L=v[O],K=z(m,O);L instanceof Pl?(ee(m,O,L.execute(K)),E=!0):K!==L&&(ee(m,O,L),E=!0)}return E}It.prototype._trans=function(m,v,S){var C=this._tx||Le.trans,E=this.name,M=Ge&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(m==="readonly"?"read":"write"," ").concat(this.name));function O(ne,G,V){if(V.schema[E])return v(V.idbtrans,V);throw new ve.NotFound("Table "+E+" not part of transaction")}var L=Ei();try{var K=C&&C.db._novip===this.db._novip?C===Le.trans?C._promise(m,O,S):ln(function(){return C._promise(m,O,S)},{trans:C,transless:Le.transless||Le}):(function ne(G,V,X,Z){if(G.idbdb&&(G._state.openComplete||Le.letThrough||G._vip)){var Y=G._createTransaction(V,X,G._dbSchema);try{Y.create(),G._state.PR1398_maxLoop=3}catch(Q){return Q.name===ft.InvalidState&&G.isOpen()&&0<--G._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),G.close({disableAutoOpen:!1}),G.open().then(function(){return ne(G,V,X,Z)})):Qt(Q)}return Y._promise(V,function(Q,ie){return ln(function(){return Le.trans=Y,Z(Q,ie,Y)})}).then(function(Q){if(V==="readwrite")try{Y.idbtrans.commit()}catch{}return V==="readonly"?Q:Y._completion.then(function(){return Q})})}if(G._state.openComplete)return Qt(new ve.DatabaseClosed(G._state.dbOpenError));if(!G._state.isBeingOpened){if(!G._state.autoOpen)return Qt(new ve.DatabaseClosed);G.open().catch(nt)}return G._state.dbReadyPromise.then(function(){return ne(G,V,X,Z)})})(this.db,m,[this.name],O);return M&&(K._consoleTask=M,K=K.catch(function(ne){return console.trace(ne),Qt(ne)})),K}finally{L&&Gr()}},It.prototype.get=function(m,v){var S=this;return m&&m.constructor===Object?this.where(m).first(v):m==null?Qt(new ve.Type("Invalid argument to Table.get()")):this._trans("readonly",function(C){return S.core.get({trans:C,key:m}).then(function(E){return S.hook.reading.fire(E)})}).then(v)},It.prototype.where=function(m){if(typeof m=="string")return new this.db.WhereClause(this,m);if(c(m))return new this.db.WhereClause(this,"[".concat(m.join("+"),"]"));var v=o(m);if(v.length===1)return this.where(v[0]).equals(m[v[0]]);var S=this.schema.indexes.concat(this.schema.primKey).filter(function(L){if(L.compound&&v.every(function(ne){return 0<=L.keyPath.indexOf(ne)})){for(var K=0;K<v.length;++K)if(v.indexOf(L.keyPath[K])===-1)return!1;return!0}return!1}).sort(function(L,K){return L.keyPath.length-K.keyPath.length})[0];if(S&&this.db._maxKey!==Or)return O=S.keyPath.slice(0,v.length),this.where(O).equals(O.map(function(L){return m[L]}));!S&&Ge&&console.warn("The query ".concat(JSON.stringify(m)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(v.join("+"),"]"));var C=this.schema.idxByName;function E(L,K){return bt(L,K)===0}var O=v.reduce(function(G,K){var ne=G[0],G=G[1],V=C[K],X=m[K];return[ne||V,ne||!V?il(G,V&&V.multi?function(Z){return Z=z(Z,K),c(Z)&&Z.some(function(Y){return E(X,Y)})}:function(Z){return E(X,z(Z,K))}):G]},[null,null]),M=O[0],O=O[1];return M?this.where(M.name).equals(m[M.keyPath]).filter(O):S?this.filter(O):this.where(v).equals("")},It.prototype.filter=function(m){return this.toCollection().and(m)},It.prototype.count=function(m){return this.toCollection().count(m)},It.prototype.offset=function(m){return this.toCollection().offset(m)},It.prototype.limit=function(m){return this.toCollection().limit(m)},It.prototype.each=function(m){return this.toCollection().each(m)},It.prototype.toArray=function(m){return this.toCollection().toArray(m)},It.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},It.prototype.orderBy=function(m){return new this.db.Collection(new this.db.WhereClause(this,c(m)?"[".concat(m.join("+"),"]"):m))},It.prototype.reverse=function(){return this.toCollection().reverse()},It.prototype.mapToClass=function(m){for(var v=this.db,S=this.name,C=((this.schema.mappedClass=m).prototype instanceof Xc&&(m=(O=>{var L=G,K=O;if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");function ne(){this.constructor=L}function G(){return O!==null&&O.apply(this,arguments)||this}return t(L,K),L.prototype=K===null?Object.create(K):(ne.prototype=K.prototype,new ne),Object.defineProperty(G.prototype,"db",{get:function(){return v},enumerable:!1,configurable:!0}),G.prototype.table=function(){return S},G})(m)),new Set),E=m.prototype;E;E=d(E))Object.getOwnPropertyNames(E).forEach(function(O){return C.add(O)});function M(O){if(!O)return O;var L,K=Object.create(m.prototype);for(L in O)if(!C.has(L))try{K[L]=O[L]}catch{}return K}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=M,this.hook("reading",M),m},It.prototype.defineClass=function(){return this.mapToClass(function(m){h(this,m)})},It.prototype.add=function(m,v){var S=this,C=this.schema.primKey,E=C.auto,M=C.keyPath,O=m;return M&&E&&(O=Ua(M)(m)),this._trans("readwrite",function(L){return S.core.mutate({trans:L,type:"add",keys:v!=null?[v]:null,values:[O]})}).then(function(L){return L.numFailures?Ue.reject(L.failures[0]):L.lastResult}).then(function(L){if(M)try{ee(m,M,L)}catch{}return L})},It.prototype.upsert=function(m,v){var S=this,C=this.schema.primKey.keyPath;return this._trans("readwrite",function(E){return S.core.get({trans:E,key:m}).then(function(M){var O=M??{};return Ns(O,v),C&&ee(O,C,m),S.core.mutate({trans:E,type:"put",values:[O],keys:[m],upsert:!0,updates:{keys:[m],changeSpecs:[v]}}).then(function(L){return L.numFailures?Ue.reject(L.failures[0]):!!M})})})},It.prototype.update=function(m,v){return typeof m!="object"||c(m)?this.where(":id").equals(m).modify(v):(m=z(m,this.schema.primKey.keyPath))===void 0?Qt(new ve.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(m).modify(v)},It.prototype.put=function(m,v){var S=this,C=this.schema.primKey,E=C.auto,M=C.keyPath,O=m;return M&&E&&(O=Ua(M)(m)),this._trans("readwrite",function(L){return S.core.mutate({trans:L,type:"put",values:[O],keys:v!=null?[v]:null})}).then(function(L){return L.numFailures?Ue.reject(L.failures[0]):L.lastResult}).then(function(L){if(M)try{ee(m,M,L)}catch{}return L})},It.prototype.delete=function(m){var v=this;return this._trans("readwrite",function(S){return v.core.mutate({trans:S,type:"delete",keys:[m]}).then(function(C){return Xn(v,[m],C)}).then(function(C){return C.numFailures?Ue.reject(C.failures[0]):void 0})})},It.prototype.clear=function(){var m=this;return this._trans("readwrite",function(v){return m.core.mutate({trans:v,type:"deleteRange",range:iu}).then(function(S){return Xn(m,null,S)})}).then(function(v){return v.numFailures?Ue.reject(v.failures[0]):void 0})},It.prototype.bulkGet=function(m){var v=this;return this._trans("readonly",function(S){return v.core.getMany({keys:m,trans:S}).then(function(C){return C.map(function(E){return v.hook.reading.fire(E)})})})},It.prototype.bulkAdd=function(m,v,S){var C=this,E=Array.isArray(v)?v:void 0,M=(S=S||(E?void 0:v))?S.allKeys:void 0;return this._trans("readwrite",function(O){var L=C.schema.primKey,ne=L.auto,L=L.keyPath;if(L&&E)throw new ve.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(E&&E.length!==m.length)throw new ve.InvalidArgument("Arguments objects and keys must have the same length");var K=m.length,ne=L&&ne?m.map(Ua(L)):m;return C.core.mutate({trans:O,type:"add",keys:E,values:ne,wantResults:M}).then(function(G){var V=G.numFailures,X=G.failures;if(V===0)return M?G.results:G.lastResult;throw new $e("".concat(C.name,".bulkAdd(): ").concat(V," of ").concat(K," operations failed"),X)})})},It.prototype.bulkPut=function(m,v,S){var C=this,E=Array.isArray(v)?v:void 0,M=(S=S||(E?void 0:v))?S.allKeys:void 0;return this._trans("readwrite",function(O){var L=C.schema.primKey,ne=L.auto,L=L.keyPath;if(L&&E)throw new ve.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(E&&E.length!==m.length)throw new ve.InvalidArgument("Arguments objects and keys must have the same length");var K=m.length,ne=L&&ne?m.map(Ua(L)):m;return C.core.mutate({trans:O,type:"put",keys:E,values:ne,wantResults:M}).then(function(G){var V=G.numFailures,X=G.failures;if(V===0)return M?G.results:G.lastResult;throw new $e("".concat(C.name,".bulkPut(): ").concat(V," of ").concat(K," operations failed"),X)})})},It.prototype.bulkUpdate=function(m){var v=this,S=this.core,C=m.map(function(O){return O.key}),E=m.map(function(O){return O.changes}),M=[];return this._trans("readwrite",function(O){return S.getMany({trans:O,keys:C,cache:"clone"}).then(function(L){var K=[],ne=[],G=(m.forEach(function(V,X){var Z=V.key,Y=V.changes,Q=L[X];if(Q){for(var ie=0,oe=Object.keys(Y);ie<oe.length;ie++){var re=oe[ie],me=Y[re];if(re===v.schema.primKey.keyPath){if(bt(me,Z)!==0)throw new ve.Constraint("Cannot update primary key in bulkUpdate()")}else ee(Q,re,me)}M.push(X),K.push(Z),ne.push(Q)}}),K.length);return S.mutate({trans:O,type:"put",keys:K,values:ne,updates:{keys:C,changeSpecs:E}}).then(function(V){var X=V.numFailures,Z=V.failures;if(X===0)return G;for(var Y=0,Q=Object.keys(Z);Y<Q.length;Y++){var ie,oe=Q[Y],re=M[Number(oe)];re!=null&&(ie=Z[oe],delete Z[oe],Z[re]=ie)}throw new $e("".concat(v.name,".bulkUpdate(): ").concat(X," of ").concat(G," operations failed"),Z)})})})},It.prototype.bulkDelete=function(m){var v=this,S=m.length;return this._trans("readwrite",function(C){return v.core.mutate({trans:C,type:"delete",keys:m}).then(function(E){return Xn(v,m,E)})}).then(function(C){var E=C.numFailures,M=C.failures;if(E===0)return C.lastResult;throw new $e("".concat(v.name,".bulkDelete(): ").concat(E," of ").concat(S," operations failed"),M)})};var lu=It;function It(){}function Va(m){function v(O,L){if(L){for(var K=arguments.length,ne=new Array(K-1);--K;)ne[K-1]=arguments[K];return S[O].subscribe.apply(null,ne),m}if(typeof O=="string")return S[O]}var S={};v.addEventType=M;for(var C=1,E=arguments.length;C<E;++C)M(arguments[C]);return v;function M(O,L,K){var ne,G;if(typeof O!="object")return L=L||at,G={subscribers:[],fire:K=K||nt,subscribe:function(V){G.subscribers.indexOf(V)===-1&&(G.subscribers.push(V),G.fire=L(G.fire,V))},unsubscribe:function(V){G.subscribers=G.subscribers.filter(function(X){return X!==V}),G.fire=G.subscribers.reduce(L,K)}},S[O]=v[O]=G;o(ne=O).forEach(function(V){var X=ne[V];if(c(X))M(V,ne[V][0],ne[V][1]);else{if(X!=="asap")throw new ve.InvalidArgument("Invalid event config");var Z=M(V,Gt,function(){for(var Y=arguments.length,Q=new Array(Y);Y--;)Q[Y]=arguments[Y];Z.subscribers.forEach(function(ie){F(function(){ie.apply(null,Q)})})})}})}}function Vn(m,v){return N(v).from({prototype:m}),v}function ji(m,v){return!(m.filter||m.algorithm||m.or)&&(v?m.justLimit:!m.replayFilter)}function Ms(m,v){m.filter=il(m.filter,v)}function Ka(m,v,S){var C=m.replayFilter;m.replayFilter=C?function(){return il(C(),v())}:v,m.justLimit=S&&!C}function gi(m,v){if(m.isPrimKey)return v.primaryKey;var S=v.getIndexByKeyPath(m.index);if(S)return S;throw new ve.Schema("KeyPath "+m.index+" on object store "+v.name+" is not indexed")}function au(m,v,S){var C=gi(m,v.schema);return v.openCursor({trans:S,values:!m.keysOnly,reverse:m.dir==="prev",unique:!!m.unique,query:{index:C,range:m.range}})}function Ga(m,v,S,C){var E,M,O=m.replayFilter?il(m.filter,m.replayFilter()):m.filter;return m.or?(E={},M=function(L,K,ne){var G,V;O&&!O(K,ne,function(X){return K.stop(X)},function(X){return K.fail(X)})||((V=""+(G=K.primaryKey))=="[object ArrayBuffer]"&&(V=""+new Uint8Array(G)),g(E,V))||(E[V]=!0,v(L,K,ne))},Promise.all([m.or._iterate(M,S),ll(au(m,C,S),m.algorithm,M,!m.keysOnly&&m.valueMapper)])):ll(au(m,C,S),il(m.algorithm,O),v,!m.keysOnly&&m.valueMapper)}function ll(m,v,S,C){var E=en(C?function(M,O,L){return S(C(M),O,L)}:S);return m.then(function(M){if(M)return M.start(function(){var O=function(){return M.continue()};v&&!v(M,function(L){return O=L},function(L){M.stop(L),O=nt},function(L){M.fail(L),O=nt})||E(M.value,M,function(L){return O=L}),O()})})}Mt.prototype._read=function(m,v){var S=this._ctx;return S.error?S.table._trans(null,Qt.bind(null,S.error)):S.table._trans("readonly",m).then(v)},Mt.prototype._write=function(m){var v=this._ctx;return v.error?v.table._trans(null,Qt.bind(null,v.error)):v.table._trans("readwrite",m,"locked")},Mt.prototype._addAlgorithm=function(m){var v=this._ctx;v.algorithm=il(v.algorithm,m)},Mt.prototype._iterate=function(m,v){return Ga(this._ctx,m,v,this._ctx.table.core)},Mt.prototype.clone=function(m){var v=Object.create(this.constructor.prototype),S=Object.create(this._ctx);return m&&h(S,m),v._ctx=S,v},Mt.prototype.raw=function(){return this._ctx.valueMapper=null,this},Mt.prototype.each=function(m){var v=this._ctx;return this._read(function(S){return Ga(v,m,S,v.table.core)})},Mt.prototype.count=function(m){var v=this;return this._read(function(S){var C,E=v._ctx,M=E.table.core;return ji(E,!0)?M.count({trans:S,query:{index:gi(E,M.schema),range:E.range}}).then(function(O){return Math.min(O,E.limit)}):(C=0,Ga(E,function(){return++C,!1},S,M).then(function(){return C}))}).then(m)},Mt.prototype.sortBy=function(m,v){var S=m.split(".").reverse(),C=S[0],E=S.length-1;function M(K,ne){return ne?M(K[S[ne]],ne-1):K[C]}var O=this._ctx.dir==="next"?1:-1;function L(K,ne){return bt(M(K,E),M(ne,E))*O}return this.toArray(function(K){return K.sort(L)}).then(v)},Mt.prototype.toArray=function(m){var v=this;return this._read(function(S){var C,E,M,O=v._ctx;return O.dir==="next"&&ji(O,!0)&&0<O.limit?(C=O.valueMapper,E=gi(O,O.table.core.schema),O.table.core.query({trans:S,limit:O.limit,values:!0,query:{index:E,range:O.range}}).then(function(L){return L=L.result,C?L.map(C):L})):(M=[],Ga(O,function(L){return M.push(L)},S,O.table.core).then(function(){return M}))},m)},Mt.prototype.offset=function(m){var v=this._ctx;return m<=0||(v.offset+=m,ji(v)?Ka(v,function(){var S=m;return function(C,E){return S===0||(S===1?--S:E(function(){C.advance(S),S=0}),!1)}}):Ka(v,function(){var S=m;return function(){return--S<0}})),this},Mt.prototype.limit=function(m){return this._ctx.limit=Math.min(this._ctx.limit,m),Ka(this._ctx,function(){var v=m;return function(S,C,E){return--v<=0&&C(E),0<=v}},!0),this},Mt.prototype.until=function(m,v){return Ms(this._ctx,function(S,C,E){return!m(S.value)||(C(E),v)}),this},Mt.prototype.first=function(m){return this.limit(1).toArray(function(v){return v[0]}).then(m)},Mt.prototype.last=function(m){return this.reverse().first(m)},Mt.prototype.filter=function(m){var v;return Ms(this._ctx,function(S){return m(S.value)}),(v=this._ctx).isMatch=il(v.isMatch,m),this},Mt.prototype.and=function(m){return this.filter(m)},Mt.prototype.or=function(m){return new this.db.WhereClause(this._ctx.table,m,this)},Mt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Mt.prototype.desc=function(){return this.reverse()},Mt.prototype.eachKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(S,C){m(C.key,C)})},Mt.prototype.eachUniqueKey=function(m){return this._ctx.unique="unique",this.eachKey(m)},Mt.prototype.eachPrimaryKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(S,C){m(C.primaryKey,C)})},Mt.prototype.keys=function(m){var v=this._ctx,S=(v.keysOnly=!v.isMatch,[]);return this.each(function(C,E){S.push(E.key)}).then(function(){return S}).then(m)},Mt.prototype.primaryKeys=function(m){var v=this._ctx;if(v.dir==="next"&&ji(v,!0)&&0<v.limit)return this._read(function(C){var E=gi(v,v.table.core.schema);return v.table.core.query({trans:C,values:!1,limit:v.limit,query:{index:E,range:v.range}})}).then(function(C){return C.result}).then(m);v.keysOnly=!v.isMatch;var S=[];return this.each(function(C,E){S.push(E.primaryKey)}).then(function(){return S}).then(m)},Mt.prototype.uniqueKeys=function(m){return this._ctx.unique="unique",this.keys(m)},Mt.prototype.firstKey=function(m){return this.limit(1).keys(function(v){return v[0]}).then(m)},Mt.prototype.lastKey=function(m){return this.reverse().firstKey(m)},Mt.prototype.distinct=function(){var m,v=this._ctx,v=v.index&&v.table.schema.idxByName[v.index];return v&&v.multi&&(m={},Ms(this._ctx,function(C){var C=C.primaryKey.toString(),E=g(m,C);return m[C]=!0,!E})),this},Mt.prototype.modify=function(m){var v=this,S=this._ctx;return this._write(function(C){function E(Q,ie){var oe=ie.failures;X+=Q-ie.numFailures;for(var re=0,me=o(oe);re<me.length;re++){var Te=me[re];V.push(oe[Te])}}var M=typeof m=="function"?m:function(Q){return Ns(Q,m)},O=S.table.core,G=O.schema.primaryKey,L=G.outbound,K=G.extractKey,ne=200,G=v.db._options.modifyChunkSize,V=(G&&(ne=typeof G=="object"?G[O.name]||G["*"]||200:G),[]),X=0,Z=[],Y=m===su;return v.clone().primaryKeys().then(function(Q){function ie(re){var me=Math.min(ne,Q.length-re),Te=Q.slice(re,re+me);return(Y?Promise.resolve([]):O.getMany({trans:C,keys:Te,cache:"immutable"})).then(function(ze){var Ie=[],Me=[],Qe=L?[]:null,Ve=Y?Te:[];if(!Y)for(var _e=0;_e<me;++_e){var Xe=ze[_e],ht={value:De(Xe),primKey:Q[re+_e]};M.call(ht,ht.value,ht)!==!1&&(ht.value==null?Ve.push(Q[re+_e]):L||bt(K(Xe),K(ht.value))===0?(Me.push(ht.value),L&&Qe.push(Q[re+_e])):(Ve.push(Q[re+_e]),Ie.push(ht.value)))}return Promise.resolve(0<Ie.length&&O.mutate({trans:C,type:"add",values:Ie}).then(function(kt){for(var it in kt.failures)Ve.splice(parseInt(it),1);E(Ie.length,kt)})).then(function(){return(0<Me.length||oe&&typeof m=="object")&&O.mutate({trans:C,type:"put",keys:Qe,values:Me,criteria:oe,changeSpec:typeof m!="function"&&m,isAdditionalChunk:0<re}).then(function(kt){return E(Me.length,kt)})}).then(function(){return(0<Ve.length||oe&&Y)&&O.mutate({trans:C,type:"delete",keys:Ve,criteria:oe,isAdditionalChunk:0<re}).then(function(kt){return Xn(S.table,Ve,kt)}).then(function(kt){return E(Ve.length,kt)})}).then(function(){return Q.length>re+me&&ie(re+ne)})})}var oe=ji(S)&&S.limit===1/0&&(typeof m!="function"||Y)&&{index:S.index,range:S.range};return ie(0).then(function(){if(0<V.length)throw new Ke("Error modifying one or more objects",V,X,Z);return Q.length})})})},Mt.prototype.delete=function(){var m=this._ctx,v=m.range;return!ji(m)||m.table.schema.yProps||!m.isPrimKey&&v.type!==3?this.modify(su):this._write(function(S){var C=m.table.core.schema.primaryKey,E=v;return m.table.core.count({trans:S,query:{index:C,range:E}}).then(function(M){return m.table.core.mutate({trans:S,type:"deleteRange",range:E}).then(function(K){var L=K.failures,K=K.numFailures;if(K)throw new Ke("Could not delete some values",Object.keys(L).map(function(ne){return L[ne]}),M-K);return M-K})})})};var Fd=Mt;function Mt(){}var su=function(m,v){return v.value=null};function ou(m,v){return m<v?-1:m===v?0:1}function Vd(m,v){return v<m?-1:m===v?0:1}function gr(m,v,S){return m=m instanceof al?new m.Collection(m):m,m._ctx.error=new(S||TypeError)(v),m}function yi(m){return new m.Collection(m,function(){return _s("")}).limit(0)}function wr(Z,v,S,C){var E,M,O,L,K,ne,G,V=S.length;if(!S.every(function(Q){return typeof Q=="string"}))return gr(Z,wn);function X(Q){E=Q==="next"?function(oe){return oe.toUpperCase()}:function(oe){return oe.toLowerCase()},M=Q==="next"?function(oe){return oe.toLowerCase()}:function(oe){return oe.toUpperCase()},O=Q==="next"?ou:Vd;var ie=S.map(function(oe){return{lower:M(oe),upper:E(oe)}}).sort(function(oe,re){return O(oe.lower,re.lower)});L=ie.map(function(oe){return oe.upper}),K=ie.map(function(oe){return oe.lower}),G=(ne=Q)==="next"?"":C}X("next");var Z=new Z.Collection(Z,function(){return Qr(L[0],K[V-1]+C)}),Y=(Z._ondirectionchange=function(Q){X(Q)},0);return Z._addAlgorithm(function(Q,ie,oe){var re=Q.key;if(typeof re=="string"){var me=M(re);if(v(me,K,Y))return!0;for(var Te=null,ze=Y;ze<V;++ze){var Ie=((Me,Qe,Ve,_e,Xe,ht)=>{for(var kt=Math.min(Me.length,_e.length),it=-1,dt=0;dt<kt;++dt){var Xt=Qe[dt];if(Xt!==_e[dt])return Xe(Me[dt],Ve[dt])<0?Me.substr(0,dt)+Ve[dt]+Ve.substr(dt+1):Xe(Me[dt],_e[dt])<0?Me.substr(0,dt)+_e[dt]+Ve.substr(dt+1):0<=it?Me.substr(0,it)+Qe[it]+Ve.substr(it+1):null;Xe(Me[dt],Xt)<0&&(it=dt)}return kt<_e.length&&ht==="next"?Me+Ve.substr(Me.length):kt<Me.length&&ht==="prev"?Me.substr(0,Ve.length):it<0?null:Me.substr(0,it)+_e[it]+Ve.substr(it+1)})(re,me,L[ze],K[ze],O,ne);Ie===null&&Te===null?Y=ze+1:(Te===null||0<O(Te,Ie))&&(Te=Ie)}ie(Te!==null?function(){Q.continue(Te+G)}:oe)}return!1}),Z}function Qr(m,v,S,C){return{type:2,lower:m,upper:v,lowerOpen:S,upperOpen:C}}function _s(m){return{type:1,lower:m,upper:m}}Object.defineProperty(on.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),on.prototype.between=function(m,v,S,C){S=S!==!1,C=C===!0;try{return 0<this._cmp(m,v)||this._cmp(m,v)===0&&(S||C)&&(!S||!C)?yi(this):new this.Collection(this,function(){return Qr(m,v,!S,!C)})}catch{return gr(this,ar)}},on.prototype.equals=function(m){return m==null?gr(this,ar):new this.Collection(this,function(){return _s(m)})},on.prototype.above=function(m){return m==null?gr(this,ar):new this.Collection(this,function(){return Qr(m,void 0,!0)})},on.prototype.aboveOrEqual=function(m){return m==null?gr(this,ar):new this.Collection(this,function(){return Qr(m,void 0,!1)})},on.prototype.below=function(m){return m==null?gr(this,ar):new this.Collection(this,function(){return Qr(void 0,m,!1,!0)})},on.prototype.belowOrEqual=function(m){return m==null?gr(this,ar):new this.Collection(this,function(){return Qr(void 0,m)})},on.prototype.startsWith=function(m){return typeof m!="string"?gr(this,wn):this.between(m,m+Or,!0,!0)},on.prototype.startsWithIgnoreCase=function(m){return m===""?this.startsWith(m):wr(this,function(v,S){return v.indexOf(S[0])===0},[m],Or)},on.prototype.equalsIgnoreCase=function(m){return wr(this,function(v,S){return v===S[0]},[m],"")},on.prototype.anyOfIgnoreCase=function(){var m=B.apply(Se,arguments);return m.length===0?yi(this):wr(this,function(v,S){return S.indexOf(v)!==-1},m,"")},on.prototype.startsWithAnyOfIgnoreCase=function(){var m=B.apply(Se,arguments);return m.length===0?yi(this):wr(this,function(v,S){return S.some(function(C){return v.indexOf(C)===0})},m,Or)},on.prototype.anyOf=function(){var m,v,S=this,C=B.apply(Se,arguments),E=this._cmp;try{C.sort(E)}catch{return gr(this,ar)}return C.length===0?yi(this):((m=new this.Collection(this,function(){return Qr(C[0],C[C.length-1])}))._ondirectionchange=function(M){E=M==="next"?S._ascending:S._descending,C.sort(E)},v=0,m._addAlgorithm(function(M,O,L){for(var K=M.key;0<E(K,C[v]);)if(++v===C.length)return O(L),!1;return E(K,C[v])===0||(O(function(){M.continue(C[v])}),!1)}),m)},on.prototype.notEqual=function(m){return this.inAnyRange([[-1/0,m],[m,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},on.prototype.noneOf=function(){var m=B.apply(Se,arguments);if(m.length===0)return new this.Collection(this);try{m.sort(this._ascending)}catch{return gr(this,ar)}var v=m.reduce(function(S,C){return S?S.concat([[S[S.length-1][1],C]]):[[-1/0,C]]},null);return v.push([m[m.length-1],this.db._maxKey]),this.inAnyRange(v,{includeLowers:!1,includeUppers:!1})},on.prototype.inAnyRange=function(m,oe){var S=this,C=this._cmp,E=this._ascending,M=this._descending,O=this._min,L=this._max;if(m.length===0)return yi(this);if(!m.every(function(re){return re[0]!==void 0&&re[1]!==void 0&&E(re[0],re[1])<=0}))return gr(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ve.InvalidArgument);var K=!oe||oe.includeLowers!==!1,ne=oe&&oe.includeUppers===!0,G,V=E;function X(re,me){return V(re[0],me[0])}try{(G=m.reduce(function(re,me){for(var Te=0,ze=re.length;Te<ze;++Te){var Ie=re[Te];if(C(me[0],Ie[1])<0&&0<C(me[1],Ie[0])){Ie[0]=O(Ie[0],me[0]),Ie[1]=L(Ie[1],me[1]);break}}return Te===ze&&re.push(me),re},[])).sort(X)}catch{return gr(this,ar)}var Z=0,Y=ne?function(re){return 0<E(re,G[Z][1])}:function(re){return 0<=E(re,G[Z][1])},Q=K?function(re){return 0<M(re,G[Z][0])}:function(re){return 0<=M(re,G[Z][0])},ie=Y,oe=new this.Collection(this,function(){return Qr(G[0][0],G[G.length-1][1],!K,!ne)});return oe._ondirectionchange=function(re){V=re==="next"?(ie=Y,E):(ie=Q,M),G.sort(X)},oe._addAlgorithm(function(re,me,Te){for(var ze,Ie=re.key;ie(Ie);)if(++Z===G.length)return me(Te),!1;return!Y(ze=Ie)&&!Q(ze)||(S._cmp(Ie,G[Z][1])===0||S._cmp(Ie,G[Z][0])===0||me(function(){V===E?re.continue(G[Z][0]):re.continue(G[Z][1])}),!1)}),oe},on.prototype.startsWithAnyOf=function(){var m=B.apply(Se,arguments);return m.every(function(v){return typeof v=="string"})?m.length===0?yi(this):this.inAnyRange(m.map(function(v){return[v,v+Or]})):gr(this,"startsWithAnyOf() only works with strings")};var al=on;function on(){}function Rr(m){return en(function(v){return sl(v),m(v.target.error),!1})}function sl(m){m.stopPropagation&&m.stopPropagation(),m.preventDefault&&m.preventDefault()}var Hl="storagemutated",ol="x-storagemutated-1",Kn=Va(null,Hl),uu=(sr.prototype._lock=function(){return ce(!Le.global),++this._reculock,this._reculock!==1||Le.global||(Le.lockOwnerFor=this),this},sr.prototype._unlock=function(){if(ce(!Le.global),--this._reculock==0)for(Le.global||(Le.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var m=this._blockedFuncs.shift();try{jr(m[1],m[0])}catch{}}return this},sr.prototype._locked=function(){return this._reculock&&Le.lockOwnerFor!==this},sr.prototype.create=function(m){var v=this;if(this.mode){var S=this.db.idbdb,C=this.db._state.dbOpenError;if(ce(!this.idbtrans),!m&&!S)switch(C&&C.name){case"DatabaseClosedError":throw new ve.DatabaseClosed(C);case"MissingAPIError":throw new ve.MissingAPI(C.message,C);default:throw new ve.OpenFailed(C)}if(!this.active)throw new ve.TransactionInactive;ce(this._completion._state===null),(m=this.idbtrans=m||(this.db.core||S).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=en(function(E){sl(E),v._reject(m.error)}),m.onabort=en(function(E){sl(E),v.active&&v._reject(new ve.Abort(m.error)),v.active=!1,v.on("abort").fire(E)}),m.oncomplete=en(function(){v.active=!1,v._resolve(),"mutatedParts"in m&&Kn.storagemutated.fire(m.mutatedParts)})}return this},sr.prototype._promise=function(m,v,S){var C,E=this;return m==="readwrite"&&this.mode!=="readwrite"?Qt(new ve.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Ue(function(M,O){E._blockedFuncs.push([function(){E._promise(m,v,S).then(M,O)},Le])}):S?ln(function(){var M=new Ue(function(O,L){E._lock();var K=v(O,L,E);K&&K.then&&K.then(O,L)});return M.finally(function(){return E._unlock()}),M._lib=!0,M}):((C=new Ue(function(M,O){var L=v(M,O,E);L&&L.then&&L.then(M,O)}))._lib=!0,C):Qt(new ve.TransactionInactive)},sr.prototype._root=function(){return this.parent?this.parent._root():this},sr.prototype.waitFor=function(m){var v,S=this._root(),C=Ue.resolve(m),E=(S._waitingFor?S._waitingFor=S._waitingFor.then(function(){return C}):(S._waitingFor=C,S._waitingQueue=[],v=S.idbtrans.objectStore(S.storeNames[0]),(function M(){for(++S._spinCount;S._waitingQueue.length;)S._waitingQueue.shift()();S._waitingFor&&(v.get(-1/0).onsuccess=M)})()),S._waitingFor);return new Ue(function(M,O){C.then(function(L){return S._waitingQueue.push(en(M.bind(null,L)))},function(L){return S._waitingQueue.push(en(O.bind(null,L)))}).finally(function(){S._waitingFor===E&&(S._waitingFor=null)})})},sr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ve.Abort))},sr.prototype.table=function(m){var v=this._memoizedTables||(this._memoizedTables={});if(g(v,m))return v[m];var S=this.schema[m];if(S)return(S=new this.db.Table(m,S,this)).core=this.db.core.table(m),v[m]=S;throw new ve.NotFound("Table "+m+" not part of transaction")},sr);function sr(){}function Xr(m,v,S,C,E,M,O,L){return{name:m,keyPath:v,unique:S,multi:C,auto:E,compound:M,src:(S&&!O?"&":"")+(C?"*":"")+(E?"++":"")+Ds(v),type:L}}function Ds(m){return typeof m=="string"?m:m?"["+[].join.call(m,"+")+"]":""}function ql(m,v,S){return{name:m,primKey:v,indexes:S,mappedClass:null,idxByName:(C=function(E){return[E.name,E]},S.reduce(function(E,M,O){return M=C(M,O),M&&(E[M[0]]=M[1]),E},{}))};var C}var Ul=function(m){try{return m.only([[]]),Ul=function(){return[[]]},[[]]}catch{return Ul=function(){return Or},Or}};function Fl(m){return m==null?function(){}:typeof m=="string"?(v=m).split(".").length===1?function(S){return S[v]}:function(S){return z(S,v)}:function(S){return z(S,m)};var v}function Ya(m){return[].slice.call(m)}var Wc=0;function _n(m){return m==null?":id":typeof m=="string"?m:"[".concat(m.join("+"),"]")}function ul(m,v,K){function C(Y){if(Y.type===3)return null;if(Y.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var V=Y.lower,X=Y.upper,Z=Y.lowerOpen,Y=Y.upperOpen;return V===void 0?X===void 0?null:v.upperBound(X,!!Y):X===void 0?v.lowerBound(V,!!Z):v.bound(V,X,!!Z,!!Y)}function E(G){var V,X=G.name;return{name:X,schema:G,mutate:function(Z){var Y=Z.trans,Q=Z.type,ie=Z.keys,oe=Z.values,re=Z.range;return new Promise(function(me,Te){me=en(me);var ze=Y.objectStore(X),Ie=ze.keyPath==null,Me=Q==="put"||Q==="add";if(!Me&&Q!=="delete"&&Q!=="deleteRange")throw new Error("Invalid operation type: "+Q);var Qe,Ve=(ie||oe||{length:1}).length;if(ie&&oe&&ie.length!==oe.length)throw new Error("Given keys array must have same length as given values array.");if(Ve===0)return me({numFailures:0,failures:{},results:[],lastResult:void 0});function _e(qt){++kt,sl(qt)}var Xe=[],ht=[],kt=0;if(Q==="deleteRange"){if(re.type===4)return me({numFailures:kt,failures:ht,results:[],lastResult:void 0});re.type===3?Xe.push(Qe=ze.clear()):Xe.push(Qe=ze.delete(C(re)))}else{var Ie=Me?Ie?[oe,ie]:[oe,null]:[ie,null],it=Ie[0],dt=Ie[1];if(Me)for(var Xt=0;Xt<Ve;++Xt)Xe.push(Qe=dt&&dt[Xt]!==void 0?ze[Q](it[Xt],dt[Xt]):ze[Q](it[Xt])),Qe.onerror=_e;else for(Xt=0;Xt<Ve;++Xt)Xe.push(Qe=ze[Q](it[Xt])),Qe.onerror=_e}function ur(qt){qt=qt.target.result,Xe.forEach(function(Li,Xl){return Li.error!=null&&(ht[Xl]=Li.error)}),me({numFailures:kt,failures:ht,results:Q==="delete"?ie:Xe.map(function(Li){return Li.result}),lastResult:qt})}Qe.onerror=function(qt){_e(qt),ur(qt)},Qe.onsuccess=ur})},getMany:function(Z){var Y=Z.trans,Q=Z.keys;return new Promise(function(ie,oe){ie=en(ie);for(var re,me=Y.objectStore(X),Te=Q.length,ze=new Array(Te),Ie=0,Me=0,Qe=function(Xe){Xe=Xe.target,ze[Xe._pos]=Xe.result,++Me===Ie&&ie(ze)},Ve=Rr(oe),_e=0;_e<Te;++_e)Q[_e]!=null&&((re=me.get(Q[_e]))._pos=_e,re.onsuccess=Qe,re.onerror=Ve,++Ie);Ie===0&&ie(ze)})},get:function(Z){var Y=Z.trans,Q=Z.key;return new Promise(function(ie,oe){ie=en(ie);var re=Y.objectStore(X).get(Q);re.onsuccess=function(me){return ie(me.target.result)},re.onerror=Rr(oe)})},query:(V=L,function(Z){return new Promise(function(Y,Q){Y=en(Y);var ie,oe,re,Me=Z.trans,me=Z.values,Te=Z.limit,Ie=Z.query,ze=Te===1/0?void 0:Te,Qe=Ie.index,Ie=Ie.range,Me=Me.objectStore(X),Me=Qe.isPrimaryKey?Me:Me.index(Qe.name),Qe=C(Ie);if(Te===0)return Y({result:[]});V?((Ie=me?Me.getAll(Qe,ze):Me.getAllKeys(Qe,ze)).onsuccess=function(Ve){return Y({result:Ve.target.result})},Ie.onerror=Rr(Q)):(ie=0,oe=!me&&"openKeyCursor"in Me?Me.openKeyCursor(Qe):Me.openCursor(Qe),re=[],oe.onsuccess=function(Ve){var _e=oe.result;return!_e||(re.push(me?_e.value:_e.primaryKey),++ie===Te)?Y({result:re}):void _e.continue()},oe.onerror=Rr(Q))})}),openCursor:function(Z){var Y=Z.trans,Q=Z.values,ie=Z.query,oe=Z.reverse,re=Z.unique;return new Promise(function(me,Te){me=en(me);var Me=ie.index,ze=ie.range,Ie=Y.objectStore(X),Ie=Me.isPrimaryKey?Ie:Ie.index(Me.name),Me=oe?re?"prevunique":"prev":re?"nextunique":"next",Qe=!Q&&"openKeyCursor"in Ie?Ie.openKeyCursor(C(ze),Me):Ie.openCursor(C(ze),Me);Qe.onerror=Rr(Te),Qe.onsuccess=en(function(Ve){var _e,Xe,ht,kt,it=Qe.result;it?(it.___id=++Wc,it.done=!1,_e=it.continue.bind(it),Xe=(Xe=it.continuePrimaryKey)&&Xe.bind(it),ht=it.advance.bind(it),kt=function(){throw new Error("Cursor not stopped")},it.trans=Y,it.stop=it.continue=it.continuePrimaryKey=it.advance=function(){throw new Error("Cursor not started")},it.fail=en(Te),it.next=function(){var dt=this,Xt=1;return this.start(function(){return Xt--?dt.continue():dt.stop()}).then(function(){return dt})},it.start=function(dt){function Xt(){if(Qe.result)try{dt()}catch(qt){it.fail(qt)}else it.done=!0,it.start=function(){throw new Error("Cursor behind last entry")},it.stop()}var ur=new Promise(function(qt,Li){qt=en(qt),Qe.onerror=Rr(Li),it.fail=Li,it.stop=function(Xl){it.stop=it.continue=it.continuePrimaryKey=it.advance=kt,qt(Xl)}});return Qe.onsuccess=en(function(qt){Qe.onsuccess=Xt,Xt()}),it.continue=_e,it.continuePrimaryKey=Xe,it.advance=ht,Xt(),ur},me(it)):me(null)},Te)})},count:function(Z){var Y=Z.query,Q=Z.trans,ie=Y.index,oe=Y.range;return new Promise(function(re,me){var Te=Q.objectStore(X),Te=ie.isPrimaryKey?Te:Te.index(ie.name),ze=C(oe),ze=ze?Te.count(ze):Te.count();ze.onsuccess=en(function(Ie){return re(Ie.target.result)}),ze.onerror=Rr(me)})}}}M=K,O=Ya((K=m).objectStoreNames);var M,K={schema:{name:K.name,tables:O.map(function(G){return M.objectStore(G)}).map(function(G){var V=G.keyPath,X=G.autoIncrement,Y=c(V),Z={},Y={name:G.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:V==null,compound:Y,keyPath:V,autoIncrement:X,unique:!0,extractKey:Fl(V)},indexes:Ya(G.indexNames).map(function(Q){return G.index(Q)}).map(function(re){var me=re.name,ie=re.unique,oe=re.multiEntry,re=re.keyPath,me={name:me,compound:c(re),keyPath:re,unique:ie,multiEntry:oe,extractKey:Fl(re)};return Z[_n(re)]=me}),getIndexByKeyPath:function(Q){return Z[_n(Q)]}};return Z[":id"]=Y.primaryKey,V!=null&&(Z[_n(V)]=Y.primaryKey),Y})},hasGetAll:0<O.length&&"getAll"in M.objectStore(O[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},O=K.schema,L=K.hasGetAll,K=O.tables.map(E),ne={};return K.forEach(function(G){return ne[G.name]=G}),{stack:"dbcore",transaction:m.transaction.bind(m),table:function(G){if(ne[G])return ne[G];throw new Error("Table '".concat(G,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ul(v),schema:O}}function js(m,v,S,C){return S=S.IDBKeyRange,v=ul(v,S,C),{dbcore:m.dbcore.reduce(function(E,M){return M=M.create,r(r({},E),M(E))},v)}}function Oi(m,v){var S=v.db,S=js(m._middlewares,S,m._deps,v);m.core=S.dbcore,m.tables.forEach(function(C){var E=C.name;m.core.schema.tables.some(function(M){return M.name===E})&&(C.core=m.core.table(E),m[E]instanceof m.Table)&&(m[E].core=C.core)})}function Os(m,v,S,C){S.forEach(function(E){var M=C[E];v.forEach(function(O){var L=(function K(ne,G){return D(ne,G)||(ne=d(ne))&&K(ne,G)})(O,E);(!L||"value"in L&&L.value===void 0)&&(O===m.Transaction.prototype||O instanceof m.Transaction?T(O,E,{get:function(){return this.table(E)},set:function(K){w(this,E,{value:K,writable:!0,configurable:!0,enumerable:!0})}}):O[E]=new m.Table(E,M))})})}function Qa(m,v){v.forEach(function(S){for(var C in S)S[C]instanceof m.Table&&delete S[C]})}function cu(m,v){return m._cfg.version-v._cfg.version}function Xa(m,v,S,C){var E=m._dbSchema,M=(S.objectStoreNames.contains("$meta")&&!E.$meta&&(E.$meta=ql("$meta",Jc("")[0],[]),m._storeNames.push("$meta")),m._createTransaction("readwrite",m._storeNames,E)),O=(M.create(S),M._completion.catch(C),M._reject.bind(M)),L=Le.transless||Le;ln(function(){if(Le.trans=M,Le.transless=L,v!==0)return Oi(m,S),ne=v,((K=M).storeNames.includes("$meta")?K.table("$meta").get("version").then(function(G){return G??ne}):Ue.resolve(ne)).then(function(ie){var V=m,X=ie,Z=M,Y=S,Q=[],ie=V._versions,oe=V._dbSchema=Vl(0,V.idbdb,Y);return(ie=ie.filter(function(re){return re._cfg.version>=X})).length===0?Ue.resolve():(ie.forEach(function(re){Q.push(function(){var me,Te,ze,Ie=oe,Me=re._cfg.dbschema,Qe=(zs(V,Ie,Y),zs(V,Me,Y),oe=V._dbSchema=Me,Bs(Ie,Me)),Ve=(Qe.add.forEach(function(_e){hu(Y,_e[0],_e[1].primKey,_e[1].indexes)}),Qe.change.forEach(function(_e){if(_e.recreate)throw new ve.Upgrade("Not yet support for changing primary key");var Xe=Y.objectStore(_e.name);_e.add.forEach(function(ht){return Ls(Xe,ht)}),_e.change.forEach(function(ht){Xe.deleteIndex(ht.name),Ls(Xe,ht)}),_e.del.forEach(function(ht){return Xe.deleteIndex(ht)})}),re._cfg.contentUpgrade);if(Ve&&re._cfg.version>X)return Oi(V,Y),Z._memoizedTables={},me=ye(Me),Qe.del.forEach(function(_e){me[_e]=Ie[_e]}),Qa(V,[V.Transaction.prototype]),Os(V,[V.Transaction.prototype],o(me),me),Z.schema=me,(Te=Pe(Ve))&&kn(),Me=Ue.follow(function(){var _e;(ze=Ve(Z))&&Te&&(_e=mr.bind(null,null),ze.then(_e,_e))}),ze&&typeof ze.then=="function"?Ue.resolve(ze):Me.then(function(){return ze})}),Q.push(function(me){var Te,ze,Ie=re._cfg.dbschema;Te=Ie,ze=me,[].slice.call(ze.db.objectStoreNames).forEach(function(Me){return Te[Me]==null&&ze.db.deleteObjectStore(Me)}),Qa(V,[V.Transaction.prototype]),Os(V,[V.Transaction.prototype],V._storeNames,V._dbSchema),Z.schema=V._dbSchema}),Q.push(function(me){V.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(V.idbdb.version/10)===re._cfg.version?(V.idbdb.deleteObjectStore("$meta"),delete V._dbSchema.$meta,V._storeNames=V._storeNames.filter(function(Te){return Te!=="$meta"})):me.objectStore("$meta").put(re._cfg.version,"version"))})}),(function re(){return Q.length?Ue.resolve(Q.shift()(Z.idbtrans)).then(re):Ue.resolve()})().then(function(){Zc(oe,Y)}))}).catch(O);var K,ne;o(E).forEach(function(G){hu(S,G,E[G].primKey,E[G].indexes)}),Oi(m,S),Ue.follow(function(){return m.on.populate.fire(M)}).catch(O)})}function Rs(m,v){Zc(m._dbSchema,v),v.db.version%10!=0||v.objectStoreNames.contains("$meta")||v.db.createObjectStore("$meta").add(Math.ceil(v.db.version/10-1),"version");var S=Vl(0,m.idbdb,v);zs(m,m._dbSchema,v);for(var C=0,E=Bs(S,m._dbSchema).change;C<E.length;C++){var M=(O=>{if(O.change.length||O.recreate)return console.warn("Unable to patch indexes of table ".concat(O.name," because it has changes on the type of index or primary key.")),{value:void 0};var L=v.objectStore(O.name);O.add.forEach(function(K){Ge&&console.debug("Dexie upgrade patch: Creating missing index ".concat(O.name,".").concat(K.src)),Ls(L,K)})})(E[C]);if(typeof M=="object")return M.value}}function Bs(m,v){var S,C={del:[],add:[],change:[]};for(S in m)v[S]||C.del.push(S);for(S in v){var E=m[S],M=v[S];if(E){var O={name:S,def:M,recreate:!1,del:[],add:[],change:[]};if(""+(E.primKey.keyPath||"")!=""+(M.primKey.keyPath||"")||E.primKey.auto!==M.primKey.auto)O.recreate=!0,C.change.push(O);else{var L=E.idxByName,K=M.idxByName,ne=void 0;for(ne in L)K[ne]||O.del.push(ne);for(ne in K){var G=L[ne],V=K[ne];G?G.src!==V.src&&O.change.push(V):O.add.push(V)}(0<O.del.length||0<O.add.length||0<O.change.length)&&C.change.push(O)}}else C.add.push([S,M])}return C}function hu(m,v,S,C){var E=m.db.createObjectStore(v,S.keyPath?{keyPath:S.keyPath,autoIncrement:S.auto}:{autoIncrement:S.auto});C.forEach(function(M){return Ls(E,M)})}function Zc(m,v){o(m).forEach(function(S){v.db.objectStoreNames.contains(S)||(Ge&&console.debug("Dexie: Creating missing table",S),hu(v,S,m[S].primKey,m[S].indexes))})}function Ls(m,v){m.createIndex(v.name,v.keyPath,{unique:v.unique,multiEntry:v.multi})}function Vl(m,v,S){var C={};return U(v.objectStoreNames,0).forEach(function(E){for(var M=S.objectStore(E),O=Xr(Ds(ne=M.keyPath),ne||"",!0,!1,!!M.autoIncrement,ne&&typeof ne!="string",!0),L=[],K=0;K<M.indexNames.length;++K){var G=M.index(M.indexNames[K]),ne=G.keyPath,G=Xr(G.name,ne,!!G.unique,!!G.multiEntry,!1,ne&&typeof ne!="string",!1);L.push(G)}C[E]=ql(E,O,L)}),C}function zs(m,v,S){for(var C=S.db.objectStoreNames,E=0;E<C.length;++E){var M=C[E],O=S.objectStore(M);m._hasGetAll="getAll"in O;for(var L=0;L<O.indexNames.length;++L){var K,ne=O.indexNames[L],G=O.index(ne).keyPath,G=typeof G=="string"?G:"["+U(G).join("+")+"]";v[M]&&(K=v[M].idxByName[G])&&(K.name=ne,delete v[M].idxByName[G],v[M].idxByName[ne]=K)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(m._hasGetAll=!1)}function Jc(m){return m.split(",").map(function(v,S){var E=v.split(":"),C=(C=E[1])==null?void 0:C.trim(),E=(v=E[0].trim()).replace(/([&*]|\+\+)/g,""),M=/^\[/.test(E)?E.match(/^\[(.*)\]$/)[1].split("+"):E;return Xr(E,M||null,/\&/.test(v),/\*/.test(v),/\+\+/.test(v),c(M),S===0,C)})}Kl.prototype._createTableSchema=ql,Kl.prototype._parseIndexSyntax=Jc,Kl.prototype._parseStoresSpec=function(m,v){var S=this;o(m).forEach(function(C){if(m[C]!==null){var E=S._parseIndexSyntax(m[C]),M=E.shift();if(!M)throw new ve.Schema("Invalid schema for table "+C+": "+m[C]);if(M.unique=!0,M.multi)throw new ve.Schema("Primary key cannot be multiEntry*");E.forEach(function(O){if(O.auto)throw new ve.Schema("Only primary key can be marked as autoIncrement (++)");if(!O.keyPath)throw new ve.Schema("Index must have a name and cannot be an empty string")}),M=S._createTableSchema(C,M,E),v[C]=M}})},Kl.prototype.stores=function(S){var v=this.db,S=(this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,S):S,v._versions),C={},E={};return S.forEach(function(M){h(C,M._cfg.storesSource),E=M._cfg.dbschema={},M._parseStoresSpec(C,E)}),v._dbSchema=E,Qa(v,[v._allTables,v,v.Transaction.prototype]),Os(v,[v._allTables,v,v.Transaction.prototype,this._cfg.tables],o(E),E),v._storeNames=o(E),this},Kl.prototype.upgrade=function(m){return this._cfg.contentUpgrade=be(this._cfg.contentUpgrade||nt,m),this};var Kd=Kl;function Kl(){}function fu(m,v){var S=m._dbNamesDB;return S||(S=m._dbNamesDB=new $r(qa,{addons:[],indexedDB:m,IDBKeyRange:v})).version(1).stores({dbnames:"name"}),S.table("dbnames")}function Is(m){return m&&typeof m.databases=="function"}function du(m){return ln(function(){return Le.letThrough=!0,m()})}function pu(m){return!("from"in m)}var Gn=function(m,v){var S;if(!this)return S=new Gn,m&&"d"in m&&h(S,m),S;h(this,arguments.length?{d:1,from:m,to:1<arguments.length?v:m}:{d:0})};function $a(m,v,S){var C=bt(v,S);if(!isNaN(C)){if(0<C)throw RangeError();if(pu(m))return h(m,{from:v,to:S,d:1});var C=m.l,E=m.r;if(bt(S,m.from)<0)return C?$a(C,v,S):m.l={from:v,to:S,d:1,l:null,r:null},th(m);if(0<bt(v,m.to))return E?$a(E,v,S):m.r={from:v,to:S,d:1,l:null,r:null},th(m);bt(v,m.from)<0&&(m.from=v,m.l=null,m.d=E?E.d+1:1),0<bt(S,m.to)&&(m.to=S,m.r=null,m.d=m.l?m.l.d+1:1),v=!m.r,C&&!m.l&&cl(m,C),E&&v&&cl(m,E)}}function cl(m,v){pu(v)||(function S(C,E){var M=E.from,O=E.l,L=E.r;$a(C,M,E.to),O&&S(C,O),L&&S(C,L)})(m,v)}function eh(m,v){var S=Ps(v),C=S.next();if(!C.done)for(var E=C.value,M=Ps(m),O=M.next(E.from),L=O.value;!C.done&&!O.done;){if(bt(L.from,E.to)<=0&&0<=bt(L.to,E.from))return!0;bt(E.from,L.from)<0?E=(C=S.next(L.from)).value:L=(O=M.next(E.from)).value}return!1}function Ps(m){var v=pu(m)?null:{s:0,n:m};return{next:function(S){for(var C=0<arguments.length;v;)switch(v.s){case 0:if(v.s=1,C)for(;v.n.l&&bt(S,v.n.from)<0;)v={up:v,n:v.n.l,s:1};else for(;v.n.l;)v={up:v,n:v.n.l,s:1};case 1:if(v.s=2,!C||bt(S,v.n.to)<=0)return{value:v.n,done:!1};case 2:if(v.n.r){v.s=3,v={up:v,n:v.n.r,s:0};continue}case 3:v=v.up}return{done:!0}}}}function th(m){var v,S,C,E=(((E=m.r)==null?void 0:E.d)||0)-(((E=m.l)==null?void 0:E.d)||0),E=1<E?"r":E<-1?"l":"";E&&(v=E=="r"?"l":"r",S=r({},m),C=m[E],m.from=C.from,m.to=C.to,m[E]=C[E],S[E]=C[v],(m[v]=S).d=mu(S)),m.d=mu(m)}function mu(S){var v=S.r,S=S.l;return(v?S?Math.max(v.d,S.d):v.d:S?S.d:0)+1}function Hs(m,v){return o(v).forEach(function(S){m[S]?cl(m[S],v[S]):m[S]=(function C(E){var M,O,L={};for(M in E)g(E,M)&&(O=E[M],L[M]=!O||typeof O!="object"||pe.has(O.constructor)?O:C(O));return L})(v[S])}),m}function gu(m,v){return m.all||v.all||Object.keys(m).some(function(S){return v[S]&&eh(v[S],m[S])})}b(Gn.prototype,((ue={add:function(m){return cl(this,m),this},addKey:function(m){return $a(this,m,m),this},addKeys:function(m){var v=this;return m.forEach(function(S){return $a(v,S,S)}),this},hasKey:function(m){var v=Ps(this).next(m).value;return v&&bt(v.from,m)<=0&&0<=bt(v.to,m)}})[q]=function(){return Ps(this)},ue));var hl={},yu={},xu=!1;function qs(m){Hs(yu,m),xu||(xu=!0,setTimeout(function(){xu=!1,vu(yu,!(yu={}))},0))}function vu(m,v){v===void 0&&(v=!1);var S=new Set;if(m.all)for(var C=0,E=Object.values(hl);C<E.length;C++)nh(L=E[C],m,S,v);else for(var M in m){var O,L,M=/^idb\:\/\/(.*)\/(.*)\//.exec(M);M&&(O=M[1],M=M[2],L=hl["idb://".concat(O,"/").concat(M)])&&nh(L,m,S,v)}S.forEach(function(K){return K()})}function nh(m,v,S,C){for(var E=[],M=0,O=Object.entries(m.queries.query);M<O.length;M++){for(var L=O[M],K=L[0],ne=[],G=0,V=L[1];G<V.length;G++){var X=V[G];gu(v,X.obsSet)?X.subscribers.forEach(function(ie){return S.add(ie)}):C&&ne.push(X)}C&&E.push([K,ne])}if(C)for(var Z=0,Y=E;Z<Y.length;Z++){var Q=Y[Z],K=Q[0],ne=Q[1];m.queries.query[K]=ne}}function Gd(m){var v=m._state,S=m._deps.indexedDB;if(v.isBeingOpened||m.idbdb)return v.dbReadyPromise.then(function(){return v.dbOpenError?Qt(v.dbOpenError):m});v.isBeingOpened=!0,v.dbOpenError=null,v.openComplete=!1;var C=v.openCanceller,E=Math.round(10*m.verno),M=!1;function O(){if(v.openCanceller!==C)throw new ve.DatabaseClosed("db.open() was cancelled")}function L(){return new Ue(function(X,Z){if(O(),!S)throw new ve.MissingAPI;var Y=m.name,Q=v.autoSchema||!E?S.open(Y):S.open(Y,E);if(!Q)throw new ve.MissingAPI;Q.onerror=Rr(Z),Q.onblocked=en(m._fireOnBlocked),Q.onupgradeneeded=en(function(ie){var oe;G=Q.transaction,v.autoSchema&&!m._options.allowEmptyDB?(Q.onerror=sl,G.abort(),Q.result.close(),(oe=S.deleteDatabase(Y)).onsuccess=oe.onerror=en(function(){Z(new ve.NoSuchDatabase("Database ".concat(Y," doesnt exist")))})):(G.onerror=Rr(Z),oe=ie.oldVersion>Math.pow(2,62)?0:ie.oldVersion,V=oe<1,m.idbdb=Q.result,M&&Rs(m,G),Xa(m,oe/10,G,Z))},Z),Q.onsuccess=en(function(){G=null;var ie,oe,re,me,Te,ze,Ie=m.idbdb=Q.result,Me=U(Ie.objectStoreNames);if(0<Me.length)try{var Qe=Ie.transaction((Te=Me).length===1?Te[0]:Te,"readonly");if(v.autoSchema)ze=Ie,me=Qe,(re=m).verno=ze.version/10,me=re._dbSchema=Vl(0,ze,me),re._storeNames=U(ze.objectStoreNames,0),Os(re,[re._allTables],o(me),me);else if(zs(m,m._dbSchema,Qe),oe=Qe,((oe=Bs(Vl(0,(ie=m).idbdb,oe),ie._dbSchema)).add.length||oe.change.some(function(Ve){return Ve.add.length||Ve.change.length}))&&!M)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Ie.close(),E=Ie.version+1,M=!0,X(L());Oi(m,Qe)}catch{}rl.push(m),Ie.onversionchange=en(function(Ve){v.vcFired=!0,m.on("versionchange").fire(Ve)}),Ie.onclose=en(function(){m.close({disableAutoOpen:!1})}),V&&(Me=m._deps,Te=Y,Is(ze=Me.indexedDB)||Te===qa||fu(ze,Me.IDBKeyRange).put({name:Te}).catch(nt)),X()},Z)}).catch(function(X){switch(X?.name){case"UnknownError":if(0<v.PR1398_maxLoop)return v.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),L();break;case"VersionError":if(0<E)return E=0,L()}return Ue.reject(X)})}var K,ne=v.dbReadyResolve,G=null,V=!1;return Ue.race([C,(typeof navigator>"u"?Ue.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(X){function Z(){return indexedDB.databases().finally(X)}K=setInterval(Z,100),Z()}).finally(function(){return clearInterval(K)}):Promise.resolve()).then(L)]).then(function(){return O(),v.onReadyBeingFired=[],Ue.resolve(du(function(){return m.on.ready.fire(m.vip)})).then(function X(){var Z;if(0<v.onReadyBeingFired.length)return Z=v.onReadyBeingFired.reduce(be,nt),v.onReadyBeingFired=[],Ue.resolve(du(function(){return Z(m.vip)})).then(X)})}).finally(function(){v.openCanceller===C&&(v.onReadyBeingFired=null,v.isBeingOpened=!1)}).catch(function(X){v.dbOpenError=X;try{G&&G.abort()}catch{}return C===v.openCanceller&&m._close(),Qt(X)}).finally(function(){v.openComplete=!0,ne()}).then(function(){var X;return V&&(X={},m.tables.forEach(function(Z){Z.schema.indexes.forEach(function(Y){Y.name&&(X["idb://".concat(m.name,"/").concat(Z.name,"/").concat(Y.name)]=new Gn(-1/0,[[[]]]))}),X["idb://".concat(m.name,"/").concat(Z.name,"/")]=X["idb://".concat(m.name,"/").concat(Z.name,"/:dels")]=new Gn(-1/0,[[[]]])}),Kn(Hl).fire(X),vu(X,!0)),m})}function Wa(m){function v(M){return m.next(M)}var S=E(v),C=E(function(M){return m.throw(M)});function E(M){return function(L){var L=M(L),K=L.value;return L.done?K:K&&typeof K.then=="function"?K.then(S,C):c(K)?Promise.all(K).then(S,C):S(K)}}return E(v)()}function Ri(m,v,S){for(var C=c(m)?m.slice():[m],E=0;E<S;++E)C.push(v);return C}var Yd={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(m){return r(r({},m),{table:function(C){var S=m.table(C),C=S.schema,E={},M=[];function O(X,Z,Y){var re=_n(X),Q=E[re]=E[re]||[],ie=X==null?0:typeof X=="string"?1:X.length,oe=0<Z,re=r(r({},Y),{name:oe?"".concat(re,"(virtual-from:").concat(Y.name,")"):Y.name,lowLevelIndex:Y,isVirtual:oe,keyTail:Z,keyLength:ie,extractKey:Fl(X),unique:!oe&&Y.unique});return Q.push(re),re.isPrimaryKey||M.push(re),1<ie&&O(ie===2?X[0]:X.slice(0,ie-1),Z+1,Y),Q.sort(function(me,Te){return me.keyTail-Te.keyTail}),re}var L=O(C.primaryKey.keyPath,0,C.primaryKey);E[":id"]=[L];for(var K=0,ne=C.indexes;K<ne.length;K++){var G=ne[K];O(G.keyPath,0,G)}function V(X){var Z,Y=X.query.index;return Y.isVirtual?r(r({},X),{query:{index:Y.lowLevelIndex,range:(Z=X.query.range,Y=Y.keyTail,{type:Z.type===1?2:Z.type,lower:Ri(Z.lower,Z.lowerOpen?m.MAX_KEY:m.MIN_KEY,Y),lowerOpen:!0,upper:Ri(Z.upper,Z.upperOpen?m.MIN_KEY:m.MAX_KEY,Y),upperOpen:!0})}}):X}return r(r({},S),{schema:r(r({},C),{primaryKey:L,indexes:M,getIndexByKeyPath:function(X){return(X=E[_n(X)])&&X[0]}}),count:function(X){return S.count(V(X))},query:function(X){return S.query(V(X))},openCursor:function(X){var Z=X.query.index,Y=Z.keyTail,Q=Z.keyLength;return Z.isVirtual?S.openCursor(V(X)).then(function(oe){return oe&&ie(oe)}):S.openCursor(X);function ie(oe){return Object.create(oe,{continue:{value:function(re){re!=null?oe.continue(Ri(re,X.reverse?m.MAX_KEY:m.MIN_KEY,Y)):X.unique?oe.continue(oe.key.slice(0,Q).concat(X.reverse?m.MIN_KEY:m.MAX_KEY,Y)):oe.continue()}},continuePrimaryKey:{value:function(re,me){oe.continuePrimaryKey(Ri(re,m.MAX_KEY,Y),me)}},primaryKey:{get:function(){return oe.primaryKey}},key:{get:function(){var re=oe.key;return Q===1?re[0]:re.slice(0,Q)}},value:{get:function(){return oe.value}}})}}})}})}};function Us(m,v,S,C){return S=S||{},C=C||"",o(m).forEach(function(E){var M,O,L;g(v,E)?(M=m[E],O=v[E],typeof M=="object"&&typeof O=="object"&&M&&O?(L=J(M))!==J(O)?S[C+E]=v[E]:L==="Object"?Us(M,O,S,C+E+"."):M!==O&&(S[C+E]=v[E]):M!==O&&(S[C+E]=v[E])):S[C+E]=void 0}),o(v).forEach(function(E){g(m,E)||(S[C+E]=v[E])}),S}function Fs(m,v){return v.type==="delete"?v.keys:v.keys||v.values.map(m.extractKey)}var rh={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(m){return r(r({},m),{table:function(v){var S=m.table(v),C=S.schema.primaryKey;return r(r({},S),{mutate:function(E){var M=Le.trans,O=M.table(v).hook,L=O.deleting,K=O.creating,ne=O.updating;switch(E.type){case"add":if(K.fire===nt)break;return M._promise("readwrite",function(){return G(E)},!0);case"put":if(K.fire===nt&&ne.fire===nt)break;return M._promise("readwrite",function(){return G(E)},!0);case"delete":if(L.fire===nt)break;return M._promise("readwrite",function(){return G(E)},!0);case"deleteRange":if(L.fire===nt)break;return M._promise("readwrite",function(){return(function V(X,Z,Y){return S.query({trans:X,values:!1,query:{index:C,range:Z},limit:Y}).then(function(Q){var ie=Q.result;return G({type:"delete",keys:ie,trans:X}).then(function(oe){return 0<oe.numFailures?Promise.reject(oe.failures[0]):ie.length<Y?{failures:[],numFailures:0,lastResult:void 0}:V(X,r(r({},Z),{lower:ie[ie.length-1],lowerOpen:!0}),Y)})})})(E.trans,E.range,1e4)},!0)}return S.mutate(E);function G(V){var X,Z,Y,Q=Le.trans,ie=V.keys||Fs(C,V);if(ie)return(V=V.type==="add"||V.type==="put"?r(r({},V),{keys:ie}):r({},V)).type!=="delete"&&(V.values=l([],V.values)),V.keys&&(V.keys=l([],V.keys)),X=S,Y=ie,((Z=V).type==="add"?Promise.resolve([]):X.getMany({trans:Z.trans,keys:Y,cache:"immutable"})).then(function(oe){var re=ie.map(function(me,Te){var ze,Ie,Me,Qe=oe[Te],Ve={onerror:null,onsuccess:null};return V.type==="delete"?L.fire.call(Ve,me,Qe,Q):V.type==="add"||Qe===void 0?(ze=K.fire.call(Ve,me,V.values[Te],Q),me==null&&ze!=null&&(V.keys[Te]=me=ze,C.outbound||ee(V.values[Te],C.keyPath,me))):(ze=Us(Qe,V.values[Te]),(Ie=ne.fire.call(Ve,ze,me,Qe,Q))&&(Me=V.values[Te],Object.keys(Ie).forEach(function(_e){g(Me,_e)?Me[_e]=Ie[_e]:ee(Me,_e,Ie[_e])}))),Ve});return S.mutate(V).then(function(me){for(var Te=me.failures,ze=me.results,Ie=me.numFailures,me=me.lastResult,Me=0;Me<ie.length;++Me){var Qe=(ze||ie)[Me],Ve=re[Me];Qe==null?Ve.onerror&&Ve.onerror(Te[Me]):Ve.onsuccess&&Ve.onsuccess(V.type==="put"&&oe[Me]?V.values[Me]:Qe)}return{failures:Te,results:ze,numFailures:Ie,lastResult:me}}).catch(function(me){return re.forEach(function(Te){return Te.onerror&&Te.onerror(me)}),Promise.reject(me)})});throw new Error("Keys missing")}}})}})}};function bu(m,v,S){try{if(!v||v.keys.length<m.length)return null;for(var C=[],E=0,M=0;E<v.keys.length&&M<m.length;++E)bt(v.keys[E],m[M])===0&&(C.push(S?De(v.values[E]):v.values[E]),++M);return C.length===m.length?C:null}catch{return null}}var ih={stack:"dbcore",level:-1,create:function(m){return{table:function(v){var S=m.table(v);return r(r({},S),{getMany:function(C){var E;return C.cache?(E=bu(C.keys,C.trans._cache,C.cache==="clone"))?Ue.resolve(E):S.getMany(C).then(function(M){return C.trans._cache={keys:C.keys,values:C.cache==="clone"?De(M):M},M}):S.getMany(C)},mutate:function(C){return C.type!=="add"&&(C.trans._cache=null),S.mutate(C)}})}}}};function fl(m,v){return m.trans.mode==="readonly"&&!!m.subscr&&!m.trans.explicit&&m.trans.db._options.cache!=="disabled"&&!v.schema.primaryKey.outbound}function lh(m,v){switch(m){case"query":return v.values&&!v.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Qd={stack:"dbcore",level:0,name:"Observability",create:function(m){var v=m.schema.name,S=new Gn(m.MIN_KEY,m.MAX_KEY);return r(r({},m),{transaction:function(C,E,M){if(Le.subscr&&E!=="readonly")throw new ve.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Le.querier));return m.transaction(C,E,M)},table:function(C){function E(ie){var Q,ie=ie.query;return[Q=ie.index,new Gn((Q=(ie=ie.range).lower)!=null?Q:m.MIN_KEY,(Q=ie.upper)!=null?Q:m.MAX_KEY)]}var M=m.table(C),O=M.schema,L=O.primaryKey,K=O.indexes,ne=L.extractKey,G=L.outbound,V=L.autoIncrement&&K.filter(function(Y){return Y.compound&&Y.keyPath.includes(L.keyPath)}),X=r(r({},M),{mutate:function(Y){function Q(Xe){return Xe="idb://".concat(v,"/").concat(C,"/").concat(Xe),Te[Xe]||(Te[Xe]=new Gn)}var ie,oe,re,me=Y.trans,Te=Y.mutatedParts||(Y.mutatedParts={}),ze=Q(""),Ie=Q(":dels"),Me=Y.type,Ve=Y.type==="deleteRange"?[Y.range]:Y.type==="delete"?[Y.keys]:Y.values.length<50?[Fs(L,Y).filter(function(Xe){return Xe}),Y.values]:[],Qe=Ve[0],Ve=Ve[1],_e=Y.trans._cache;return c(Qe)?(ze.addKeys(Qe),(Me=Me==="delete"||Qe.length===Ve.length?bu(Qe,_e):null)||Ie.addKeys(Qe),(Me||Ve)&&(ie=Q,oe=Me,re=Ve,O.indexes.forEach(function(Xe){var ht=ie(Xe.name||"");function kt(dt){return dt!=null?Xe.extractKey(dt):null}function it(dt){Xe.multiEntry&&c(dt)?dt.forEach(function(Xt){return ht.addKey(Xt)}):ht.addKey(dt)}(oe||re).forEach(function(dt,qt){var ur=oe&&kt(oe[qt]),qt=re&&kt(re[qt]);bt(ur,qt)!==0&&(ur!=null&&it(ur),qt!=null)&&it(qt)})}))):Qe?(Ve={from:(_e=Qe.lower)!=null?_e:m.MIN_KEY,to:(Me=Qe.upper)!=null?Me:m.MAX_KEY},Ie.add(Ve),ze.add(Ve)):(ze.add(S),Ie.add(S),O.indexes.forEach(function(Xe){return Q(Xe.name).add(S)})),M.mutate(Y).then(function(Xe){return!Qe||Y.type!=="add"&&Y.type!=="put"||(ze.addKeys(Xe.results),V&&V.forEach(function(ht){for(var kt=Y.values.map(function(ur){return ht.extractKey(ur)}),it=ht.keyPath.findIndex(function(ur){return ur===L.keyPath}),dt=0,Xt=Xe.results.length;dt<Xt;++dt)kt[dt][it]=Xe.results[dt];Q(ht.name).addKeys(kt)})),me.mutatedParts=Hs(me.mutatedParts||{},Te),Xe})}}),Z={get:function(Y){return[L,new Gn(Y.key)]},getMany:function(Y){return[L,new Gn().addKeys(Y.keys)]},count:E,query:E,openCursor:E};return o(Z).forEach(function(Y){X[Y]=function(Q){var ie=Le.subscr,oe=!!ie,re=fl(Le,M)&&lh(Y,Q)?Q.obsSet={}:ie;if(oe){var me,ie=function(Ve){return Ve="idb://".concat(v,"/").concat(C,"/").concat(Ve),re[Ve]||(re[Ve]=new Gn)},Te=ie(""),ze=ie(":dels"),oe=Z[Y](Q),Ie=oe[0],oe=oe[1];if((Y==="query"&&Ie.isPrimaryKey&&!Q.values?ze:ie(Ie.name||"")).add(oe),!Ie.isPrimaryKey){if(Y!=="count")return me=Y==="query"&&G&&Q.values&&M.query(r(r({},Q),{values:!1})),M[Y].apply(this,arguments).then(function(Ve){if(Y==="query"){if(G&&Q.values)return me.then(function(kt){return kt=kt.result,Te.addKeys(kt),Ve});var _e=Q.values?Ve.result.map(ne):Ve.result;(Q.values?Te:ze).addKeys(_e)}else{var Xe,ht;if(Y==="openCursor")return ht=Q.values,(Xe=Ve)&&Object.create(Xe,{key:{get:function(){return ze.addKey(Xe.primaryKey),Xe.key}},primaryKey:{get:function(){var kt=Xe.primaryKey;return ze.addKey(kt),kt}},value:{get:function(){return ht&&Te.addKey(Xe.primaryKey),Xe.value}}})}return Ve});ze.add(S)}}return M[Y].apply(this,arguments)}}),X}})}};function ah(m,v,S){var C;return S.numFailures===0?v:v.type==="deleteRange"||(C=v.keys?v.keys.length:"values"in v&&v.values?v.values.length:1,S.numFailures===C)?null:(C=r({},v),c(C.keys)&&(C.keys=C.keys.filter(function(E,M){return!(M in S.failures)})),"values"in C&&c(C.values)&&(C.values=C.values.filter(function(E,M){return!(M in S.failures)})),C)}function Vs(m,v){return S=m,((C=v).lower===void 0||(C.lowerOpen?0<bt(S,C.lower):0<=bt(S,C.lower)))&&(S=m,(C=v).upper===void 0||(C.upperOpen?bt(S,C.upper)<0:bt(S,C.upper)<=0));var S,C}function ku(m,v,S,C,E,M){var O,L,K,ne,G,V;return!S||S.length===0||(O=v.query.index,L=O.multiEntry,K=v.query.range,ne=C.schema.primaryKey.extractKey,G=O.extractKey,V=(O.lowLevelIndex||O).extractKey,(C=S.reduce(function(X,Z){var Y=X,Q=[];if(Z.type==="add"||Z.type==="put")for(var ie=new Gn,oe=Z.values.length-1;0<=oe;--oe){var re,me=Z.values[oe],Te=ne(me);!ie.hasKey(Te)&&(re=G(me),L&&c(re)?re.some(function(Ve){return Vs(Ve,K)}):Vs(re,K))&&(ie.addKey(Te),Q.push(me))}switch(Z.type){case"add":var ze=new Gn().addKeys(v.values?X.map(function(_e){return ne(_e)}):X),Y=X.concat(v.values?Q.filter(function(_e){return _e=ne(_e),!ze.hasKey(_e)&&(ze.addKey(_e),!0)}):Q.map(function(_e){return ne(_e)}).filter(function(_e){return!ze.hasKey(_e)&&(ze.addKey(_e),!0)}));break;case"put":var Ie=new Gn().addKeys(Z.values.map(function(_e){return ne(_e)}));Y=X.filter(function(_e){return!Ie.hasKey(v.values?ne(_e):_e)}).concat(v.values?Q:Q.map(function(_e){return ne(_e)}));break;case"delete":var Me=new Gn().addKeys(Z.keys);Y=X.filter(function(_e){return!Me.hasKey(v.values?ne(_e):_e)});break;case"deleteRange":var Qe=Z.range;Y=X.filter(function(_e){return!Vs(ne(_e),Qe)})}return Y},m))===m)?m:(C.sort(function(X,Z){return bt(V(X),V(Z))||bt(ne(X),ne(Z))}),v.limit&&v.limit<1/0&&(C.length>v.limit?C.length=v.limit:m.length===v.limit&&C.length<v.limit&&(E.dirty=!0)),M?Object.freeze(C):C)}function Gl(m,v){return bt(m.lower,v.lower)===0&&bt(m.upper,v.upper)===0&&!!m.lowerOpen==!!v.lowerOpen&&!!m.upperOpen==!!v.upperOpen}function Za(m,v){return((S,C,E,M)=>{if(S===void 0)return C!==void 0?-1:0;if(C===void 0)return 1;if((S=bt(S,C))===0){if(E&&M)return 0;if(E)return 1;if(M)return-1}return S})(m.lower,v.lower,m.lowerOpen,v.lowerOpen)<=0&&0<=((S,C,E,M)=>{if(S===void 0)return C!==void 0?1:0;if(C===void 0)return-1;if((S=bt(S,C))===0){if(E&&M)return 0;if(E)return-1;if(M)return 1}return S})(m.upper,v.upper,m.upperOpen,v.upperOpen)}function Xd(m,v,S,C){m.subscribers.add(S),C.addEventListener("abort",function(){var E,M;m.subscribers.delete(S),m.subscribers.size===0&&(E=m,M=v,setTimeout(function(){E.subscribers.size===0&&Ae(M,E)},3e3))})}var Ks={stack:"dbcore",level:0,name:"Cache",create:function(m){var v=m.schema.name;return r(r({},m),{transaction:function(S,C,E){var M,O,L=m.transaction(S,C,E);return C==="readwrite"&&(E=(M=new AbortController).signal,L.addEventListener("abort",(O=function(K){return function(){if(M.abort(),C==="readwrite"){for(var ne=new Set,G=0,V=S;G<V.length;G++){var X=V[G],Z=hl["idb://".concat(v,"/").concat(X)];if(Z){var Y=m.table(X),Q=Z.optimisticOps.filter(function(Xe){return Xe.trans===L});if(L._explicit&&K&&L.mutatedParts)for(var ie=0,oe=Object.values(Z.queries.query);ie<oe.length;ie++)for(var re=0,me=(Ie=oe[ie]).slice();re<me.length;re++)gu((Me=me[re]).obsSet,L.mutatedParts)&&(Ae(Ie,Me),Me.subscribers.forEach(function(Xe){return ne.add(Xe)}));else if(0<Q.length){Z.optimisticOps=Z.optimisticOps.filter(function(Xe){return Xe.trans!==L});for(var Te=0,ze=Object.values(Z.queries.query);Te<ze.length;Te++)for(var Ie,Me,Qe,Ve=0,_e=(Ie=ze[Te]).slice();Ve<_e.length;Ve++)(Me=_e[Ve]).res!=null&&L.mutatedParts&&(K&&!Me.dirty?(Qe=Object.isFrozen(Me.res),Qe=ku(Me.res,Me.req,Q,Y,Me,Qe),Me.dirty?(Ae(Ie,Me),Me.subscribers.forEach(function(Xe){return ne.add(Xe)})):Qe!==Me.res&&(Me.res=Qe,Me.promise=Ue.resolve({result:Qe}))):(Me.dirty&&Ae(Ie,Me),Me.subscribers.forEach(function(Xe){return ne.add(Xe)})))}}}ne.forEach(function(Xe){return Xe()})}}})(!1),{signal:E}),L.addEventListener("error",O(!1),{signal:E}),L.addEventListener("complete",O(!0),{signal:E})),L},table:function(S){var C=m.table(S),E=C.schema.primaryKey;return r(r({},C),{mutate:function(M){var O,L=Le.trans;return!E.outbound&&L.db._options.cache!=="disabled"&&!L.explicit&&L.idbtrans.mode==="readwrite"&&(O=hl["idb://".concat(v,"/").concat(S)])?(L=C.mutate(M),M.type!=="add"&&M.type!=="put"||!(50<=M.values.length||Fs(E,M).some(function(K){return K==null}))?(O.optimisticOps.push(M),M.mutatedParts&&qs(M.mutatedParts),L.then(function(K){0<K.numFailures&&(Ae(O.optimisticOps,M),(K=ah(0,M,K))&&O.optimisticOps.push(K),M.mutatedParts)&&qs(M.mutatedParts)}),L.catch(function(){Ae(O.optimisticOps,M),M.mutatedParts&&qs(M.mutatedParts)})):L.then(function(K){var ne=ah(0,r(r({},M),{values:M.values.map(function(G,V){var X;return K.failures[V]?G:(ee(X=(X=E.keyPath)!=null&&X.includes(".")?De(G):r({},G),E.keyPath,K.results[V]),X)})}),K);O.optimisticOps.push(ne),queueMicrotask(function(){return M.mutatedParts&&qs(M.mutatedParts)})}),L):C.mutate(M)},query:function(M){var O,L,K,ne,G,V,X;return fl(Le,C)&&lh("query",M)?(O=((K=Le.trans)==null?void 0:K.db._options.cache)==="immutable",L=(K=Le).requery,K=K.signal,V=((Z,Y,Q,ie)=>{var oe=hl["idb://".concat(Z,"/").concat(Y)];if(!oe)return[];if(!(Z=oe.queries[Q]))return[null,!1,oe,null];var re=Z[(ie.query?ie.query.index.name:null)||""];if(!re)return[null,!1,oe,null];switch(Q){case"query":var me=re.find(function(Te){return Te.req.limit===ie.limit&&Te.req.values===ie.values&&Gl(Te.req.query.range,ie.query.range)});return me?[me,!0,oe,re]:[re.find(function(Te){return("limit"in Te.req?Te.req.limit:1/0)>=ie.limit&&(!ie.values||Te.req.values)&&Za(Te.req.query.range,ie.query.range)}),!1,oe,re];case"count":return me=re.find(function(Te){return Gl(Te.req.query.range,ie.query.range)}),[me,!!me,oe,re]}})(v,S,"query",M),X=V[0],ne=V[2],G=V[3],X&&V[1]?X.obsSet=M.obsSet:(V=C.query(M).then(function(Z){var Y=Z.result;if(X&&(X.res=Y),O){for(var Q=0,ie=Y.length;Q<ie;++Q)Object.freeze(Y[Q]);Object.freeze(Y)}else Z.result=De(Y);return Z}).catch(function(Z){return G&&X&&Ae(G,X),Promise.reject(Z)}),X={obsSet:M.obsSet,promise:V,subscribers:new Set,type:"query",req:M,dirty:!1},G?G.push(X):(G=[X],(ne=ne||(hl["idb://".concat(v,"/").concat(S)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[M.query.index.name||""]=G)),Xd(X,G,L,K),X.promise.then(function(Z){return{result:ku(Z.result,M,ne?.optimisticOps,C,X,O)}})):C.query(M)}})}})}};function Ja(m,v){return new Proxy(m,{get:function(S,C,E){return C==="db"?v:Reflect.get(S,C,E)}})}un.prototype.version=function(m){if(isNaN(m)||m<.1)throw new ve.Type("Given version is not a positive number");if(m=Math.round(10*m)/10,this.idbdb||this._state.isBeingOpened)throw new ve.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,m);var v=this._versions,S=v.filter(function(C){return C._cfg.version===m})[0];return S||(S=new this.Version(m),v.push(S),v.sort(cu),S.stores({}),this._state.autoSchema=!1),S},un.prototype._whenReady=function(m){var v=this;return this.idbdb&&(this._state.openComplete||Le.letThrough||this._vip)?m():new Ue(function(S,C){if(v._state.openComplete)return C(new ve.DatabaseClosed(v._state.dbOpenError));if(!v._state.isBeingOpened){if(!v._state.autoOpen)return void C(new ve.DatabaseClosed);v.open().catch(nt)}v._state.dbReadyPromise.then(S,C)}).then(m)},un.prototype.use=function(E){var v=E.stack,S=E.create,C=E.level,E=E.name,M=(E&&this.unuse({stack:v,name:E}),this._middlewares[v]||(this._middlewares[v]=[]));return M.push({stack:v,create:S,level:C??10,name:E}),M.sort(function(O,L){return O.level-L.level}),this},un.prototype.unuse=function(m){var v=m.stack,S=m.name,C=m.create;return v&&this._middlewares[v]&&(this._middlewares[v]=this._middlewares[v].filter(function(E){return C?E.create!==C:!!S&&E.name!==S})),this},un.prototype.open=function(){var m=this;return jr(gn,function(){return Gd(m)})},un.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var m=this._state,v=rl.indexOf(this);if(0<=v&&rl.splice(v,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}m.isBeingOpened||(m.dbReadyPromise=new Ue(function(S){m.dbReadyResolve=S}),m.openCanceller=new Ue(function(S,C){m.cancelOpen=C}))},un.prototype.close=function(v){var v=(v===void 0?{disableAutoOpen:!0}:v).disableAutoOpen,S=this._state;v?(S.isBeingOpened&&S.cancelOpen(new ve.DatabaseClosed),this._close(),S.autoOpen=!1,S.dbOpenError=new ve.DatabaseClosed):(this._close(),S.autoOpen=this._options.autoOpen||S.isBeingOpened,S.openComplete=!1,S.dbOpenError=null)},un.prototype.delete=function(m){var v=this,S=(m===void 0&&(m={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),C=this._state;return new Ue(function(E,M){function O(){v.close(m);var L=v._deps.indexedDB.deleteDatabase(v.name);L.onsuccess=en(function(){var K,ne,G;K=v._deps,ne=v.name,Is(G=K.indexedDB)||ne===qa||fu(G,K.IDBKeyRange).delete(ne).catch(nt),E()}),L.onerror=Rr(M),L.onblocked=v._fireOnBlocked}if(S)throw new ve.InvalidArgument("Invalid closeOptions argument to db.delete()");C.isBeingOpened?C.dbReadyPromise.then(O):O()})},un.prototype.backendDB=function(){return this.idbdb},un.prototype.isOpen=function(){return this.idbdb!==null},un.prototype.hasBeenClosed=function(){var m=this._state.dbOpenError;return m&&m.name==="DatabaseClosed"},un.prototype.hasFailed=function(){return this._state.dbOpenError!==null},un.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(un.prototype,"tables",{get:function(){var m=this;return o(this._allTables).map(function(v){return m._allTables[v]})},enumerable:!1,configurable:!0}),un.prototype.transaction=function(){var m=function(v,S,C){var E=arguments.length;if(E<2)throw new ve.InvalidArgument("Too few arguments");for(var M=new Array(E-1);--E;)M[E-1]=arguments[E];return C=M.pop(),[v,P(M),C]}.apply(this,arguments);return this._transaction.apply(this,m)},un.prototype._transaction=function(m,v,S){var C,E,M=this,O=Le.trans,L=(O&&O.db===this&&m.indexOf("!")===-1||(O=null),m.indexOf("?")!==-1);m=m.replace("!","").replace("?","");try{if(E=v.map(function(ne){if(ne=ne instanceof M.Table?ne.name:ne,typeof ne!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return ne}),m=="r"||m===mi)C=mi;else{if(m!="rw"&&m!=Di)throw new ve.InvalidArgument("Invalid transaction mode: "+m);C=Di}if(O){if(O.mode===mi&&C===Di){if(!L)throw new ve.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");O=null}O&&E.forEach(function(ne){if(O&&O.storeNames.indexOf(ne)===-1){if(!L)throw new ve.SubTransaction("Table "+ne+" not included in parent transaction.");O=null}}),L&&O&&!O.active&&(O=null)}}catch(ne){return O?O._promise(null,function(G,V){V(ne)}):Qt(ne)}var K=function ne(G,V,X,Z,Y){return Ue.resolve().then(function(){var re=Le.transless||Le,Q=G._createTransaction(V,X,G._dbSchema,Z),re=(Q.explicit=!0,{trans:Q,transless:re});if(Z)Q.idbtrans=Z.idbtrans;else try{Q.create(),Q.idbtrans._explicit=!0,G._state.PR1398_maxLoop=3}catch(me){return me.name===ft.InvalidState&&G.isOpen()&&0<--G._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),G.close({disableAutoOpen:!1}),G.open().then(function(){return ne(G,V,X,null,Y)})):Qt(me)}var ie,oe=Pe(Y),re=(oe&&kn(),Ue.follow(function(){var me;(ie=Y.call(Q,Q))&&(oe?(me=mr.bind(null,null),ie.then(me,me)):typeof ie.next=="function"&&typeof ie.throw=="function"&&(ie=Wa(ie)))},re));return(ie&&typeof ie.then=="function"?Ue.resolve(ie).then(function(me){return Q.active?me:Qt(new ve.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):re.then(function(){return ie})).then(function(me){return Z&&Q._resolve(),Q._completion.then(function(){return me})}).catch(function(me){return Q._reject(me),Qt(me)})})}.bind(null,this,C,E,O,S);return O?O._promise(C,K,"lock"):Le.trans?jr(Le.transless,function(){return M._whenReady(K)}):this._whenReady(K)},un.prototype.table=function(m){if(g(this._allTables,m))return this._allTables[m];throw new ve.InvalidTable("Table ".concat(m," does not exist"))};var $r=un;function un(m,v){var S,C,E,M,O,L=this,K=(this._middlewares={},this.verno=0,un.dependencies),K=(this._options=v=r({addons:un.addons,autoOpen:!0,indexedDB:K.indexedDB,IDBKeyRange:K.IDBKeyRange,cache:"cloned"},v),this._deps={indexedDB:v.indexedDB,IDBKeyRange:v.IDBKeyRange},v.addons),ne=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:nt,dbReadyPromise:null,cancelOpen:nt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:v.autoOpen}),G=(ne.dbReadyPromise=new Ue(function(V){ne.dbReadyResolve=V}),ne.openCanceller=new Ue(function(V,X){ne.cancelOpen=X}),this._state=ne,this.name=m,this.on=Va(this,"populate","blocked","versionchange","close",{ready:[be,nt]}),this.once=function(V,X){var Z=function(){for(var Y=[],Q=0;Q<arguments.length;Q++)Y[Q]=arguments[Q];L.on(V).unsubscribe(Z),X.apply(L,Y)};return L.on(V,Z)},this.on.ready.subscribe=I(this.on.ready.subscribe,function(V){return function(X,Z){un.vip(function(){var Y,Q=L._state;Q.openComplete?(Q.dbOpenError||Ue.resolve().then(X),Z&&V(X)):Q.onReadyBeingFired?(Q.onReadyBeingFired.push(X),Z&&V(X)):(V(X),Y=L,Z||V(function ie(){Y.on.ready.unsubscribe(X),Y.on.ready.unsubscribe(ie)}))})}}),this.Collection=(S=this,Vn(Fd.prototype,function(ie,Q){this.db=S;var Z=iu,Y=null;if(Q)try{Z=Q()}catch(re){Y=re}var Q=ie._ctx,ie=Q.table,oe=ie.hook.reading.fire;this._ctx={table:ie,index:Q.index,isPrimKey:!Q.index||ie.schema.primKey.keyPath&&Q.index===ie.schema.primKey.name,range:Z,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:Y,or:Q.or,valueMapper:oe!==Gt?oe:null}})),this.Table=(C=this,Vn(lu.prototype,function(V,X,Z){this.db=C,this._tx=Z,this.name=V,this.schema=X,this.hook=C._allTables[V]?C._allTables[V].hook:Va(null,{creating:[dn,nt],reading:[yn,Gt],updating:[He,nt],deleting:[Ye,nt]})})),this.Transaction=(E=this,Vn(uu.prototype,function(V,X,Z,Y,Q){var ie=this;V!=="readonly"&&X.forEach(function(oe){oe=(oe=Z[oe])==null?void 0:oe.yProps,oe&&(X=X.concat(oe.map(function(re){return re.updatesTable})))}),this.db=E,this.mode=V,this.storeNames=X,this.schema=Z,this.chromeTransactionDurability=Y,this.idbtrans=null,this.on=Va(this,"complete","error","abort"),this.parent=Q||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ue(function(oe,re){ie._resolve=oe,ie._reject=re}),this._completion.then(function(){ie.active=!1,ie.on.complete.fire()},function(oe){var re=ie.active;return ie.active=!1,ie.on.error.fire(oe),ie.parent?ie.parent._reject(oe):re&&ie.idbtrans&&ie.idbtrans.abort(),Qt(oe)})})),this.Version=(M=this,Vn(Kd.prototype,function(V){this.db=M,this._cfg={version:V,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(O=this,Vn(al.prototype,function(V,X,Z){if(this.db=O,this._ctx={table:V,index:X===":id"?null:X,or:Z},this._cmp=this._ascending=bt,this._descending=function(Y,Q){return bt(Q,Y)},this._max=function(Y,Q){return 0<bt(Y,Q)?Y:Q},this._min=function(Y,Q){return bt(Y,Q)<0?Y:Q},this._IDBKeyRange=O._deps.IDBKeyRange,!this._IDBKeyRange)throw new ve.MissingAPI})),this.on("versionchange",function(V){0<V.newVersion?console.warn("Another connection wants to upgrade database '".concat(L.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(L.name,"'. Closing db now to resume the delete request.")),L.close({disableAutoOpen:!1})}),this.on("blocked",function(V){!V.newVersion||V.newVersion<V.oldVersion?console.warn("Dexie.delete('".concat(L.name,"') was blocked")):console.warn("Upgrade '".concat(L.name,"' blocked by other connection holding version ").concat(V.oldVersion/10))}),this._maxKey=Ul(v.IDBKeyRange),this._createTransaction=function(V,X,Z,Y){return new L.Transaction(V,X,Z,L._options.chromeTransactionDurability,Y)},this._fireOnBlocked=function(V){L.on("blocked").fire(V),rl.filter(function(X){return X.name===L.name&&X!==L&&!X._state.vcFired}).map(function(X){return X.on("versionchange").fire(V)})},this.use(ih),this.use(Ks),this.use(Qd),this.use(Yd),this.use(rh),new Proxy(this,{get:function(V,X,Z){var Y;return X==="_vip"||(X==="table"?function(Q){return Ja(L.table(Q),G)}:(Y=Reflect.get(V,X,Z))instanceof lu?Ja(Y,G):X==="tables"?Y.map(function(Q){return Ja(Q,G)}):X==="_createTransaction"?function(){return Ja(Y.apply(this,arguments),G)}:Y)}}));this.vip=G,K.forEach(function(V){return V(L)})}var Yl,dl=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",sh=(Gs.prototype.subscribe=function(m,v,S){return this._subscribe(m&&typeof m!="function"?m:{next:m,error:v,complete:S})},Gs.prototype[dl]=function(){return this},Gs);function Gs(m){this._subscribe=m}try{Yl={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch{Yl={indexedDB:null,IDBKeyRange:null}}function oh(m){var v,S=!1,C=new sh(function(E){var M=Pe(m),O,L=!1,K={},ne={},G={get closed(){return L},unsubscribe:function(){L||(L=!0,O&&O.abort(),V&&Kn.storagemutated.unsubscribe(Z))}},V=(E.start&&E.start(G),!1),X=function(){return _i(Y)},Z=function(Q){Hs(K,Q),gu(ne,K)&&X()},Y=function(){var Q,ie,oe;!L&&Yl.indexedDB&&(K={},Q={},O&&O.abort(),O=new AbortController,oe=(re=>{var me=Ei();try{M&&kn();var Te=ln(m,re);return Te=M?Te.finally(mr):Te}finally{me&&Gr()}})(ie={subscr:Q,signal:O.signal,requery:X,querier:m,trans:null}),Promise.resolve(oe).then(function(re){S=!0,v=re,L||ie.signal.aborted||(K={},(me=>{for(var Te in me)if(g(me,Te))return;return 1})(ne=Q)||V||(Kn(Hl,Z),V=!0),_i(function(){return!L&&E.next&&E.next(re)}))},function(re){S=!1,["DatabaseClosedError","AbortError"].includes(re?.name)||L||_i(function(){L||E.error&&E.error(re)})}))};return setTimeout(X,0),G});return C.hasValue=function(){return S},C.getValue=function(){return v},C}var pl=$r;function wu(m){var v=Bi;try{Bi=!0,Kn.storagemutated.fire(m),vu(m,!0)}finally{Bi=v}}b(pl,r(r({},qe),{delete:function(m){return new pl(m,{addons:[]}).delete()},exists:function(m){return new pl(m,{addons:[]}).open().then(function(v){return v.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(m){try{return v=pl.dependencies,S=v.indexedDB,v=v.IDBKeyRange,(Is(S)?Promise.resolve(S.databases()).then(function(C){return C.map(function(E){return E.name}).filter(function(E){return E!==qa})}):fu(S,v).toCollection().primaryKeys()).then(m)}catch{return Qt(new ve.MissingAPI)}var v,S},defineClass:function(){return function(m){h(this,m)}},ignoreTransaction:function(m){return Le.trans?jr(Le.transless,m):m()},vip:du,async:function(m){return function(){try{var v=Wa(m.apply(this,arguments));return v&&typeof v.then=="function"?v:Ue.resolve(v)}catch(S){return Qt(S)}}},spawn:function(m,v,S){try{var C=Wa(m.apply(S,v||[]));return C&&typeof C.then=="function"?C:Ue.resolve(C)}catch(E){return Qt(E)}},currentTransaction:{get:function(){return Le.trans||null}},waitFor:function(m,v){return m=Ue.resolve(typeof m=="function"?pl.ignoreTransaction(m):m).timeout(v||6e4),Le.trans?Le.trans.waitFor(m):m},Promise:Ue,debug:{get:function(){return Ge},set:function(m){zt(m)}},derive:N,extend:h,props:b,override:I,Events:Va,on:Kn,liveQuery:oh,extendObservabilitySet:Hs,getByKeyPath:z,setByKeyPath:ee,delByKeyPath:function(m,v){typeof v=="string"?ee(m,v,void 0):"length"in v&&[].map.call(v,function(S){ee(m,S,void 0)})},shallowClone:ye,deepClone:De,getObjectDiff:Us,cmp:bt,asap:F,minKey:-1/0,addons:[],connections:rl,errnames:ft,dependencies:Yl,cache:hl,semVer:"4.3.0",version:"4.3.0".split(".").map(function(m){return parseInt(m)}).reduce(function(m,v,S){return m+v/Math.pow(10,2*S)})})),pl.maxKey=Ul(pl.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Kn(Hl,function(m){Bi||(m=new CustomEvent(ol,{detail:m}),Bi=!0,dispatchEvent(m),Bi=!1)}),addEventListener(ol,function(m){m=m.detail,Bi||wu(m)}));var Ql,Bi=!1,or=function(){};return typeof BroadcastChannel<"u"&&((or=function(){(Ql=new BroadcastChannel(ol)).onmessage=function(m){return m.data&&wu(m.data)}})(),typeof Ql.unref=="function"&&Ql.unref(),Kn(Hl,function(m){Bi||Ql.postMessage(m)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(m){if(!$r.disableBfCache&&m.persisted){Ge&&console.debug("Dexie: handling persisted pagehide"),Ql?.close();for(var v=0,S=rl;v<S.length;v++)S[v].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(m){!$r.disableBfCache&&m.persisted&&(Ge&&console.debug("Dexie: handling persisted pageshow"),or(),wu({all:new Gn(-1/0,[[]])}))})),Ue.rejectionMapper=function(m,v){return!m||m instanceof je||m instanceof TypeError||m instanceof SyntaxError||!m.name||!gt[m.name]?m:(v=new gt[m.name](v||m.message,m),"stack"in m&&T(v,"stack",{get:function(){return this.inner.stack}}),v)},zt(Ge),r($r,Object.freeze({__proto__:null,Dexie:$r,Entity:Xc,PropModification:Pl,RangeSet:Gn,add:function(m){return new Pl({add:m})},cmp:bt,default:$r,liveQuery:oh,mergeRanges:cl,rangesOverlap:eh,remove:function(m){return new Pl({remove:m})},replacePrefix:function(m,v){return new Pl({replacePrefix:[m,v]})}}),{default:$r}),$r})})(jf)),jf.exports}var ZA=WA();const Tg=vd(ZA),Lb=Symbol.for("Dexie"),Hf=globalThis[Lb]||(globalThis[Lb]=Tg);if(Tg.semVer!==Hf.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Tg.semVer} and ${Hf.semVer}`);const{liveQuery:hB,mergeRanges:fB,rangesOverlap:dB,RangeSet:pB,cmp:mB,Entity:gB,PropModification:yB,replacePrefix:xB,add:vB,remove:bB,DexieYProvider:kB}=Hf,Mo=[{id:"image",label:"Image",icon:"Image",description:"Character avatar image"},{id:"name",label:"Name",icon:"Type",description:"Character name"},{id:"description",label:"Description",icon:"FileText",description:"Character description"},{id:"first_mes",label:"First Message",icon:"MessageCircle",description:"First greeting message"},{id:"alternate_greetings",label:"Greetings",icon:"Greeting",description:"Alternate greetings"},{id:"mes_example",label:"Examples",icon:"MessagesSquare",description:"Message examples"},{id:"scenario",label:"Scenario",icon:"Map",description:"Roleplay scenario"},{id:"physical_description",label:"Appearance",icon:"Eye",description:"Physical description"},{id:"personality",label:"Personality",icon:"User",description:"Personality traits"},{id:"system_prompt",label:"System",icon:"Terminal",description:"System prompt"},{id:"post_history_instructions",label:"Post-History",icon:"History",description:"Post-history instructions"},{id:"lorebook",label:"Lorebook",icon:"Book",description:"Character lore entries"},{id:"creator",label:"Creator",icon:"UserCircle",description:"Character creator name"},{id:"creator_notes",label:"Creator Notes",icon:"NotebookPen",description:"Notes from the creator (supports CSS)"},{id:"tags",label:"Tags",icon:"Tags",description:"Character tags (comma-separated)"},{id:"character_version",label:"Version",icon:"Tag",description:"Character version identifier"},{id:"extensions",label:"Extensions",icon:"Puzzle",description:"Extension data"},{id:"avatar",label:"Avatar URL",icon:"Link",description:"Character avatar URL (CharHub, etc.)"}],Gk={ui:{theme:"system",editorFontSize:16,sidebarWidth:280},version:1},er=[];for(let n=0;n<256;++n)er.push((n+256).toString(16).slice(1));function JA(n,e=0){return(er[n[e+0]]+er[n[e+1]]+er[n[e+2]]+er[n[e+3]]+"-"+er[n[e+4]]+er[n[e+5]]+"-"+er[n[e+6]]+er[n[e+7]]+"-"+er[n[e+8]]+er[n[e+9]]+"-"+er[n[e+10]]+er[n[e+11]]+er[n[e+12]]+er[n[e+13]]+er[n[e+14]]+er[n[e+15]]).toLowerCase()}let Im;const e4=new Uint8Array(16);function t4(){if(!Im){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Im=crypto.getRandomValues.bind(crypto)}return Im(e4)}const n4=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),zb={randomUUID:n4};function r4(n,e,t){n=n||{};const r=n.random??n.rng?.()??t4();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,JA(r)}function Pm(n,e,t){return zb.randomUUID&&!n?zb.randomUUID():r4(n)}class i4 extends Hf{characters;settings;constructor(){super("character-vault-db"),this.version(1).stores({characters:"id, name, updatedAt, createdAt",settings:"id"})}async getAllCharacters(){return this.characters.orderBy("updatedAt").reverse().toArray()}async getCharacter(e){return this.characters.get(e)}async searchCharacters(e){const t=e.toLowerCase();return this.characters.filter(r=>r.name.toLowerCase().includes(t)).toArray()}async createCharacter(e){const t=new Date().toISOString(),l={id:Pm(),name:e.name,imageData:e.imageData||"",data:{spec:{name:e.name,description:e.data?.spec?.description||"",personality:e.data?.spec?.personality||"",scenario:e.data?.spec?.scenario||"",first_mes:e.data?.spec?.first_mes||"",mes_example:e.data?.spec?.mes_example||"",system_prompt:e.data?.spec?.system_prompt||"",post_history_instructions:e.data?.spec?.post_history_instructions||"",alternate_greetings:e.data?.spec?.alternate_greetings||[],physical_description:e.data?.spec?.physical_description||"",avatar:e.data?.spec?.avatar,creator_notes:e.data?.spec?.creator_notes,creator:e.data?.spec?.creator,character_version:e.data?.spec?.character_version,tags:e.data?.spec?.tags},characterBook:e.data?.characterBook,extensions:e.data?.extensions||{}},version:1,createdAt:t,updatedAt:t,lastOpenedAt:t};return await this.characters.add(l),l}async updateCharacter(e,t){const r=await this.characters.get(e);if(!r)throw new Error(`Character with ID "${e}" not found`);const l=new Date().toISOString(),s={...r,name:t.name??r.name,imageData:t.imageData??r.imageData,data:{spec:{...r.data.spec,...t.data?.spec},characterBook:t.data?.characterBook??r.data.characterBook,extensions:t.data?.extensions??r.data.extensions},updatedAt:l};return await this.characters.put(s),s}async updateSpecField(e,t,r){const l=await this.characters.get(e);if(!l)throw new Error(`Character with ID "${e}" not found`);const s=new Date().toISOString(),o={...l,data:{...l.data,spec:{...l.data.spec,[t]:r}},updatedAt:s};return await this.characters.put(o),o}async updateCharacterImage(e,t){return this.updateCharacter(e,{imageData:t})}async deleteCharacter(e){await this.characters.delete(e)}async duplicateCharacter(e,t){const r=await this.characters.get(e);if(!r)throw new Error(`Character with ID "${e}" not found`);const l=new Date().toISOString(),s=Pm(),o={...r,id:s,name:t,data:{...r.data,spec:{...r.data.spec,name:t}},createdAt:l,updatedAt:l,lastOpenedAt:l};return await this.characters.add(o),o}async updateLastOpened(e){const t=new Date().toISOString();await this.characters.update(e,{lastOpenedAt:t})}async getSettings(){const e=await this.settings.get("app-settings");if(!e){const t={...Gk,id:"app-settings"};return await this.settings.add(t),t}return e}async updateSettings(e){const t=await this.getSettings(),r={...t,...e,ui:{...t.ui,...e.ui}};return await this.settings.put(r),r}async importCharacter(e){const t=new Date().toISOString(),l={id:Pm(),name:e.name||"Imported Character",imageData:e.imageData||"",data:{spec:{name:e.data?.spec?.name||e.name||"Imported Character",description:e.data?.spec?.description||"",personality:e.data?.spec?.personality||"",scenario:e.data?.spec?.scenario||"",first_mes:e.data?.spec?.first_mes||"",mes_example:e.data?.spec?.mes_example||"",system_prompt:e.data?.spec?.system_prompt||"",post_history_instructions:e.data?.spec?.post_history_instructions||"",alternate_greetings:e.data?.spec?.alternate_greetings||[],physical_description:e.data?.spec?.physical_description||"",avatar:e.data?.spec?.avatar,creator_notes:e.data?.spec?.creator_notes,creator:e.data?.spec?.creator,character_version:e.data?.spec?.character_version,tags:e.data?.spec?.tags},characterBook:e.data?.characterBook,extensions:e.data?.extensions||{}},version:1,createdAt:t,updatedAt:t,lastOpenedAt:t};return await this.characters.add(l),l}}const Vt=new i4;function l4(){const[n,e]=$.useState([]),[t,r]=$.useState(null),[l,s]=$.useState(!0),[o,c]=$.useState(null),[h,d]=$.useState(null);$.useEffect(()=>{async function F(){try{s(!0);const[z,ee]=await Promise.all([Vt.getAllCharacters(),Vt.getSettings()]);if(e(z),d(ee),ee.lastActiveCharacterId){const ye=z.find(Ce=>Ce.id===ee.lastActiveCharacterId);ye&&r(ye)}}catch(z){c(z instanceof Error?z:new Error("Failed to load characters"))}finally{s(!1)}}F()},[]);const p=$.useCallback(async()=>{try{const F=await Vt.getAllCharacters();e(F)}catch(F){c(F instanceof Error?F:new Error("Failed to refresh characters"))}},[]),g=$.useCallback(async F=>{const z=await Vt.createCharacter(F);return e(ee=>[z,...ee]),r(z),h&&(await Vt.updateSettings({lastActiveCharacterId:z.id}),d({...h,lastActiveCharacterId:z.id})),z},[h]),b=$.useCallback(async F=>{try{const z=await Vt.getCharacter(F);z&&(await Vt.updateLastOpened(F),r(z),h&&(await Vt.updateSettings({lastActiveCharacterId:F}),d({...h,lastActiveCharacterId:F})),await p())}catch(z){c(z instanceof Error?z:new Error("Failed to open character"))}},[h,p]),w=$.useCallback(()=>{r(null),h&&(Vt.updateSettings({lastActiveCharacterId:void 0}),d({...h,lastActiveCharacterId:void 0}))},[h]),T=$.useCallback(async F=>{try{await Vt.deleteCharacter(F),e(z=>z.filter(ee=>ee.id!==F)),t?.id===F&&(r(null),h&&(await Vt.updateSettings({lastActiveCharacterId:void 0}),d({...h,lastActiveCharacterId:void 0})))}catch(z){throw c(z instanceof Error?z:new Error("Failed to delete character")),z}},[t,h]),N=$.useCallback(async(F,z)=>{try{const ee=await Vt.updateCharacter(F,z);return e(ye=>ye.map(Ce=>Ce.id===F?ee:Ce)),t?.id===F&&r(ee),ee}catch(ee){throw c(ee instanceof Error?ee:new Error("Failed to update character")),ee}},[t]),D=$.useCallback(async(F,z,ee)=>{try{const ye=await Vt.updateSpecField(F,z,ee);return e(Ce=>Ce.map(P=>P.id===F?ye:P)),t?.id===F&&r(ye),ye}catch(ye){throw c(ye instanceof Error?ye:new Error("Failed to update spec field")),ye}},[t]),j=$.useCallback(async(F,z)=>{try{const ee=await Vt.duplicateCharacter(F,z);return e(ye=>[ee,...ye]),ee}catch(ee){throw c(ee instanceof Error?ee:new Error("Failed to duplicate character")),ee}},[]),U=$.useCallback(async F=>{try{const z=await Vt.updateSettings(F);d(z)}catch(z){throw c(z instanceof Error?z:new Error("Failed to update settings")),z}},[]);return[{characters:n,currentCharacter:t,isLoading:l,error:o,settings:h},{createCharacter:g,openCharacter:b,closeCharacter:w,deleteCharacter:T,updateCharacter:N,duplicateCharacter:j,refreshCharacters:p,updateSpecField:D,updateSettings:U}]}const Yk=$.createContext(null);function a4({children:n}){const[e,t]=l4(),r={currentCharacter:e.currentCharacter,isCharacterOpen:e.currentCharacter!==null,createCharacter:t.createCharacter,openCharacter:t.openCharacter,closeCharacter:t.closeCharacter,deleteCharacter:t.deleteCharacter,updateCharacter:t.updateCharacter,duplicateCharacter:t.duplicateCharacter,updateSpecField:t.updateSpecField,characters:e.characters,refreshCharacters:t.refreshCharacters,settings:e.settings,updateSettings:t.updateSettings,isLoading:e.isLoading,error:e.error};return k.jsx(Yk.Provider,{value:r,children:n})}function Qo(){const n=$.useContext(Yk);if(!n)throw new Error("useCharacterContext must be used within a CharacterProvider");return n}const tr={ai:{baseUrl:"https://nano-gpt.com/api/v1",apiKey:"",modelId:"",availableModels:[],enableStreaming:!1,enableReasoning:!1,showReasoning:!1},sampler:{temperature:.7,minP:.05,topK:40,repetitionPenalty:1.1,topP:1,contextLength:4096,maxTokens:2048},samplerPresets:[{id:"preset-creative",name:"Creative",settings:{temperature:.9,minP:.05,topK:50,repetitionPenalty:1.05,topP:.95,contextLength:4096,maxTokens:2048}},{id:"preset-balanced",name:"Balanced",settings:{temperature:.7,minP:.05,topK:40,repetitionPenalty:1.1,topP:1,contextLength:4096,maxTokens:2048}},{id:"preset-factual",name:"Factual",settings:{temperature:.3,minP:.1,topK:20,repetitionPenalty:1.2,topP:.5,contextLength:4096,maxTokens:1024}}],prompts:{expand:`Please expand and elaborate on the following text, adding more detail and depth while maintaining the same style and tone:

"""
\${text}
"""

Provide only the expanded text without any additional commentary.`,rewrite:`Please rewrite the following text to improve clarity, flow, and impact while preserving the original meaning:

"""
\${text}
"""

Provide only the rewritten text without any additional commentary.`,instruct:`Please apply the following instruction to the text below:

Instruction: \${instruction}

Text:
"""
\${text}
"""

Provide only the modified text without any additional commentary.`,shorten:`Please shorten and condense the following text, making it more concise while preserving the key meaning and essential details:

"""
\${text}
"""

Provide only the shortened text without any additional commentary.`,lengthen:`Please lengthen the following text by adding more detail, depth, and elaboration while maintaining the same style and tone:

"""
\${text}
"""

Provide only the lengthened text without any additional commentary.`,vivid:`Please rewrite the following text to make it more vivid and descriptive, adding sensory details, imagery, and evocative language:

"""
\${text}
"""

Provide only the enhanced text without any additional commentary.`,emotion:`Please rewrite the following text to add more emotional depth, feeling, and character voice while preserving the original meaning:

"""
\${text}
"""

Provide only the enhanced text without any additional commentary.`,grammar:`Please fix any grammar, spelling, and punctuation errors in the following text while preserving the original meaning and style:

"""
\${text}
"""

Provide only the corrected text without any additional commentary.`}},Qk=$.createContext(null);class s4{async getSettings(){const e=await Vt.getSettings();if(!e){const t={id:"app-settings",ui:{theme:"system",editorFontSize:16,sidebarWidth:280},version:1};return await Vt.settings.add(t),t}return e}async saveSettings(e){await Vt.settings.put(e)}async getAISettings(){const e=await this.getSettings();return{...tr.ai,...e.ai}}async saveAISettings(e){const r={...await this.getSettings(),ai:{...tr.ai,...e}};await Vt.settings.put(r)}async getSamplerSettings(){const e=await this.getSettings();return{...tr.sampler,...e.sampler}}async saveSamplerSettings(e){const r={...await this.getSettings(),sampler:{...tr.sampler,...e}};await Vt.settings.put(r)}async getContextSectionIds(){return(await this.getSettings()).contextSectionIds||[]}async saveContextSectionIds(e){const r={...await this.getSettings(),contextSectionIds:e};await Vt.settings.put(r)}async addContextSection(e){const t=await this.getSettings(),r=t.contextSectionIds||[];if(!r.includes(e)){const l={...t,contextSectionIds:[...r,e]};await Vt.settings.put(l)}}async removeContextSection(e){const t=await this.getSettings(),r=t.contextSectionIds||[],l={...t,contextSectionIds:r.filter(s=>s!==e)};await Vt.settings.put(l)}async getPromptSettings(){const e=await this.getSettings();return{...tr.prompts,...e.prompts}}async savePromptSettings(e){const r={...await this.getSettings(),prompts:{...tr.prompts,...e}};await Vt.settings.put(r)}async saveAllAISettings(e,t,r){const s={...await this.getSettings(),ai:{...tr.ai,...e},sampler:{...tr.sampler,...t},prompts:{...tr.prompts,...r}};await Vt.settings.put(s)}async applySamplerPreset(e){const r=tr.samplerPresets.find(l=>l.id===e);if(!r)throw new Error(`Preset with ID "${e}" not found`);await this.saveSamplerSettings(r.settings)}async resetToDefaults(){const e={...Gk,id:"app-settings",ai:tr.ai,sampler:tr.sampler,prompts:tr.prompts,contextSectionIds:[]};return await Vt.settings.put(e),e}}const cr=new s4;function o4({children:n}){const{currentCharacter:e,updateCharacter:t,updateSpecField:r}=Qo(),[l,s]=$.useState("name"),[o,c]=$.useState(!1),[h,d]=$.useState("saved"),[p,g]=$.useState(16),[b,w]=$.useState(""),[T,N]=$.useState([]),[D,j]=$.useState([]),[U,I]=$.useState(tr.ai),[ce,F]=$.useState(tr.sampler),[z,ee]=$.useState(tr.prompts),ye=Zi.useMemo(()=>{const R=["image","extensions"].includes(l)||D.includes(l)?[]:[l];return[...new Set([...R,...T])].filter(je=>!D.includes(je))},[l,T,D]),Ce=$.useCallback(async()=>{try{const[R,je,Ee,Ke]=await Promise.all([cr.getAISettings(),cr.getSamplerSettings(),cr.getPromptSettings(),cr.getSettings()]);I(R),F(je),ee(Ee),g(Ke.ui.editorFontSize)}catch(R){console.error("Failed to load settings:",R)}},[]);$.useEffect(()=>{const R=setTimeout(()=>{Ce()},0);return()=>clearTimeout(R)},[Ce]),$.useEffect(()=>{document.documentElement.style.setProperty("--editor-font-size",`${p}px`)},[p]);const P=$.useRef(l);$.useEffect(()=>{if(P.current!==l){P.current=l;const R=setTimeout(()=>{j([])},0);return()=>clearTimeout(R)}},[l]);const pe=$.useCallback(async R=>{if(!e)throw new Error("No character is currently open");const je=await t(e.id,R);return c(!1),d("saved"),je},[e,t]),fe=$.useCallback(async(R,je)=>{if(!e)throw new Error("No character is currently open");c(!0),d("saving");try{const Ee=await r(e.id,R,je);return c(!1),d("saved"),Ee}catch(Ee){throw console.error("Failed to save spec field:",Ee),d("error"),Ee}},[e,r]),De=$.useCallback(async R=>{g(R),document.documentElement.style.setProperty("--editor-font-size",`${R}px`);try{const je=await cr.getSettings();await cr.saveSettings({...je,ui:{...je.ui,editorFontSize:R}})}catch(je){console.error("Failed to save font size:",je)}},[]),ke=$.useCallback(R=>{N(je=>{const Ke=(typeof R=="function"?R(je):R).filter($e=>$e!==l);return cr.saveContextSectionIds(Ke),Ke})},[l]),J=$.useCallback(R=>{j(je=>je.filter(Ee=>Ee!==R)),N(je=>{if(je.includes(R))return je;const Ee=[...je,R];return cr.addContextSection(R),Ee})},[]),q=$.useCallback(R=>{j(je=>[...new Set([...je,R])]),N(je=>{const Ee=je.filter(Ke=>Ke!==R);return cr.removeContextSection(R),Ee})},[]),le=$.useCallback(R=>{I(je=>{const Ee={...je,...R};return cr.saveAISettings(Ee),Ee})},[]),Ae=$.useCallback(R=>{F(je=>{const Ee={...je,...R};return cr.saveSamplerSettings(Ee),Ee})},[]),Se=$.useCallback(R=>{ee(je=>{const Ee={...je,...R};return cr.savePromptSettings(Ee),Ee})},[]),B=$.useCallback(R=>e?R.map(je=>{const Ee=e.data.spec;switch(je){case"name":return`Character Name: ${Ee.name}`;case"description":return`Description:
${Ee.description}`;case"personality":return`Personality:
${Ee.personality}`;case"scenario":return`Scenario:
${Ee.scenario}`;case"first_mes":return`First Message:
${Ee.first_mes}`;case"mes_example":return`Message Examples:
${Ee.mes_example}`;case"system_prompt":return`System Prompt:
${Ee.system_prompt}`;case"post_history_instructions":return`Post-History Instructions:
${Ee.post_history_instructions}`;case"alternate_greetings":return`Alternate Greetings:
${Ee.alternate_greetings.join(`
---
`)}`;case"physical_description":return`Physical Description:
${Ee.physical_description}`;case"avatar":return Ee.avatar?`Avatar URL: ${Ee.avatar}`:"";case"creator_notes":return Ee.creator_notes?`Creator Notes:
${Ee.creator_notes}`:"";case"creator":return Ee.creator?`Creator: ${Ee.creator}`:"";case"character_version":return Ee.character_version?`Version: ${Ee.character_version}`:"";case"tags":return Ee.tags?.length?`Tags: ${Ee.tags.join(", ")}`:"";case"lorebook":{const Ke=e.data.characterBook;if(!Ke||Ke.entries.length===0)return"";const $e=Ke.entries.filter(et=>et.enabled);if($e.length===0)return"";let ft=`Lorebook: ${Ke.name||"Character Lore"}
`;return Ke.description&&(ft+=`${Ke.description}
`),ft+=`
`,$e.forEach(et=>{ft+=`[Entry ${et.id}]`,et.name&&(ft+=` ${et.name}`),ft+=`
`,ft+=`Keys: ${et.keys.join(", ")}
`,et.comment&&(ft+=`Note: ${et.comment}
`),ft+=`${et.content}

`}),ft.trim()}default:return""}}).filter(je=>je.length>0):[],[e]),Pe=$.useCallback((R,je,Ee)=>{if(!e||!l)return;const Ke=e.data.spec;let $e;switch(l){case"name":$e=Ke.name;break;case"description":$e=Ke.description;break;case"personality":$e=Ke.personality;break;case"scenario":$e=Ke.scenario;break;case"first_mes":$e=Ke.first_mes;break;case"mes_example":$e=Ke.mes_example;break;case"system_prompt":$e=Ke.system_prompt;break;case"post_history_instructions":$e=Ke.post_history_instructions;break;case"alternate_greetings":$e=Ke.alternate_greetings.join(`
---
`);break;case"physical_description":$e=Ke.physical_description;break;case"avatar":$e=Ke.avatar||"";break;case"creator_notes":$e=Ke.creator_notes||"";break;case"creator":$e=Ke.creator||"";break;case"character_version":$e=Ke.character_version||"";break;case"tags":$e=Ke.tags?.join(", ")||"";break;default:return}const ft=Ee??b;let et;switch(je){case"expand":case"rewrite":case"instruct":if(ft){const ve=$e.indexOf(ft);if(ve!==-1)et=$e.substring(0,ve)+R+$e.substring(ve+ft.length);else{const gt=ft.trim(),nt=$e.indexOf(gt);nt!==-1?et=$e.substring(0,nt)+R+$e.substring(nt+gt.length):(console.warn("AI operation: Selected text not found in content, appending instead"),et=$e+`

`+R)}}else et=$e+`

`+R;break;case"ask":et=$e+`

`+R;break;default:et=$e}l==="alternate_greetings"?fe(l,et.split(`
---
`).filter(ve=>ve.trim())):l==="tags"?fe(l,et.split(",").map(ve=>ve.trim()).filter(ve=>ve)):fe(l,et),w("")},[e,l,b,fe]),qe={currentCharacter:e,activeSection:l,isDirty:o,saveStatus:h,fontSize:p,selectedText:b,contextSectionIds:ye,userAddedContextIds:T,aiConfig:U,samplerSettings:ce,promptSettings:z,setActiveSection:s,updateCharacter:pe,updateSpecField:fe,setFontSize:De,setSelectedText:w,setContextSectionIds:ke,addContextSection:J,removeContextSection:q,updateAIConfig:le,updateSamplerSettings:Ae,updatePromptSettings:Se,handleAIOperation:Pe,getContextContent:B,reloadSettings:Ce};return k.jsx(Qk.Provider,{value:qe,children:n})}function bd(){const n=$.useContext(Qk);if(!n)throw new Error("useCharacterEditorContext must be used within a CharacterEditorProvider");return n}var u4=Kk();const Xk=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim();const c4=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const h4=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());const Ib=n=>{const e=h4(n);return e.charAt(0).toUpperCase()+e.slice(1)};var f4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const d4=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const p4=$.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:l="",children:s,iconNode:o,...c},h)=>$.createElement("svg",{ref:h,...f4,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:Xk("lucide",l),...!s&&!d4(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,p])=>$.createElement(d,p)),...Array.isArray(s)?s:[s]]));const We=(n,e)=>{const t=$.forwardRef(({className:r,...l},s)=>$.createElement(p4,{ref:s,iconNode:e,className:Xk(`lucide-${c4(Ib(n))}`,`lucide-${n}`,r),...l}));return t.displayName=Ib(n),t};const m4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],g4=We("arrow-left",m4);const y4=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],qf=We("book-open",y4);const x4=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],D0=We("book",x4);const v4=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],$k=We("brain",v4);const b4=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Wk=We("check",b4);const k4=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ea=We("chevron-down",k4);const w4=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],S4=We("chevron-left",w4);const C4=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],A4=We("chevron-right",C4);const T4=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],zo=We("chevron-up",T4);const E4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Aa=We("circle-alert",E4);const N4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],M4=We("circle-question-mark",N4);const _4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],D4=We("circle-user",_4);const j4=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],O4=We("clock",j4);const R4=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],j0=We("copy",R4);const B4=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Zk=We("download",B4);const L4=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],z4=We("eye",L4);const I4=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ao=We("file-text",I4);const P4=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],H4=We("funnel",P4);const q4=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],U4=We("hash",q4);const F4=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],V4=We("history",F4);const K4=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],O0=We("image",K4);const G4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Y4=We("info",G4);const Q4=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],X4=We("key",Q4);const $4=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],W4=We("layers",$4);const Z4=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],J4=We("link",Z4);const eT=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Uf=We("loader-circle",eT);const tT=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],nT=We("map",tT);const rT=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Eg=We("message-circle",rT);const iT=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],_o=We("message-square",iT);const lT=[["path",{d:"M16 10a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 14.286V4a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z",key:"1n2ejm"}],["path",{d:"M20 9a2 2 0 0 1 2 2v10.286a.71.71 0 0 1-1.212.502l-2.202-2.202A2 2 0 0 0 17.172 19H10a2 2 0 0 1-2-2v-1",key:"1qfcsi"}]],aT=We("messages-square",lT);const sT=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],oT=We("moon",sT);const uT=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],cT=We("notebook-pen",uT);const hT=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],fT=We("palette",hT);const dT=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],pT=We("panel-left",dT);const mT=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}]],gT=We("panel-right",mT);const yT=[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]],Pb=We("pen-tool",yT);const xT=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],vT=We("percent",xT);const bT=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],kT=We("play",bT);const wT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Xo=We("plus",wT);const ST=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],CT=We("puzzle",ST);const AT=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Jk=We("refresh-cw",AT);const TT=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],ET=We("repeat",TT);const NT=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Ng=We("rocket",NT);const MT=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],_T=We("rotate-ccw",MT);const DT=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ew=We("save",DT);const jT=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],OT=We("scroll-text",jT);const RT=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ff=We("search",RT);const BT=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],LT=We("server",BT);const zT=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],IT=We("settings-2",zT);const PT=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],HT=We("settings",PT);const qT=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],tw=We("sliders-vertical",qT);const UT=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],jl=We("sparkles",UT);const FT=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],VT=We("square",FT);const KT=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],GT=We("sun",KT);const YT=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],QT=We("tag",YT);const XT=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],$T=We("tags",XT);const WT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],nw=We("target",WT);const ZT=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],JT=We("terminal",ZT);const eE=[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]],tE=We("thermometer",eE);const nE=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],$o=We("trash-2",nE);const rE=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],rw=We("type",rE);const iE=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Nc=We("upload",iE);const lE=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],R0=We("user",lE);const aE=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Vf=We("users",aE);const sE=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],iw=We("wand-sparkles",sE);const oE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],vs=We("x",oE);const uE=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],cE=We("zap",uE);let Mg=[],lw=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?lw:Mg).push(t=t+n[e])})();function hE(n){if(n<768)return!1;for(let e=0,t=Mg.length;;){let r=e+t>>1;if(n<Mg[r])t=r;else if(n>=lw[r])e=r+1;else return!0;if(e==t)return!1}}function Hb(n){return n>=127462&&n<=127487}const qb=8205;function fE(n,e,t=!0,r=!0){return(t?aw:dE)(n,e,r)}function aw(n,e,t){if(e==n.length)return e;e&&sw(n.charCodeAt(e))&&ow(n.charCodeAt(e-1))&&e--;let r=Hm(n,e);for(e+=Ub(r);e<n.length;){let l=Hm(n,e);if(r==qb||l==qb||t&&hE(l))e+=Ub(l),r=l;else if(Hb(l)){let s=0,o=e-2;for(;o>=0&&Hb(Hm(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function dE(n,e,t){for(;e>0;){let r=aw(n,e-2,t);if(r<e)return r;e--}return 0}function Hm(n,e){let t=n.charCodeAt(e);if(!ow(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return sw(r)?(t-55296<<10)+(r-56320)+65536:t}function sw(n){return n>=56320&&n<57344}function ow(n){return n>=55296&&n<56320}function Ub(n){return n<65536?1:2}class Lt{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){[e,t]=Io(this,e,t);let l=[];return this.decompose(0,e,l,2),r.length&&r.decompose(0,r.length,l,3),this.decompose(t,this.length,l,1),Gi.from(l,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Io(this,e,t);let r=[];return this.decompose(e,t,r,0),Gi.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),l=new gc(this),s=new gc(e);for(let o=t,c=t;;){if(l.next(o),s.next(o),o=0,l.lineBreak!=s.lineBreak||l.done!=s.done||l.value!=s.value)return!1;if(c+=l.value.length,l.done||c>=r)return!0}}iter(e=1){return new gc(this,e)}iterRange(e,t=this.length){return new uw(this,e,t)}iterLines(e,t){let r;if(e==null)r=this.iter();else{t==null&&(t=this.lines+1);let l=this.line(e).from;r=this.iterRange(l,Math.max(l,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new cw(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Lt.empty:e.length<=32?new Tn(e):Gi.from(Tn.split(e,[]))}}class Tn extends Lt{constructor(e,t=pE(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,r,l){for(let s=0;;s++){let o=this.text[s],c=l+o.length;if((t?r:c)>=e)return new mE(l,c,r,o);l=c+1,r++}}decompose(e,t,r,l){let s=e<=0&&t>=this.length?this:new Tn(Fb(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(l&1){let o=r.pop(),c=Of(s.text,o.text.slice(),0,s.length);if(c.length<=32)r.push(new Tn(c,o.length+s.length));else{let h=c.length>>1;r.push(new Tn(c.slice(0,h)),new Tn(c.slice(h)))}}else r.push(s)}replace(e,t,r){if(!(r instanceof Tn))return super.replace(e,t,r);[e,t]=Io(this,e,t);let l=Of(this.text,Of(r.text,Fb(this.text,0,e)),t),s=this.length+r.length-(t-e);return l.length<=32?new Tn(l,s):Gi.from(Tn.split(l,[]),s)}sliceString(e,t=this.length,r=`
`){[e,t]=Io(this,e,t);let l="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let c=this.text[o],h=s+c.length;s>e&&o&&(l+=r),e<h&&t>s&&(l+=c.slice(Math.max(0,e-s),t-s)),s=h+1}return l}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],l=-1;for(let s of e)r.push(s),l+=s.length+1,r.length==32&&(t.push(new Tn(r,l)),r=[],l=-1);return l>-1&&t.push(new Tn(r,l)),t}}class Gi extends Lt{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let r of e)this.lines+=r.lines}lineInner(e,t,r,l){for(let s=0;;s++){let o=this.children[s],c=l+o.length,h=r+o.lines-1;if((t?h:c)>=e)return o.lineInner(e,t,r,l);l=c+1,r=h+1}}decompose(e,t,r,l){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let c=this.children[s],h=o+c.length;if(e<=h&&t>=o){let d=l&((o<=e?1:0)|(h>=t?2:0));o>=e&&h<=t&&!d?r.push(c):c.decompose(e-o,t-o,r,d)}o=h+1}}replace(e,t,r){if([e,t]=Io(this,e,t),r.lines<this.lines)for(let l=0,s=0;l<this.children.length;l++){let o=this.children[l],c=s+o.length;if(e>=s&&t<=c){let h=o.replace(e-s,t-s,r),d=this.lines-o.lines+h.lines;if(h.lines<d>>4&&h.lines>d>>6){let p=this.children.slice();return p[l]=h,new Gi(p,this.length-(t-e)+r.length)}return super.replace(s,c,h)}s=c+1}return super.replace(e,t,r)}sliceString(e,t=this.length,r=`
`){[e,t]=Io(this,e,t);let l="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let c=this.children[s],h=o+c.length;o>e&&s&&(l+=r),e<h&&t>o&&(l+=c.sliceString(e-o,t-o,r)),o=h+1}return l}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Gi))return 0;let r=0,[l,s,o,c]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;l+=t,s+=t){if(l==o||s==c)return r;let h=this.children[l],d=e.children[s];if(h!=d)return r+h.scanIdentical(d,t);r+=h.length+1}}static from(e,t=e.reduce((r,l)=>r+l.length+1,-1)){let r=0;for(let w of e)r+=w.lines;if(r<32){let w=[];for(let T of e)T.flatten(w);return new Tn(w,t)}let l=Math.max(32,r>>5),s=l<<1,o=l>>1,c=[],h=0,d=-1,p=[];function g(w){let T;if(w.lines>s&&w instanceof Gi)for(let N of w.children)g(N);else w.lines>o&&(h>o||!h)?(b(),c.push(w)):w instanceof Tn&&h&&(T=p[p.length-1])instanceof Tn&&w.lines+T.lines<=32?(h+=w.lines,d+=w.length+1,p[p.length-1]=new Tn(T.text.concat(w.text),T.length+1+w.length)):(h+w.lines>l&&b(),h+=w.lines,d+=w.length+1,p.push(w))}function b(){h!=0&&(c.push(p.length==1?p[0]:Gi.from(p,d)),d=-1,h=p.length=0)}for(let w of e)g(w);return b(),c.length==1?c[0]:new Gi(c,t)}}Lt.empty=new Tn([""],0);function pE(n){let e=-1;for(let t of n)e+=t.length+1;return e}function Of(n,e,t=0,r=1e9){for(let l=0,s=0,o=!0;s<n.length&&l<=r;s++){let c=n[s],h=l+c.length;h>=t&&(h>r&&(c=c.slice(0,r-l)),l<t&&(c=c.slice(t-l)),o?(e[e.length-1]+=c,o=!1):e.push(c)),l=h+1}return e}function Fb(n,e,t){return Of(n,[""],e,t)}class gc{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Tn?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,l=this.nodes[r],s=this.offsets[r],o=s>>1,c=l instanceof Tn?l.text.length:l.children.length;if(o==(t>0?c:0)){if(r==0)return this.done=!0,this.value="",this;t>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[r]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(l instanceof Tn){let h=l.text[o+(t<0?-1:0)];if(this.offsets[r]+=t,h.length>Math.max(0,e))return this.value=e==0?h:t>0?h.slice(e):h.slice(0,h.length-e),this;e-=h.length}else{let h=l.children[o+(t<0?-1:0)];e>h.length?(e-=h.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(h),this.offsets.push(t>0?1:(h instanceof Tn?h.text.length:h.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class uw{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new gc(e,t>r?-1:1),this.pos=t>r?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let r=t<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:l}=this.cursor.next(e);return this.pos+=(l.length+e)*t,this.value=l.length<=r?l:t<0?l.slice(l.length-r):l.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class cw{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:r,value:l}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=l,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Lt.prototype[Symbol.iterator]=function(){return this.iter()},gc.prototype[Symbol.iterator]=uw.prototype[Symbol.iterator]=cw.prototype[Symbol.iterator]=function(){return this});class mE{constructor(e,t,r,l){this.from=e,this.to=t,this.number=r,this.text=l}get length(){return this.to-this.from}}function Io(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function qn(n,e,t=!0,r=!0){return fE(n,e,t,r)}function gE(n){return n>=56320&&n<57344}function yE(n){return n>=55296&&n<56320}function hw(n,e){let t=n.charCodeAt(e);if(!yE(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return gE(r)?(t-55296<<10)+(r-56320)+65536:t}function xE(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function fw(n){return n<65536?1:2}const _g=/\r\n?|\n/;var Vr=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(Vr||(Vr={}));class Wi{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,r=0,l=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(r,l,s),l+=s):l+=o,r+=s}}iterChangedRanges(e,t=!1){Dg(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let r=this.sections[t++],l=this.sections[t++];l<0?e.push(r,l):e.push(l,r)}return new Wi(e)}composeDesc(e){return this.empty?e:e.empty?this:dw(this,e)}mapDesc(e,t=!1){return e.empty?this:jg(this,e,t)}mapPos(e,t=-1,r=Vr.Simple){let l=0,s=0;for(let o=0;o<this.sections.length;){let c=this.sections[o++],h=this.sections[o++],d=l+c;if(h<0){if(d>e)return s+(e-l);s+=c}else{if(r!=Vr.Simple&&d>=e&&(r==Vr.TrackDel&&l<e&&d>e||r==Vr.TrackBefore&&l<e||r==Vr.TrackAfter&&d>e))return null;if(d>e||d==e&&t<0&&!c)return e==l||t<0?s:s+h;s+=h}l=d}if(e>l)throw new RangeError(`Position ${e} is out of range for changeset of length ${l}`);return s}touchesRange(e,t=e){for(let r=0,l=0;r<this.sections.length&&l<=t;){let s=this.sections[r++],o=this.sections[r++],c=l+s;if(o>=0&&l<=t&&c>=e)return l<e&&c>t?"cover":!0;l=c}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let r=this.sections[t++],l=this.sections[t++];e+=(e?" ":"")+r+(l>=0?":"+l:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Wi(e)}static create(e){return new Wi(e)}}class Hn extends Wi{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Dg(this,(t,r,l,s,o)=>e=e.replace(l,l+(r-t),o),!1),e}mapDesc(e,t=!1){return jg(this,e,t,!0)}invert(e){let t=this.sections.slice(),r=[];for(let l=0,s=0;l<t.length;l+=2){let o=t[l],c=t[l+1];if(c>=0){t[l]=c,t[l+1]=o;let h=l>>1;for(;r.length<h;)r.push(Lt.empty);r.push(o?e.slice(s,s+o):Lt.empty)}s+=o}return new Hn(t,r)}compose(e){return this.empty?e:e.empty?this:dw(this,e,!0)}map(e,t=!1){return e.empty?this:jg(this,e,t,!0)}iterChanges(e,t=!1){Dg(this,e,t)}get desc(){return Wi.create(this.sections)}filter(e){let t=[],r=[],l=[],s=new Mc(this);e:for(let o=0,c=0;;){let h=o==e.length?1e9:e[o++];for(;c<h||c==h&&s.len==0;){if(s.done)break e;let p=Math.min(s.len,h-c);hr(l,p,-1);let g=s.ins==-1?-1:s.off==0?s.ins:0;hr(t,p,g),g>0&&Sa(r,t,s.text),s.forward(p),c+=p}let d=e[o++];for(;c<d;){if(s.done)break e;let p=Math.min(s.len,d-c);hr(t,p,-1),hr(l,p,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(p),c+=p}}return{changes:new Hn(t,r),filtered:Wi.create(l)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t],l=this.sections[t+1];l<0?e.push(r):l==0?e.push([r]):e.push([r].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,r){let l=[],s=[],o=0,c=null;function h(p=!1){if(!p&&!l.length)return;o<t&&hr(l,t-o,-1);let g=new Hn(l,s);c=c?c.compose(g.map(c)):g,l=[],s=[],o=0}function d(p){if(Array.isArray(p))for(let g of p)d(g);else if(p instanceof Hn){if(p.length!=t)throw new RangeError(`Mismatched change set length (got ${p.length}, expected ${t})`);h(),c=c?c.compose(p.map(c)):p}else{let{from:g,to:b=g,insert:w}=p;if(g>b||g<0||b>t)throw new RangeError(`Invalid change range ${g} to ${b} (in doc of length ${t})`);let T=w?typeof w=="string"?Lt.of(w.split(r||_g)):w:Lt.empty,N=T.length;if(g==b&&N==0)return;g<o&&h(),g>o&&hr(l,g-o,-1),hr(l,b-g,N),Sa(s,l,T),o=b}}return d(e),h(!c),c}static empty(e){return new Hn(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],r=[];for(let l=0;l<e.length;l++){let s=e[l];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,c)=>c&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;r.length<l;)r.push(Lt.empty);r[l]=Lt.of(s.slice(1)),t.push(s[0],r[l].length)}}}return new Hn(t,r)}static createSet(e,t){return new Hn(e,t)}}function hr(n,e,t,r=!1){if(e==0&&t<=0)return;let l=n.length-2;l>=0&&t<=0&&t==n[l+1]?n[l]+=e:l>=0&&e==0&&n[l]==0?n[l+1]+=t:r?(n[l]+=e,n[l+1]+=t):n.push(e,t)}function Sa(n,e,t){if(t.length==0)return;let r=e.length-2>>1;if(r<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<r;)n.push(Lt.empty);n.push(t)}}function Dg(n,e,t){let r=n.inserted;for(let l=0,s=0,o=0;o<n.sections.length;){let c=n.sections[o++],h=n.sections[o++];if(h<0)l+=c,s+=c;else{let d=l,p=s,g=Lt.empty;for(;d+=c,p+=h,h&&r&&(g=g.append(r[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)c=n.sections[o++],h=n.sections[o++];e(l,d,s,p,g),l=d,s=p}}}function jg(n,e,t,r=!1){let l=[],s=r?[]:null,o=new Mc(n),c=new Mc(e);for(let h=-1;;){if(o.done&&c.len||c.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&c.ins==-1){let d=Math.min(o.len,c.len);hr(l,d,-1),o.forward(d),c.forward(d)}else if(c.ins>=0&&(o.ins<0||h==o.i||o.off==0&&(c.len<o.len||c.len==o.len&&!t))){let d=c.len;for(hr(l,c.ins,-1);d;){let p=Math.min(o.len,d);o.ins>=0&&h<o.i&&o.len<=p&&(hr(l,0,o.ins),s&&Sa(s,l,o.text),h=o.i),o.forward(p),d-=p}c.next()}else if(o.ins>=0){let d=0,p=o.len;for(;p;)if(c.ins==-1){let g=Math.min(p,c.len);d+=g,p-=g,c.forward(g)}else if(c.ins==0&&c.len<p)p-=c.len,c.next();else break;hr(l,d,h<o.i?o.ins:0),s&&h<o.i&&Sa(s,l,o.text),h=o.i,o.forward(o.len-p)}else{if(o.done&&c.done)return s?Hn.createSet(l,s):Wi.create(l);throw new Error("Mismatched change set lengths")}}}function dw(n,e,t=!1){let r=[],l=t?[]:null,s=new Mc(n),o=new Mc(e);for(let c=!1;;){if(s.done&&o.done)return l?Hn.createSet(r,l):Wi.create(r);if(s.ins==0)hr(r,s.len,0,c),s.next();else if(o.len==0&&!o.done)hr(r,0,o.ins,c),l&&Sa(l,r,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let h=Math.min(s.len2,o.len),d=r.length;if(s.ins==-1){let p=o.ins==-1?-1:o.off?0:o.ins;hr(r,h,p,c),l&&p&&Sa(l,r,o.text)}else o.ins==-1?(hr(r,s.off?0:s.len,h,c),l&&Sa(l,r,s.textBit(h))):(hr(r,s.off?0:s.len,o.off?0:o.ins,c),l&&!o.off&&Sa(l,r,o.text));c=(s.ins>h||o.ins>=0&&o.len>h)&&(c||r.length>d),s.forward2(h),o.forward(h)}}}}class Mc{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Lt.empty:e[t]}textBit(e){let{inserted:t}=this.set,r=this.i-2>>1;return r>=t.length&&!e?Lt.empty:t[r].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class gs{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let r,l;return this.empty?r=l=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),l=e.mapPos(this.to,-1)),r==this.from&&l==this.to?this:new gs(r,l,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return Oe.range(e,t);let r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return Oe.range(this.anchor,r)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Oe.range(e.anchor,e.head)}static create(e,t,r){return new gs(e,t,r)}}class Oe{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:Oe.create(this.ranges.map(r=>r.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Oe([this.main],0)}addRange(e,t=!0){return Oe.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let r=this.ranges.slice();return r[t]=e,Oe.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Oe(e.ranges.map(t=>gs.fromJSON(t)),e.main)}static single(e,t=e){return new Oe([Oe.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,l=0;l<e.length;l++){let s=e[l];if(s.empty?s.from<=r:s.from<r)return Oe.normalized(e.slice(),t);r=s.to}return new Oe(e,t)}static cursor(e,t=0,r,l){return gs.create(e,e,(t==0?0:t<0?8:16)|(r==null?7:Math.min(6,r))|(l??16777215)<<6)}static range(e,t,r,l){let s=(r??16777215)<<6|(l==null?7:Math.min(6,l));return t<e?gs.create(t,e,48|s):gs.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let r=e[t];e.sort((l,s)=>l.from-s.from),t=e.indexOf(r);for(let l=1;l<e.length;l++){let s=e[l],o=e[l-1];if(s.empty?s.from<=o.to:s.from<o.to){let c=o.from,h=Math.max(s.to,o.to);l<=t&&t--,e.splice(--l,2,s.anchor>s.head?Oe.range(h,c):Oe.range(c,h))}}return new Oe(e,t)}}function pw(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let B0=0;class ct{constructor(e,t,r,l,s){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=l,this.id=B0++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new ct(e.combine||(t=>t),e.compareInput||((t,r)=>t===r),e.compare||(e.combine?(t,r)=>t===r:L0),!!e.static,e.enables)}of(e){return new Rf([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Rf(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Rf(e,this,2,t)}from(e,t){return t||(t=r=>r),this.compute([e],r=>t(r.field(e)))}}function L0(n,e){return n==e||n.length==e.length&&n.every((t,r)=>t===e[r])}class Rf{constructor(e,t,r,l){this.dependencies=e,this.facet=t,this.type=r,this.value=l,this.id=B0++}dynamicSlot(e){var t;let r=this.value,l=this.facet.compareInput,s=this.id,o=e[s]>>1,c=this.type==2,h=!1,d=!1,p=[];for(let g of this.dependencies)g=="doc"?h=!0:g=="selection"?d=!0:(((t=e[g.id])!==null&&t!==void 0?t:1)&1)==0&&p.push(e[g.id]);return{create(g){return g.values[o]=r(g),1},update(g,b){if(h&&b.docChanged||d&&(b.docChanged||b.selection)||Og(g,p)){let w=r(g);if(c?!Vb(w,g.values[o],l):!l(w,g.values[o]))return g.values[o]=w,1}return 0},reconfigure:(g,b)=>{let w,T=b.config.address[s];if(T!=null){let N=Gf(b,T);if(this.dependencies.every(D=>D instanceof ct?b.facet(D)===g.facet(D):D instanceof el?b.field(D,!1)==g.field(D,!1):!0)||(c?Vb(w=r(g),N,l):l(w=r(g),N)))return g.values[o]=N,0}else w=r(g);return g.values[o]=w,1}}}}function Vb(n,e,t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function Og(n,e){let t=!1;for(let r of e)yc(n,r)&1&&(t=!0);return t}function vE(n,e,t){let r=t.map(h=>n[h.id]),l=t.map(h=>h.type),s=r.filter(h=>!(h&1)),o=n[e.id]>>1;function c(h){let d=[];for(let p=0;p<r.length;p++){let g=Gf(h,r[p]);if(l[p]==2)for(let b of g)d.push(b);else d.push(g)}return e.combine(d)}return{create(h){for(let d of r)yc(h,d);return h.values[o]=c(h),1},update(h,d){if(!Og(h,s))return 0;let p=c(h);return e.compare(p,h.values[o])?0:(h.values[o]=p,1)},reconfigure(h,d){let p=Og(h,r),g=d.config.facets[e.id],b=d.facet(e);if(g&&!p&&L0(t,g))return h.values[o]=b,0;let w=c(h);return e.compare(w,b)?(h.values[o]=b,0):(h.values[o]=w,1)}}}const of=ct.define({static:!0});class el{constructor(e,t,r,l,s){this.id=e,this.createF=t,this.updateF=r,this.compareF=l,this.spec=s,this.provides=void 0}static define(e){let t=new el(B0++,e.create,e.update,e.compare||((r,l)=>r===l),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(of).find(r=>r.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:r=>(r.values[t]=this.create(r),1),update:(r,l)=>{let s=r.values[t],o=this.updateF(s,l);return this.compareF(s,o)?0:(r.values[t]=o,1)},reconfigure:(r,l)=>{let s=r.facet(of),o=l.facet(of),c;return(c=s.find(h=>h.field==this))&&c!=o.find(h=>h.field==this)?(r.values[t]=c.create(r),1):l.config.address[this.id]!=null?(r.values[t]=l.field(this),0):(r.values[t]=this.create(r),1)}}}init(e){return[this,of.of({field:this,create:e})]}get extension(){return this}}const ms={lowest:4,low:3,default:2,high:1,highest:0};function rc(n){return e=>new mw(e,n)}const kd={highest:rc(ms.highest),high:rc(ms.high),default:rc(ms.default),low:rc(ms.low),lowest:rc(ms.lowest)};class mw{constructor(e,t){this.inner=e,this.prec=t}}class wd{of(e){return new Rg(this,e)}reconfigure(e){return wd.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Rg{constructor(e,t){this.compartment=e,this.inner=t}}class Kf{constructor(e,t,r,l,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=l,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,r){let l=[],s=Object.create(null),o=new Map;for(let b of bE(e,t,o))b instanceof el?l.push(b):(s[b.facet.id]||(s[b.facet.id]=[])).push(b);let c=Object.create(null),h=[],d=[];for(let b of l)c[b.id]=d.length<<1,d.push(w=>b.slot(w));let p=r?.config.facets;for(let b in s){let w=s[b],T=w[0].facet,N=p&&p[b]||[];if(w.every(D=>D.type==0))if(c[T.id]=h.length<<1|1,L0(N,w))h.push(r.facet(T));else{let D=T.combine(w.map(j=>j.value));h.push(r&&T.compare(D,r.facet(T))?r.facet(T):D)}else{for(let D of w)D.type==0?(c[D.id]=h.length<<1|1,h.push(D.value)):(c[D.id]=d.length<<1,d.push(j=>D.dynamicSlot(j)));c[T.id]=d.length<<1,d.push(D=>vE(D,T,w))}}let g=d.map(b=>b(c));return new Kf(e,o,g,c,h,s)}}function bE(n,e,t){let r=[[],[],[],[],[]],l=new Map;function s(o,c){let h=l.get(o);if(h!=null){if(h<=c)return;let d=r[h].indexOf(o);d>-1&&r[h].splice(d,1),o instanceof Rg&&t.delete(o.compartment)}if(l.set(o,c),Array.isArray(o))for(let d of o)s(d,c);else if(o instanceof Rg){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let d=e.get(o.compartment)||o.inner;t.set(o.compartment,d),s(d,c)}else if(o instanceof mw)s(o.inner,o.prec);else if(o instanceof el)r[c].push(o),o.provides&&s(o.provides,c);else if(o instanceof Rf)r[c].push(o),o.facet.extensions&&s(o.facet.extensions,ms.default);else{let d=o.extension;if(!d)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(d,c)}}return s(n,ms.default),r.reduce((o,c)=>o.concat(c))}function yc(n,e){if(e&1)return 2;let t=e>>1,r=n.status[t];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;n.status[t]=4;let l=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|l}function Gf(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const gw=ct.define(),Bg=ct.define({combine:n=>n.some(e=>e),static:!0}),yw=ct.define({combine:n=>n.length?n[0]:void 0,static:!0}),xw=ct.define(),vw=ct.define(),bw=ct.define(),kw=ct.define({combine:n=>n.length?n[0]:!1});class Oa{constructor(e,t){this.type=e,this.value=t}static define(){return new kE}}class kE{of(e){return new Oa(this,e)}}class wE{constructor(e){this.map=e}of(e){return new fn(this,e)}}class fn{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new fn(this.type,t)}is(e){return this.type==e}static define(e={}){return new wE(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let r=[];for(let l of e){let s=l.map(t);s&&r.push(s)}return r}}fn.reconfigure=fn.define();fn.appendConfig=fn.define();class Un{constructor(e,t,r,l,s,o){this.startState=e,this.changes=t,this.selection=r,this.effects=l,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,r&&pw(r,t.newLength),s.some(c=>c.type==Un.time)||(this.annotations=s.concat(Un.time.of(Date.now())))}static create(e,t,r,l,s,o){return new Un(e,t,r,l,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Un.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Un.time=Oa.define();Un.userEvent=Oa.define();Un.addToHistory=Oa.define();Un.remote=Oa.define();function SE(n,e){let t=[];for(let r=0,l=0;;){let s,o;if(r<n.length&&(l==e.length||e[l]>=n[r]))s=n[r++],o=n[r++];else if(l<e.length)s=e[l++],o=e[l++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function ww(n,e,t){var r;let l,s,o;return t?(l=e.changes,s=Hn.empty(e.changes.length),o=n.changes.compose(e.changes)):(l=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(l)),{changes:o,selection:e.selection?e.selection.map(s):(r=n.selection)===null||r===void 0?void 0:r.map(l),effects:fn.mapEffects(n.effects,l).concat(fn.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function Lg(n,e,t){let r=e.selection,l=Do(e.annotations);return e.userEvent&&(l=l.concat(Un.userEvent.of(e.userEvent))),{changes:e.changes instanceof Hn?e.changes:Hn.of(e.changes||[],t,n.facet(yw)),selection:r&&(r instanceof Oe?r:Oe.single(r.anchor,r.head)),effects:Do(e.effects),annotations:l,scrollIntoView:!!e.scrollIntoView}}function Sw(n,e,t){let r=Lg(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;r=ww(r,Lg(n,e[s],o?r.changes.newLength:n.doc.length),o)}let l=Un.create(n,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return AE(t?CE(l):l)}function CE(n){let e=n.startState,t=!0;for(let l of e.facet(xw)){let s=l(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:SE(t,s))}if(t!==!0){let l,s;if(t===!1)s=n.changes.invertedDesc,l=Hn.empty(e.doc.length);else{let o=n.changes.filter(t);l=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=Un.create(e,l,n.selection&&n.selection.map(s),fn.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let r=e.facet(vw);for(let l=r.length-1;l>=0;l--){let s=r[l](n);s instanceof Un?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Un?n=s[0]:n=Sw(e,Do(s),!1)}return n}function AE(n){let e=n.startState,t=e.facet(bw),r=n;for(let l=t.length-1;l>=0;l--){let s=t[l](n);s&&Object.keys(s).length&&(r=ww(r,Lg(e,s,n.changes.newLength),!0))}return r==n?n:Un.create(e,n.changes,n.selection,r.effects,r.annotations,r.scrollIntoView)}const TE=[];function Do(n){return n==null?TE:Array.isArray(n)?n:[n]}var ir=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(ir||(ir={}));const EE=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let zg;try{zg=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function NE(n){if(zg)return zg.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||EE.test(t)))return!0}return!1}function ME(n){return e=>{if(!/\S/.test(e))return ir.Space;if(NE(e))return ir.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return ir.Word;return ir.Other}}class Ht{constructor(e,t,r,l,s,o){this.config=e,this.doc=t,this.selection=r,this.values=l,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let c=0;c<this.config.dynamicSlots.length;c++)yc(this,c<<1);this.computeSlot=null}field(e,t=!0){let r=this.config.address[e.id];if(r==null){if(t)throw new RangeError("Field is not present in this state");return}return yc(this,r),Gf(this,r)}update(...e){return Sw(this,e,!0)}applyTransaction(e){let t=this.config,{base:r,compartments:l}=t;for(let c of e.effects)c.is(wd.reconfigure)?(t&&(l=new Map,t.compartments.forEach((h,d)=>l.set(d,h)),t=null),l.set(c.value.compartment,c.value.extension)):c.is(fn.reconfigure)?(t=null,r=c.value):c.is(fn.appendConfig)&&(t=null,r=Do(r).concat(c.value));let s;t?s=e.startState.values.slice():(t=Kf.resolve(r,l,this),s=new Ht(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(h,d)=>d.reconfigure(h,this),null).values);let o=e.startState.facet(Bg)?e.newSelection:e.newSelection.asSingle();new Ht(t,e.newDoc,o,s,(c,h)=>h.update(c,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:Oe.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,r=e(t.ranges[0]),l=this.changes(r.changes),s=[r.range],o=Do(r.effects);for(let c=1;c<t.ranges.length;c++){let h=e(t.ranges[c]),d=this.changes(h.changes),p=d.map(l);for(let b=0;b<c;b++)s[b]=s[b].map(p);let g=l.mapDesc(d,!0);s.push(h.range.map(g)),l=l.compose(p),o=fn.mapEffects(o,p).concat(fn.mapEffects(Do(h.effects),g))}return{changes:l,selection:Oe.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Hn?e:Hn.of(e,this.doc.length,this.facet(Ht.lineSeparator))}toText(e){return Lt.of(e.split(this.facet(Ht.lineSeparator)||_g))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(yc(this,t),Gf(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let l=e[r];l instanceof el&&this.config.address[l.id]!=null&&(t[r]=l.spec.toJSON(this.field(e[r]),this))}return t}static fromJSON(e,t={},r){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let l=[];if(r){for(let s in r)if(Object.prototype.hasOwnProperty.call(e,s)){let o=r[s],c=e[s];l.push(o.init(h=>o.spec.fromJSON(c,h)))}}return Ht.create({doc:e.doc,selection:Oe.fromJSON(e.selection),extensions:t.extensions?l.concat([t.extensions]):l})}static create(e={}){let t=Kf.resolve(e.extensions||[],new Map),r=e.doc instanceof Lt?e.doc:Lt.of((e.doc||"").split(t.staticFacet(Ht.lineSeparator)||_g)),l=e.selection?e.selection instanceof Oe?e.selection:Oe.single(e.selection.anchor,e.selection.head):Oe.single(0);return pw(l,r.length),t.staticFacet(Bg)||(l=l.asSingle()),new Ht(t,r,l,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Ht.tabSize)}get lineBreak(){return this.facet(Ht.lineSeparator)||`
`}get readOnly(){return this.facet(kw)}phrase(e,...t){for(let r of this.facet(Ht.phrases))if(Object.prototype.hasOwnProperty.call(r,e)){e=r[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(r,l)=>{if(l=="$")return"$";let s=+(l||1);return!s||s>t.length?r:t[s-1]})),e}languageDataAt(e,t,r=-1){let l=[];for(let s of this.facet(gw))for(let o of s(this,t,r))Object.prototype.hasOwnProperty.call(o,e)&&l.push(o[e]);return l}charCategorizer(e){let t=this.languageDataAt("wordChars",e);return ME(t.length?t[0]:"")}wordAt(e){let{text:t,from:r,length:l}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-r,c=e-r;for(;o>0;){let h=qn(t,o,!1);if(s(t.slice(h,o))!=ir.Word)break;o=h}for(;c<l;){let h=qn(t,c);if(s(t.slice(c,h))!=ir.Word)break;c=h}return o==c?null:Oe.range(o+r,c+r)}}Ht.allowMultipleSelections=Bg;Ht.tabSize=ct.define({combine:n=>n.length?n[0]:4});Ht.lineSeparator=yw;Ht.readOnly=kw;Ht.phrases=ct.define({compare(n,e){let t=Object.keys(n),r=Object.keys(e);return t.length==r.length&&t.every(l=>n[l]==e[l])}});Ht.languageData=gw;Ht.changeFilter=xw;Ht.transactionFilter=vw;Ht.transactionExtender=bw;wd.reconfigure=fn.define();function Cw(n,e,t={}){let r={};for(let l of n)for(let s of Object.keys(l)){let o=l[s],c=r[s];if(c===void 0)r[s]=o;else if(!(c===o||o===void 0))if(Object.hasOwnProperty.call(t,s))r[s]=t[s](c,o);else throw new Error("Config merge conflict for field "+s)}for(let l in e)r[l]===void 0&&(r[l]=e[l]);return r}class bs{eq(e){return this==e}range(e,t=e){return Ig.create(e,t,this)}}bs.prototype.startSide=bs.prototype.endSide=0;bs.prototype.point=!1;bs.prototype.mapMode=Vr.TrackDel;function z0(n,e){return n==e||n.constructor==e.constructor&&n.eq(e)}let Ig=class Aw{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new Aw(e,t,r)}};function Pg(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class I0{constructor(e,t,r,l){this.from=e,this.to=t,this.value=r,this.maxPoint=l}get length(){return this.to[this.to.length-1]}findIndex(e,t,r,l=0){let s=r?this.to:this.from;for(let o=l,c=s.length;;){if(o==c)return o;let h=o+c>>1,d=s[h]-e||(r?this.value[h].endSide:this.value[h].startSide)-t;if(h==o)return d>=0?o:c;d>=0?c=h:o=h+1}}between(e,t,r,l){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(r,1e9,!1,s);s<o;s++)if(l(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let r=[],l=[],s=[],o=-1,c=-1;for(let h=0;h<this.value.length;h++){let d=this.value[h],p=this.from[h]+e,g=this.to[h]+e,b,w;if(p==g){let T=t.mapPos(p,d.startSide,d.mapMode);if(T==null||(b=w=T,d.startSide!=d.endSide&&(w=t.mapPos(p,d.endSide),w<b)))continue}else if(b=t.mapPos(p,d.startSide),w=t.mapPos(g,d.endSide),b>w||b==w&&d.startSide>0&&d.endSide<=0)continue;(w-b||d.endSide-d.startSide)<0||(o<0&&(o=b),d.point&&(c=Math.max(c,w-b)),r.push(d),l.push(b-o),s.push(w-o))}return{mapped:r.length?new I0(l,s,r,c):null,pos:o}}}class Kt{constructor(e,t,r,l){this.chunkPos=e,this.chunk=t,this.nextLayer=r,this.maxPoint=l}static create(e,t,r,l){return new Kt(e,t,r,l)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:r=!1,filterFrom:l=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(r&&(t=t.slice().sort(Pg)),this.isEmpty)return t.length?Kt.of(t):this;let c=new Tw(this,null,-1).goto(0),h=0,d=[],p=new Po;for(;c.value||h<t.length;)if(h<t.length&&(c.from-t[h].from||c.startSide-t[h].value.startSide)>=0){let g=t[h++];p.addInner(g.from,g.to,g.value)||d.push(g)}else c.rangeIndex==1&&c.chunkIndex<this.chunk.length&&(h==t.length||this.chunkEnd(c.chunkIndex)<t[h].from)&&(!o||l>this.chunkEnd(c.chunkIndex)||s<this.chunkPos[c.chunkIndex])&&p.addChunk(this.chunkPos[c.chunkIndex],this.chunk[c.chunkIndex])?c.nextChunk():((!o||l>c.to||s<c.from||o(c.from,c.to,c.value))&&(p.addInner(c.from,c.to,c.value)||d.push(Ig.create(c.from,c.to,c.value))),c.next());return p.finishInner(this.nextLayer.isEmpty&&!d.length?Kt.empty:this.nextLayer.update({add:d,filter:o,filterFrom:l,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],r=[],l=-1;for(let o=0;o<this.chunk.length;o++){let c=this.chunkPos[o],h=this.chunk[o],d=e.touchesRange(c,c+h.length);if(d===!1)l=Math.max(l,h.maxPoint),t.push(h),r.push(e.mapPos(c));else if(d===!0){let{mapped:p,pos:g}=h.map(c,e);p&&(l=Math.max(l,p.maxPoint),t.push(p),r.push(g))}}let s=this.nextLayer.map(e);return t.length==0?s:new Kt(r,t,s||Kt.empty,l)}between(e,t,r){if(!this.isEmpty){for(let l=0;l<this.chunk.length;l++){let s=this.chunkPos[l],o=this.chunk[l];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,r)===!1)return}this.nextLayer.between(e,t,r)}}iter(e=0){return _c.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return _c.from(e).goto(t)}static compare(e,t,r,l,s=-1){let o=e.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=s),c=t.filter(g=>g.maxPoint>0||!g.isEmpty&&g.maxPoint>=s),h=Kb(o,c,r),d=new ic(o,h,s),p=new ic(c,h,s);r.iterGaps((g,b,w)=>Gb(d,g,p,b,w,l)),r.empty&&r.length==0&&Gb(d,0,p,0,0,l)}static eq(e,t,r=0,l){l==null&&(l=999999999);let s=e.filter(p=>!p.isEmpty&&t.indexOf(p)<0),o=t.filter(p=>!p.isEmpty&&e.indexOf(p)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let c=Kb(s,o),h=new ic(s,c,0).goto(r),d=new ic(o,c,0).goto(r);for(;;){if(h.to!=d.to||!Hg(h.active,d.active)||h.point&&(!d.point||!z0(h.point,d.point)))return!1;if(h.to>l)return!0;h.next(),d.next()}}static spans(e,t,r,l,s=-1){let o=new ic(e,null,s).goto(t),c=t,h=o.openStart;for(;;){let d=Math.min(o.to,r);if(o.point){let p=o.activeForPoint(o.to),g=o.pointFrom<t?p.length+1:o.point.startSide<0?p.length:Math.min(p.length,h);l.point(c,d,o.point,p,g,o.pointRank),h=Math.min(o.openEnd(d),p.length)}else d>c&&(l.span(c,d,o.active,h),h=o.openEnd(d));if(o.to>r)return h+(o.point&&o.to>r?1:0);c=o.to,o.next()}}static of(e,t=!1){let r=new Po;for(let l of e instanceof Ig?[e]:t?_E(e):e)r.add(l.from,l.to,l.value);return r.finish()}static join(e){if(!e.length)return Kt.empty;let t=e[e.length-1];for(let r=e.length-2;r>=0;r--)for(let l=e[r];l!=Kt.empty;l=l.nextLayer)t=new Kt(l.chunkPos,l.chunk,t,Math.max(l.maxPoint,t.maxPoint));return t}}Kt.empty=new Kt([],[],null,-1);function _E(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let r=n[t];if(Pg(e,r)>0)return n.slice().sort(Pg);e=r}return n}Kt.empty.nextLayer=Kt.empty;class Po{finishChunk(e){this.chunks.push(new I0(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new Po)).add(e,t,r)}addInner(e,t,r){let l=e-this.lastTo||r.startSide-this.last.endSide;if(l<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return l<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(Kt.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=Kt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Kb(n,e,t){let r=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&r.set(s.chunk[o],s.chunkPos[o]);let l=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let c=r.get(s.chunk[o]);c!=null&&(t?t.mapPos(c):c)==s.chunkPos[o]&&!t?.touchesRange(c,c+s.chunk[o].length)&&l.add(s.chunk[o])}return l}class Tw{constructor(e,t,r,l=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=l}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){let l=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(l)||this.layer.chunkEnd(this.chunkIndex)<e||l.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let l=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!r||this.rangeIndex<l)&&this.setRangeIndex(l)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],r=e+t.from[this.rangeIndex];if(this.from=r,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class _c{constructor(e){this.heap=e}static from(e,t=null,r=-1){let l=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&l.push(new Tw(o,t,r,s));return l.length==1?l[0]:new _c(l)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let r of this.heap)r.goto(e,t);for(let r=this.heap.length>>1;r>=0;r--)qm(this.heap,r);return this.next(),this}forward(e,t){for(let r of this.heap)r.forward(e,t);for(let r=this.heap.length>>1;r>=0;r--)qm(this.heap,r);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),qm(this.heap,0)}}}function qm(n,e){for(let t=n[e];;){let r=(e<<1)+1;if(r>=n.length)break;let l=n[r];if(r+1<n.length&&l.compare(n[r+1])>=0&&(l=n[r+1],r++),t.compare(l)<0)break;n[r]=t,n[e]=l,e=r}}class ic{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=_c.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){uf(this.active,e),uf(this.activeTo,e),uf(this.activeRank,e),this.minActive=Yb(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:l,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||l-this.activeTo[t])>0;)t++;cf(this.active,t,r),cf(this.activeTo,t,l),cf(this.activeRank,t,s),e&&cf(e,t,this.cursor.from),this.minActive=Yb(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let l=this.minActive;if(l>-1&&(this.activeTo[l]-this.cursor.from||this.active[l].endSide-this.cursor.startSide)<0){if(this.activeTo[l]>e){this.to=this.activeTo[l],this.endSide=this.active[l].endSide;break}this.removeActive(l),r&&uf(r,l)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(r),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let l=r.length-1;l>=0&&r[l]<e;l--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&t.push(this.active[r]);return t.reverse()}openEnd(e){let t=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)t++;return t}}function Gb(n,e,t,r,l,s){n.goto(e),t.goto(r);let o=r+l,c=r,h=r-e,d=!!s.boundChange;for(let p=!1;;){let g=n.to+h-t.to,b=g||n.endSide-t.endSide,w=b<0?n.to+h:t.to,T=Math.min(w,o);if(n.point||t.point?(n.point&&t.point&&z0(n.point,t.point)&&Hg(n.activeForPoint(n.to),t.activeForPoint(t.to))||s.comparePoint(c,T,n.point,t.point),p=!1):(p&&s.boundChange(c),T>c&&!Hg(n.active,t.active)&&s.compareRange(c,T,n.active,t.active),d&&T<o&&(g||n.openEnd(w)!=t.openEnd(w))&&(p=!0)),w>o)break;c=w,b<=0&&n.next(),b>=0&&t.next()}}function Hg(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!z0(n[t],e[t]))return!1;return!0}function uf(n,e){for(let t=e,r=n.length-1;t<r;t++)n[t]=n[t+1];n.pop()}function cf(n,e,t){for(let r=n.length-1;r>=e;r--)n[r+1]=n[r];n[e]=t}function Yb(n,e){let t=-1,r=1e9;for(let l=0;l<e.length;l++)(e[l]-r||n[l].endSide-n[t].endSide)<0&&(t=l,r=e[l]);return t}function Sd(n,e,t=n.length){let r=0;for(let l=0;l<t&&l<n.length;)n.charCodeAt(l)==9?(r+=e-r%e,l++):(r++,l=qn(n,l));return r}function DE(n,e,t,r){for(let l=0,s=0;;){if(s>=e)return l;if(l==n.length)break;s+=n.charCodeAt(l)==9?t-s%t:1,l=qn(n,l)}return n.length}const qg="",Qb=typeof Symbol>"u"?"__"+qg:Symbol.for(qg),Ug=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Xb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Na{constructor(e,t){this.rules=[];let{finish:r}=t||{};function l(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,c,h,d){let p=[],g=/^@(\w+)\b/.exec(o[0]),b=g&&g[1]=="keyframes";if(g&&c==null)return h.push(o[0]+";");for(let w in c){let T=c[w];if(/&/.test(w))s(w.split(/,\s*/).map(N=>o.map(D=>N.replace(/&/,D))).reduce((N,D)=>N.concat(D)),T,h);else if(T&&typeof T=="object"){if(!g)throw new RangeError("The value of a property ("+w+") should be a primitive value.");s(l(w),T,p,b)}else T!=null&&p.push(w.replace(/_.*/,"").replace(/[A-Z]/g,N=>"-"+N.toLowerCase())+": "+T+";")}(p.length||b)&&h.push((r&&!g&&!d?o.map(r):o).join(", ")+" {"+p.join(" ")+"}")}for(let o in e)s(l(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Xb[Qb]||1;return Xb[Qb]=e+1,qg+e.toString(36)}static mount(e,t,r){let l=e[Ug],s=r&&r.nonce;l?s&&l.setNonce(s):l=new jE(e,s),l.mount(Array.isArray(t)?t:[t],e)}}let $b=new Map;class jE{constructor(e,t){let r=e.ownerDocument||e,l=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&l.CSSStyleSheet){let s=$b.get(r);if(s)return e[Ug]=s;this.sheet=new l.CSSStyleSheet,$b.set(r,this)}else this.styleTag=r.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[Ug]=this}mount(e,t){let r=this.sheet,l=0,s=0;for(let o=0;o<e.length;o++){let c=e[o],h=this.modules.indexOf(c);if(h<s&&h>-1&&(this.modules.splice(h,1),s--,h=-1),h==-1){if(this.modules.splice(s++,0,c),r)for(let d=0;d<c.rules.length;d++)r.insertRule(c.rules[d],l++)}else{for(;s<h;)l+=this.modules[s++].rules.length;l+=c.rules.length,s++}}if(r)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let h=0;h<this.modules.length;h++)o+=this.modules[h].getRules()+`
`;this.styleTag.textContent=o;let c=t.head||t;this.styleTag.parentNode!=c&&c.insertBefore(this.styleTag,c.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Ma={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Dc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},OE=typeof navigator<"u"&&/Mac/.test(navigator.platform),RE=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var rr=0;rr<10;rr++)Ma[48+rr]=Ma[96+rr]=String(rr);for(var rr=1;rr<=24;rr++)Ma[rr+111]="F"+rr;for(var rr=65;rr<=90;rr++)Ma[rr]=String.fromCharCode(rr+32),Dc[rr]=String.fromCharCode(rr);for(var Um in Ma)Dc.hasOwnProperty(Um)||(Dc[Um]=Ma[Um]);function BE(n){var e=OE&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||RE&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Dc:Ma)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function ii(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var l=t[r];typeof l=="string"?n.setAttribute(r,l):l!=null&&(n[r]=l)}e++}for(;e<arguments.length;e++)Ew(n,arguments[e]);return n}function Ew(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)Ew(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}let xr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Fg=typeof document<"u"?document:{documentElement:{style:{}}};const Vg=/Edge\/(\d+)/.exec(xr.userAgent),Nw=/MSIE \d/.test(xr.userAgent),Kg=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(xr.userAgent),Cd=!!(Nw||Kg||Vg),Wb=!Cd&&/gecko\/(\d+)/i.test(xr.userAgent),Fm=!Cd&&/Chrome\/(\d+)/.exec(xr.userAgent),LE="webkitFontSmoothing"in Fg.documentElement.style,Gg=!Cd&&/Apple Computer/.test(xr.vendor),Zb=Gg&&(/Mobile\/\w+/.test(xr.userAgent)||xr.maxTouchPoints>2);var Ze={mac:Zb||/Mac/.test(xr.platform),windows:/Win/.test(xr.platform),linux:/Linux|X11/.test(xr.platform),ie:Cd,ie_version:Nw?Fg.documentMode||6:Kg?+Kg[1]:Vg?+Vg[1]:0,gecko:Wb,gecko_version:Wb?+(/Firefox\/(\d+)/.exec(xr.userAgent)||[0,0])[1]:0,chrome:!!Fm,chrome_version:Fm?+Fm[1]:0,ios:Zb,android:/Android\b/.test(xr.userAgent),webkit_version:LE?+(/\bAppleWebKit\/(\d+)/.exec(xr.userAgent)||[0,0])[1]:0,safari:Gg,safari_version:Gg?+(/\bVersion\/(\d+(\.\d+)?)/.exec(xr.userAgent)||[0,0])[1]:0,tabSize:Fg.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function P0(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const Yf=Object.create(null);function H0(n,e,t){if(n==e)return!0;n||(n=Yf),e||(e=Yf);let r=Object.keys(n),l=Object.keys(e);if(r.length-0!=l.length-0)return!1;for(let s of r)if(s!=t&&(l.indexOf(s)==-1||n[s]!==e[s]))return!1;return!0}function zE(n,e){for(let t=n.attributes.length-1;t>=0;t--){let r=n.attributes[t].name;e[r]==null&&n.removeAttribute(r)}for(let t in e){let r=e[t];t=="style"?n.style.cssText=r:n.getAttribute(t)!=r&&n.setAttribute(t,r)}}function Jb(n,e,t){let r=!1;if(e)for(let l in e)t&&l in t||(r=!0,l=="style"?n.style.cssText="":n.removeAttribute(l));if(t)for(let l in t)e&&e[l]==t[l]||(r=!0,l=="style"?n.style.cssText=t[l]:n.setAttribute(l,t[l]));return r}function IE(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let r=n.attributes[t];e[r.name]=r.value}return e}class Ad{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var ui=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(ui||(ui={}));class Nn extends bs{constructor(e,t,r,l){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=l}get heightRelevant(){return!1}static mark(e){return new Hc(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new ks(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,l;if(e.isBlockGap)r=-5e8,l=4e8;else{let{start:s,end:o}=Mw(e,t);r=(s?t?-3e8:-1:5e8)-1,l=(o?t?2e8:1:-6e8)+1}return new ks(e,r,l,t,e.widget||null,!0)}static line(e){return new qc(e)}static set(e,t=!1){return Kt.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Nn.none=Kt.empty;class Hc extends Nn{constructor(e){let{start:t,end:r}=Mw(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?P0(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||Yf}eq(e){return this==e||e instanceof Hc&&this.tagName==e.tagName&&H0(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Hc.prototype.point=!1;class qc extends Nn{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof qc&&this.spec.class==e.spec.class&&H0(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}qc.prototype.mapMode=Vr.TrackBefore;qc.prototype.point=!0;class ks extends Nn{constructor(e,t,r,l,s,o){super(t,r,s,e),this.block=l,this.isReplace=o,this.mapMode=l?t<=0?Vr.TrackBefore:Vr.TrackAfter:Vr.TrackDel}get type(){return this.startSide!=this.endSide?ui.WidgetRange:this.startSide<=0?ui.WidgetBefore:ui.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof ks&&PE(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}ks.prototype.point=!0;function Mw(n,e=!1){let{inclusiveStart:t,inclusiveEnd:r}=n;return t==null&&(t=n.inclusive),r==null&&(r=n.inclusive),{start:t??e,end:r??e}}function PE(n,e){return n==e||!!(n&&e&&n.compare(e))}function jo(n,e,t,r=0){let l=t.length-1;l>=0&&t[l]+r>=n?t[l]=Math.max(t[l],e):t.push(n,e)}class jc extends bs{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof jc&&this.tagName==e.tagName&&H0(this.attributes,e.attributes)}static create(e){return new jc(e.tagName,e.attributes||Yf)}static set(e,t=!1){return Kt.of(e,t)}}jc.prototype.startSide=jc.prototype.endSide=-1;function Ho(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function Yg(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function xc(n,e){if(!e.anchorNode)return!1;try{return Yg(n,e.anchorNode)}catch{return!1}}function Bf(n){return n.nodeType==3?Oc(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function vc(n,e,t,r){return t?e1(n,e,t,r,-1)||e1(n,e,t,r,1):!1}function _a(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function Qf(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function e1(n,e,t,r,l){for(;;){if(n==t&&e==r)return!0;if(e==(l<0?0:Rl(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=_a(n)+(l<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(l<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=l<0?Rl(n):0}else return!1}}function Rl(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Xf(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function HE(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function _w(n,e){let t=e.width/n.offsetWidth,r=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.height-n.offsetHeight)<1)&&(r=1),{scaleX:t,scaleY:r}}function qE(n,e,t,r,l,s,o,c){let h=n.ownerDocument,d=h.defaultView||window;for(let p=n,g=!1;p&&!g;)if(p.nodeType==1){let b,w=p==h.body,T=1,N=1;if(w)b=HE(d);else{if(/^(fixed|sticky)$/.test(getComputedStyle(p).position)&&(g=!0),p.scrollHeight<=p.clientHeight&&p.scrollWidth<=p.clientWidth){p=p.assignedSlot||p.parentNode;continue}let U=p.getBoundingClientRect();({scaleX:T,scaleY:N}=_w(p,U)),b={left:U.left,right:U.left+p.clientWidth*T,top:U.top,bottom:U.top+p.clientHeight*N}}let D=0,j=0;if(l=="nearest")e.top<b.top?(j=e.top-(b.top+o),t>0&&e.bottom>b.bottom+j&&(j=e.bottom-b.bottom+o)):e.bottom>b.bottom&&(j=e.bottom-b.bottom+o,t<0&&e.top-j<b.top&&(j=e.top-(b.top+o)));else{let U=e.bottom-e.top,I=b.bottom-b.top;j=(l=="center"&&U<=I?e.top+U/2-I/2:l=="start"||l=="center"&&t<0?e.top-o:e.bottom-I+o)-b.top}if(r=="nearest"?e.left<b.left?(D=e.left-(b.left+s),t>0&&e.right>b.right+D&&(D=e.right-b.right+s)):e.right>b.right&&(D=e.right-b.right+s,t<0&&e.left<b.left+D&&(D=e.left-(b.left+s))):D=(r=="center"?e.left+(e.right-e.left)/2-(b.right-b.left)/2:r=="start"==c?e.left-s:e.right-(b.right-b.left)+s)-b.left,D||j)if(w)d.scrollBy(D,j);else{let U=0,I=0;if(j){let ce=p.scrollTop;p.scrollTop+=j/N,I=(p.scrollTop-ce)*N}if(D){let ce=p.scrollLeft;p.scrollLeft+=D/T,U=(p.scrollLeft-ce)*T}e={left:e.left-U,top:e.top-I,right:e.right-U,bottom:e.bottom-I},U&&Math.abs(U-D)<1&&(r="nearest"),I&&Math.abs(I-j)<1&&(l="nearest")}if(w)break;(e.top<b.top||e.bottom>b.bottom||e.left<b.left||e.right>b.right)&&(e={left:Math.max(e.left,b.left),right:Math.min(e.right,b.right),top:Math.max(e.top,b.top),bottom:Math.min(e.bottom,b.bottom)}),p=p.assignedSlot||p.parentNode}else if(p.nodeType==11)p=p.host;else break}function UE(n){let e=n.ownerDocument,t,r;for(let l=n.parentNode;l&&!(l==e.body||t&&r);)if(l.nodeType==1)!r&&l.scrollHeight>l.clientHeight&&(r=l),!t&&l.scrollWidth>l.clientWidth&&(t=l),l=l.assignedSlot||l.parentNode;else if(l.nodeType==11)l=l.host;else break;return{x:t,y:r}}class FE{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?Rl(t):0),r,Math.min(e.focusOffset,r?Rl(r):0))}set(e,t,r,l){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=l}}let ps=null;Ze.safari&&Ze.safari_version>=26&&(ps=!1);function Dw(n){if(n.setActive)return n.setActive();if(ps)return n.focus(ps);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(ps==null?{get preventScroll(){return ps={preventScroll:!0},!0}}:void 0),!ps){ps=!1;for(let t=0;t<e.length;){let r=e[t++],l=e[t++],s=e[t++];r.scrollTop!=l&&(r.scrollTop=l),r.scrollLeft!=s&&(r.scrollLeft=s)}}}let t1;function Oc(n,e,t=e){let r=t1||(t1=document.createRange());return r.setEnd(n,t),r.setStart(n,e),r}function Oo(n,e,t,r){let l={key:e,code:e,keyCode:t,which:t,cancelable:!0};r&&({altKey:l.altKey,ctrlKey:l.ctrlKey,shiftKey:l.shiftKey,metaKey:l.metaKey}=r);let s=new KeyboardEvent("keydown",l);s.synthetic=!0,n.dispatchEvent(s);let o=new KeyboardEvent("keyup",l);return o.synthetic=!0,n.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function VE(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function KE(n,e){let t=e.focusNode,r=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=r)return!1;for(r=Math.min(r,Rl(t));;)if(r){if(t.nodeType!=1)return!1;let l=t.childNodes[r-1];l.contentEditable=="false"?r--:(t=l,r=Rl(t))}else{if(t==n)return!0;r=_a(t),t=t.parentNode}}function jw(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function Ow(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r>0)return{node:t,offset:r};if(t.nodeType==1&&r>0){if(t.contentEditable=="false")return null;t=t.childNodes[r-1],r=Rl(t)}else if(t.parentNode&&!Qf(t))r=_a(t),t=t.parentNode;else return null}}function Rw(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r<t.nodeValue.length)return{node:t,offset:r};if(t.nodeType==1&&r<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[r],r=0}else if(t.parentNode&&!Qf(t))r=_a(t)+1,t=t.parentNode;else return null}}class ki{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new ki(e.parentNode,_a(e),t)}static after(e,t){return new ki(e.parentNode,_a(e)+1,t)}}var Ln=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(Ln||(Ln={}));const ws=Ln.LTR,q0=Ln.RTL;function Bw(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const GE=Bw("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),YE=Bw("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Qg=Object.create(null),qi=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);Qg[e]=t,Qg[t]=-e}function Lw(n){return n<=247?GE[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?YE[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const QE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Dl{get dir(){return this.level%2?q0:ws}constructor(e,t,r){this.from=e,this.to=t,this.level=r}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,r,l){let s=-1;for(let o=0;o<e.length;o++){let c=e[o];if(c.from<=t&&c.to>=t){if(c.level==r)return o;(s<0||(l!=0?l<0?c.from<t:c.to>t:e[s].level>c.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function zw(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let r=n[t],l=e[t];if(r.from!=l.from||r.to!=l.to||r.direction!=l.direction||!zw(r.inner,l.inner))return!1}return!0}const nn=[];function XE(n,e,t,r,l){for(let s=0;s<=r.length;s++){let o=s?r[s-1].to:e,c=s<r.length?r[s].from:t,h=s?256:l;for(let d=o,p=h,g=h;d<c;d++){let b=Lw(n.charCodeAt(d));b==512?b=p:b==8&&g==4&&(b=16),nn[d]=b==4?2:b,b&7&&(g=b),p=b}for(let d=o,p=h,g=h;d<c;d++){let b=nn[d];if(b==128)d<c-1&&p==nn[d+1]&&p&24?b=nn[d]=p:nn[d]=256;else if(b==64){let w=d+1;for(;w<c&&nn[w]==64;)w++;let T=d&&p==8||w<t&&nn[w]==8?g==1?1:8:256;for(let N=d;N<w;N++)nn[N]=T;d=w-1}else b==8&&g==1&&(nn[d]=1);p=b,b&7&&(g=b)}}}function $E(n,e,t,r,l){let s=l==1?2:1;for(let o=0,c=0,h=0;o<=r.length;o++){let d=o?r[o-1].to:e,p=o<r.length?r[o].from:t;for(let g=d,b,w,T;g<p;g++)if(w=Qg[b=n.charCodeAt(g)])if(w<0){for(let N=c-3;N>=0;N-=3)if(qi[N+1]==-w){let D=qi[N+2],j=D&2?l:D&4?D&1?s:l:0;j&&(nn[g]=nn[qi[N]]=j),c=N;break}}else{if(qi.length==189)break;qi[c++]=g,qi[c++]=b,qi[c++]=h}else if((T=nn[g])==2||T==1){let N=T==l;h=N?0:1;for(let D=c-3;D>=0;D-=3){let j=qi[D+2];if(j&2)break;if(N)qi[D+2]|=2;else{if(j&4)break;qi[D+2]|=4}}}}}function WE(n,e,t,r){for(let l=0,s=r;l<=t.length;l++){let o=l?t[l-1].to:n,c=l<t.length?t[l].from:e;for(let h=o;h<c;){let d=nn[h];if(d==256){let p=h+1;for(;;)if(p==c){if(l==t.length)break;p=t[l++].to,c=l<t.length?t[l].from:e}else if(nn[p]==256)p++;else break;let g=s==1,b=(p<e?nn[p]:r)==1,w=g==b?g?1:2:r;for(let T=p,N=l,D=N?t[N-1].to:n;T>h;)T==D&&(T=t[--N].from,D=N?t[N-1].to:n),nn[--T]=w;h=p}else s=d,h++}}}function Xg(n,e,t,r,l,s,o){let c=r%2?2:1;if(r%2==l%2)for(let h=e,d=0;h<t;){let p=!0,g=!1;if(d==s.length||h<s[d].from){let N=nn[h];N!=c&&(p=!1,g=N==16)}let b=!p&&c==1?[]:null,w=p?r:r+1,T=h;e:for(;;)if(d<s.length&&T==s[d].from){if(g)break e;let N=s[d];if(!p)for(let D=N.to,j=d+1;;){if(D==t)break e;if(j<s.length&&s[j].from==D)D=s[j++].to;else{if(nn[D]==c)break e;break}}if(d++,b)b.push(N);else{N.from>h&&o.push(new Dl(h,N.from,w));let D=N.direction==ws!=!(w%2);$g(n,D?r+1:r,l,N.inner,N.from,N.to,o),h=N.to}T=N.to}else{if(T==t||(p?nn[T]!=c:nn[T]==c))break;T++}b?Xg(n,h,T,r+1,l,b,o):h<T&&o.push(new Dl(h,T,w)),h=T}else for(let h=t,d=s.length;h>e;){let p=!0,g=!1;if(!d||h>s[d-1].to){let N=nn[h-1];N!=c&&(p=!1,g=N==16)}let b=!p&&c==1?[]:null,w=p?r:r+1,T=h;e:for(;;)if(d&&T==s[d-1].to){if(g)break e;let N=s[--d];if(!p)for(let D=N.from,j=d;;){if(D==e)break e;if(j&&s[j-1].to==D)D=s[--j].from;else{if(nn[D-1]==c)break e;break}}if(b)b.push(N);else{N.to<h&&o.push(new Dl(N.to,h,w));let D=N.direction==ws!=!(w%2);$g(n,D?r+1:r,l,N.inner,N.from,N.to,o),h=N.from}T=N.from}else{if(T==e||(p?nn[T-1]!=c:nn[T-1]==c))break;T--}b?Xg(n,T,h,r+1,l,b,o):T<h&&o.push(new Dl(T,h,w)),h=T}}function $g(n,e,t,r,l,s,o){let c=e%2?2:1;XE(n,l,s,r,c),$E(n,l,s,r,c),WE(l,s,r,c),Xg(n,l,s,e,t,r,o)}function ZE(n,e,t){if(!n)return[new Dl(0,0,e==q0?1:0)];if(e==ws&&!t.length&&!QE.test(n))return Iw(n.length);if(t.length)for(;n.length>nn.length;)nn[nn.length]=256;let r=[],l=e==ws?0:1;return $g(n,l,l,t,0,n.length,r),r}function Iw(n){return[new Dl(0,n,0)]}let Pw="";function JE(n,e,t,r,l){var s;let o=r.head-n.from,c=Dl.find(e,o,(s=r.bidiLevel)!==null&&s!==void 0?s:-1,r.assoc),h=e[c],d=h.side(l,t);if(o==d){let b=c+=l?1:-1;if(b<0||b>=e.length)return null;h=e[c=b],o=h.side(!l,t),d=h.side(l,t)}let p=qn(n.text,o,h.forward(l,t));(p<h.from||p>h.to)&&(p=d),Pw=n.text.slice(Math.min(o,p),Math.max(o,p));let g=c==(l?e.length-1:0)?null:e[c+(l?1:-1)];return g&&p==d&&g.level+(l?0:1)<h.level?Oe.cursor(g.side(!l,t)+n.from,g.forward(l,t)?1:-1,g.level):Oe.cursor(p+n.from,h.forward(l,t)?-1:1,h.level)}function eN(n,e,t){for(let r=e;r<t;r++){let l=Lw(n.charCodeAt(r));if(l==1)return ws;if(l==2||l==4)return q0}return ws}const Hw=ct.define(),qw=ct.define(),Uw=ct.define(),Fw=ct.define(),Wg=ct.define(),Vw=ct.define(),Kw=ct.define(),U0=ct.define(),F0=ct.define(),Gw=ct.define({combine:n=>n.some(e=>e)}),tN=ct.define({combine:n=>n.some(e=>e)}),Yw=ct.define();class Ro{constructor(e,t="nearest",r="nearest",l=5,s=5,o=!1){this.range=e,this.y=t,this.x=r,this.yMargin=l,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new Ro(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ro(Oe.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const hf=fn.define({map:(n,e)=>n.map(e)}),Qw=fn.define();function Qi(n,e,t){let r=n.facet(Fw);r.length?r[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const _l=ct.define({combine:n=>n.length?n[0]:!0});let nN=0;const To=ct.define({combine(n){return n.filter((e,t)=>{for(let r=0;r<t;r++)if(n[r].plugin==e.plugin)return!1;return!0})}});class Si{constructor(e,t,r,l,s){this.id=e,this.create=t,this.domEventHandlers=r,this.domEventObservers=l,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(To.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(To.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:r,eventObservers:l,provide:s,decorations:o}=t||{};return new Si(nN++,e,r,l,c=>{let h=[];return o&&h.push(Td.of(d=>{let p=d.plugin(c);return p?o(p):Nn.none})),s&&h.push(s(c)),h})}static fromClass(e,t){return Si.define((r,l)=>new e(r,l),t)}}class Vm{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(r){if(Qi(t.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){Qi(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(r){Qi(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Xw=ct.define(),V0=ct.define(),Td=ct.define(),$w=ct.define(),K0=ct.define(),Uc=ct.define(),Ww=ct.define();function n1(n,e){let t=n.state.facet(Ww);if(!t.length)return t;let r=t.map(s=>s instanceof Function?s(n):s),l=[];return Kt.spans(r,e.from,e.to,{point(){},span(s,o,c,h){let d=s-e.from,p=o-e.from,g=l;for(let b=c.length-1;b>=0;b--,h--){let w=c[b].spec.bidiIsolate,T;if(w==null&&(w=eN(e.text,d,p)),h>0&&g.length&&(T=g[g.length-1]).to==d&&T.direction==w)T.to=p,g=T.inner;else{let N={from:d,to:p,direction:w,inner:[]};g.push(N),g=N.inner}}}}),l}const Zw=ct.define();function Jw(n){let e=0,t=0,r=0,l=0;for(let s of n.state.facet(Zw)){let o=s(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(r=Math.max(r,o.top)),o.bottom!=null&&(l=Math.max(l,o.bottom)))}return{left:e,right:t,top:r,bottom:l}}const fc=ct.define();class si{constructor(e,t,r,l){this.fromA=e,this.toA=t,this.fromB=r,this.toB=l}join(e){return new si(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let l=e[t-1];if(!(l.fromA>r.toA)){if(l.toA<r.fromA)break;r=r.join(l),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(t.length==0)return e;let r=[];for(let l=0,s=0,o=0;;){let c=l<e.length?e[l].fromB:1e9,h=s<t.length?t[s]:1e9,d=Math.min(c,h);if(d==1e9)break;let p=d+o,g=d,b=p;for(;;)if(s<t.length&&t[s]<=g){let w=t[s+1];s+=2,g=Math.max(g,w);for(let T=l;T<e.length&&e[T].fromB<=g;T++)o=e[T].toA-e[T].toB;b=Math.max(b,w+o)}else if(l<e.length&&e[l].fromB<=g){let w=e[l++];g=Math.max(g,w.toB),b=Math.max(b,w.toA),o=w.toA-w.toB}else break;r.push(new si(p,b,d,g))}return r}}class $f{constructor(e,t,r){this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=Hn.empty(this.startState.doc.length);for(let s of r)this.changes=this.changes.compose(s.changes);let l=[];this.changes.iterChangedRanges((s,o,c,h)=>l.push(new si(s,o,c,h))),this.changedRanges=l}static create(e,t,r){return new $f(e,t,r)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const rN=[];class zn{constructor(e,t,r=0){this.dom=e,this.length=t,this.flags=r,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return rN}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let t=this.domAttrs;t&&zE(this.dom,t)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,t=this.posAtStart){let r=t;for(let l of this.children){if(l==e)return r;r+=l.length+l.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let r=_a(this.dom),l=this.length?e>0:t>0;return new ki(this.parent.dom,r+(l?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof Nd)return e;return null}static get(e){return e.cmTile}}class Ed extends zn{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let t=this.dom,r=null,l,s=e?.node==t?e:null,o=0;for(let c of this.children){if(c.sync(e),o+=c.length+c.breakAfter,l=r?r.nextSibling:t.firstChild,s&&l!=c.dom&&(s.written=!0),c.dom.parentNode==t)for(;l&&l!=c.dom;)l=r1(l);else t.insertBefore(c.dom,l);r=c.dom}for(l=r?r.nextSibling:t.firstChild,s&&l&&(s.written=!0);l;)l=r1(l);this.length=o}}function r1(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Nd extends Ed{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=zn.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],r=this,l=0,s=0;;)if(l==r.children.length){if(!t.length)return;r=r.parent,r.breakAfter&&s++,l=t.pop()}else{let o=r.children[l++];if(o instanceof Ta)t.push(l),r=o,l=0;else{let c=s+o.length,h=e(o,s);if(h!==void 0)return h;s=c+o.breakAfter}}}resolveBlock(e,t){let r,l=-1,s,o=-1;if(this.blockTiles((c,h)=>{let d=h+c.length;if(e>=h&&e<=d){if(c.isWidget()&&t>=-1&&t<=1){if(c.flags&32)return!0;c.flags&16&&(r=void 0)}(h<e||e==d&&(t<-1?c.length:c.covers(1)))&&(!r||!c.isWidget()&&r.isWidget())&&(r=c,l=e-h),(d>e||e==h&&(t>1?c.length:c.covers(-1)))&&(!s||!c.isWidget()&&s.isWidget())&&(s=c,o=e-h)}}),!r&&!s)throw new Error("No tile at position "+e);return r&&t<0||!s?{tile:r,offset:l}:{tile:s,offset:o}}}class Ta extends Ed{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,t){let r=new Ta(t||document.createElement(e.tagName),e);return t||(r.flags|=4),r}}class qo extends Ed{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,r){let l=new qo(t||document.createElement("div"),e);return(!t||!r)&&(l.flags|=4),l}get domAttrs(){return this.attrs}resolveInline(e,t,r){let l=null,s=-1,o=null,c=-1;function h(p,g){for(let b=0,w=0;b<p.children.length&&w<=g;b++){let T=p.children[b],N=w+T.length;N>=g&&(T.isComposite()?h(T,g-w):(!o||o.isHidden&&(t>0||r&&lN(o,T)))&&(N>g||T.flags&32)?(o=T,c=g-w):(w<g||T.flags&16&&!T.isHidden)&&(l=T,s=g-w)),w=N}}h(this,e);let d=(t<0?l:o)||l||o;return d?{tile:d,offset:d==l?s:c}:null}coordsIn(e,t){let r=this.resolveInline(e,t,!0);return r?r.tile.coordsIn(Math.max(0,r.offset),t):iN(this)}domIn(e,t){let r=this.resolveInline(e,t);if(r){let{tile:l,offset:s}=r;if(this.dom.contains(l.dom))return l.isText()?new ki(l.dom,Math.min(l.dom.nodeValue.length,s)):l.domPosFor(s,l.flags&16?1:l.flags&32?-1:t);let o=r.tile.parent,c=!1;for(let h of o.children){if(c)return new ki(h.dom,0);h==r.tile&&(c=!0)}}return new ki(this.dom,0)}}function iN(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=Bf(e);return t[t.length-1]||null}function lN(n,e){let t=n.coordsIn(0,1),r=e.coordsIn(0,1);return t&&r&&r.top<t.bottom}class Mr extends Ed{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let r=new Mr(t||document.createElement(e.tagName),e);return t||(r.flags|=4),r}}class ys extends zn{constructor(e,t){super(e,t.length),this.text=t}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let r=this.dom.nodeValue.length;e>r&&(e=r);let l=e,s=e,o=0;e==0&&t<0||e==r&&t>=0?Ze.chrome||Ze.gecko||(e?(l--,o=1):s<r&&(s++,o=-1)):t<0?l--:s<r&&s++;let c=Oc(this.dom,l,s).getClientRects();if(!c.length)return null;let h=c[(o?o<0:t>=0)?0:c.length-1];return Ze.safari&&!o&&h.width==0&&(h=Array.prototype.find.call(c,d=>d.width)||h),o?Xf(h,o<0):h||null}static of(e,t){let r=new ys(t||document.createTextNode(e),e);return t||(r.flags|=2),r}}class Ss extends zn{constructor(e,t,r,l){super(e,t,l),this.widget=r}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,r){let l=this.widget.coordsAt(this.dom,e,t);if(l)return l;if(r)return Xf(this.dom.getBoundingClientRect(),this.length?e==0:t<=0);{let s=this.dom.getClientRects(),o=null;if(!s.length)return null;let c=this.flags&16?!0:this.flags&32?!1:e>0;for(let h=c?s.length-1:0;o=s[h],!(e>0?h==0:h==s.length-1||o.top<o.bottom);h+=c?-1:1);return Xf(o,!c)}}get overrideDOMText(){if(!this.length)return Lt.empty;let{root:e}=this;if(!e)return Lt.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,r,l,s){return s||(s=e.toDOM(t),e.editable||(s.contentEditable="false")),new Ss(s,r,e,l)}}class Wf extends zn{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!0}get overrideDOMText(){return Lt.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class aN{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,r){let{tile:l,index:s,beforeBreak:o,parents:c}=this;for(;e||t>0;)if(l.isComposite())if(o){if(!e)break;r&&r.break(),e--,o=!1}else if(s==l.children.length){if(!e&&!c.length)break;r&&r.leave(l),o=!!l.breakAfter,{tile:l,index:s}=c.pop(),s++}else{let h=l.children[s],d=h.breakAfter;(t>0?h.length<=e:h.length<e)&&(!r||r.skip(h,0,h.length)!==!1||!h.isComposite)?(o=!!d,s++,e-=h.length):(c.push({tile:l,index:s}),l=h,s=0,r&&h.isComposite()&&r.enter(h))}else if(s==l.length)o=!!l.breakAfter,{tile:l,index:s}=c.pop(),s++;else if(e){let h=Math.min(e,l.length-s);r&&r.skip(l,s,s+h),e-=h,s+=h}else break;return this.tile=l,this.index=s,this.beforeBreak=o,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class sN{constructor(e,t,r,l){this.from=e,this.to=t,this.wrapper=r,this.rank=l}}class oN{constructor(e,t,r){this.cache=e,this.root=t,this.blockWrappers=r,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,r,l){var s;this.flushBuffer();let o=this.ensureMarks(t,r),c=o.lastChild;if(c&&c.isText()&&!(c.flags&8)&&c.length+e.length<512){this.cache.reused.set(c,2);let h=o.children[o.children.length-1]=new ys(c.dom,c.text+e);h.parent=o}else o.append(l||ys.of(e,(s=this.cache.find(ys))===null||s===void 0?void 0:s.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let r=this.curLine;r.dom!=t.line.dom&&(r.setDOM(this.cache.reused.has(t.line)?Km(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let l=r;for(let c=t.marks.length-1;c>=0;c--){let h=t.marks[c],d=l.lastChild;if(d instanceof Mr&&d.mark.eq(h.mark))d.dom!=h.dom&&d.setDOM(Km(h.dom)),l=d;else{if(this.cache.reused.get(h)){let g=zn.get(h.dom);g&&g.setDOM(Km(h.dom))}let p=Mr.of(h.mark,h.dom);l.append(p),l=p}this.cache.reused.set(h,2)}let s=zn.get(e.text);s&&this.cache.reused.set(s,2);let o=new ys(e.text,e.text.nodeValue);o.flags|=8,l.append(o)}addInlineWidget(e,t,r){let l=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);l||this.flushBuffer();let s=this.ensureMarks(t,r);!l&&!(e.flags&16)&&s.append(this.getBuffer(1)),s.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,r){this.flushBuffer(),this.ensureMarks(t,r).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let t=this.afterWidget||this.lastBlock;t.length+=e,this.pos+=e}addLineStart(e,t){var r;e||(e=eS);let l=qo.start(e,t||((r=this.cache.find(qo))===null||r===void 0?void 0:r.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=l)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var r;let l=this.curLine;for(let s=e.length-1;s>=0;s--){let o=e[s],c;if(t>0&&(c=l.lastChild)&&c instanceof Mr&&c.mark.eq(o))l=c,t--;else{let h=Mr.of(o,(r=this.cache.find(Mr,d=>d.mark.eq(o)))===null||r===void 0?void 0:r.dom);l.append(h),l=h,t=0}}return l}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!i1(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(Ze.ios&&i1(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(Gm,0,32)||new Ss(Gm.toDOM(),0,Gm,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new sN(e.from,e.to,e.value,e.rank),r=this.wrappers.length;for(;r>0&&(this.wrappers[r-1].rank-t.rank||this.wrappers[r-1].to-t.to)<0;)r--;this.wrappers.splice(r,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let r of this.wrappers){let l=t.lastChild;if(r.from<this.pos&&l instanceof Ta&&l.wrapper.eq(r.wrapper))t=l;else{let s=Ta.of(r.wrapper,(e=this.cache.find(Ta,o=>o.wrapper.eq(r.wrapper)))===null||e===void 0?void 0:e.dom);t.append(s),t=s}}return t}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let t=2|(e<0?16:32),r=this.cache.find(Wf,void 0,1);return r&&(r.flags=t),r||new Wf(t)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class uN{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:l,lineBreak:s,done:o}=this.cursor.next(this.skipCount);if(this.skipCount=0,o)throw new Error("Ran out of text content when drawing inline views");this.text=l;let c=this.textOff=Math.min(e,l.length);return s?null:l.slice(0,c)}let t=Math.min(this.text.length,this.textOff+e),r=this.text.slice(this.textOff,t);return this.textOff=t,r}}const Zf=[Ss,qo,ys,Mr,Wf,Ta,Nd];for(let n=0;n<Zf.length;n++)Zf[n].bucket=n;class cN{constructor(e){this.view=e,this.buckets=Zf.map(()=>[]),this.index=Zf.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,r=this.buckets[t];r.length<6?r.push(e):r[this.index[t]=(this.index[t]+1)%6]=e}find(e,t,r=2){let l=e.bucket,s=this.buckets[l],o=this.index[l];for(let c=s.length-1;c>=0;c--){let h=(c+o)%s.length,d=s[h];if((!t||t(d))&&!this.reused.has(d))return s.splice(h,1),h<o&&this.index[l]--,this.reused.set(d,r),d}return null}findWidget(e,t,r){let l=this.buckets[0];if(l.length)for(let s=0,o=0;;s++){if(s==l.length){if(o)return null;o=1,s=0}let c=l[s];if(!this.reused.has(c)&&(o==0?c.widget.compare(e):c.widget.constructor==e.constructor&&e.updateDOM(c.dom,this.view)))return l.splice(s,1),s<this.index[0]&&this.index[0]--,c.widget==e&&c.length==t&&(c.flags&497)==r?(this.reused.set(c,1),c):(this.reused.set(c,2),new Ss(c.dom,t,e,c.flags&-498|r))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,t=2){if(!this.reused.has(e))return this.reused.set(e,t),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class hN{constructor(e,t,r,l,s){this.view=e,this.decorations=l,this.disallowBlockEffectsFor=s,this.openWidget=!1,this.openMarks=0,this.cache=new cN(e),this.text=new uN(e.state.doc),this.builder=new oN(this.cache,new Nd(e,e.contentDOM),Kt.iter(r)),this.cache.reused.set(t,2),this.old=new aN(t),this.reuseWalker={skip:(o,c,h)=>{if(this.cache.add(o),o.isComposite())return!1},enter:o=>this.cache.add(o),leave:()=>{},break:()=>{}}}run(e,t){let r=t&&this.getCompositionContext(t.text);for(let l=0,s=0,o=0;;){let c=o<e.length?e[o++]:null,h=c?c.fromA:this.old.root.length;if(h>l){let d=h-l;this.preserve(d,!o,!c),l=h,s+=d}if(!c)break;t&&c.fromA<=t.range.fromA&&c.toA>=t.range.toA?(this.forward(c.fromA,t.range.fromA,t.range.fromA<t.range.toA?1:-1),this.emit(s,t.range.fromB),this.cache.clear(),this.builder.addComposition(t,r),this.text.skip(t.range.toB-t.range.fromB),this.forward(t.range.fromA,c.toA),this.emit(t.range.toB,c.toB)):(this.forward(c.fromA,c.toA),this.emit(s,c.toB)),s=c.toB,l=c.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,r){let l=pN(this.old),s=this.openMarks;this.old.advance(e,r?1:-1,{skip:(o,c,h)=>{if(o.isWidget())if(this.openWidget)this.builder.continueWidget(h-c);else{let d=h>0||c<o.length?Ss.of(o.widget,this.view,h-c,o.flags&496,this.cache.maybeReuse(o)):this.cache.reuse(o);d.flags&256?(d.flags&=-2,this.builder.addBlockWidget(d)):(this.builder.ensureLine(null),this.builder.addInlineWidget(d,l,s),s=l.length)}else if(o.isText())this.builder.ensureLine(null),!c&&h==o.length?this.builder.addText(o.text,l,s,this.cache.reuse(o)):(this.cache.add(o),this.builder.addText(o.text.slice(c,h),l,s)),s=l.length;else if(o.isLine())o.flags&=-2,this.cache.reused.set(o,1),this.builder.addLine(o);else if(o instanceof Wf)this.cache.add(o);else if(o instanceof Mr)this.builder.ensureLine(null),this.builder.addMark(o,l,s),this.cache.reused.set(o,1),s=l.length;else return!1;this.openWidget=!1},enter:o=>{o.isLine()?this.builder.addLineStart(o.attrs,this.cache.maybeReuse(o)):(this.cache.add(o),o instanceof Mr&&l.unshift(o.mark)),this.openWidget=!1},leave:o=>{o.isLine()?l.length&&(l.length=s=0):o instanceof Mr&&(l.shift(),s=Math.min(s,l.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let r=null,l=this.builder,s=0,o=Kt.spans(this.decorations,e,t,{point:(c,h,d,p,g,b)=>{if(d instanceof ks){if(this.disallowBlockEffectsFor[b]){if(d.block)throw new RangeError("Block decorations may not be specified via plugins");if(h>this.view.state.doc.lineAt(c).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(s=p.length,g>p.length)l.continueWidget(h-c);else{let w=d.widget||(d.block?Uo.block:Uo.inline),T=fN(d),N=this.cache.findWidget(w,h-c,T)||Ss.of(w,this.view,h-c,T);d.block?(d.startSide>0&&l.addLineStartIfNotCovered(r),l.addBlockWidget(N)):(l.ensureLine(r),l.addInlineWidget(N,p,g))}r=null}else r=dN(r,d);h>c&&this.text.skip(h-c)},span:(c,h,d,p)=>{for(let g=c;g<h;){let b=this.text.next(Math.min(512,h-g));b==null?(l.addLineStartIfNotCovered(r),l.addBreak(),g++):(l.ensureLine(r),l.addText(b,d,g==c?p:d.length),g+=b.length),r=null}}});l.addLineStartIfNotCovered(r),this.openWidget=o>s,this.openMarks=o}forward(e,t,r=1){t-e<=10?this.old.advance(t-e,r,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(t-e-10,-1),this.old.advance(5,r,this.reuseWalker))}getCompositionContext(e){let t=[],r=null;for(let l=e.parentNode;;l=l.parentNode){let s=zn.get(l);if(l==this.view.contentDOM)break;s instanceof Mr?t.push(s):s?.isLine()?r=s:l.nodeName=="DIV"&&!r&&l!=this.view.contentDOM?r=new qo(l,eS):t.push(Mr.of(new Hc({tagName:l.nodeName.toLowerCase(),attributes:IE(l)}),l))}return{line:r,marks:t}}}function i1(n,e){let t=r=>{for(let l of r.children)if((e?l.isText():l.length)||t(l))return!0;return!1};return t(n)}function fN(n){let e=n.isReplace?(n.startSide<0?64:0)|(n.endSide>0?128:0):n.startSide>0?32:16;return n.block&&(e|=256),e}const eS={class:"cm-line"};function dN(n,e){let t=e.spec.attributes,r=e.spec.class;return!t&&!r||(n||(n={class:"cm-line"}),t&&P0(t,n),r&&(n.class+=" "+r)),n}function pN(n){let e=[];for(let t=n.parents.length;t>1;t--){let r=t==n.parents.length?n.tile:n.parents[t].tile;r instanceof Mr&&e.push(r.mark)}return e}function Km(n){let e=zn.get(n);return e&&e.setDOM(n.cloneNode()),n}class Uo extends Ad{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Uo.inline=new Uo("span");Uo.block=new Uo("div");const Gm=new class extends Ad{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class l1{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=Nn.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new Nd(e,e.contentDOM),this.updateInner([new si(0,0,0,e.state.doc.length)],null)}update(e){var t;let r=e.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:p,toA:g})=>g<this.minWidthFrom||p>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let l=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?l=this.domChanged.newSel.head:!SN(e.changes,this.hasComposition)&&!e.selectionSet&&(l=e.state.selection.main.head));let s=l>-1?gN(this.view,e.changes,l):null;if(this.domChanged=null,this.hasComposition){let{from:p,to:g}=this.hasComposition;r=new si(p,g,e.changes.mapPos(p,-1),e.changes.mapPos(g,1)).addToSet(r.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Ze.ie||Ze.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,c=this.blockWrappers;this.updateDeco();let h=vN(o,this.decorations,e.changes);h.length&&(r=si.extendWithRanges(r,h));let d=kN(c,this.blockWrappers,e.changes);return d.length&&(r=si.extendWithRanges(r,d)),s&&!r.some(p=>p.fromA<=s.range.fromA&&p.toA>=s.range.toA)&&(r=s.range.addToSet(r.slice())),this.tile.flags&2&&r.length==0?!1:(this.updateInner(r,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:r}=this.view;r.ignore(()=>{if(t||e.length){let o=this.tile,c=new hN(this.view,o,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=c.run(e,t),Zg(o,c.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=Ze.chrome||Ze.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(s),s&&(s.written||r.selectionRange.focusNode!=s.node||!this.tile.dom.contains(s.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let l=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.tile.children)s.isWidget()&&s.widget instanceof Ym&&l.push(s.dom);r.updateGaps(l)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let r of t.effects)r.is(Qw)&&(this.editContextFormatting=r.value)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:r}=this.tile,l=this.view.root.activeElement,s=l==r,o=!s&&!(this.view.state.facet(_l)||r.tabIndex>-1)&&xc(r,this.view.observer.selectionRange)&&!(l&&r.contains(l));if(!(s||t||o))return;let c=this.forceSelection;this.forceSelection=!1;let h=this.view.state.selection.main,d,p;if(h.empty?p=d=this.inlineDOMNearPos(h.anchor,h.assoc||1):(p=this.inlineDOMNearPos(h.head,h.head==h.from?1:-1),d=this.inlineDOMNearPos(h.anchor,h.anchor==h.from?1:-1)),Ze.gecko&&h.empty&&!this.hasComposition&&mN(d)){let b=document.createTextNode("");this.view.observer.ignore(()=>d.node.insertBefore(b,d.node.childNodes[d.offset]||null)),d=p=new ki(b,0),c=!0}let g=this.view.observer.selectionRange;(c||!g.focusNode||(!vc(d.node,d.offset,g.anchorNode,g.anchorOffset)||!vc(p.node,p.offset,g.focusNode,g.focusOffset))&&!this.suppressWidgetCursorChange(g,h))&&(this.view.observer.ignore(()=>{Ze.android&&Ze.chrome&&r.contains(g.focusNode)&&wN(g.focusNode,r)&&(r.blur(),r.focus({preventScroll:!0}));let b=Ho(this.view.root);if(b)if(h.empty){if(Ze.gecko){let w=yN(d.node,d.offset);if(w&&w!=3){let T=(w==1?Ow:Rw)(d.node,d.offset);T&&(d=new ki(T.node,T.offset))}}b.collapse(d.node,d.offset),h.bidiLevel!=null&&b.caretBidiLevel!==void 0&&(b.caretBidiLevel=h.bidiLevel)}else if(b.extend){b.collapse(d.node,d.offset);try{b.extend(p.node,p.offset)}catch{}}else{let w=document.createRange();h.anchor>h.head&&([d,p]=[p,d]),w.setEnd(p.node,p.offset),w.setStart(d.node,d.offset),b.removeAllRanges(),b.addRange(w)}o&&this.view.root.activeElement==r&&(r.blur(),l&&l.focus())}),this.view.observer.setSelectionRange(d,p)),this.impreciseAnchor=d.precise?null:new ki(g.anchorNode,g.anchorOffset),this.impreciseHead=p.precise?null:new ki(g.focusNode,g.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&vc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,r=Ho(e.root),{anchorNode:l,anchorOffset:s}=e.observer.selectionRange;if(!r||!t.empty||!t.assoc||!r.modify)return;let o=this.lineAt(t.head,t.assoc);if(!o)return;let c=o.posAtStart;if(t.head==c||t.head==c+o.length)return;let h=this.coordsAt(t.head,-1),d=this.coordsAt(t.head,1);if(!h||!d||h.bottom>d.top)return;let p=this.domAtPos(t.head+t.assoc,t.assoc);r.collapse(p.node,p.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let g=e.observer.selectionRange;e.docView.posFromDOM(g.anchorNode,g.anchorOffset)!=t.from&&r.collapse(l,s)}posFromDOM(e,t){let r=this.tile.nearest(e);if(!r)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let l=r.posAtStart;if(r.isComposite()){let s;if(e==r.dom)s=r.dom.childNodes[t];else{let o=Rl(e)==0?0:t==0?-1:1;for(;;){let c=e.parentNode;if(c==r.dom)break;o==0&&c.firstChild!=c.lastChild&&(e==c.firstChild?o=-1:o=1),e=c}o<0?s=e:s=e.nextSibling}if(s==r.dom.firstChild)return l;for(;s&&!zn.get(s);)s=s.nextSibling;if(!s)return l+r.length;for(let o=0,c=l;;o++){let h=r.children[o];if(h.dom==s)return c;c+=h.length+h.breakAfter}}else return r.isText()?e==r.dom?l+t:l+(t?r.length:0):l}domAtPos(e,t){let{tile:r,offset:l}=this.tile.resolveBlock(e,t);return r.isWidget()?r.domPosFor(e,t):r.domIn(l,t)}inlineDOMNearPos(e,t){let r,l=-1,s=!1,o,c=-1,h=!1;return this.tile.blockTiles((d,p)=>{if(d.isWidget()){if(d.flags&32&&p>=e)return!0;d.flags&16&&(s=!0)}else{let g=p+d.length;if(p<=e&&(r=d,l=e-p,s=g<e),g>=e&&!o&&(o=d,c=e-p,h=p>e),p>e&&o)return!0}}),!r&&!o?this.domAtPos(e,t):(s&&o?r=null:h&&r&&(o=null),r&&t<0||!o?r.domIn(l,t):o.domIn(c,t))}coordsAt(e,t){let{tile:r,offset:l}=this.tile.resolveBlock(e,t);return r.isWidget()?r.widget instanceof Ym?null:r.coordsInWidget(l,t,!0):r.coordsIn(l,t)}lineAt(e,t){let{tile:r}=this.tile.resolveBlock(e,t);return r.isLine()?r:null}coordsForChar(e){let{tile:t,offset:r}=this.tile.resolveBlock(e,1);if(!t.isLine())return null;function l(s,o){if(s.isComposite())for(let c of s.children){if(c.length>=o){let h=l(c,o);if(h)return h}if(o-=c.length,o<0)break}else if(s.isText()&&o<s.length){let c=qn(s.text,o);if(c==o)return null;let h=Oc(s.dom,o,c).getClientRects();for(let d=0;d<h.length;d++){let p=h[d];if(d==h.length-1||p.top<p.bottom&&p.left<p.right)return p}}return null}return l(t,r)}measureVisibleLineHeights(e){let t=[],{from:r,to:l}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,c=-1,h=this.view.textDirection==Ln.LTR,d=0,p=(g,b,w)=>{for(let T=0;T<g.children.length&&!(b>l);T++){let N=g.children[T],D=b+N.length,j=N.dom.getBoundingClientRect(),{height:U}=j;if(w&&!T&&(d+=j.top-w.top),N instanceof Ta)D>r&&p(N,b,j);else if(b>=r&&(d>0&&t.push(-d),t.push(U+d),d=0,o)){let I=N.dom.lastChild,ce=I?Bf(I):[];if(ce.length){let F=ce[ce.length-1],z=h?F.right-j.left:j.right-F.left;z>c&&(c=z,this.minWidth=s,this.minWidthFrom=b,this.minWidthTo=D)}}w&&T==g.children.length-1&&(d+=w.bottom-j.bottom),b=D+N.breakAfter}};return p(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return getComputedStyle(t.dom).direction=="rtl"?Ln.RTL:Ln.LTR}measureTextSize(){let e=this.tile.blockTiles(o=>{if(o.isLine()&&o.children.length&&o.length<=20){let c=0,h;for(let d of o.children){if(!d.isText()||/[^ -~]/.test(d.text))return;let p=Bf(d.dom);if(p.length!=1)return;c+=p[0].width,h=p[0].height}if(c)return{lineHeight:o.dom.getBoundingClientRect().height,charWidth:c/o.length,textHeight:h}}});if(e)return e;let t=document.createElement("div"),r,l,s;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(t);let o=Bf(t.firstChild)[0];r=t.getBoundingClientRect().height,l=o&&o.width?o.width/27:7,s=o&&o.height?o.height:r,t.remove()}),{lineHeight:r,charWidth:l,textHeight:s}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,l=0;;l++){let s=l==t.viewports.length?null:t.viewports[l],o=s?s.from-1:this.view.state.doc.length;if(o>r){let c=(t.lineBlockAt(o).bottom-t.lineBlockAt(r).top)/this.view.scaleY;e.push(Nn.replace({widget:new Ym(c),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!s)break;r=s.to+1}return Nn.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Td).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),r=!1,l=this.view.state.facet(K0).map((s,o)=>{let c=typeof s=="function";return c&&(r=!0),c?s(this.view):s});for(l.length&&(this.dynamicDecorationMap[e++]=r,t.push(Kt.join(l))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet($w).map(s=>typeof s=="function"?s(this.view):s)}scrollIntoView(e){if(e.isSnapshot){let d=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=d.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let d of this.view.state.facet(Yw))try{if(d(this.view,e.range,e))return!0}catch(p){Qi(this.view.state,p,"scroll handler")}let{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),l;if(!r)return;!t.empty&&(l=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,l.left),top:Math.min(r.top,l.top),right:Math.max(r.right,l.right),bottom:Math.max(r.bottom,l.bottom)});let s=Jw(this.view),o={left:r.left-s.left,top:r.top-s.top,right:r.right+s.right,bottom:r.bottom+s.bottom},{offsetWidth:c,offsetHeight:h}=this.view.scrollDOM;qE(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,c),-c),Math.max(Math.min(e.yMargin,h),-h),this.view.textDirection==Ln.LTR)}lineHasWidget(e){let t=r=>r.isWidget()||r.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){Zg(this.tile)}}function Zg(n,e){let t=e?.get(n);if(t!=1){t==null&&n.destroy();for(let r of n.children)Zg(r,e)}}function mN(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function tS(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let r=Ow(t.focusNode,t.focusOffset),l=Rw(t.focusNode,t.focusOffset),s=r||l;if(l&&r&&l.node!=r.node){let c=zn.get(l.node);if(!c||c.isText()&&c.text!=l.node.nodeValue)s=l;else if(n.docView.lastCompositionAfterCursor){let h=zn.get(r.node);!h||h.isText()&&h.text!=r.node.nodeValue||(s=l)}}if(n.docView.lastCompositionAfterCursor=s!=r,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function gN(n,e,t){let r=tS(n,t);if(!r)return null;let{node:l,from:s,to:o}=r,c=l.nodeValue;if(/[\n\r]/.test(c)||n.state.doc.sliceString(r.from,r.to)!=c)return null;let h=e.invertedDesc;return{range:new si(h.mapPos(s),h.mapPos(o),s,o),text:l}}function yN(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let xN=class{constructor(){this.changes=[]}compareRange(e,t){jo(e,t,this.changes)}comparePoint(e,t){jo(e,t,this.changes)}boundChange(e){jo(e,e,this.changes)}};function vN(n,e,t){let r=new xN;return Kt.compare(n,e,t,r),r.changes}class bN{constructor(){this.changes=[]}compareRange(e,t){jo(e,t,this.changes)}comparePoint(){}boundChange(e){jo(e,e,this.changes)}}function kN(n,e,t){let r=new bN;return Kt.compare(n,e,t,r),r.changes}function wN(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function SN(n,e){let t=!1;return e&&n.iterChangedRanges((r,l)=>{r<e.to&&l>e.from&&(t=!0)}),t}class Ym extends Ad{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function CN(n,e,t=1){let r=n.charCategorizer(e),l=n.doc.lineAt(e),s=e-l.from;if(l.length==0)return Oe.cursor(e);s==0?t=1:s==l.length&&(t=-1);let o=s,c=s;t<0?o=qn(l.text,s,!1):c=qn(l.text,s);let h=r(l.text.slice(o,c));for(;o>0;){let d=qn(l.text,o,!1);if(r(l.text.slice(d,o))!=h)break;o=d}for(;c<l.length;){let d=qn(l.text,c);if(r(l.text.slice(c,d))!=h)break;c=d}return Oe.range(o+l.from,c+l.from)}function AN(n,e,t,r,l){let s=Math.round((r-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let c=n.viewState.heightOracle.textHeight,h=Math.floor((l-t.top-(n.defaultLineHeight-c)*.5)/c);s+=h*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+DE(o,s,n.state.tabSize)}function TN(n,e,t){let r=n.lineBlockAt(e);if(Array.isArray(r.type)){let l;for(let s of r.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!l||s.type==ui.Text&&(l.type!=s.type||(t<0?s.from<e:s.to>e)))&&(l=s)}}return l||r}return r}function EN(n,e,t,r){let l=TN(n,e.head,e.assoc||-1),s=!r||l.type!=ui.Text||!(n.lineWrapping||l.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>l.from?e.head-1:e.head);if(s){let o=n.dom.getBoundingClientRect(),c=n.textDirectionAt(l.from),h=n.posAtCoords({x:t==(c==Ln.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(h!=null)return Oe.cursor(h,t?-1:1)}return Oe.cursor(t?l.to:l.from,t?-1:1)}function a1(n,e,t,r){let l=n.state.doc.lineAt(e.head),s=n.bidiSpans(l),o=n.textDirectionAt(l.from);for(let c=e,h=null;;){let d=JE(l,s,o,c,t),p=Pw;if(!d){if(l.number==(t?n.state.doc.lines:1))return c;p=`
`,l=n.state.doc.line(l.number+(t?1:-1)),s=n.bidiSpans(l),d=n.visualLineSide(l,!t)}if(h){if(!h(p))return c}else{if(!r)return d;h=r(p)}c=d}}function NN(n,e,t){let r=n.state.charCategorizer(e),l=r(t);return s=>{let o=r(s);return l==ir.Space&&(l=o),l==o}}function MN(n,e,t,r){let l=e.head,s=t?1:-1;if(l==(t?n.state.doc.length:0))return Oe.cursor(l,e.assoc);let o=e.goalColumn,c,h=n.contentDOM.getBoundingClientRect(),d=n.coordsAtPos(l,e.assoc||-1),p=n.documentTop;if(d)o==null&&(o=d.left-h.left),c=s<0?d.top:d.bottom;else{let T=n.viewState.lineBlockAt(l);o==null&&(o=Math.min(h.right-h.left,n.defaultCharacterWidth*(l-T.from))),c=(s<0?T.top:T.bottom)+p}let g=h.left+o,b=r??n.viewState.heightOracle.textHeight>>1,w=Jg(n,{x:g,y:c+b*s},!1,s);return Oe.cursor(w.pos,w.assoc,void 0,o)}function bc(n,e,t){for(;;){let r=0;for(let l of n)l.between(e-1,e+1,(s,o,c)=>{if(e>s&&e<o){let h=r||t||(e-s<o-e?-1:1);e=h<0?s:o,r=h}});if(!r)return e}}function nS(n,e){let t=null;for(let r=0;r<e.ranges.length;r++){let l=e.ranges[r],s=null;if(l.empty){let o=bc(n,l.from,0);o!=l.from&&(s=Oe.cursor(o,-1))}else{let o=bc(n,l.from,-1),c=bc(n,l.to,1);(o!=l.from||c!=l.to)&&(s=Oe.range(l.from==l.anchor?o:c,l.from==l.head?o:c))}s&&(t||(t=e.ranges.slice()),t[r]=s)}return t?Oe.create(t,e.mainIndex):e}function Qm(n,e,t){let r=bc(n.state.facet(Uc).map(l=>l(n)),t.from,e.head>t.from?-1:1);return r==t.from?t:Oe.cursor(r,r<t.from?1:-1)}class Yi{constructor(e,t){this.pos=e,this.assoc=t}}function Jg(n,e,t,r){let l=n.contentDOM.getBoundingClientRect(),s=l.top+n.viewState.paddingTop,{x:o,y:c}=e,h=c-s,d;for(;;){if(h<0)return new Yi(0,1);if(h>n.viewState.docHeight)return new Yi(n.state.doc.length,-1);if(d=n.elementAtHeight(h),r==null)break;if(d.type==ui.Text){if(r<0?d.to<n.viewport.from:d.from>n.viewport.to)break;let b=n.docView.coordsAt(r<0?d.from:d.to,r);if(b&&(r<0?b.top<=h+s:b.bottom>=h+s))break}let g=n.viewState.heightOracle.textHeight/2;h=r>0?d.bottom+g:d.top-g}if(n.viewport.from>=d.to||n.viewport.to<=d.from){if(t)return null;if(d.type==ui.Text){let g=AN(n,l,d,o,c);return new Yi(g,g==d.from?1:-1)}}if(d.type!=ui.Text)return h<(d.top+d.bottom)/2?new Yi(d.from,1):new Yi(d.to,-1);let p=n.docView.lineAt(d.from,2);return(!p||p.length!=d.length)&&(p=n.docView.lineAt(d.from,-2)),rS(n,p,d.from,o,c)}function rS(n,e,t,r,l){let s=-1,o=null,c=1e9,h=1e9,d=l,p=l,g=(b,w)=>{for(let T=0;T<b.length;T++){let N=b[T];if(N.top==N.bottom)continue;let D=N.left>r?N.left-r:N.right<r?r-N.right:0,j=N.top>l?N.top-l:N.bottom<l?l-N.bottom:0;N.top<=p&&N.bottom>=d&&(d=Math.min(N.top,d),p=Math.max(N.bottom,p),j=0),(s<0||(j-h||D-c)<0)&&(s>=0&&h&&c<D&&o.top<=p-2&&o.bottom>=d+2?h=0:(s=w,c=D,h=j,o=N))}};if(e.isText()){for(let w=0;w<e.length;){let T=qn(e.text,w);if(g(Oc(e.dom,w,T).getClientRects(),w),!c&&!h)break;w=T}return r>(o.left+o.right)/2==(s1(n,s+t)==Ln.LTR)?new Yi(t+qn(e.text,s),-1):new Yi(t+s,1)}else{if(!e.length)return new Yi(t,1);for(let N=0;N<e.children.length;N++){let D=e.children[N];if(D.flags&48)continue;let j=(D.dom.nodeType==1?D.dom:Oc(D.dom,0,D.length)).getClientRects();if(g(j,N),!c&&!h)break}let b=e.children[s],w=e.posBefore(b,t);return b.isComposite()||b.isText()?rS(n,b,w,Math.max(o.left,Math.min(o.right,r)),l):r>(o.left+o.right)/2==(s1(n,s+t)==Ln.LTR)?new Yi(w+b.length,-1):new Yi(w,1)}}function s1(n,e){let t=n.state.doc.lineAt(e);return n.bidiSpans(t)[Dl.find(n.bidiSpans(t),e-t.from,-1,1)].dir}const dc="";class _N{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineSeparator=t.state.facet(Ht.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=dc}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let l=e;;){this.findPointBefore(r,l);let s=this.text.length;this.readNode(l);let o=zn.get(l),c=l.nextSibling;if(c==t){o?.breakAfter&&!c&&r!=this.view.contentDOM&&this.lineBreak();break}let h=zn.get(c);(o&&h?o.breakAfter:(o?o.breakAfter:Qf(l))||Qf(c)&&(l.nodeName!="BR"||o?.isWidget())&&this.text.length>s)&&!jN(c,t)&&this.lineBreak(),l=c}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,l=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,c;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(c=l.exec(t))&&(s=c.index,o=c[0].length),this.append(t.slice(r,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let h of this.points)h.node==e&&h.pos>this.text.length&&(h.pos-=o-1);r=s+o}}readNode(e){let t=zn.get(e),r=t&&t.overrideDOMText;if(r!=null){this.findPointInside(e,r.length);for(let l=r.iter();!l.next().done;)l.lineBreak?this.lineBreak():this.append(l.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(e.nodeType==3?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(DN(e,r.node,r.offset)?t:0))}}function DN(n,e,t){for(;;){if(!e||t<Rl(e))return!1;if(e==n)return!0;t=_a(e)+1,e=e.parentNode}}function jN(n,e){let t;for(;!(n==e||!n);n=n.nextSibling){let r=zn.get(n);if(!r?.isWidget())return!1;r&&(t||(t=[])).push(r)}if(t)for(let r of t){let l=r.overrideDOMText;if(l?.length)return!1}return!0}class o1{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class ON{constructor(e,t,r,l){this.typeOver=l,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=iS(e.docView.tile,t,r,0))){let c=s||o?[]:BN(e),h=new _N(c,e);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=LN(c,this.bounds.from)}else{let c=e.observer.selectionRange,h=s&&s.node==c.focusNode&&s.offset==c.focusOffset||!Yg(e.contentDOM,c.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(c.focusNode,c.focusOffset),d=o&&o.node==c.anchorNode&&o.offset==c.anchorOffset||!Yg(e.contentDOM,c.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(c.anchorNode,c.anchorOffset),p=e.viewport;if((Ze.ios||Ze.chrome)&&e.state.selection.main.empty&&h!=d&&(p.from>0||p.to<e.state.doc.length)){let g=Math.min(h,d),b=Math.max(h,d),w=p.from-g,T=p.to-b;(w==0||w==1||g==0)&&(T==0||T==-1||b==e.state.doc.length)&&(h=0,d=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(Oe.range(d,h)):this.newSel=Oe.single(d,h)}}}function iS(n,e,t,r){if(n.isComposite()){let l=-1,s=-1,o=-1,c=-1;for(let h=0,d=r,p=r;h<n.children.length;h++){let g=n.children[h],b=d+g.length;if(d<e&&b>t)return iS(g,e,t,d);if(b>=e&&l==-1&&(l=h,s=d),d>t&&g.dom.parentNode==n.dom){o=h,c=p;break}p=b,d=b+g.breakAfter}return{from:s,to:c<0?r+n.length:c,startDOM:(l?n.children[l-1].dom.nextSibling:null)||n.dom.firstChild,endDOM:o<n.children.length&&o>=0?n.children[o].dom:null}}else return n.isText()?{from:r,to:r+n.length,startDOM:n.dom,endDOM:n.dom.nextSibling}:null}function lS(n,e){let t,{newSel:r}=e,l=n.state.selection.main,s=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:c}=e.bounds,h=l.from,d=null;(s===8||Ze.android&&e.text.length<c-o)&&(h=l.to,d="end");let p=aS(n.state.doc.sliceString(o,c,dc),e.text,h-o,d);p&&(Ze.chrome&&s==13&&p.toB==p.from+2&&e.text.slice(p.from,p.toB)==dc+dc&&p.toB--,t={from:o+p.from,to:o+p.toA,insert:Lt.of(e.text.slice(p.from,p.toB).split(dc))})}else r&&(!n.hasFocus&&n.state.facet(_l)||Jf(r,l))&&(r=null);if(!t&&!r)return!1;if(!t&&e.typeOver&&!l.empty&&r&&r.main.empty?t={from:l.from,to:l.to,insert:n.state.doc.slice(l.from,l.to)}:(Ze.mac||Ze.android)&&t&&t.from==t.to&&t.from==l.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(r&&t.insert.length==2&&(r=Oe.single(r.main.anchor-1,r.main.head-1)),t={from:t.from,to:t.to,insert:Lt.of([t.insert.toString().replace("."," ")])}):t&&t.from>=l.from&&t.to<=l.to&&(t.from!=l.from||t.to!=l.to)&&l.to-l.from-(t.to-t.from)<=4?t={from:l.from,to:l.to,insert:n.state.doc.slice(l.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,l.to))}:n.state.doc.lineAt(l.from).to<l.to&&n.docView.lineHasWidget(l.to)&&n.inputState.insertingTextAt>Date.now()-50?t={from:l.from,to:l.to,insert:n.state.toText(n.inputState.insertingText)}:Ze.chrome&&t&&t.from==t.to&&t.from==l.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(r&&(r=Oe.single(r.main.anchor-1,r.main.head-1)),t={from:l.from,to:l.to,insert:Lt.of([" "])}),t)return G0(n,t,r,s);if(r&&!Jf(r,l)){let o=!1,c="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),c=n.inputState.lastSelectionOrigin,c=="select.pointer"&&(r=nS(n.state.facet(Uc).map(h=>h(n)),r))),n.dispatch({selection:r,scrollIntoView:o,userEvent:c}),!0}else return!1}function G0(n,e,t,r=-1){if(Ze.ios&&n.inputState.flushIOSKey(e))return!0;let l=n.state.selection.main;if(Ze.android&&(e.to==l.to&&(e.from==l.from||e.from==l.from-1&&n.state.sliceDoc(e.from,l.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Oo(n.contentDOM,"Enter",13)||(e.from==l.from-1&&e.to==l.to&&e.insert.length==0||r==8&&e.insert.length<e.to-e.from&&e.to>l.head)&&Oo(n.contentDOM,"Backspace",8)||e.from==l.from&&e.to==l.to+1&&e.insert.length==0&&Oo(n.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,c=()=>o||(o=RN(n,e,t));return n.state.facet(Vw).some(h=>h(n,e.from,e.to,s,c))||n.dispatch(c()),!0}function RN(n,e,t){let r,l=n.state,s=l.selection.main,o=-1;if(e.from==e.to&&e.from<s.from||e.from>s.to){let h=e.from<s.from?-1:1,d=h<0?s.from:s.to,p=bc(l.facet(Uc).map(g=>g(n)),d,h);e.from==p&&(o=p)}if(o>-1)r={changes:e,selection:Oe.cursor(e.from+e.insert.length,-1)};else if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let h=s.from<e.from?l.sliceDoc(s.from,e.from):"",d=s.to>e.to?l.sliceDoc(e.to,s.to):"";r=l.replaceSelection(n.state.toText(h+e.insert.sliceString(0,void 0,n.state.lineBreak)+d))}else{let h=l.changes(e),d=t&&t.main.to<=h.newLength?t.main:void 0;if(l.selection.ranges.length>1&&(n.inputState.composing>=0||n.inputState.compositionPendingChange)&&e.to<=s.to+10&&e.to>=s.to-10){let p=n.state.sliceDoc(e.from,e.to),g,b=t&&tS(n,t.main.head);if(b){let T=e.insert.length-(e.to-e.from);g={from:b.from,to:b.to-T}}else g=n.state.doc.lineAt(s.head);let w=s.to-e.to;r=l.changeByRange(T=>{if(T.from==s.from&&T.to==s.to)return{changes:h,range:d||T.map(h)};let N=T.to-w,D=N-p.length;if(n.state.sliceDoc(D,N)!=p||N>=g.from&&D<=g.to)return{range:T};let j=l.changes({from:D,to:N,insert:e.insert}),U=T.to-s.to;return{changes:j,range:d?Oe.range(Math.max(0,d.anchor+U),Math.max(0,d.head+U)):T.map(j)}})}else r={changes:h,selection:d&&l.selection.replaceRange(d)}}let c="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,c+=".compose",n.inputState.compositionFirstChange&&(c+=".start",n.inputState.compositionFirstChange=!1)),l.update(r,{userEvent:c,scrollIntoView:!0})}function aS(n,e,t,r){let l=Math.min(n.length,e.length),s=0;for(;s<l&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==l&&n.length==e.length)return null;let o=n.length,c=e.length;for(;o>0&&c>0&&n.charCodeAt(o-1)==e.charCodeAt(c-1);)o--,c--;if(r=="end"){let h=Math.max(0,s-Math.min(o,c));t-=o+h-s}if(o<s&&n.length<e.length){let h=t<=s&&t>=o?s-t:0;s-=h,c=s+(c-o),o=s}else if(c<s){let h=t<=s&&t>=c?s-t:0;s-=h,o=s+(o-c),c=s}return{from:s,toA:o,toB:c}}function BN(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:r,focusNode:l,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new o1(t,r)),(l!=t||s!=r)&&e.push(new o1(l,s))),e}function LN(n,e){if(n.length==0)return null;let t=n[0].pos,r=n.length==2?n[1].pos:t;return t>-1&&r>-1?Oe.single(t+e,r+e):null}function Jf(n,e){return e.head==n.main.head&&e.anchor==n.main.anchor}class zN{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Ze.safari&&e.contentDOM.addEventListener("input",()=>null),Ze.gecko&&ZN(e.contentDOM.ownerDocument)}handleEvent(e){!KN(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let r=this.handlers[e];if(r){for(let l of r.observers)l(this.view,t);for(let l of r.handlers){if(t.defaultPrevented)break;if(l(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=IN(e),r=this.handlers,l=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,c=r[s];c&&o!=!c.handlers.length&&(l.removeEventListener(s,this.handleEvent),c=null),c||l.addEventListener(s,this.handleEvent,{passive:o})}for(let s in r)s!="scroll"&&!t[s]&&l.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&oS.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Ze.android&&Ze.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return Ze.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=sS.find(r=>r.keyCode==e.keyCode))&&!e.ctrlKey||PN.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Oo(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:Ze.safari&&!Ze.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function u1(n,e){return(t,r)=>{try{return e.call(n,r,t)}catch(l){Qi(t.state,l)}}}function IN(n){let e=Object.create(null);function t(r){return e[r]||(e[r]={observers:[],handlers:[]})}for(let r of n){let l=r.spec,s=l&&l.plugin.domEventHandlers,o=l&&l.plugin.domEventObservers;if(s)for(let c in s){let h=s[c];h&&t(c).handlers.push(u1(r.value,h))}if(o)for(let c in o){let h=o[c];h&&t(c).observers.push(u1(r.value,h))}}for(let r in Ci)t(r).handlers.push(Ci[r]);for(let r in hi)t(r).observers.push(hi[r]);return e}const sS=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],PN="dthko",oS=[16,17,18,20,91,92,224,225],ff=6;function df(n){return Math.max(0,n)*.7+8}function HN(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class qN{constructor(e,t,r,l){this.view=e,this.startEvent=t,this.style=r,this.mustSelect=l,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=UE(e.contentDOM),this.atoms=e.state.facet(Uc).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Ht.allowMultipleSelections)&&UN(e,t),this.dragging=VN(e,t)&&hS(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&HN(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,r=0,l=0,s=0,o=this.view.win.innerWidth,c=this.view.win.innerHeight;this.scrollParents.x&&({left:l,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:c}=this.scrollParents.y.getBoundingClientRect());let h=Jw(this.view);e.clientX-h.left<=l+ff?t=-df(l-e.clientX):e.clientX+h.right>=o-ff&&(t=df(e.clientX-o)),e.clientY-h.top<=s+ff?r=-df(s-e.clientY):e.clientY+h.bottom>=c-ff&&(r=df(e.clientY-c)),this.setScrollSpeed(t,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,r=nS(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function UN(n,e){let t=n.state.facet(Hw);return t.length?t[0](e):Ze.mac?e.metaKey:e.ctrlKey}function FN(n,e){let t=n.state.facet(qw);return t.length?t[0](e):Ze.mac?!e.altKey:!e.ctrlKey}function VN(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let r=Ho(n.root);if(!r||r.rangeCount==0)return!0;let l=r.getRangeAt(0).getClientRects();for(let s=0;s<l.length;s++){let o=l[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function KN(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,r;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(r=zn.get(t))&&r.isWidget()&&!r.isHidden&&r.widget.ignoreEvent(e))return!1;return!0}const Ci=Object.create(null),hi=Object.create(null),uS=Ze.ie&&Ze.ie_version<15||Ze.ios&&Ze.webkit_version<604;function GN(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),cS(n,t.value)},50)}function Md(n,e,t){for(let r of n.facet(e))t=r(t,n);return t}function cS(n,e){e=Md(n.state,U0,e);let{state:t}=n,r,l=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(e0!=null&&t.selection.ranges.every(h=>h.empty)&&e0==s.toString()){let h=-1;r=t.changeByRange(d=>{let p=t.doc.lineAt(d.from);if(p.from==h)return{range:d};h=p.from;let g=t.toText((o?s.line(l++).text:e)+t.lineBreak);return{changes:{from:p.from,insert:g},range:Oe.cursor(d.from+g.length)}})}else o?r=t.changeByRange(h=>{let d=s.line(l++);return{changes:{from:h.from,to:h.to,insert:d.text},range:Oe.cursor(h.from+d.length)}}):r=t.replaceSelection(s);n.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}hi.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};Ci.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);hi.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};hi.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Ci.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let r of n.state.facet(Uw))if(t=r(n,e),t)break;if(!t&&e.button==0&&(t=QN(n,e)),t){let r=!n.hasFocus;n.inputState.startMouseSelection(new qN(n,e,t,r)),r&&n.observer.ignore(()=>{Dw(n.contentDOM);let s=n.root.activeElement;s&&!s.contains(n.contentDOM)&&s.blur()});let l=n.inputState.mouseSelection;if(l)return l.start(e),l.dragging===!1}else n.inputState.setSelectionOrigin("select.pointer");return!1};function c1(n,e,t,r){if(r==1)return Oe.cursor(e,t);if(r==2)return CN(n.state,e,t);{let l=n.docView.lineAt(e,t),s=n.state.doc.lineAt(l?l.posAtEnd:e),o=l?l.posAtStart:s.from,c=l?l.posAtEnd:s.to;return c<n.state.doc.length&&c==s.to&&c++,Oe.range(o,c)}}const YN=Ze.ie&&Ze.ie_version<=11;let h1=null,f1=0,d1=0;function hS(n){if(!YN)return n.detail;let e=h1,t=d1;return h1=n,d1=Date.now(),f1=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(f1+1)%3:1}function QN(n,e){let t=n.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),r=hS(e),l=n.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),l=l.map(s.changes))},get(s,o,c){let h=n.posAndSideAtCoords({x:s.clientX,y:s.clientY},!1),d,p=c1(n,h.pos,h.assoc,r);if(t.pos!=h.pos&&!o){let g=c1(n,t.pos,t.assoc,r),b=Math.min(g.from,p.from),w=Math.max(g.to,p.to);p=b<p.from?Oe.range(b,w):Oe.range(w,b)}return o?l.replaceRange(l.main.extend(p.from,p.to)):c&&r==1&&l.ranges.length>1&&(d=XN(l,h.pos))?d:c?l.addRange(p):Oe.create([p])}}}function XN(n,e){for(let t=0;t<n.ranges.length;t++){let{from:r,to:l}=n.ranges[t];if(r<=e&&l>=e)return Oe.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}Ci.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let l=n.docView.tile.nearest(e.target);if(l&&l.isWidget()){let s=l.posAtStart,o=s+l.length;(s>=t.to||o<=t.from)&&(t=Oe.range(s,o))}}let{inputState:r}=n;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Md(n.state,F0,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Ci.dragend=n=>(n.inputState.draggedContent=null,!1);function p1(n,e,t,r){if(t=Md(n.state,U0,t),!t)return;let l=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=n.inputState,o=r&&s&&FN(n,e)?{from:s.from,to:s.to}:null,c={from:l,insert:t},h=n.state.changes(o?[o,c]:c);n.focus(),n.dispatch({changes:h,selection:{anchor:h.mapPos(l,-1),head:h.mapPos(l,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}Ci.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let r=Array(t.length),l=0,s=()=>{++l==t.length&&p1(n,e,r.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let c=new FileReader;c.onerror=s,c.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(c.result)||(r[o]=c.result),s()},c.readAsText(t[o])}return!0}else{let r=e.dataTransfer.getData("Text");if(r)return p1(n,e,r,!0),!0}return!1};Ci.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=uS?null:e.clipboardData;return t?(cS(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(GN(n),!1)};function $N(n,e){let t=n.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),n.focus()},50)}function WN(n){let e=[],t=[],r=!1;for(let l of n.selection.ranges)l.empty||(e.push(n.sliceDoc(l.from,l.to)),t.push(l));if(!e.length){let l=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>l&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),l=o.number}r=!0}return{text:Md(n,F0,e.join(n.lineBreak)),ranges:t,linewise:r}}let e0=null;Ci.copy=Ci.cut=(n,e)=>{let t=Ho(n.root);if(t&&!xc(n.contentDOM,t))return!1;let{text:r,ranges:l,linewise:s}=WN(n.state);if(!r&&!s)return!1;e0=s?r:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:l,scrollIntoView:!0,userEvent:"delete.cut"});let o=uS?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",r),!0):($N(n,r),!1)};const fS=Oa.define();function dS(n,e){let t=[];for(let r of n.facet(Kw)){let l=r(n,e);l&&t.push(l)}return t.length?n.update({effects:t,annotations:fS.of(!0)}):null}function pS(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=dS(n.state,e);t?n.dispatch(t):n.update([])}},10)}hi.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),pS(n)};hi.blur=n=>{n.observer.clearSelectionRange(),pS(n)};hi.compositionstart=hi.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};hi.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Ze.chrome&&Ze.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};hi.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Ci.beforeinput=(n,e)=>{var t,r;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(n.inputState.insertingText=e.data,n.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&n.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let c=o[0],h=n.posAtDOM(c.startContainer,c.startOffset),d=n.posAtDOM(c.endContainer,c.endOffset);return G0(n,{from:h,to:d,insert:n.state.toText(s)},null),!0}}let l;if(Ze.chrome&&Ze.android&&(l=sS.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(l.key,l.keyCode),l.key=="Backspace"||l.key=="Delete")){let s=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return Ze.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),Ze.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>hi.compositionend(n,e),20),!1};const m1=new Set;function ZN(n){m1.has(n)||(m1.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const g1=["pre-wrap","normal","pre-line","break-spaces"];let Fo=!1;function y1(){Fo=!1}class JN{constructor(e){this.lineWrapping=e,this.doc=Lt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return g1.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let l=e[r];l<0?r++:this.heightSamples[Math.floor(l*10)]||(t=!0,this.heightSamples[Math.floor(l*10)]=!0)}return t}refresh(e,t,r,l,s,o){let c=g1.indexOf(e)>-1,h=Math.abs(t-this.lineHeight)>.3||this.lineWrapping!=c||Math.abs(r-this.charWidth)>.1;if(this.lineWrapping=c,this.lineHeight=t,this.charWidth=r,this.textHeight=l,this.lineLength=s,h){this.heightSamples={};for(let d=0;d<o.length;d++){let p=o[d];p<0?d++:this.heightSamples[Math.floor(p*10)]=!0}}return h}}class e3{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class bi{constructor(e,t,r,l,s){this.from=e,this.length=t,this.top=r,this.height=l,this._content=s}get type(){return typeof this._content=="number"?ui.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ks?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new bi(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var sn=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(sn||(sn={}));const Lf=.001;class br{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Lf&&(Fo=!0),this.height=e)}replace(e,t,r){return br.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,l){let s=this,o=r.doc;for(let c=l.length-1;c>=0;c--){let{fromA:h,toA:d,fromB:p,toB:g}=l[c],b=s.lineAt(h,sn.ByPosNoHeight,r.setDoc(t),0,0),w=b.to>=d?b:s.lineAt(d,sn.ByPosNoHeight,r,0,0);for(g+=w.to-d,d=w.to;c>0&&b.from<=l[c-1].toA;)h=l[c-1].fromA,p=l[c-1].fromB,c--,h<b.from&&(b=s.lineAt(h,sn.ByPosNoHeight,r,0,0));p+=b.from-h,h=b.from;let T=Y0.build(r.setDoc(o),e,p,g);s=ed(s,s.replace(h,d,T))}return s.updateHeight(r,0)}static empty(){return new Fr(0,0,0)}static of(e){if(e.length==1)return e[0];let t=0,r=e.length,l=0,s=0;for(;;)if(t==r)if(l>s*2){let c=e[t-1];c.break?e.splice(--t,1,c.left,null,c.right):e.splice(--t,1,c.left,c.right),r+=1+c.break,l-=c.size}else if(s>l*2){let c=e[r];c.break?e.splice(r,1,c.left,null,c.right):e.splice(r,1,c.left,c.right),r+=2+c.break,s-=c.size}else break;else if(l<s){let c=e[t++];c&&(l+=c.size)}else{let c=e[--r];c&&(s+=c.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,r++),new n3(br.of(e.slice(0,t)),o,br.of(e.slice(r)))}}function ed(n,e){return n==e?n:(n.constructor!=e.constructor&&(Fo=!0),e)}br.prototype.size=1;const t3=Nn.replace({});class mS extends br{constructor(e,t,r){super(e,t),this.deco=r,this.spaceAbove=0}mainBlock(e,t){return new bi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,r,l){return this.spaceAbove&&e<r+this.spaceAbove?new bi(l,0,r,this.spaceAbove,t3):this.mainBlock(r,l)}lineAt(e,t,r,l,s){let o=this.mainBlock(l,s);return this.spaceAbove?this.blockAt(0,r,l,s).join(o):o}forEachLine(e,t,r,l,s,o){e<=s+this.length&&t>=s&&o(this.lineAt(0,sn.ByPos,r,l,s))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e,t=0,r=!1,l){return l&&l.from<=t&&l.more&&this.setMeasuredHeight(l),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Fr extends mS{constructor(e,t,r){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=r}mainBlock(e,t){return new bi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,r){let l=r[0];return r.length==1&&(l instanceof Fr||l instanceof nr&&l.flags&4)&&Math.abs(this.length-l.length)<10?(l instanceof nr?l=new Fr(l.length,this.height,this.spaceAbove):l.height=this.height,this.outdated||(l.outdated=!1),l):br.of(r)}updateHeight(e,t=0,r=!1,l){return l&&l.from<=t&&l.more?this.setMeasuredHeight(l):(r||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class nr extends br{constructor(e){super(e,0)}heightMetrics(e,t){let r=e.doc.lineAt(t).number,l=e.doc.lineAt(t+this.length).number,s=l-r+1,o,c=0;if(e.lineWrapping){let h=Math.min(this.height,e.lineHeight*s);o=h/s,this.length>s+1&&(c=(this.height-h)/(this.length-s-1))}else o=this.height/s;return{firstLine:r,lastLine:l,perLine:o,perChar:c}}blockAt(e,t,r,l){let{firstLine:s,lastLine:o,perLine:c,perChar:h}=this.heightMetrics(t,l);if(t.lineWrapping){let d=l+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),p=t.doc.lineAt(d),g=c+p.length*h,b=Math.max(r,e-g/2);return new bi(p.from,p.length,b,g,0)}else{let d=Math.max(0,Math.min(o-s,Math.floor((e-r)/c))),{from:p,length:g}=t.doc.line(s+d);return new bi(p,g,r+c*d,c,0)}}lineAt(e,t,r,l,s){if(t==sn.ByHeight)return this.blockAt(e,r,l,s);if(t==sn.ByPosNoHeight){let{from:w,to:T}=r.doc.lineAt(e);return new bi(w,T-w,0,0,0)}let{firstLine:o,perLine:c,perChar:h}=this.heightMetrics(r,s),d=r.doc.lineAt(e),p=c+d.length*h,g=d.number-o,b=l+c*g+h*(d.from-s-g);return new bi(d.from,d.length,Math.max(l,Math.min(b,l+this.height-p)),p,0)}forEachLine(e,t,r,l,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:c,perLine:h,perChar:d}=this.heightMetrics(r,s);for(let p=e,g=l;p<=t;){let b=r.doc.lineAt(p);if(p==e){let T=b.number-c;g+=h*T+d*(e-s-T)}let w=h+d*b.length;o(new bi(b.from,b.length,g,w,0)),g+=w,p=b.to+1}}replace(e,t,r){let l=this.length-t;if(l>0){let s=r[r.length-1];s instanceof nr?r[r.length-1]=new nr(s.length+l):r.push(null,new nr(l-1))}if(e>0){let s=r[0];s instanceof nr?r[0]=new nr(e+s.length):r.unshift(new nr(e-1),null)}return br.of(r)}decomposeLeft(e,t){t.push(new nr(e-1),null)}decomposeRight(e,t){t.push(null,new nr(this.length-e-1))}updateHeight(e,t=0,r=!1,l){let s=t+this.length;if(l&&l.from<=t+this.length&&l.more){let o=[],c=Math.max(t,l.from),h=-1;for(l.from>t&&o.push(new nr(l.from-t-1).updateHeight(e,t));c<=s&&l.more;){let p=e.doc.lineAt(c).length;o.length&&o.push(null);let g=l.heights[l.index++],b=0;g<0&&(b=-g,g=l.heights[l.index++]),h==-1?h=g:Math.abs(g-h)>=Lf&&(h=-2);let w=new Fr(p,g,b);w.outdated=!1,o.push(w),c+=p+1}c<=s&&o.push(null,new nr(s-c).updateHeight(e,c));let d=br.of(o);return(h<0||Math.abs(d.height-this.height)>=Lf||Math.abs(h-this.heightMetrics(e,t).perLine)>=Lf)&&(Fo=!0),ed(this,d)}else(r||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class n3 extends br{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return this.flags&1}blockAt(e,t,r,l){let s=r+this.left.height;return e<s?this.left.blockAt(e,t,r,l):this.right.blockAt(e,t,s,l+this.left.length+this.break)}lineAt(e,t,r,l,s){let o=l+this.left.height,c=s+this.left.length+this.break,h=t==sn.ByHeight?e<o:e<c,d=h?this.left.lineAt(e,t,r,l,s):this.right.lineAt(e,t,r,o,c);if(this.break||(h?d.to<c:d.from>c))return d;let p=t==sn.ByPosNoHeight?sn.ByPosNoHeight:sn.ByPos;return h?d.join(this.right.lineAt(c,p,r,o,c)):this.left.lineAt(c,p,r,l,s).join(d)}forEachLine(e,t,r,l,s,o){let c=l+this.left.height,h=s+this.left.length+this.break;if(this.break)e<h&&this.left.forEachLine(e,t,r,l,s,o),t>=h&&this.right.forEachLine(e,t,r,c,h,o);else{let d=this.lineAt(h,sn.ByPos,r,l,s);e<d.from&&this.left.forEachLine(e,d.from-1,r,l,s,o),d.to>=e&&d.from<=t&&o(d),t>d.to&&this.right.forEachLine(d.to+1,t,r,c,h,o)}}replace(e,t,r){let l=this.left.length+this.break;if(t<l)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-l,t-l,r));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let c of r)s.push(c);if(e>0&&x1(s,o-1),t<this.length){let c=s.length;this.decomposeRight(t,s),x1(s,c)}return br.of(s)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(r++,e>=r&&t.push(null)),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,l=r+this.break;if(e>=l)return this.right.decomposeRight(e-l,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<l&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?br.of(this.break?[e,null,t]:[e,t]):(this.left=ed(this.left,e),this.right=ed(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,l){let{left:s,right:o}=this,c=t+s.length+this.break,h=null;return l&&l.from<=t+s.length&&l.more?h=s=s.updateHeight(e,t,r,l):s.updateHeight(e,t,r),l&&l.from<=c+o.length&&l.more?h=o=o.updateHeight(e,c,r,l):o.updateHeight(e,c,r),h?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function x1(n,e){let t,r;n[e]==null&&(t=n[e-1])instanceof nr&&(r=n[e+1])instanceof nr&&n.splice(e-1,3,new nr(t.length+1+r.length))}const r3=5;class Y0{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let r=Math.min(t,this.lineEnd),l=this.nodes[this.nodes.length-1];l instanceof Fr?l.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new Fr(r-this.pos,-1,0)),this.writtenTo=r,t>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let l=r.widget?r.widget.estimatedHeight:0,s=r.widget?r.widget.lineBreaks:0;l<0&&(l=this.oracle.lineHeight);let o=t-e;r.block?this.addBlock(new mS(o,l,r)):(o||s||l>=r3)&&this.addLineDeco(l,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Fr(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let r=new nr(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Fr)return e;let t=new Fr(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,r){let l=this.ensureLine();l.length+=r,l.collapsed+=r,l.widgetHeight=Math.max(l.widgetHeight,e),l.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Fr)&&!this.isCovered?this.nodes.push(new Fr(0,-1,0)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=e;for(let l of this.nodes)l instanceof Fr&&l.updateHeight(this.oracle,r),r+=l?l.length:1;return this.nodes}static build(e,t,r,l){let s=new Y0(r,e);return Kt.spans(t,r,l,s,0),s.finish(r)}}function i3(n,e,t){let r=new l3;return Kt.compare(n,e,t,r,0),r.changes}class l3{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,l){(e<t||r&&r.heightRelevant||l&&l.heightRelevant)&&jo(e,t,this.changes,5)}}function a3(n,e){let t=n.getBoundingClientRect(),r=n.ownerDocument,l=r.defaultView||window,s=Math.max(0,t.left),o=Math.min(l.innerWidth,t.right),c=Math.max(0,t.top),h=Math.min(l.innerHeight,t.bottom);for(let d=n.parentNode;d&&d!=r.body;)if(d.nodeType==1){let p=d,g=window.getComputedStyle(p);if((p.scrollHeight>p.clientHeight||p.scrollWidth>p.clientWidth)&&g.overflow!="visible"){let b=p.getBoundingClientRect();s=Math.max(s,b.left),o=Math.min(o,b.right),c=Math.max(c,b.top),h=Math.min(d==n.parentNode?l.innerHeight:h,b.bottom)}d=g.position=="absolute"||g.position=="fixed"?p.offsetParent:p.parentNode}else if(d.nodeType==11)d=d.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:c-(t.top+e),bottom:Math.max(c,h)-(t.top+e)}}function s3(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function o3(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Xm{constructor(e,t,r,l){this.from=e,this.to=t,this.size=r,this.displaySize=l}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let l=e[r],s=t[r];if(l.from!=s.from||l.to!=s.to||l.size!=s.size)return!1}return!0}draw(e,t){return Nn.replace({widget:new u3(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class u3 extends Ad{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class v1{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=b1,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ln.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(V0).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new JN(t),this.stateDeco=k1(e),this.heightMap=br.empty().applyChanges(this.stateDeco,Lt.empty,this.heightOracle.setDoc(e.doc),[new si(0,0,0,e.doc.length)]);for(let r=0;r<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());r++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Nn.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let l=r?t.head:t.anchor;if(!e.some(({from:s,to:o})=>l>=s&&l<=o)){let{from:s,to:o}=this.lineBlockAt(l);e.push(new pf(s,o))}}return this.viewports=e.sort((r,l)=>r.from-l.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?b1:new Q0(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(pc(e,this.scaler))})}update(e,t=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=k1(this.state);let l=e.changedRanges,s=si.extendWithRanges(l,i3(r,this.stateDeco,e?e.changes:Hn.empty(this.state.doc.length))),o=this.heightMap.height,c=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);y1(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||Fo)&&(e.flags|=2),c?(this.scrollAnchorPos=e.changes.mapPos(c.from,-1),this.scrollAnchorHeight=c.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let h=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<h.from||t.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,t));let d=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,e.flags|=this.updateForViewport(),(d||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(tN)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,r=window.getComputedStyle(t),l=this.heightOracle,s=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?Ln.RTL:Ln.LTR;let o=this.heightOracle.mustRefreshForWrapping(s)||this.mustMeasureContent,c=t.getBoundingClientRect(),h=o||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let d=0,p=0;if(c.width&&c.height){let{scaleX:ce,scaleY:F}=_w(t,c);(ce>.005&&Math.abs(this.scaleX-ce)>.005||F>.005&&Math.abs(this.scaleY-F)>.005)&&(this.scaleX=ce,this.scaleY=F,d|=16,o=h=!0)}let g=(parseInt(r.paddingTop)||0)*this.scaleY,b=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=g||this.paddingBottom!=b)&&(this.paddingTop=g,this.paddingBottom=b,d|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(l.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,d|=16);let w=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=w&&(this.scrollAnchorHeight=-1,this.scrollTop=w),this.scrolledToBottom=jw(e.scrollDOM);let T=(this.printing?o3:a3)(t,this.paddingTop),N=T.top-this.pixelViewport.top,D=T.bottom-this.pixelViewport.bottom;this.pixelViewport=T;let j=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(j!=this.inView&&(this.inView=j,j&&(h=!0)),!this.inView&&!this.scrollTarget&&!s3(e.dom))return 0;let U=c.width;if((this.contentDOMWidth!=U||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,d|=16),h){let ce=e.docView.measureVisibleLineHeights(this.viewport);if(l.mustRefreshForHeights(ce)&&(o=!0),o||l.lineWrapping&&Math.abs(U-this.contentDOMWidth)>l.charWidth){let{lineHeight:F,charWidth:z,textHeight:ee}=e.docView.measureTextSize();o=F>0&&l.refresh(s,F,z,ee,Math.max(5,U/z),ce),o&&(e.docView.minWidth=0,d|=16)}N>0&&D>0?p=Math.max(N,D):N<0&&D<0&&(p=Math.min(N,D)),y1();for(let F of this.viewports){let z=F.from==this.viewport.from?ce:e.docView.measureVisibleLineHeights(F);this.heightMap=(o?br.empty().applyChanges(this.stateDeco,Lt.empty,this.heightOracle,[new si(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(l,0,o,new e3(F.from,z))}Fo&&(d|=2)}let I=!this.viewportIsAppropriate(this.viewport,p)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return I&&(d&2&&(d|=this.updateScaler()),this.viewport=this.getViewport(p,this.scrollTarget),d|=this.updateForViewport()),(d&2||I)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),d|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),d}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),l=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:c}=this,h=new pf(l.lineAt(o-r*1e3,sn.ByHeight,s,0,0).from,l.lineAt(c+(1-r)*1e3,sn.ByHeight,s,0,0).to);if(t){let{head:d}=t.range;if(d<h.from||d>h.to){let p=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),g=l.lineAt(d,sn.ByPos,s,0,0),b;t.y=="center"?b=(g.top+g.bottom)/2-p/2:t.y=="start"||t.y=="nearest"&&d<h.from?b=g.top:b=g.bottom-p,h=new pf(l.lineAt(b-1e3/2,sn.ByHeight,s,0,0).from,l.lineAt(b+p+1e3/2,sn.ByHeight,s,0,0).to)}}return h}mapViewport(e,t){let r=t.mapPos(e.from,-1),l=t.mapPos(e.to,1);return new pf(this.heightMap.lineAt(r,sn.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(l,sn.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:l}=this.heightMap.lineAt(e,sn.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,sn.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:c}=this;return(e==0||l<=o-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||s>=c+Math.max(10,Math.min(r,250)))&&l>o-2*1e3&&s<c+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let l of e)t.touchesRange(l.from,l.to)||r.push(new Xm(t.mapPos(l.from),t.mapPos(l.to),l.size,l.displaySize));return r}ensureLineGaps(e,t){let r=this.heightOracle.lineWrapping,l=r?1e4:2e3,s=l>>1,o=l<<1;if(this.defaultTextDirection!=Ln.LTR&&!r)return[];let c=[],h=(p,g,b,w)=>{if(g-p<s)return;let T=this.state.selection.main,N=[T.from];T.empty||N.push(T.to);for(let j of N)if(j>p&&j<g){h(p,j-10,b,w),h(j+10,g,b,w);return}let D=h3(e,j=>j.from>=b.from&&j.to<=b.to&&Math.abs(j.from-p)<s&&Math.abs(j.to-g)<s&&!N.some(U=>j.from<U&&j.to>U));if(!D){if(g<b.to&&t&&r&&t.visibleRanges.some(I=>I.from<=g&&I.to>=g)){let I=t.moveToLineBoundary(Oe.cursor(g),!1,!0).head;I>p&&(g=I)}let j=this.gapSize(b,p,g,w),U=r||j<2e6?j:2e6;D=new Xm(p,g,j,U)}c.push(D)},d=p=>{if(p.length<o||p.type!=ui.Text)return;let g=c3(p.from,p.to,this.stateDeco);if(g.total<o)return;let b=this.scrollTarget?this.scrollTarget.range.head:null,w,T;if(r){let N=l/this.heightOracle.lineLength*this.heightOracle.lineHeight,D,j;if(b!=null){let U=gf(g,b),I=((this.visibleBottom-this.visibleTop)/2+N)/p.height;D=U-I,j=U+I}else D=(this.visibleTop-p.top-N)/p.height,j=(this.visibleBottom-p.top+N)/p.height;w=mf(g,D),T=mf(g,j)}else{let N=g.total*this.heightOracle.charWidth,D=l*this.heightOracle.charWidth,j=0;if(N>2e6)for(let z of e)z.from>=p.from&&z.from<p.to&&z.size!=z.displaySize&&z.from*this.heightOracle.charWidth+j<this.pixelViewport.left&&(j=z.size-z.displaySize);let U=this.pixelViewport.left+j,I=this.pixelViewport.right+j,ce,F;if(b!=null){let z=gf(g,b),ee=((I-U)/2+D)/N;ce=z-ee,F=z+ee}else ce=(U-D)/N,F=(I+D)/N;w=mf(g,ce),T=mf(g,F)}w>p.from&&h(p.from,w,p,g),T<p.to&&h(T,p.to,p,g)};for(let p of this.viewportLines)Array.isArray(p.type)?p.type.forEach(d):d(p);return c}gapSize(e,t,r,l){let s=gf(l,r)-gf(l,t);return this.heightOracle.lineWrapping?e.height*s:l.total*this.heightOracle.charWidth*s}updateLineGaps(e){Xm.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Nn.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let r=[];Kt.spans(t,this.viewport.from,this.viewport.to,{span(s,o){r.push({from:s,to:o})},point(){}},20);let l=0;if(r.length!=this.visibleRanges.length)l=12;else for(let s=0;s<r.length&&!(l&8);s++){let o=this.visibleRanges[s],c=r[s];(o.from!=c.from||o.to!=c.to)&&(l|=4,e&&e.mapPos(o.from,-1)==c.from&&e.mapPos(o.to,1)==c.to||(l|=8))}return this.visibleRanges=r,l}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||pc(this.heightMap.lineAt(e,sn.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||pc(this.heightMap.lineAt(this.scaler.fromDOM(e),sn.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return pc(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class pf{constructor(e,t){this.from=e,this.to=t}}function c3(n,e,t){let r=[],l=n,s=0;return Kt.spans(t,n,e,{span(){},point(o,c){o>l&&(r.push({from:l,to:o}),s+=o-l),l=c}},20),l<e&&(r.push({from:l,to:e}),s+=e-l),{total:s,ranges:r}}function mf({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let r=Math.floor(n*t);for(let l=0;;l++){let{from:s,to:o}=e[l],c=o-s;if(r<=c)return s+r;r-=c}}function gf(n,e){let t=0;for(let{from:r,to:l}of n.ranges){if(e<=l){t+=e-r;break}t+=l-r}return t/n.total}function h3(n,e){for(let t of n)if(e(t))return t}const b1={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};function k1(n){let e=n.facet(Td).filter(r=>typeof r!="function"),t=n.facet(K0).filter(r=>typeof r!="function");return t.length&&e.push(Kt.join(t)),e}class Q0{constructor(e,t,r){let l=0,s=0,o=0;this.viewports=r.map(({from:c,to:h})=>{let d=t.lineAt(c,sn.ByPos,e,0,0).top,p=t.lineAt(h,sn.ByPos,e,0,0).bottom;return l+=p-d,{from:c,to:h,top:d,bottom:p,domTop:0,domBottom:0}}),this.scale=(7e6-l)/(t.height-l);for(let c of this.viewports)c.domTop=o+(c.top-s)*this.scale,o=c.domBottom=c.domTop+(c.bottom-c.top),s=c.bottom}toDOM(e){for(let t=0,r=0,l=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return l+(e-r)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);r=s.bottom,l=s.domBottom}}fromDOM(e){for(let t=0,r=0,l=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return r+(e-l)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);r=s.bottom,l=s.domBottom}}eq(e){return e instanceof Q0?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,r)=>t.from==e.viewports[r].from&&t.to==e.viewports[r].to):!1}}function pc(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),r=e.toDOM(n.bottom);return new bi(n.from,n.length,t,r-t,Array.isArray(n._content)?n._content.map(l=>pc(l,e)):n._content)}const yf=ct.define({combine:n=>n.join(" ")}),t0=ct.define({combine:n=>n.indexOf(!0)>-1}),n0=Na.newName(),gS=Na.newName(),yS=Na.newName(),xS={"&light":"."+gS,"&dark":"."+yS};function r0(n,e,t){return new Na(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,l=>{if(l=="&")return n;if(!t||!t[l])throw new RangeError(`Unsupported selector: ${l}`);return t[l]}):n+" "+r}})}const f3=r0("."+n0,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},xS),d3={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},$m=Ze.ie&&Ze.ie_version<=11;class p3{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new FE,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let r of t)this.queue.push(r);(Ze.ie&&Ze.ie_version<=11||Ze.ios&&e.composing)&&t.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&Ze.android&&e.constructor.EDIT_CONTEXT!==!1&&!(Ze.chrome&&Ze.chrome_version<126)&&(this.editContext=new g3(e),e.state.facet(_l)&&(e.contentDOM.editContext=this.editContext.editContext)),$m&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,l=this.selectionRange;if(r.state.facet(_l)?r.root.activeElement!=this.dom:!xc(this.dom,l))return;let s=l.anchorNode&&r.docView.tile.nearest(l.anchorNode);if(s&&s.isWidget()&&s.widget.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(Ze.ie&&Ze.ie_version<=11||Ze.android&&Ze.chrome)&&!r.state.selection.main.empty&&l.focusNode&&vc(l.focusNode,l.focusOffset,l.anchorNode,l.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Ho(e.root);if(!t)return!1;let r=Ze.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&m3(this.view,t)||t;if(!r||this.selectionRange.eq(r))return!1;let l=xc(this.dom,r);return l&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&KE(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),l&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(r.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=t)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,d3),$m&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),$m&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var r;if(!this.delayedAndroidKey){let l=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Oo(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(l)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,r=-1,l=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(l=!0),t==-1?{from:t,to:r}=o:(t=Math.min(o.from,t),r=Math.max(o.to,r)))}return{from:t,to:r,typeOver:l}}readChange(){let{from:e,to:t,typeOver:r}=this.processRecords(),l=this.selectionChanged&&xc(this.dom,this.selectionRange);if(e<0&&!l)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new ON(this.view,e,t,r);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let r=this.view.state,l=lS(this.view,t);return this.view.state==r&&(t.domChanged||t.newSel&&!Jf(this.view.state.selection,t.newSel.main))&&this.view.update([]),l}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty(e.type=="attributes"),e.type=="childList"){let r=w1(t,e.previousSibling||e.target.previousSibling,-1),l=w1(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:l?t.posBefore(l):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(_l)!=e.state.facet(_l)&&(e.view.contentDOM.editContext=e.state.facet(_l)?this.editContext.editContext:null))}destroy(){var e,t,r;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect();for(let l of this.scrollTargets)l.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function w1(n,e,t){for(;e;){let r=zn.get(e);if(r&&r.parent==n)return r;let l=e.parentNode;e=l!=n.dom?l:t>0?e.nextSibling:e.previousSibling}return null}function S1(n,e){let t=e.startContainer,r=e.startOffset,l=e.endContainer,s=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor,1);return vc(o.node,o.offset,l,s)&&([t,r,l,s]=[l,s,t,r]),{anchorNode:t,anchorOffset:r,focusNode:l,focusOffset:s}}function m3(n,e){if(e.getComposedRanges){let l=e.getComposedRanges(n.root)[0];if(l)return S1(n,l)}let t=null;function r(l){l.preventDefault(),l.stopImmediatePropagation(),t=l.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",r,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",r,!0),t?S1(n,t):null}class g3{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=r=>{let l=e.state.selection.main,{anchor:s,head:o}=l,c=this.toEditorPos(r.updateRangeStart),h=this.toEditorPos(r.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:c,drifted:!1});let d=h-c>r.text.length;c==this.from&&s<this.from?c=s:h==this.to&&s>this.to&&(h=s);let p=aS(e.state.sliceDoc(c,h),r.text,(d?l.from:l.to)-c,d?"end":null);if(!p){let b=Oe.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));Jf(b,l)||e.dispatch({selection:b,userEvent:"select"});return}let g={from:p.from+c,to:p.toA+c,insert:Lt.of(r.text.slice(p.from,p.toB).split(`
`))};if((Ze.mac||Ze.android)&&g.from==o-1&&/^\. ?$/.test(r.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(g={from:c,to:h,insert:Lt.of([r.text.replace("."," ")])}),this.pendingContextChange=g,!e.state.readOnly){let b=this.to-this.from+(g.to-g.from+g.insert.length);G0(e,g,Oe.single(this.toEditorPos(r.selectionStart,b),this.toEditorPos(r.selectionEnd,b)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),g.from<g.to&&!g.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,r.updateRangeStart-1),Math.min(t.text.length,r.updateRangeStart+1)))&&this.handlers.compositionend(r)},this.handlers.characterboundsupdate=r=>{let l=[],s=null;for(let o=this.toEditorPos(r.rangeStart),c=this.toEditorPos(r.rangeEnd);o<c;o++){let h=e.coordsForChar(o);s=h&&new DOMRect(h.left,h.top,h.right-h.left,h.bottom-h.top)||s||new DOMRect,l.push(s)}t.updateCharacterBounds(r.rangeStart,l)},this.handlers.textformatupdate=r=>{let l=[];for(let s of r.getTextFormats()){let o=s.underlineStyle,c=s.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(c)){let h=this.toEditorPos(s.rangeStart),d=this.toEditorPos(s.rangeEnd);if(h<d){let p=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(c)?1:2}px`;l.push(Nn.mark({attributes:{style:p}}).range(h,d))}}}e.dispatch({effects:Qw.of(Nn.set(l))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:r}=this.composing;this.composing=null,r&&this.reset(e.state)}};for(let r in this.handlers)t.addEventListener(r,this.handlers[r]);this.measureReq={read:r=>{this.editContext.updateControlBounds(r.contentDOM.getBoundingClientRect());let l=Ho(r.root);l&&l.rangeCount&&this.editContext.updateSelectionBounds(l.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,r=!1,l=this.pendingContextChange;return e.changes.iterChanges((s,o,c,h,d)=>{if(r)return;let p=d.length-(o-s);if(l&&o>=l.to)if(l.from==s&&l.to==o&&l.insert.eq(d)){l=this.pendingContextChange=null,t+=p,this.to+=p;return}else l=null,this.revertPending(e.state);if(s+=t,o+=t,o<=this.from)this.from+=p,this.to+=p;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+d.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),d.toString()),this.to+=p}t+=p}),l&&!r&&this.revertPending(e.state),!r}update(e){let t=this.pendingContextChange,r=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(r.from,r.to)&&e.transactions.some(l=>!l.isUserEvent("input.type")&&l.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),l=this.toContextPos(t.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=l)&&this.editContext.updateSelection(r,l)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let r=this.composing;return r&&r.drifted?r.editorBase+(e-r.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class st{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:r}=e;this.dispatchTransactions=e.dispatchTransactions||r&&(l=>l.forEach(s=>r(s,this)))||(l=>this.update(l)),this.dispatch=this.dispatch.bind(this),this._root=e.root||VE(e.parent)||document,this.viewState=new v1(e.state||Ht.create(e)),e.scrollTo&&e.scrollTo.is(hf)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(To).map(l=>new Vm(l));for(let l of this.plugins)l.update(this);this.observer=new p3(this),this.inputState=new zN(this),this.inputState.ensureHandlers(this.plugins),this.docView=new l1(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...e){let t=e.length==1&&e[0]instanceof Un?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,r=!1,l,s=this.state;for(let b of e){if(b.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=b.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,c=0,h=null;e.some(b=>b.annotation(fS))?(this.inputState.notifiedFocused=o,c=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,h=dS(s,o),h||(c=1));let d=this.observer.delayedAndroidKey,p=null;if(d?(this.observer.clearDelayedAndroidKey(),p=this.observer.readChange(),(p&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(p=null)):this.observer.clear(),s.facet(Ht.phrases)!=this.state.facet(Ht.phrases))return this.setState(s);l=$f.create(this,s,e),l.flags|=c;let g=this.viewState.scrollTarget;try{this.updateState=2;for(let b of e){if(g&&(g=g.map(b.changes)),b.scrollIntoView){let{main:w}=b.state.selection;g=new Ro(w.empty?w:Oe.cursor(w.head,w.head>w.anchor?-1:1))}for(let w of b.effects)w.is(hf)&&(g=w.value.clip(this.state))}this.viewState.update(l,g),this.bidiCache=td.update(this.bidiCache,l.changes),l.empty||(this.updatePlugins(l),this.inputState.update(l)),t=this.docView.update(l),this.state.facet(fc)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(b=>b.isUserEvent("select.pointer")))}finally{this.updateState=0}if(l.startState.facet(yf)!=l.state.facet(yf)&&(this.viewState.mustMeasureContent=!0),(t||r||g||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!l.empty)for(let b of this.state.facet(Wg))try{b(l)}catch(w){Qi(this.state,w,"update listener")}(h||p)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),p&&!lS(this,p)&&d.force&&Oo(this.contentDOM,d.key,d.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new v1(e),this.plugins=e.facet(To).map(r=>new Vm(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView.destroy(),this.docView=new l1(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(To),r=e.state.facet(To);if(t!=r){let l=[];for(let s of r){let o=t.indexOf(s);if(o<0)l.push(new Vm(s));else{let c=this.plugins[o];c.mustUpdate=e,l.push(c)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=l,this.pluginMap.clear()}else for(let l of this.plugins)l.mustUpdate=e;for(let l=0;l<this.plugins.length;l++)this.plugins[l].update(this);t!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(r){Qi(this.state,r,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,r=this.scrollDOM,l=r.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(l-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let c=0;;c++){if(o<0)if(jw(r))s=-1,o=this.viewState.heightMap.height;else{let w=this.viewState.scrollAnchorAt(l);s=w.from,o=w.top}this.updateState=1;let h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(c>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let d=[];h&4||([this.measureRequests,d]=[d,this.measureRequests]);let p=d.map(w=>{try{return w.read(this)}catch(T){return Qi(this.state,T),C1}}),g=$f.create(this,this.state,[]),b=!1;g.flags|=h,t?t.flags|=h:t=g,this.updateState=2,g.empty||(this.updatePlugins(g),this.inputState.update(g),this.updateAttrs(),b=this.docView.update(g),b&&this.docViewUpdate());for(let w=0;w<d.length;w++)if(p[w]!=C1)try{let T=d[w];T.write&&T.write(p[w],this)}catch(T){Qi(this.state,T)}if(b&&this.docView.updateSelection(!0),!g.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let T=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(T>1||T<-1){l=l+T,r.scrollTop=l/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let c of this.state.facet(Wg))c(t)}get themeClasses(){return n0+" "+(this.state.facet(t0)?yS:gS)+" "+this.state.facet(yf)}updateAttrs(){let e=A1(this,Xw,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(_l)?"true":"false",class:"cm-content",style:`${Ze.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),A1(this,V0,t);let r=this.observer.ignore(()=>{let l=Jb(this.contentDOM,this.contentAttrs,t),s=Jb(this.dom,this.editorAttrs,e);return l||s});return this.editorAttrs=e,this.contentAttrs=t,r}showAnnouncements(e){let t=!0;for(let r of e)for(let l of r.effects)if(l.is(st.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=l.value}}mountStyles(){this.styleModules=this.state.facet(fc);let e=this.state.facet(st.cspNonce);Na.mount(this.root,this.styleModules.concat(f3).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(r=>r.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return Qm(this,e,a1(this,e,t,r))}moveByGroup(e,t){return Qm(this,e,a1(this,e,t,r=>NN(this,e.head,r)))}visualLineSide(e,t){let r=this.bidiSpans(e),l=this.textDirectionAt(e.from),s=r[t?r.length-1:0];return Oe.cursor(s.side(t,l)+e.from,s.forward(!t,l)?1:-1)}moveToLineBoundary(e,t,r=!0){return EN(this,e,t,r)}moveVertically(e,t,r){return Qm(this,e,MN(this,e,t,r))}domAtPos(e,t=1){return this.docView.domAtPos(e,t)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){this.readMeasured();let r=Jg(this,e,t);return r&&r.pos}posAndSideAtCoords(e,t=!0){return this.readMeasured(),Jg(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;let l=this.state.doc.lineAt(e),s=this.bidiSpans(l),o=s[Dl.find(s,e-l.from,-1,t)];return Xf(r,o.dir==Ln.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(Gw)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>y3)return Iw(e.length);let t=this.textDirectionAt(e.from),r;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||zw(s.isolates,r=n1(this,e))))return s.order;r||(r=n1(this,e));let l=ZE(e.text,t,r);return this.bidiCache.push(new td(e.from,e.to,t,r,!0,l)),l}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Ze.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Dw(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return hf.of(new Ro(typeof e=="number"?Oe.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return hf.of(new Ro(Oe.cursor(r.from),"start","start",r.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Si.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Si.define(()=>({}),{eventObservers:e})}static theme(e,t){let r=Na.newName(),l=[yf.of(r),fc.of(r0(`.${r}`,e))];return t&&t.dark&&l.push(t0.of(!0)),l}static baseTheme(e){return kd.lowest(fc.of(r0("."+n0,e,xS)))}static findFromDOM(e){var t;let r=e.querySelector(".cm-content"),l=r&&zn.get(r)||zn.get(e);return((t=l?.root)===null||t===void 0?void 0:t.view)||null}}st.styleModule=fc;st.inputHandler=Vw;st.clipboardInputFilter=U0;st.clipboardOutputFilter=F0;st.scrollHandler=Yw;st.focusChangeEffect=Kw;st.perLineTextDirection=Gw;st.exceptionSink=Fw;st.updateListener=Wg;st.editable=_l;st.mouseSelectionStyle=Uw;st.dragMovesSelection=qw;st.clickAddsSelectionRange=Hw;st.decorations=Td;st.blockWrappers=$w;st.outerDecorations=K0;st.atomicRanges=Uc;st.bidiIsolatedRanges=Ww;st.scrollMargins=Zw;st.darkTheme=t0;st.cspNonce=ct.define({combine:n=>n.length?n[0]:""});st.contentAttributes=V0;st.editorAttributes=Xw;st.lineWrapping=st.contentAttributes.of({class:"cm-lineWrapping"});st.announce=fn.define();const y3=4096,C1={};class td{constructor(e,t,r,l,s,o){this.from=e,this.to=t,this.dir=r,this.isolates=l,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let r=[],l=e.length?e[e.length-1].dir:Ln.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==l&&!t.touchesRange(o.from,o.to)&&r.push(new td(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return r}}function A1(n,e,t){for(let r=n.state.facet(e),l=r.length-1;l>=0;l--){let s=r[l],o=typeof s=="function"?s(n):s;o&&P0(o,t)}return t}const x3=Ze.mac?"mac":Ze.windows?"win":Ze.linux?"linux":"key";function v3(n,e){const t=n.split(/-(?!$)/);let r=t[t.length-1];r=="Space"&&(r=" ");let l,s,o,c;for(let h=0;h<t.length-1;++h){const d=t[h];if(/^(cmd|meta|m)$/i.test(d))c=!0;else if(/^a(lt)?$/i.test(d))l=!0;else if(/^(c|ctrl|control)$/i.test(d))s=!0;else if(/^s(hift)?$/i.test(d))o=!0;else if(/^mod$/i.test(d))e=="mac"?c=!0:s=!0;else throw new Error("Unrecognized modifier name: "+d)}return l&&(r="Alt-"+r),s&&(r="Ctrl-"+r),c&&(r="Meta-"+r),o&&(r="Shift-"+r),r}function xf(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const b3=kd.default(st.domEventHandlers({keydown(n,e){return bS(vS(e.state),n,e,"editor")}})),nd=ct.define({enables:b3}),T1=new WeakMap;function vS(n){let e=n.facet(nd),t=T1.get(e);return t||T1.set(e,t=S3(e.reduce((r,l)=>r.concat(l),[]))),t}function k3(n,e,t){return bS(vS(n.state),e,n,t)}let wa=null;const w3=4e3;function S3(n,e=x3){let t=Object.create(null),r=Object.create(null),l=(o,c)=>{let h=r[o];if(h==null)r[o]=c;else if(h!=c)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,c,h,d,p)=>{var g,b;let w=t[o]||(t[o]=Object.create(null)),T=c.split(/ (?!$)/).map(j=>v3(j,e));for(let j=1;j<T.length;j++){let U=T.slice(0,j).join(" ");l(U,!0),w[U]||(w[U]={preventDefault:!0,stopPropagation:!1,run:[I=>{let ce=wa={view:I,prefix:U,scope:o};return setTimeout(()=>{wa==ce&&(wa=null)},w3),!0}]})}let N=T.join(" ");l(N,!1);let D=w[N]||(w[N]={preventDefault:!1,stopPropagation:!1,run:((b=(g=w._any)===null||g===void 0?void 0:g.run)===null||b===void 0?void 0:b.slice())||[]});h&&D.run.push(h),d&&(D.preventDefault=!0),p&&(D.stopPropagation=!0)};for(let o of n){let c=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let d of c){let p=t[d]||(t[d]=Object.create(null));p._any||(p._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:g}=o;for(let b in p)p[b].run.push(w=>g(w,i0))}let h=o[e]||o.key;if(h)for(let d of c)s(d,h,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(d,"Shift-"+h,o.shift,o.preventDefault,o.stopPropagation)}return t}let i0=null;function bS(n,e,t,r){i0=e;let l=BE(e),s=hw(l,0),o=fw(s)==l.length&&l!=" ",c="",h=!1,d=!1,p=!1;wa&&wa.view==t&&wa.scope==r&&(c=wa.prefix+" ",oS.indexOf(e.keyCode)<0&&(d=!0,wa=null));let g=new Set,b=D=>{if(D){for(let j of D.run)if(!g.has(j)&&(g.add(j),j(t)))return D.stopPropagation&&(p=!0),!0;D.preventDefault&&(D.stopPropagation&&(p=!0),d=!0)}return!1},w=n[r],T,N;return w&&(b(w[c+xf(l,e,!o)])?h=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Ze.windows&&e.ctrlKey&&e.altKey)&&!(Ze.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(T=Ma[e.keyCode])&&T!=l?(b(w[c+xf(T,e,!0)])||e.shiftKey&&(N=Dc[e.keyCode])!=l&&N!=T&&b(w[c+xf(N,e,!1)]))&&(h=!0):o&&e.shiftKey&&b(w[c+xf(l,e,!0)])&&(h=!0),!h&&b(w._any)&&(h=!0)),d&&(h=!0),h&&p&&e.stopPropagation(),i0=null,h}const E1=ct.define({combine(n){let e,t;for(let r of n)e=e||r.topContainer,t=t||r.bottomContainer;return{topContainer:e,bottomContainer:t}}});function kS(n,e){let t=n.plugin(wS),r=t?t.specs.indexOf(e):-1;return r>-1?t.panels[r]:null}const wS=Si.fromClass(class{constructor(n){this.input=n.state.facet(rd),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(E1);this.top=new vf(n,!0,e.topContainer),this.bottom=new vf(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(E1);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new vf(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new vf(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(rd);if(t!=this.input){let r=t.filter(h=>h),l=[],s=[],o=[],c=[];for(let h of r){let d=this.specs.indexOf(h),p;d<0?(p=h(n.view),c.push(p)):(p=this.panels[d],p.update&&p.update(n)),l.push(p),(p.top?s:o).push(p)}this.specs=r,this.panels=l,this.top.sync(s),this.bottom.sync(o);for(let h of c)h.dom.classList.add("cm-panel"),h.mount&&h.mount()}else for(let r of this.panels)r.update&&r.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>st.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class vf{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=N1(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=N1(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function N1(n){let e=n.nextSibling;return n.remove(),e}const rd=ct.define({enables:wS});class Vo extends bs{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Vo.prototype.elementClass="";Vo.prototype.toDOM=void 0;Vo.prototype.mapMode=Vr.TrackBefore;Vo.prototype.startSide=Vo.prototype.endSide=-1;Vo.prototype.point=!0;const C3=1024;let A3=0;class Wm{constructor(e,t){this.from=e,this.to=t}}class Ot{constructor(e={}){this.id=A3++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=fi.match(e)),t=>{let r=e(t);return r===void 0?null:[this,r]}}}Ot.closedBy=new Ot({deserialize:n=>n.split(" ")});Ot.openedBy=new Ot({deserialize:n=>n.split(" ")});Ot.group=new Ot({deserialize:n=>n.split(" ")});Ot.isolate=new Ot({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});Ot.contextHash=new Ot({perNode:!0});Ot.lookAhead=new Ot({perNode:!0});Ot.mounted=new Ot({perNode:!0});class kc{constructor(e,t,r,l=!1){this.tree=e,this.overlay=t,this.parser=r,this.bracketed=l}static get(e){return e&&e.props&&e.props[Ot.mounted.id]}}const T3=Object.create(null);class fi{constructor(e,t,r,l=0){this.name=e,this.props=t,this.id=r,this.flags=l}static define(e){let t=e.props&&e.props.length?Object.create(null):T3,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),l=new fi(e.name||"",t,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(l)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return l}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Ot.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let l of r.split(" "))t[l]=e[r];return r=>{for(let l=r.prop(Ot.group),s=-1;s<(l?l.length:0);s++){let o=t[s<0?r.name:l[s]];if(o)return o}}}}fi.none=new fi("",Object.create(null),0,8);const bf=new WeakMap,M1=new WeakMap;var En;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays",n[n.EnterBracketed=16]="EnterBracketed"})(En||(En={}));class lr{constructor(e,t,r,l,s){if(this.type=e,this.children=t,this.positions=r,this.length=l,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,c]of s)this.props[typeof o=="number"?o:o.id]=c}}toString(){let e=kc.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let r of this.children){let l=r.toString();l&&(t&&(t+=","),t+=l)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new a0(this.topNode,e)}cursorAt(e,t=0,r=0){let l=bf.get(this)||this.topNode,s=new a0(l);return s.moveTo(e,t),bf.set(this,s._tree),s}get topNode(){return new ci(this,0,0,null)}resolve(e,t=0){let r=Rc(bf.get(this)||this.topNode,e,t,!1);return bf.set(this,r),r}resolveInner(e,t=0){let r=Rc(M1.get(this)||this.topNode,e,t,!0);return M1.set(this,r),r}resolveStack(e,t=0){return M3(this,e,t)}iterate(e){let{enter:t,leave:r,from:l=0,to:s=this.length}=e,o=e.mode||0,c=(o&En.IncludeAnonymous)>0;for(let h=this.cursor(o|En.IncludeAnonymous);;){let d=!1;if(h.from<=s&&h.to>=l&&(!c&&h.type.isAnonymous||t(h)!==!1)){if(h.firstChild())continue;d=!0}for(;d&&r&&(c||!h.type.isAnonymous)&&r(h),!h.nextSibling();){if(!h.parent())return;d=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:W0(fi.none,this.children,this.positions,0,this.children.length,0,this.length,(t,r,l)=>new lr(this.type,t,r,l,this.propValues),e.makeTree||((t,r,l)=>new lr(fi.none,t,r,l)))}static build(e){return _3(e)}}lr.empty=new lr(fi.none,[],[],0);class X0{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new X0(this.buffer,this.index)}}class Da{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return fi.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],l=this.set.types[t],s=l.name;if(/\W/.test(s)&&!l.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,r,l,s){let{buffer:o}=this,c=-1;for(let h=e;h!=t&&!(SS(s,l,o[h+1],o[h+2])&&(c=h,r>0));h=o[h+3]);return c}slice(e,t,r){let l=this.buffer,s=new Uint16Array(t-e),o=0;for(let c=e,h=0;c<t;){s[h++]=l[c++],s[h++]=l[c++]-r;let d=s[h++]=l[c++]-r;s[h++]=l[c++]-e,o=Math.max(o,d)}return new Da(s,o,this.set)}}function SS(n,e,t,r){switch(n){case-2:return t<e;case-1:return r>=e&&t<e;case 0:return t<e&&r>e;case 1:return t<=e&&r>e;case 2:return r>e;case 4:return!0}}function Rc(n,e,t,r){for(var l;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!r&&n instanceof ci&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=r?0:En.IgnoreOverlays;if(r)for(let o=n,c=o.parent;c;o=c,c=o.parent)o instanceof ci&&o.index<0&&((l=c.enter(e,t,s))===null||l===void 0?void 0:l.from)!=o.from&&(n=c);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class CS{cursor(e=0){return new a0(this,e)}getChild(e,t=null,r=null){let l=_1(this,e,t,r);return l.length?l[0]:null}getChildren(e,t=null,r=null){return _1(this,e,t,r)}resolve(e,t=0){return Rc(this,e,t,!1)}resolveInner(e,t=0){return Rc(this,e,t,!0)}matchContext(e){return l0(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let l=t.lastChild;if(!l||l.to!=t.to)break;l.type.isError&&l.from==l.to?(r=t,t=l.prevSibling):t=l}return r}get node(){return this}get next(){return this.parent}}class ci extends CS{constructor(e,t,r,l){super(),this._tree=e,this.from=t,this.index=r,this._parent=l}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,l,s=0){var o;for(let c=this;;){for(let{children:h,positions:d}=c._tree,p=t>0?h.length:-1;e!=p;e+=t){let g=h[e],b=d[e]+c.from;if(!(!(s&En.EnterBracketed&&g instanceof lr&&((o=kc.get(g))===null||o===void 0?void 0:o.overlay)===null&&(b>=r||b+g.length<=r))&&!SS(l,r,b,b+g.length))){if(g instanceof Da){if(s&En.ExcludeBuffers)continue;let w=g.findChild(0,g.buffer.length,t,r-b,l);if(w>-1)return new Ca(new E3(c,g,e,b),null,w)}else if(s&En.IncludeAnonymous||!g.type.isAnonymous||$0(g)){let w;if(!(s&En.IgnoreMounts)&&(w=kc.get(g))&&!w.overlay)return new ci(w.tree,b,e,c);let T=new ci(g,b,e,c);return s&En.IncludeAnonymous||!T.type.isAnonymous?T:T.nextChild(t<0?g.children.length-1:0,t,r,l,s)}}}if(s&En.IncludeAnonymous||!c.type.isAnonymous||(c.index>=0?e=c.index+t:e=t<0?-1:c._parent._tree.children.length,c=c._parent,!c))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t,r=0){let l;if(!(r&En.IgnoreOverlays)&&(l=kc.get(this._tree))&&l.overlay){let s=e-this.from,o=r&En.EnterBracketed&&l.bracketed;for(let{from:c,to:h}of l.overlay)if((t>0||o?c<=s:c<s)&&(t<0||o?h>=s:h>s))return new ci(l.tree,l.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function _1(n,e,t,r){let l=n.cursor(),s=[];if(!l.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=l.type.is(t),!l.nextSibling())return s}for(;;){if(r!=null&&l.type.is(r))return s;if(l.type.is(e)&&s.push(l.node),!l.nextSibling())return r==null?s:[]}}function l0(n,e,t=e.length-1){for(let r=n;t>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[t]&&e[t]!=r.name)return!1;t--}}return!0}class E3{constructor(e,t,r,l){this.parent=e,this.buffer=t,this.index=r,this.start=l}}class Ca extends CS{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:l}=this.context,s=l.findChild(this.index+4,l.buffer[this.index+3],e,t-this.context.start,r);return s<0?null:new Ca(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t,r=0){if(r&En.ExcludeBuffers)return null;let{buffer:l}=this.context,s=l.findChild(this.index+4,l.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Ca(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Ca(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Ca(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,l=this.index+4,s=r.buffer[this.index+3];if(s>l){let o=r.buffer[this.index+1];e.push(r.slice(l,s,o)),t.push(0)}return new lr(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function AS(n){if(!n.length)return null;let e=0,t=n[0];for(let s=1;s<n.length;s++){let o=n[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let r=t instanceof ci&&t.index<0?null:t.parent,l=n.slice();return r?l[e]=r:l.splice(e,1),new N3(l,t)}class N3{constructor(e,t){this.heads=e,this.node=t}get next(){return AS(this.heads)}}function M3(n,e,t){let r=n.resolveInner(e,t),l=null;for(let s=r instanceof ci?r:r.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(l||(l=[r])).push(o.resolve(e,t)),s=o}else{let o=kc.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let c=new ci(o.tree,o.overlay[0].from+s.from,-1,s);(l||(l=[r])).push(Rc(c,e,t,!1))}}return l?AS(l):r}class a0{get name(){return this.type.name}constructor(e,t=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=t&~En.EnterBracketed,e instanceof ci)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:r,buffer:l}=this.buffer;return this.type=t||l.set.types[l.buffer[e]],this.from=r+l.buffer[e+1],this.to=r+l.buffer[e+2],!0}yield(e){return e?e instanceof ci?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:l}=this.buffer,s=l.findChild(this.index+4,l.buffer[this.index+3],e,t-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?r&En.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&En.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&En.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let l=r<0?0:this.stack[r]+4;if(this.index!=l)return this.yieldBuf(t.findChild(l,this.index,-1,0,4))}else{let l=t.buffer[this.index+3];if(l<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(l)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:l}=this;if(l){if(e>0){if(this.index<l.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(l.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:r}=l)}else({index:t,_parent:r}=this._tree);for(;r;{index:t,_parent:r}=r)if(t>-1)for(let s=t+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let c=r._tree.children[s];if(this.mode&En.IncludeAnonymous||c instanceof Da||!c.type.isAnonymous||$0(c))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let l=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==l){if(l==this.index)return o;t=o,r=s+1;break e}l=this.stack[--s]}for(let l=r;l<this.stack.length;l++)t=new Ca(this.buffer,t,this.stack[l]);return this.bufferNode=new Ca(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let l=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(l=!0)}for(;;){if(l&&t&&t(this),l=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,l=!0}}}matchContext(e){if(!this.buffer)return l0(this.node.parent,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let l=e.length-1,s=this.stack.length-1;l>=0;s--){if(s<0)return l0(this._tree,e,l);let o=r[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[l]&&e[l]!=o.name)return!1;l--}}return!0}}function $0(n){return n.children.some(e=>e instanceof Da||!e.type.isAnonymous||$0(e))}function _3(n){var e;let{buffer:t,nodeSet:r,maxBufferLength:l=C3,reused:s=[],minRepeatType:o=r.types.length}=n,c=Array.isArray(t)?new X0(t,t.length):t,h=r.types,d=0,p=0;function g(F,z,ee,ye,Ce,P){let{id:pe,start:fe,end:De,size:ke}=c,J=p,q=d;if(ke<0)if(c.next(),ke==-1){let Pe=s[pe];ee.push(Pe),ye.push(fe-F);return}else if(ke==-3){d=pe;return}else if(ke==-4){p=pe;return}else throw new RangeError(`Unrecognized record size: ${ke}`);let le=h[pe],Ae,Se,B=fe-F;if(De-fe<=l&&(Se=D(c.pos-z,Ce))){let Pe=new Uint16Array(Se.size-Se.skip),qe=c.pos-Se.size,R=Pe.length;for(;c.pos>qe;)R=j(Se.start,Pe,R);Ae=new Da(Pe,De-Se.start,r),B=Se.start-F}else{let Pe=c.pos-ke;c.next();let qe=[],R=[],je=pe>=o?pe:-1,Ee=0,Ke=De;for(;c.pos>Pe;)je>=0&&c.id==je&&c.size>=0?(c.end<=Ke-l&&(T(qe,R,fe,Ee,c.end,Ke,je,J,q),Ee=qe.length,Ke=c.end),c.next()):P>2500?b(fe,Pe,qe,R):g(fe,Pe,qe,R,je,P+1);if(je>=0&&Ee>0&&Ee<qe.length&&T(qe,R,fe,Ee,fe,Ke,je,J,q),qe.reverse(),R.reverse(),je>-1&&Ee>0){let $e=w(le,q);Ae=W0(le,qe,R,0,qe.length,0,De-fe,$e,$e)}else Ae=N(le,qe,R,De-fe,J-De,q)}ee.push(Ae),ye.push(B)}function b(F,z,ee,ye){let Ce=[],P=0,pe=-1;for(;c.pos>z;){let{id:fe,start:De,end:ke,size:J}=c;if(J>4)c.next();else{if(pe>-1&&De<pe)break;pe<0&&(pe=ke-l),Ce.push(fe,De,ke),P++,c.next()}}if(P){let fe=new Uint16Array(P*4),De=Ce[Ce.length-2];for(let ke=Ce.length-3,J=0;ke>=0;ke-=3)fe[J++]=Ce[ke],fe[J++]=Ce[ke+1]-De,fe[J++]=Ce[ke+2]-De,fe[J++]=J;ee.push(new Da(fe,Ce[2]-De,r)),ye.push(De-F)}}function w(F,z){return(ee,ye,Ce)=>{let P=0,pe=ee.length-1,fe,De;if(pe>=0&&(fe=ee[pe])instanceof lr){if(!pe&&fe.type==F&&fe.length==Ce)return fe;(De=fe.prop(Ot.lookAhead))&&(P=ye[pe]+fe.length+De)}return N(F,ee,ye,Ce,P,z)}}function T(F,z,ee,ye,Ce,P,pe,fe,De){let ke=[],J=[];for(;F.length>ye;)ke.push(F.pop()),J.push(z.pop()+ee-Ce);F.push(N(r.types[pe],ke,J,P-Ce,fe-P,De)),z.push(Ce-ee)}function N(F,z,ee,ye,Ce,P,pe){if(P){let fe=[Ot.contextHash,P];pe=pe?[fe].concat(pe):[fe]}if(Ce>25){let fe=[Ot.lookAhead,Ce];pe=pe?[fe].concat(pe):[fe]}return new lr(F,z,ee,ye,pe)}function D(F,z){let ee=c.fork(),ye=0,Ce=0,P=0,pe=ee.end-l,fe={size:0,start:0,skip:0};e:for(let De=ee.pos-F;ee.pos>De;){let ke=ee.size;if(ee.id==z&&ke>=0){fe.size=ye,fe.start=Ce,fe.skip=P,P+=4,ye+=4,ee.next();continue}let J=ee.pos-ke;if(ke<0||J<De||ee.start<pe)break;let q=ee.id>=o?4:0,le=ee.start;for(ee.next();ee.pos>J;){if(ee.size<0)if(ee.size==-3||ee.size==-4)q+=4;else break e;else ee.id>=o&&(q+=4);ee.next()}Ce=le,ye+=ke,P+=q}return(z<0||ye==F)&&(fe.size=ye,fe.start=Ce,fe.skip=P),fe.size>4?fe:void 0}function j(F,z,ee){let{id:ye,start:Ce,end:P,size:pe}=c;if(c.next(),pe>=0&&ye<o){let fe=ee;if(pe>4){let De=c.pos-(pe-4);for(;c.pos>De;)ee=j(F,z,ee)}z[--ee]=fe,z[--ee]=P-F,z[--ee]=Ce-F,z[--ee]=ye}else pe==-3?d=ye:pe==-4&&(p=ye);return ee}let U=[],I=[];for(;c.pos>0;)g(n.start||0,n.bufferStart||0,U,I,-1,0);let ce=(e=n.length)!==null&&e!==void 0?e:U.length?I[0]+U[0].length:0;return new lr(h[n.topID],U.reverse(),I.reverse(),ce)}const D1=new WeakMap;function zf(n,e){if(!n.isAnonymous||e instanceof Da||e.type!=n)return 1;let t=D1.get(e);if(t==null){t=1;for(let r of e.children){if(r.type!=n||!(r instanceof lr)){t=1;break}t+=zf(n,r)}D1.set(e,t)}return t}function W0(n,e,t,r,l,s,o,c,h){let d=0;for(let T=r;T<l;T++)d+=zf(n,e[T]);let p=Math.ceil(d*1.5/8),g=[],b=[];function w(T,N,D,j,U){for(let I=D;I<j;){let ce=I,F=N[I],z=zf(n,T[I]);for(I++;I<j;I++){let ee=zf(n,T[I]);if(z+ee>=p)break;z+=ee}if(I==ce+1){if(z>p){let ee=T[ce];w(ee.children,ee.positions,0,ee.children.length,N[ce]+U);continue}g.push(T[ce])}else{let ee=N[I-1]+T[I-1].length-F;g.push(W0(n,T,N,ce,I,F,ee,null,h))}b.push(F+U-s)}}return w(e,t,r,l,0),(c||h)(g,b,o)}class xs{constructor(e,t,r,l,s=!1,o=!1){this.from=e,this.to=t,this.tree=r,this.offset=l,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],r=!1){let l=[new xs(0,e.length,e,0,!1,r)];for(let s of t)s.to>e.length&&l.push(s);return l}static applyChanges(e,t,r=128){if(!t.length)return e;let l=[],s=1,o=e.length?e[0]:null;for(let c=0,h=0,d=0;;c++){let p=c<t.length?t[c]:null,g=p?p.fromA:1e9;if(g-h>=r)for(;o&&o.from<g;){let b=o;if(h>=b.from||g<=b.to||d){let w=Math.max(b.from,h)-d,T=Math.min(b.to,g)-d;b=w>=T?null:new xs(w,T,b.tree,b.offset+d,c>0,!!p)}if(b&&l.push(b),o.to>g)break;o=s<e.length?e[s++]:null}if(!p)break;h=p.toA,d=p.toA-p.toB}return l}}class D3{startParse(e,t,r){return typeof e=="string"&&(e=new j3(e)),r=r?r.length?r.map(l=>new Wm(l.from,l.to)):[new Wm(0,0)]:[new Wm(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let l=this.startParse(e,t,r);for(;;){let s=l.advance();if(s)return s}}}class j3{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Ot({perNode:!0});let O3=0;class li{constructor(e,t,r,l){this.name=e,this.set=t,this.base=r,this.modified=l,this.id=O3++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let r=typeof e=="string"?e:"?";if(e instanceof li&&(t=e),t?.base)throw new Error("Can not derive from a modified tag");let l=new li(r,[],null,[]);if(l.set.push(l),t)for(let s of t.set)l.set.push(s);return l}static defineModifier(e){let t=new id(e);return r=>r.modified.indexOf(t)>-1?r:id.get(r.base||r,r.modified.concat(t).sort((l,s)=>l.id-s.id))}}let R3=0;class id{constructor(e){this.name=e,this.instances=[],this.id=R3++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(c=>c.base==e&&B3(t,c.modified));if(r)return r;let l=[],s=new li(e.name,l,e,t);for(let c of t)c.instances.push(s);let o=L3(t);for(let c of e.set)if(!c.modified.length)for(let h of o)l.push(id.get(c,h));return s}}function B3(n,e){return n.length==e.length&&n.every((t,r)=>t==e[r])}function L3(n){let e=[[]];for(let t=0;t<n.length;t++)for(let r=0,l=e.length;r<l;r++)e.push(e[r].concat(n[t]));return e.sort((t,r)=>r.length-t.length)}function z3(n){let e=Object.create(null);for(let t in n){let r=n[t];Array.isArray(r)||(r=[r]);for(let l of t.split(" "))if(l){let s=[],o=2,c=l;for(let g=0;;){if(c=="..."&&g>0&&g+3==l.length){o=1;break}let b=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(c);if(!b)throw new RangeError("Invalid path: "+l);if(s.push(b[0]=="*"?"":b[0][0]=='"'?JSON.parse(b[0]):b[0]),g+=b[0].length,g==l.length)break;let w=l[g++];if(g==l.length&&w=="!"){o=0;break}if(w!="/")throw new RangeError("Invalid path: "+l);c=l.slice(g)}let h=s.length-1,d=s[h];if(!d)throw new RangeError("Invalid path: "+l);let p=new Bc(r,o,h>0?s.slice(0,h):null);e[d]=p.sort(e[d])}}return TS.add(e)}const TS=new Ot({combine(n,e){let t,r,l;for(;n||e;){if(!n||e&&n.depth>=e.depth?(l=e,e=e.next):(l=n,n=n.next),t&&t.mode==l.mode&&!l.context&&!t.context)continue;let s=new Bc(l.tags,l.mode,l.context);t?t.next=s:r=s,t=s}return r}});class Bc{constructor(e,t,r,l){this.tags=e,this.mode=t,this.context=r,this.next=l}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Bc.empty=new Bc([],2,null);function ES(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:r,all:l=null}=e||{};return{style:s=>{let o=l;for(let c of s)for(let h of c.set){let d=t[h.id];if(d){o=o?o+" "+d:d;break}}return o},scope:r}}function I3(n,e){let t=null;for(let r of n){let l=r.style(e);l&&(t=t?t+" "+l:l)}return t}function P3(n,e,t,r=0,l=n.length){let s=new H3(r,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),r,l,"",s.highlighters),s.flush(l)}class H3{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,l,s){let{type:o,from:c,to:h}=e;if(c>=r||h<=t)return;o.isTop&&(s=this.highlighters.filter(w=>!w.scope||w.scope(o)));let d=l,p=q3(e)||Bc.empty,g=I3(s,p.tags);if(g&&(d&&(d+=" "),d+=g,p.mode==1&&(l+=(l?" ":"")+g)),this.startSpan(Math.max(t,c),d),p.opaque)return;let b=e.tree&&e.tree.prop(Ot.mounted);if(b&&b.overlay){let w=e.node.enter(b.overlay[0].from+c,1),T=this.highlighters.filter(D=>!D.scope||D.scope(b.tree.type)),N=e.firstChild();for(let D=0,j=c;;D++){let U=D<b.overlay.length?b.overlay[D]:null,I=U?U.from+c:h,ce=Math.max(t,j),F=Math.min(r,I);if(ce<F&&N)for(;e.from<F&&(this.highlightRange(e,ce,F,l,s),this.startSpan(Math.min(F,e.to),d),!(e.to>=I||!e.nextSibling())););if(!U||I>r)break;j=U.to+c,j>t&&(this.highlightRange(w.cursor(),Math.max(t,U.from+c),Math.min(r,j),"",T),this.startSpan(Math.min(r,j),d))}N&&e.parent()}else if(e.firstChild()){b&&(l="");do if(!(e.to<=t)){if(e.from>=r)break;this.highlightRange(e,t,r,l,s),this.startSpan(Math.min(r,e.to),d)}while(e.nextSibling());e.parent()}}}function q3(n){let e=n.type.prop(TS);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const Fe=li.define,kf=Fe(),va=Fe(),j1=Fe(va),O1=Fe(va),ba=Fe(),wf=Fe(ba),Zm=Fe(ba),Vi=Fe(),fs=Fe(Vi),Ui=Fe(),Fi=Fe(),s0=Fe(),lc=Fe(s0),Sf=Fe(),Be={comment:kf,lineComment:Fe(kf),blockComment:Fe(kf),docComment:Fe(kf),name:va,variableName:Fe(va),typeName:j1,tagName:Fe(j1),propertyName:O1,attributeName:Fe(O1),className:Fe(va),labelName:Fe(va),namespace:Fe(va),macroName:Fe(va),literal:ba,string:wf,docString:Fe(wf),character:Fe(wf),attributeValue:Fe(wf),number:Zm,integer:Fe(Zm),float:Fe(Zm),bool:Fe(ba),regexp:Fe(ba),escape:Fe(ba),color:Fe(ba),url:Fe(ba),keyword:Ui,self:Fe(Ui),null:Fe(Ui),atom:Fe(Ui),unit:Fe(Ui),modifier:Fe(Ui),operatorKeyword:Fe(Ui),controlKeyword:Fe(Ui),definitionKeyword:Fe(Ui),moduleKeyword:Fe(Ui),operator:Fi,derefOperator:Fe(Fi),arithmeticOperator:Fe(Fi),logicOperator:Fe(Fi),bitwiseOperator:Fe(Fi),compareOperator:Fe(Fi),updateOperator:Fe(Fi),definitionOperator:Fe(Fi),typeOperator:Fe(Fi),controlOperator:Fe(Fi),punctuation:s0,separator:Fe(s0),bracket:lc,angleBracket:Fe(lc),squareBracket:Fe(lc),paren:Fe(lc),brace:Fe(lc),content:Vi,heading:fs,heading1:Fe(fs),heading2:Fe(fs),heading3:Fe(fs),heading4:Fe(fs),heading5:Fe(fs),heading6:Fe(fs),contentSeparator:Fe(Vi),list:Fe(Vi),quote:Fe(Vi),emphasis:Fe(Vi),strong:Fe(Vi),link:Fe(Vi),monospace:Fe(Vi),strikethrough:Fe(Vi),inserted:Fe(),deleted:Fe(),changed:Fe(),invalid:Fe(),meta:Sf,documentMeta:Fe(Sf),annotation:Fe(Sf),processingInstruction:Fe(Sf),definition:li.defineModifier("definition"),constant:li.defineModifier("constant"),function:li.defineModifier("function"),standard:li.defineModifier("standard"),local:li.defineModifier("local"),special:li.defineModifier("special")};for(let n in Be){let e=Be[n];e instanceof li&&(e.name=n)}ES([{tag:Be.link,class:"tok-link"},{tag:Be.heading,class:"tok-heading"},{tag:Be.emphasis,class:"tok-emphasis"},{tag:Be.strong,class:"tok-strong"},{tag:Be.keyword,class:"tok-keyword"},{tag:Be.atom,class:"tok-atom"},{tag:Be.bool,class:"tok-bool"},{tag:Be.url,class:"tok-url"},{tag:Be.labelName,class:"tok-labelName"},{tag:Be.inserted,class:"tok-inserted"},{tag:Be.deleted,class:"tok-deleted"},{tag:Be.literal,class:"tok-literal"},{tag:Be.string,class:"tok-string"},{tag:Be.number,class:"tok-number"},{tag:[Be.regexp,Be.escape,Be.special(Be.string)],class:"tok-string2"},{tag:Be.variableName,class:"tok-variableName"},{tag:Be.local(Be.variableName),class:"tok-variableName tok-local"},{tag:Be.definition(Be.variableName),class:"tok-variableName tok-definition"},{tag:Be.special(Be.variableName),class:"tok-variableName2"},{tag:Be.definition(Be.propertyName),class:"tok-propertyName tok-definition"},{tag:Be.typeName,class:"tok-typeName"},{tag:Be.namespace,class:"tok-namespace"},{tag:Be.className,class:"tok-className"},{tag:Be.macroName,class:"tok-macroName"},{tag:Be.propertyName,class:"tok-propertyName"},{tag:Be.operator,class:"tok-operator"},{tag:Be.comment,class:"tok-comment"},{tag:Be.meta,class:"tok-meta"},{tag:Be.invalid,class:"tok-invalid"},{tag:Be.punctuation,class:"tok-punctuation"}]);var Jm;const mc=new Ot,U3=new Ot;class Xi{constructor(e,t,r=[],l=""){this.data=e,this.name=l,Ht.prototype.hasOwnProperty("tree")||Object.defineProperty(Ht.prototype,"tree",{get(){return Ji(this)}}),this.parser=t,this.extension=[Go.of(this),Ht.languageData.of((s,o,c)=>{let h=R1(s,o,c),d=h.type.prop(mc);if(!d)return[];let p=s.facet(d),g=h.type.prop(U3);if(g){let b=h.resolve(o-h.from,c);for(let w of g)if(w.test(b,s)){let T=s.facet(w.facet);return w.type=="replace"?T:T.concat(p)}}return p})].concat(r)}isActiveAt(e,t,r=-1){return R1(e,t,r).type.prop(mc)==this.data}findRegions(e){let t=e.facet(Go);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let r=[],l=(s,o)=>{if(s.prop(mc)==this.data){r.push({from:o,to:o+s.length});return}let c=s.prop(Ot.mounted);if(c){if(c.tree.prop(mc)==this.data){if(c.overlay)for(let h of c.overlay)r.push({from:h.from+o,to:h.to+o});else r.push({from:o,to:o+s.length});return}else if(c.overlay){let h=r.length;if(l(c.tree,c.overlay[0].from+o),r.length>h)return}}for(let h=0;h<s.children.length;h++){let d=s.children[h];d instanceof lr&&l(d,s.positions[h]+o)}};return l(Ji(e),0),r}get allowsNesting(){return!0}}Xi.setState=fn.define();function R1(n,e,t){let r=n.facet(Go),l=Ji(n).topNode;if(!r||r.allowsNesting)for(let s=l;s;s=s.enter(e,t,En.ExcludeBuffers|En.EnterBracketed))s.type.isTop&&(l=s);return l}function Ji(n){let e=n.field(Xi.state,!1);return e?e.tree:lr.empty}class F3{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let ac=null;class ld{constructor(e,t,r=[],l,s,o,c,h){this.parser=e,this.state=t,this.fragments=r,this.tree=l,this.treeLen=s,this.viewport=o,this.skipped=c,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new ld(e,t,[],lr.empty,0,r,[],null)}startParse(){return this.parser.startParse(new F3(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=lr.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let l=Date.now()+e;e=()=>Date.now()>l}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let l=this.parse.advance();if(l)if(this.fragments=this.withoutTempSkipped(xs.addTree(l,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=l,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(xs.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=ac;ac=this;try{return e()}finally{ac=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=B1(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:l,treeLen:s,viewport:o,skipped:c}=this;if(this.takeTree(),!e.empty){let h=[];if(e.iterChangedRanges((d,p,g,b)=>h.push({fromA:d,toA:p,fromB:g,toB:b})),r=xs.applyChanges(r,h),l=lr.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){c=[];for(let d of this.skipped){let p=e.mapPos(d.from,1),g=e.mapPos(d.to,-1);p<g&&c.push({from:p,to:g})}}}return new ld(this.parser,t,r,l,s,o,c,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:l,to:s}=this.skipped[r];l<e.to&&s>e.from&&(this.fragments=B1(this.fragments,l,s),this.skipped.splice(r--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends D3{createParse(t,r,l){let s=l[0].from,o=l[l.length-1].to;return{parsedPos:s,advance(){let h=ac;if(h){for(let d of l)h.tempSkipped.push(d);e&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,e]):e)}return this.parsedPos=o,new lr(fi.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return ac}}function B1(n,e,t){return xs.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Ko{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new Ko(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=ld.create(e.facet(Go).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new Ko(r)}}Xi.state=el.define({create:Ko.init,update(n,e){for(let t of e.effects)if(t.is(Xi.setState))return t.value;return e.startState.facet(Go)!=e.state.facet(Go)?Ko.init(e.state):n.apply(e)}});let NS=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(NS=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const eg=typeof navigator<"u"&&(!((Jm=navigator.scheduling)===null||Jm===void 0)&&Jm.isInputPending)?()=>navigator.scheduling.isInputPending():null,V3=Si.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Xi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Xi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=NS(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:l}}=this.view,s=r.field(Xi.state);if(s.tree==s.context.tree&&s.context.isDone(l+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!eg?Math.max(25,e.timeRemaining()-5):1e9),c=s.context.treeLen<l&&r.doc.length>l+1e3,h=s.context.work(()=>eg&&eg()||Date.now()>o,l+(c?0:1e5));this.chunkBudget-=Date.now()-t,(h||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Xi.setState.of(new Ko(s.context))})),this.chunkBudget>0&&!(h&&!c)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Qi(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Go=ct.define({combine(n){return n.length?n[0]:null},enables:n=>[Xi.state,V3,st.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]}),K3=ct.define(),Z0=ct.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function ad(n){let e=n.facet(Z0);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function sd(n,e){let t="",r=n.tabSize,l=n.facet(Z0)[0];if(l=="	"){for(;e>=r;)t+="	",e-=r;l=" "}for(let s=0;s<e;s++)t+=l;return t}function MS(n,e){n instanceof Ht&&(n=new _d(n));for(let r of n.state.facet(K3)){let l=r(n,e);if(l!==void 0)return l}let t=Ji(n.state);return t.length>=e?Y3(n,t,e):null}class _d{constructor(e,t={}){this.state=e,this.options=t,this.unit=ad(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:l,simulateDoubleBreak:s}=this.options;return l!=null&&l>=r.from&&l<=r.to?s&&l==e?{text:"",from:e}:(t<0?l<e:l<=e)?{text:r.text.slice(l-r.from),from:l}:{text:r.text.slice(0,l-r.from),from:r.from}:r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:l}=this.lineAt(e,t);return r.slice(e-l,Math.min(r.length,e+100-l))}column(e,t=1){let{text:r,from:l}=this.lineAt(e,t),s=this.countColumn(r,e-l),o=this.options.overrideIndentation?this.options.overrideIndentation(l):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,t=e.length){return Sd(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:l}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(l);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const G3=new Ot;function Y3(n,e,t){let r=e.resolveStack(t),l=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(l!=r.node){let s=[];for(let o=l;o&&!(o.from<r.node.from||o.to>r.node.to||o.from==r.node.from&&o.type==r.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)r={node:s[o],next:r}}return _S(r,n,t)}function _S(n,e,t){for(let r=n;r;r=r.next){let l=X3(r.node);if(l)return l(J0.create(e,t,r))}return 0}function Q3(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function X3(n){let e=n.type.prop(G3);if(e)return e;let t=n.firstChild,r;if(t&&(r=t.type.prop(Ot.closedBy))){let l=n.lastChild,s=l&&r.indexOf(l.name)>-1;return o=>J3(o,!0,1,void 0,s&&!Q3(o)?l.from:void 0)}return n.parent==null?$3:null}function $3(){return 0}class J0 extends _d{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.context=r}get node(){return this.context.node}static create(e,t,r){return new J0(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(t.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(W3(r,e))break;t=this.state.doc.lineAt(r.from)}return this.lineIndent(t.from)}continue(){return _S(this.context.next,this.base,this.pos)}}function W3(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function Z3(n){let e=n.node,t=e.childAfter(e.from),r=e.lastChild;if(!t)return null;let l=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=l==null||l<=s.from?s.to:Math.min(s.to,l);for(let c=t.to;;){let h=e.childAfter(c);if(!h||h==r)return null;if(!h.type.isSkipped){if(h.from>=o)return null;let d=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+d}}c=h.to}}function J3(n,e,t,r,l){let s=n.textAfter,o=s.match(/^\s*/)[0].length,c=r&&s.slice(o,o+r.length)==r||l==n.pos+o,h=Z3(n);return h?c?n.column(h.from):n.column(h.to):n.baseIndent+(c?0:n.unit*t)}class Dd{constructor(e,t){this.specs=e;let r;function l(c){let h=Na.newName();return(r||(r=Object.create(null)))["."+h]=c,h}const s=typeof t.all=="string"?t.all:t.all?l(t.all):void 0,o=t.scope;this.scope=o instanceof Xi?c=>c.prop(mc)==o.data:o?c=>c==o:void 0,this.style=ES(e.map(c=>({tag:c.tag,class:c.class||l(Object.assign({},c,{tag:null}))})),{all:s}).style,this.module=r?new Na(r):null,this.themeType=t.themeType}static define(e,t){return new Dd(e,t||{})}}const o0=ct.define(),eM=ct.define({combine(n){return n.length?[n[0]]:null}});function tg(n){let e=n.facet(o0);return e.length?e:n.facet(eM)}function tM(n,e){let t=[rM],r;return n instanceof Dd&&(n.module&&t.push(st.styleModule.of(n.module)),r=n.themeType),r?t.push(o0.computeN([st.darkTheme],l=>l.facet(st.darkTheme)==(r=="dark")?[n]:[])):t.push(o0.of(n)),t}class nM{constructor(e){this.markCache=Object.create(null),this.tree=Ji(e.state),this.decorations=this.buildDeco(e,tg(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Ji(e.state),r=tg(e.state),l=r!=tg(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!l&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||l)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return Nn.none;let r=new Po;for(let{from:l,to:s}of e.visibleRanges)P3(this.tree,t,(o,c,h)=>{r.add(o,c,this.markCache[h]||(this.markCache[h]=Nn.mark({class:h})))},l,s);return r.finish()}}const rM=kd.high(Si.fromClass(nM,{decorations:n=>n.decorations})),iM=1e4,lM="()[]{}",aM=new Ot;function u0(n,e,t){let r=n.prop(e<0?Ot.openedBy:Ot.closedBy);if(r)return r;if(n.name.length==1){let l=t.indexOf(n.name);if(l>-1&&l%2==(e<0?1:0))return[t[l+e]]}return null}function c0(n){let e=n.type.prop(aM);return e?e(n.node):n}function Eo(n,e,t,r={}){let l=r.maxScanDistance||iM,s=r.brackets||lM,o=Ji(n),c=o.resolveInner(e,t);for(let h=c;h;h=h.parent){let d=u0(h.type,t,s);if(d&&h.from<h.to){let p=c0(h);if(p&&(t>0?e>=p.from&&e<p.to:e>p.from&&e<=p.to))return sM(n,e,t,h,p,d,s)}}return oM(n,e,t,o,c.type,l,s)}function sM(n,e,t,r,l,s,o){let c=r.parent,h={from:l.from,to:l.to},d=0,p=c?.cursor();if(p&&(t<0?p.childBefore(r.from):p.childAfter(r.to)))do if(t<0?p.to<=r.from:p.from>=r.to){if(d==0&&s.indexOf(p.type.name)>-1&&p.from<p.to){let g=c0(p);return{start:h,end:g?{from:g.from,to:g.to}:void 0,matched:!0}}else if(u0(p.type,t,o))d++;else if(u0(p.type,-t,o)){if(d==0){let g=c0(p);return{start:h,end:g&&g.from<g.to?{from:g.from,to:g.to}:void 0,matched:!1}}d--}}while(t<0?p.prevSibling():p.nextSibling());return{start:h,matched:!1}}function oM(n,e,t,r,l,s,o){let c=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),h=o.indexOf(c);if(h<0||h%2==0!=t>0)return null;let d={from:t<0?e-1:e,to:t>0?e+1:e},p=n.doc.iterRange(e,t>0?n.doc.length:0),g=0;for(let b=0;!p.next().done&&b<=s;){let w=p.value;t<0&&(b+=w.length);let T=e+b*t;for(let N=t>0?0:w.length-1,D=t>0?w.length:-1;N!=D;N+=t){let j=o.indexOf(w[N]);if(!(j<0||r.resolveInner(T+N,1).type!=l))if(j%2==0==t>0)g++;else{if(g==1)return{start:d,end:{from:T+N,to:T+N+1},matched:j>>1==h>>1};g--}}t>0&&(b+=w.length)}return p.done?{start:d,matched:!1}:null}const uM=Object.create(null),L1=[fi.none],z1=[],I1=Object.create(null),cM=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])cM[n]=hM(uM,e);function ng(n,e){z1.indexOf(n)>-1||(z1.push(n),console.warn(e))}function hM(n,e){let t=[];for(let c of e.split(" ")){let h=[];for(let d of c.split(".")){let p=n[d]||Be[d];p?typeof p=="function"?h.length?h=h.map(p):ng(d,`Modifier ${d} used at start of tag`):h.length?ng(d,`Tag ${d} used as modifier`):h=Array.isArray(p)?p:[p]:ng(d,`Unknown highlighting tag ${d}`)}for(let d of h)t.push(d)}if(!t.length)return 0;let r=e.replace(/ /g,"_"),l=r+" "+t.map(c=>c.id),s=I1[l];if(s)return s.id;let o=I1[l]=fi.define({id:L1.length,name:r,props:[z3({[r]:t})]});return L1.push(o),o.id}Ln.RTL,Ln.LTR;const fM=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),r=ty(n.state,t.from);return r.line?dM(n):r.block?mM(n):!1};function ey(n,e){return({state:t,dispatch:r})=>{if(t.readOnly)return!1;let l=n(e,t);return l?(r(t.update(l)),!0):!1}}const dM=ey(xM,0),pM=ey(DS,0),mM=ey((n,e)=>DS(n,e,yM(e)),0);function ty(n,e){let t=n.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const sc=50;function gM(n,{open:e,close:t},r,l){let s=n.sliceDoc(r-sc,r),o=n.sliceDoc(l,l+sc),c=/\s*$/.exec(s)[0].length,h=/^\s*/.exec(o)[0].length,d=s.length-c;if(s.slice(d-e.length,d)==e&&o.slice(h,h+t.length)==t)return{open:{pos:r-c,margin:c&&1},close:{pos:l+h,margin:h&&1}};let p,g;l-r<=2*sc?p=g=n.sliceDoc(r,l):(p=n.sliceDoc(r,r+sc),g=n.sliceDoc(l-sc,l));let b=/^\s*/.exec(p)[0].length,w=/\s*$/.exec(g)[0].length,T=g.length-w-t.length;return p.slice(b,b+e.length)==e&&g.slice(T,T+t.length)==t?{open:{pos:r+b+e.length,margin:/\s/.test(p.charAt(b+e.length))?1:0},close:{pos:l-w-t.length,margin:/\s/.test(g.charAt(T-1))?1:0}}:null}function yM(n){let e=[];for(let t of n.selection.ranges){let r=n.doc.lineAt(t.from),l=t.to<=r.to?r:n.doc.lineAt(t.to);l.from>r.from&&l.from==t.to&&(l=t.to==r.to+1?r:n.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>r.from?e[s].to=l.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:l.to})}return e}function DS(n,e,t=e.selection.ranges){let r=t.map(s=>ty(e,s.from).block);if(!r.every(s=>s))return null;let l=t.map((s,o)=>gM(e,r[o],s.from,s.to));if(n!=2&&!l.every(s=>s))return{changes:e.changes(t.map((s,o)=>l[o]?[]:[{from:s.from,insert:r[o].open+" "},{from:s.to,insert:" "+r[o].close}]))};if(n!=1&&l.some(s=>s)){let s=[];for(let o=0,c;o<l.length;o++)if(c=l[o]){let h=r[o],{open:d,close:p}=c;s.push({from:d.pos-h.open.length,to:d.pos+d.margin},{from:p.pos-p.margin,to:p.pos+h.close.length})}return{changes:s}}return null}function xM(n,e,t=e.selection.ranges){let r=[],l=-1;for(let{from:s,to:o}of t){let c=r.length,h=1e9,d=ty(e,s).line;if(d){for(let p=s;p<=o;){let g=e.doc.lineAt(p);if(g.from>l&&(s==o||o>g.from)){l=g.from;let b=/^\s*/.exec(g.text)[0].length,w=b==g.length,T=g.text.slice(b,b+d.length)==d?b:-1;b<g.text.length&&b<h&&(h=b),r.push({line:g,comment:T,token:d,indent:b,empty:w,single:!1})}p=g.to+1}if(h<1e9)for(let p=c;p<r.length;p++)r[p].indent<r[p].line.text.length&&(r[p].indent=h);r.length==c+1&&(r[c].single=!0)}}if(n!=2&&r.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:c,token:h,indent:d,empty:p,single:g}of r)(g||!p)&&s.push({from:c.from+d,insert:h+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&r.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:c,token:h}of r)if(c>=0){let d=o.from+c,p=d+h.length;o.text[p-o.from]==" "&&p++,s.push({from:d,to:p})}return{changes:s}}return null}const h0=Oa.define(),vM=Oa.define(),bM=ct.define(),jS=ct.define({combine(n){return Cw(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,l)=>e(r,l)||t(r,l)})}}),OS=el.define({create(){return $i.empty},update(n,e){let t=e.state.facet(jS),r=e.annotation(h0);if(r){let h=_r.fromTransaction(e,r.selection),d=r.side,p=d==0?n.undone:n.done;return h?p=od(p,p.length,t.minDepth,h):p=LS(p,e.startState.selection),new $i(d==0?r.rest:p,d==0?p:r.rest)}let l=e.annotation(vM);if((l=="full"||l=="before")&&(n=n.isolate()),e.annotation(Un.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=_r.fromTransaction(e),o=e.annotation(Un.time),c=e.annotation(Un.userEvent);return s?n=n.addChanges(s,o,c,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,c,t.newGroupDelay)),(l=="full"||l=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new $i(n.done.map(_r.fromJSON),n.undone.map(_r.fromJSON))}});function kM(n={}){return[OS,jS.of(n),st.domEventHandlers({beforeinput(e,t){let r=e.inputType=="historyUndo"?RS:e.inputType=="historyRedo"?f0:null;return r?(e.preventDefault(),r(t)):!1}})]}function jd(n,e){return function({state:t,dispatch:r}){if(!e&&t.readOnly)return!1;let l=t.field(OS,!1);if(!l)return!1;let s=l.pop(n,t,e);return s?(r(s),!0):!1}}const RS=jd(0,!1),f0=jd(1,!1),wM=jd(0,!0),SM=jd(1,!0);class _r{constructor(e,t,r,l,s){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=l,this.selectionsAfter=s}setSelAfter(e){return new _r(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(l=>l.toJSON())}}static fromJSON(e){return new _r(e.changes&&Hn.fromJSON(e.changes),[],e.mapped&&Wi.fromJSON(e.mapped),e.startSelection&&Oe.fromJSON(e.startSelection),e.selectionsAfter.map(Oe.fromJSON))}static fromTransaction(e,t){let r=oi;for(let l of e.startState.facet(bM)){let s=l(e);s.length&&(r=r.concat(s))}return!r.length&&e.changes.empty?null:new _r(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,oi)}static selection(e){return new _r(void 0,oi,void 0,void 0,e)}}function od(n,e,t,r){let l=e+1>t+20?e-t-1:0,s=n.slice(l,e);return s.push(r),s}function CM(n,e){let t=[],r=!1;return n.iterChangedRanges((l,s)=>t.push(l,s)),e.iterChangedRanges((l,s,o,c)=>{for(let h=0;h<t.length;){let d=t[h++],p=t[h++];c>=d&&o<=p&&(r=!0)}}),r}function AM(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length===0}function BS(n,e){return n.length?e.length?n.concat(e):n:e}const oi=[],TM=200;function LS(n,e){if(n.length){let t=n[n.length-1],r=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-TM));return r.length&&r[r.length-1].eq(e)?n:(r.push(e),od(n,n.length-1,1e9,t.setSelAfter(r)))}else return[_r.selection([e])]}function EM(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function rg(n,e){if(!n.length)return n;let t=n.length,r=oi;for(;t;){let l=NM(n[t-1],e,r);if(l.changes&&!l.changes.empty||l.effects.length){let s=n.slice(0,t);return s[t-1]=l,s}else e=l.mapped,t--,r=l.selectionsAfter}return r.length?[_r.selection(r)]:oi}function NM(n,e,t){let r=BS(n.selectionsAfter.length?n.selectionsAfter.map(c=>c.map(e)):oi,t);if(!n.changes)return _r.selection(r);let l=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new _r(l,fn.mapEffects(n.effects,e),o,n.startSelection.map(s),r)}const MM=/^(input\.type|delete)($|\.)/;class $i{constructor(e,t,r=0,l=void 0){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=l}isolate(){return this.prevTime?new $i(this.done,this.undone):this}addChanges(e,t,r,l,s){let o=this.done,c=o[o.length-1];return c&&c.changes&&!c.changes.empty&&e.changes&&(!r||MM.test(r))&&(!c.selectionsAfter.length&&t-this.prevTime<l.newGroupDelay&&l.joinToEvent(s,CM(c.changes,e.changes))||r=="input.type.compose")?o=od(o,o.length-1,l.minDepth,new _r(e.changes.compose(c.changes),BS(fn.mapEffects(e.effects,c.changes),c.effects),c.mapped,c.startSelection,oi)):o=od(o,o.length,l.minDepth,e),new $i(o,oi,t,r)}addSelection(e,t,r,l){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:oi;return s.length>0&&t-this.prevTime<l&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&AM(s[s.length-1],e)?this:new $i(LS(this.done,e),this.undone,t,r)}addMapping(e){return new $i(rg(this.done,e),rg(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,r){let l=e==0?this.done:this.undone;if(l.length==0)return null;let s=l[l.length-1],o=s.selectionsAfter[0]||t.selection;if(r&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:h0.of({side:e,rest:EM(l),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let c=l.length==1?oi:l.slice(0,l.length-1);return s.mapped&&(c=rg(c,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:h0.of({side:e,rest:c,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}$i.empty=new $i(oi,oi);const _M=[{key:"Mod-z",run:RS,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:f0,preventDefault:!0},{linux:"Ctrl-Shift-z",run:f0,preventDefault:!0},{key:"Mod-u",run:wM,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:SM,preventDefault:!0}];function Wo(n,e){return Oe.create(n.ranges.map(e),n.mainIndex)}function Ai(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Ti({state:n,dispatch:e},t){let r=Wo(n.selection,t);return r.eq(n.selection,!0)?!1:(e(Ai(n,r)),!0)}function Od(n,e){return Oe.cursor(e?n.to:n.from)}function zS(n,e){return Ti(n,t=>t.empty?n.moveByChar(t,e):Od(t,e))}function dr(n){return n.textDirectionAt(n.state.selection.main.head)==Ln.LTR}const IS=n=>zS(n,!dr(n)),PS=n=>zS(n,dr(n));function HS(n,e){return Ti(n,t=>t.empty?n.moveByGroup(t,e):Od(t,e))}const DM=n=>HS(n,!dr(n)),jM=n=>HS(n,dr(n));function OM(n,e,t){if(e.type.prop(t))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function Rd(n,e,t){let r=Ji(n).resolveInner(e.head),l=t?Ot.closedBy:Ot.openedBy;for(let h=e.head;;){let d=t?r.childAfter(h):r.childBefore(h);if(!d)break;OM(n,d,l)?r=d:h=t?d.to:d.from}let s=r.type.prop(l),o,c;return s&&(o=t?Eo(n,r.from,1):Eo(n,r.to,-1))&&o.matched?c=t?o.end.to:o.end.from:c=t?r.to:r.from,Oe.cursor(c,t?-1:1)}const RM=n=>Ti(n,e=>Rd(n.state,e,!dr(n))),BM=n=>Ti(n,e=>Rd(n.state,e,dr(n)));function qS(n,e){return Ti(n,t=>{if(!t.empty)return Od(t,e);let r=n.moveVertically(t,e);return r.head!=t.head?r:n.moveToLineBoundary(t,e)})}const US=n=>qS(n,!1),FS=n=>qS(n,!0);function VS(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,r=0,l;if(e){for(let s of n.state.facet(st.scrollMargins)){let o=s(n);o?.top&&(t=Math.max(o?.top,t)),o?.bottom&&(r=Math.max(o?.bottom,r))}l=n.scrollDOM.clientHeight-t-r}else l=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:r,selfScroll:e,height:Math.max(n.defaultLineHeight,l-5)}}function KS(n,e){let t=VS(n),{state:r}=n,l=Wo(r.selection,o=>o.empty?n.moveVertically(o,e,t.height):Od(o,e));if(l.eq(r.selection))return!1;let s;if(t.selfScroll){let o=n.coordsAtPos(r.selection.main.head),c=n.scrollDOM.getBoundingClientRect(),h=c.top+t.marginTop,d=c.bottom-t.marginBottom;o&&o.top>h&&o.bottom<d&&(s=st.scrollIntoView(l.main.head,{y:"start",yMargin:o.top-h}))}return n.dispatch(Ai(r,l),{effects:s}),!0}const P1=n=>KS(n,!1),d0=n=>KS(n,!0);function Ra(n,e,t){let r=n.lineBlockAt(e.head),l=n.moveToLineBoundary(e,t);if(l.head==e.head&&l.head!=(t?r.to:r.from)&&(l=n.moveToLineBoundary(e,t,!1)),!t&&l.head==r.from&&r.length){let s=/^\s*/.exec(n.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&e.head!=r.from+s&&(l=Oe.cursor(r.from+s))}return l}const LM=n=>Ti(n,e=>Ra(n,e,!0)),zM=n=>Ti(n,e=>Ra(n,e,!1)),IM=n=>Ti(n,e=>Ra(n,e,!dr(n))),PM=n=>Ti(n,e=>Ra(n,e,dr(n))),HM=n=>Ti(n,e=>Oe.cursor(n.lineBlockAt(e.head).from,1)),qM=n=>Ti(n,e=>Oe.cursor(n.lineBlockAt(e.head).to,-1));function UM(n,e,t){let r=!1,l=Wo(n.selection,s=>{let o=Eo(n,s.head,-1)||Eo(n,s.head,1)||s.head>0&&Eo(n,s.head-1,1)||s.head<n.doc.length&&Eo(n,s.head+1,-1);if(!o||!o.end)return s;r=!0;let c=o.start.from==s.head?o.end.to:o.end.from;return Oe.cursor(c)});return r?(e(Ai(n,l)),!0):!1}const FM=({state:n,dispatch:e})=>UM(n,e);function di(n,e){let t=Wo(n.state.selection,r=>{let l=e(r);return Oe.range(r.anchor,l.head,l.goalColumn,l.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(Ai(n.state,t)),!0)}function GS(n,e){return di(n,t=>n.moveByChar(t,e))}const YS=n=>GS(n,!dr(n)),QS=n=>GS(n,dr(n));function XS(n,e){return di(n,t=>n.moveByGroup(t,e))}const VM=n=>XS(n,!dr(n)),KM=n=>XS(n,dr(n)),GM=n=>di(n,e=>Rd(n.state,e,!dr(n))),YM=n=>di(n,e=>Rd(n.state,e,dr(n)));function $S(n,e){return di(n,t=>n.moveVertically(t,e))}const WS=n=>$S(n,!1),ZS=n=>$S(n,!0);function JS(n,e){return di(n,t=>n.moveVertically(t,e,VS(n).height))}const H1=n=>JS(n,!1),q1=n=>JS(n,!0),QM=n=>di(n,e=>Ra(n,e,!0)),XM=n=>di(n,e=>Ra(n,e,!1)),$M=n=>di(n,e=>Ra(n,e,!dr(n))),WM=n=>di(n,e=>Ra(n,e,dr(n))),ZM=n=>di(n,e=>Oe.cursor(n.lineBlockAt(e.head).from)),JM=n=>di(n,e=>Oe.cursor(n.lineBlockAt(e.head).to)),U1=({state:n,dispatch:e})=>(e(Ai(n,{anchor:0})),!0),F1=({state:n,dispatch:e})=>(e(Ai(n,{anchor:n.doc.length})),!0),V1=({state:n,dispatch:e})=>(e(Ai(n,{anchor:n.selection.main.anchor,head:0})),!0),K1=({state:n,dispatch:e})=>(e(Ai(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),e5=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),t5=({state:n,dispatch:e})=>{let t=Bd(n).map(({from:r,to:l})=>Oe.range(r,Math.min(l+1,n.doc.length)));return e(n.update({selection:Oe.create(t),userEvent:"select"})),!0},n5=({state:n,dispatch:e})=>{let t=Wo(n.selection,r=>{let l=Ji(n),s=l.resolveStack(r.from,1);if(r.empty){let o=l.resolveStack(r.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:c}=o;if((c.from<r.from&&c.to>=r.to||c.to>r.to&&c.from<=r.from)&&o.next)return Oe.range(c.to,c.from)}return r});return t.eq(n.selection)?!1:(e(Ai(n,t)),!0)};function e2(n,e){let{state:t}=n,r=t.selection,l=t.selection.ranges.slice();for(let s of t.selection.ranges){let o=t.doc.lineAt(s.head);if(e?o.to<n.state.doc.length:o.from>0)for(let c=s;;){let h=n.moveVertically(c,e);if(h.head<o.from||h.head>o.to){l.some(d=>d.head==h.head)||l.push(h);break}else{if(h.head==c.head)break;c=h}}}return l.length==r.ranges.length?!1:(n.dispatch(Ai(t,Oe.create(l,l.length-1))),!0)}const r5=n=>e2(n,!1),i5=n=>e2(n,!0),l5=({state:n,dispatch:e})=>{let t=n.selection,r=null;return t.ranges.length>1?r=Oe.create([t.main]):t.main.empty||(r=Oe.create([Oe.cursor(t.main.head)])),r?(e(Ai(n,r)),!0):!1};function Fc(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:r}=n,l=r.changeByRange(s=>{let{from:o,to:c}=s;if(o==c){let h=e(s);h<o?(t="delete.backward",h=Cf(n,h,!1)):h>o&&(t="delete.forward",h=Cf(n,h,!0)),o=Math.min(o,h),c=Math.max(c,h)}else o=Cf(n,o,!1),c=Cf(n,c,!0);return o==c?{range:s}:{changes:{from:o,to:c},range:Oe.cursor(o,o<s.head?-1:1)}});return l.changes.empty?!1:(n.dispatch(r.update(l,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?st.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function Cf(n,e,t){if(n instanceof st)for(let r of n.state.facet(st.atomicRanges).map(l=>l(n)))r.between(e,e,(l,s)=>{l<e&&s>e&&(e=t?s:l)});return e}const t2=(n,e,t)=>Fc(n,r=>{let l=r.from,{state:s}=n,o=s.doc.lineAt(l),c,h;if(t&&!e&&l>o.from&&l<o.from+200&&!/[^ \t]/.test(c=o.text.slice(0,l-o.from))){if(c[c.length-1]=="	")return l-1;let d=Sd(c,s.tabSize),p=d%ad(s)||ad(s);for(let g=0;g<p&&c[c.length-1-g]==" ";g++)l--;h=l}else h=qn(o.text,l-o.from,e,e)+o.from,h==l&&o.number!=(e?s.doc.lines:1)?h+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(h-o.from,l-o.from))&&(h=qn(o.text,h-o.from,!1,!1)+o.from);return h}),p0=n=>t2(n,!1,!0),n2=n=>t2(n,!0,!1),r2=(n,e)=>Fc(n,t=>{let r=t.head,{state:l}=n,s=l.doc.lineAt(r),o=l.charCategorizer(r);for(let c=null;;){if(r==(e?s.to:s.from)){r==t.head&&s.number!=(e?l.doc.lines:1)&&(r+=e?1:-1);break}let h=qn(s.text,r-s.from,e)+s.from,d=s.text.slice(Math.min(r,h)-s.from,Math.max(r,h)-s.from),p=o(d);if(c!=null&&p!=c)break;(d!=" "||r!=t.head)&&(c=p),r=h}return r}),i2=n=>r2(n,!1),a5=n=>r2(n,!0),s5=n=>Fc(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),o5=n=>Fc(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),u5=n=>Fc(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),c5=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:Lt.of(["",""])},range:Oe.cursor(r.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},h5=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>{if(!r.empty||r.from==0||r.from==n.doc.length)return{range:r};let l=r.from,s=n.doc.lineAt(l),o=l==s.from?l-1:qn(s.text,l-s.from,!1)+s.from,c=l==s.to?l+1:qn(s.text,l-s.from,!0)+s.from;return{changes:{from:o,to:c,insert:n.doc.slice(l,c).append(n.doc.slice(o,l))},range:Oe.cursor(c)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Bd(n){let e=[],t=-1;for(let r of n.selection.ranges){let l=n.doc.lineAt(r.from),s=n.doc.lineAt(r.to);if(!r.empty&&r.to==s.from&&(s=n.doc.lineAt(r.to-1)),t>=l.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(r)}else e.push({from:l.from,to:s.to,ranges:[r]});t=s.number+1}return e}function l2(n,e,t){if(n.readOnly)return!1;let r=[],l=[];for(let s of Bd(n)){if(t?s.to==n.doc.length:s.from==0)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),c=o.length+1;if(t){r.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let h of s.ranges)l.push(Oe.range(Math.min(n.doc.length,h.anchor+c),Math.min(n.doc.length,h.head+c)))}else{r.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let h of s.ranges)l.push(Oe.range(h.anchor-c,h.head-c))}}return r.length?(e(n.update({changes:r,scrollIntoView:!0,selection:Oe.create(l,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const f5=({state:n,dispatch:e})=>l2(n,e,!1),d5=({state:n,dispatch:e})=>l2(n,e,!0);function a2(n,e,t){if(n.readOnly)return!1;let r=[];for(let s of Bd(n))t?r.push({from:s.from,insert:n.doc.slice(s.from,s.to)+n.lineBreak}):r.push({from:s.to,insert:n.lineBreak+n.doc.slice(s.from,s.to)});let l=n.changes(r);return e(n.update({changes:l,selection:n.selection.map(l,t?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const p5=({state:n,dispatch:e})=>a2(n,e,!1),m5=({state:n,dispatch:e})=>a2(n,e,!0),g5=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Bd(e).map(({from:l,to:s})=>(l>0?l--:s<e.doc.length&&s++,{from:l,to:s}))),r=Wo(e.selection,l=>{let s;if(n.lineWrapping){let o=n.lineBlockAt(l.head),c=n.coordsAtPos(l.head,l.assoc||1);c&&(s=o.bottom+n.documentTop-c.bottom+n.defaultLineHeight/2)}return n.moveVertically(l,!0,s)}).map(t);return n.dispatch({changes:t,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function y5(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Ji(n).resolveInner(e),r=t.childBefore(e),l=t.childAfter(e),s;return r&&l&&r.to<=e&&l.from>=e&&(s=r.type.prop(Ot.closedBy))&&s.indexOf(l.name)>-1&&n.doc.lineAt(r.to).from==n.doc.lineAt(l.from).from&&!/\S/.test(n.sliceDoc(r.to,l.from))?{from:r.to,to:l.from}:null}const G1=s2(!1),x5=s2(!0);function s2(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(l=>{let{from:s,to:o}=l,c=e.doc.lineAt(s),h=!n&&s==o&&y5(e,s);n&&(s=o=(o<=c.to?c:e.doc.lineAt(o)).to);let d=new _d(e,{simulateBreak:s,simulateDoubleBreak:!!h}),p=MS(d,s);for(p==null&&(p=Sd(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<c.to&&/\s/.test(c.text[o-c.from]);)o++;h?{from:s,to:o}=h:s>c.from&&s<c.from+100&&!/\S/.test(c.text.slice(0,s))&&(s=c.from);let g=["",sd(e,p)];return h&&g.push(sd(e,d.lineIndent(c.from,-1))),{changes:{from:s,to:o,insert:Lt.of(g)},range:Oe.cursor(s+1+g[1].length)}});return t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function ny(n,e){let t=-1;return n.changeByRange(r=>{let l=[];for(let o=r.from;o<=r.to;){let c=n.doc.lineAt(o);c.number>t&&(r.empty||r.to>c.from)&&(e(c,l,r),t=c.number),o=c.to+1}let s=n.changes(l);return{changes:l,range:Oe.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}})}const v5=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),r=new _d(n,{overrideIndentation:s=>{let o=t[s];return o??-1}}),l=ny(n,(s,o,c)=>{let h=MS(r,s.from);if(h==null)return;/\S/.test(s.text)||(h=0);let d=/^\s*/.exec(s.text)[0],p=sd(n,h);(d!=p||c.from<s.from+d.length)&&(t[s.from]=h,o.push({from:s.from,to:s.from+d.length,insert:p}))});return l.changes.empty||e(n.update(l,{userEvent:"indent"})),!0},b5=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(ny(n,(t,r)=>{r.push({from:t.from,insert:n.facet(Z0)})}),{userEvent:"input.indent"})),!0),k5=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(ny(n,(t,r)=>{let l=/^\s*/.exec(t.text)[0];if(!l)return;let s=Sd(l,n.tabSize),o=0,c=sd(n,Math.max(0,s-ad(n)));for(;o<l.length&&o<c.length&&l.charCodeAt(o)==c.charCodeAt(o);)o++;r.push({from:t.from+o,to:t.from+l.length,insert:c.slice(o)})}),{userEvent:"delete.dedent"})),!0),w5=n=>(n.setTabFocusMode(),!0),S5=[{key:"Ctrl-b",run:IS,shift:YS,preventDefault:!0},{key:"Ctrl-f",run:PS,shift:QS},{key:"Ctrl-p",run:US,shift:WS},{key:"Ctrl-n",run:FS,shift:ZS},{key:"Ctrl-a",run:HM,shift:ZM},{key:"Ctrl-e",run:qM,shift:JM},{key:"Ctrl-d",run:n2},{key:"Ctrl-h",run:p0},{key:"Ctrl-k",run:s5},{key:"Ctrl-Alt-h",run:i2},{key:"Ctrl-o",run:c5},{key:"Ctrl-t",run:h5},{key:"Ctrl-v",run:d0}],C5=[{key:"ArrowLeft",run:IS,shift:YS,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:DM,shift:VM,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:IM,shift:$M,preventDefault:!0},{key:"ArrowRight",run:PS,shift:QS,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:jM,shift:KM,preventDefault:!0},{mac:"Cmd-ArrowRight",run:PM,shift:WM,preventDefault:!0},{key:"ArrowUp",run:US,shift:WS,preventDefault:!0},{mac:"Cmd-ArrowUp",run:U1,shift:V1},{mac:"Ctrl-ArrowUp",run:P1,shift:H1},{key:"ArrowDown",run:FS,shift:ZS,preventDefault:!0},{mac:"Cmd-ArrowDown",run:F1,shift:K1},{mac:"Ctrl-ArrowDown",run:d0,shift:q1},{key:"PageUp",run:P1,shift:H1},{key:"PageDown",run:d0,shift:q1},{key:"Home",run:zM,shift:XM,preventDefault:!0},{key:"Mod-Home",run:U1,shift:V1},{key:"End",run:LM,shift:QM,preventDefault:!0},{key:"Mod-End",run:F1,shift:K1},{key:"Enter",run:G1,shift:G1},{key:"Mod-a",run:e5},{key:"Backspace",run:p0,shift:p0,preventDefault:!0},{key:"Delete",run:n2,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:i2,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:a5,preventDefault:!0},{mac:"Mod-Backspace",run:o5,preventDefault:!0},{mac:"Mod-Delete",run:u5,preventDefault:!0}].concat(S5.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),A5=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:RM,shift:GM},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:BM,shift:YM},{key:"Alt-ArrowUp",run:f5},{key:"Shift-Alt-ArrowUp",run:p5},{key:"Alt-ArrowDown",run:d5},{key:"Shift-Alt-ArrowDown",run:m5},{key:"Mod-Alt-ArrowUp",run:r5},{key:"Mod-Alt-ArrowDown",run:i5},{key:"Escape",run:l5},{key:"Mod-Enter",run:x5},{key:"Alt-l",mac:"Ctrl-l",run:t5},{key:"Mod-i",run:n5,preventDefault:!0},{key:"Mod-[",run:k5},{key:"Mod-]",run:b5},{key:"Mod-Alt-\\",run:v5},{key:"Shift-Mod-k",run:g5},{key:"Shift-Mod-\\",run:FM},{key:"Mod-/",run:fM},{key:"Alt-A",run:pM},{key:"Ctrl-m",mac:"Shift-Alt-m",run:w5}].concat(C5),T5="#e5c07b",Y1="#e06c75",E5="#56b6c2",N5="#ffffff",If="#abb2bf",m0="#7d8799",M5="#61afef",_5="#98c379",Q1="#d19a66",D5="#c678dd",j5="#21252b",X1="#2c313a",$1="#282c34",ig="#353a42",O5="#3E4451",W1="#528bff",R5=st.theme({"&":{color:If,backgroundColor:$1},".cm-content":{caretColor:W1},".cm-cursor, .cm-dropCursor":{borderLeftColor:W1},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:O5},".cm-panels":{backgroundColor:j5,color:If},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:$1,color:m0,border:"none"},".cm-activeLineGutter":{backgroundColor:X1},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:ig},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:ig,borderBottomColor:ig},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:X1,color:If}}},{dark:!0}),B5=Dd.define([{tag:Be.keyword,color:D5},{tag:[Be.name,Be.deleted,Be.character,Be.propertyName,Be.macroName],color:Y1},{tag:[Be.function(Be.variableName),Be.labelName],color:M5},{tag:[Be.color,Be.constant(Be.name),Be.standard(Be.name)],color:Q1},{tag:[Be.definition(Be.name),Be.separator],color:If},{tag:[Be.typeName,Be.className,Be.number,Be.changed,Be.annotation,Be.modifier,Be.self,Be.namespace],color:T5},{tag:[Be.operator,Be.operatorKeyword,Be.url,Be.escape,Be.regexp,Be.link,Be.special(Be.string)],color:E5},{tag:[Be.meta,Be.comment],color:m0},{tag:Be.strong,fontWeight:"bold"},{tag:Be.emphasis,fontStyle:"italic"},{tag:Be.strikethrough,textDecoration:"line-through"},{tag:Be.link,color:m0,textDecoration:"underline"},{tag:Be.heading,fontWeight:"bold",color:Y1},{tag:[Be.atom,Be.bool,Be.special(Be.variableName)],color:Q1},{tag:[Be.processingInstruction,Be.string,Be.inserted],color:_5},{tag:Be.invalid,color:N5}]),L5=[R5,tM(B5)],Z1=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class o2{constructor(e,t,r=0,l=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,l),this.bufferStart=r,this.normalize=s?c=>s(Z1(c)):Z1,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return hw(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=xE(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=fw(e);let l=this.normalize(t);if(l.length)for(let s=0,o=r;;s++){let c=l.charCodeAt(s),h=this.match(c,o,this.bufferPos+this.bufferStart);if(s==l.length-1){if(h)return this.value=h,this;break}o==r&&s<t.length&&t.charCodeAt(s)==c&&o++}}}match(e,t,r){let l=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],c=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?l={from:this.matches[s+1],to:r}:(this.matches[s]++,c=!0)),c||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?l={from:t,to:r}:this.matches.push(1,t)),l&&this.test&&!this.test(l.from,l.to,this.buffer,this.bufferStart)&&(l=null),l}}typeof Symbol<"u"&&(o2.prototype[Symbol.iterator]=function(){return this});const u2={from:-1,to:-1,match:/.*/.exec("")},ry="gm"+(/x/.unicode==null?"":"u");class c2{constructor(e,t,r,l=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=u2,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new h2(e,t,r,l,s);this.re=new RegExp(t,ry+(r?.ignoreCase?"i":"")),this.test=r?.test,this.iter=e.iter();let o=e.lineAt(l);this.curLineStart=o.from,this.matchPos=ud(e,l),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,l=r+t[0].length;if(this.matchPos=ud(this.text,l+(r==l?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<l||r>this.value.to)&&(!this.test||this.test(r,l,t)))return this.value={from:r,to:l,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const lg=new WeakMap;class Bo{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let l=lg.get(e);if(!l||l.from>=r||l.to<=t){let c=new Bo(t,e.sliceString(t,r));return lg.set(e,c),c}if(l.from==t&&l.to==r)return l;let{text:s,from:o}=l;return o>t&&(s=e.sliceString(t,o)+s,o=t),l.to<r&&(s+=e.sliceString(l.to,r)),lg.set(e,new Bo(o,s)),new Bo(t,s.slice(t-o,r-o))}}class h2{constructor(e,t,r,l,s){this.text=e,this.to=s,this.done=!1,this.value=u2,this.matchPos=ud(e,l),this.re=new RegExp(t,ry+(r?.ignoreCase?"i":"")),this.test=r?.test,this.flat=Bo.get(e,l,this.chunkEnd(l+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let r=this.flat.from+t.index,l=r+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,l,t)))return this.value={from:r,to:l,match:t},this.matchPos=ud(this.text,l+(r==l?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Bo.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(c2.prototype[Symbol.iterator]=h2.prototype[Symbol.iterator]=function(){return this});function z5(n){try{return new RegExp(n,ry),!0}catch{return!1}}function ud(n,e){if(e>=n.length)return e;let t=n.lineAt(e),r;for(;e<t.to&&(r=t.text.charCodeAt(e-t.from))>=56320&&r<57344;)e++;return e}const Zo=ct.define({combine(n){return Cw(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Q5(e),scrollToMatch:e=>st.scrollIntoView(e)})}});class Lc{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||z5(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord,this.test=e.test}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord&&this.test==e.test}create(){return this.regexp?new F5(this):new H5(this)}getCursor(e,t=0,r){let l=e.doc?e:Ht.create({doc:e});return r==null&&(r=l.doc.length),this.regexp?So(this,l,t,r):wo(this,l,t,r)}}class f2{constructor(e){this.spec=e}}function I5(n,e,t){return(r,l,s,o)=>{if(t&&!t(r,l,s,o))return!1;let c=r>=o&&l<=o+s.length?s.slice(r-o,l-o):e.doc.sliceString(r,l);return n(c,e,r,l)}}function wo(n,e,t,r){let l;return n.wholeWord&&(l=P5(e.doc,e.charCategorizer(e.selection.main.head))),n.test&&(l=I5(n.test,e,l)),new o2(e.doc,n.unquoted,t,r,n.caseSensitive?void 0:s=>s.toLowerCase(),l)}function P5(n,e){return(t,r,l,s)=>((s>t||s+l.length<r)&&(s=Math.max(0,t-2),l=n.sliceString(s,Math.min(n.length,r+2))),(e(cd(l,t-s))!=ir.Word||e(hd(l,t-s))!=ir.Word)&&(e(hd(l,r-s))!=ir.Word||e(cd(l,r-s))!=ir.Word))}class H5 extends f2{constructor(e){super(e)}nextMatch(e,t,r){let l=wo(this.spec,e,r,e.doc.length).nextOverlapping();if(l.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);l=wo(this.spec,e,0,s).nextOverlapping()}return l.done||l.value.from==t&&l.value.to==r?null:l.value}prevMatchInRange(e,t,r){for(let l=r;;){let s=Math.max(t,l-1e4-this.spec.unquoted.length),o=wo(this.spec,e,s,l),c=null;for(;!o.nextOverlapping().done;)c=o.value;if(c)return c;if(s==t)return null;l-=1e4}}prevMatch(e,t,r){let l=this.prevMatchInRange(e,0,t);return l||(l=this.prevMatchInRange(e,Math.max(0,r-this.spec.unquoted.length),e.doc.length)),l&&(l.from!=t||l.to!=r)?l:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=wo(this.spec,e,0,e.doc.length),l=[];for(;!r.next().done;){if(l.length>=t)return null;l.push(r.value)}return l}highlight(e,t,r,l){let s=wo(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)l(s.value.from,s.value.to)}}function q5(n,e,t){return(r,l,s)=>(!t||t(r,l,s))&&n(s[0],e,r,l)}function So(n,e,t,r){let l;return n.wholeWord&&(l=U5(e.charCategorizer(e.selection.main.head))),n.test&&(l=q5(n.test,e,l)),new c2(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:l},t,r)}function cd(n,e){return n.slice(qn(n,e,!1),e)}function hd(n,e){return n.slice(e,qn(n,e))}function U5(n){return(e,t,r)=>!r[0].length||(n(cd(r.input,r.index))!=ir.Word||n(hd(r.input,r.index))!=ir.Word)&&(n(hd(r.input,r.index+r[0].length))!=ir.Word||n(cd(r.input,r.index+r[0].length))!=ir.Word)}class F5 extends f2{nextMatch(e,t,r){let l=So(this.spec,e,r,e.doc.length).next();return l.done&&(l=So(this.spec,e,0,t).next()),l.done?null:l.value}prevMatchInRange(e,t,r){for(let l=1;;l++){let s=Math.max(t,r-l*1e4),o=So(this.spec,e,s,r),c=null;for(;!o.next().done;)c=o.value;if(c&&(s==t||c.from>s+10))return c;if(s==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,r)=>{if(r=="&")return e.match[0];if(r=="$")return"$";for(let l=r.length;l>0;l--){let s=+r.slice(0,l);if(s>0&&s<e.match.length)return e.match[s]+r.slice(l)}return t})}matchAll(e,t){let r=So(this.spec,e,0,e.doc.length),l=[];for(;!r.next().done;){if(l.length>=t)return null;l.push(r.value)}return l}highlight(e,t,r,l){let s=So(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));for(;!s.next().done;)l(s.value.from,s.value.to)}}const ja=fn.define(),iy=fn.define(),Ol=el.define({create(n){return new ag(dd(n).create(),null)},update(n,e){for(let t of e.effects)t.is(ja)?n=new ag(t.value.create(),n.panel):t.is(iy)&&(n=new ag(n.query,t.value?ly:null));return n},provide:n=>rd.from(n,e=>e.panel)});function zc(n){let e=n.field(Ol,!1);return e?e.query.spec:dd(n)}class ag{constructor(e,t){this.query=e,this.panel=t}}const V5=Nn.mark({class:"cm-searchMatch"}),K5=Nn.mark({class:"cm-searchMatch cm-searchMatch-selected"}),G5=Si.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(Ol))}update(n){let e=n.state.field(Ol);(e!=n.startState.field(Ol)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return Nn.none;let{view:t}=this,r=new Po;for(let l=0,s=t.visibleRanges,o=s.length;l<o;l++){let{from:c,to:h}=s[l];for(;l<o-1&&h>s[l+1].from-500;)h=s[++l].to;n.highlight(t.state,c,h,(d,p)=>{let g=t.state.selection.ranges.some(b=>b.from==d&&b.to==p);r.add(d,p,g?K5:V5)})}return r.finish()}},{decorations:n=>n.decorations});function Vc(n){return e=>{let t=e.state.field(Ol,!1);return t&&t.query.spec.valid?n(e,t):g2(e)}}const wc=Vc((n,{query:e})=>{let{to:t}=n.state.selection.main,r=e.nextMatch(n.state,t,t);if(!r)return!1;let l=Oe.single(r.from,r.to),s=n.state.facet(Zo);return n.dispatch({selection:l,effects:[ay(n,r),s.scrollToMatch(l.main,n)],userEvent:"select.search"}),m2(n),!0}),fd=Vc((n,{query:e})=>{let{state:t}=n,{from:r}=t.selection.main,l=e.prevMatch(t,r,r);if(!l)return!1;let s=Oe.single(l.from,l.to),o=n.state.facet(Zo);return n.dispatch({selection:s,effects:[ay(n,l),o.scrollToMatch(s.main,n)],userEvent:"select.search"}),m2(n),!0}),Y5=Vc((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:Oe.create(t.map(r=>Oe.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),g0=Vc((n,{query:e})=>{let{state:t}=n,{from:r,to:l}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,r,r);if(!s)return!1;let o=s,c=[],h,d,p=[];o.from==r&&o.to==l&&(d=t.toText(e.getReplacement(o)),c.push({from:o.from,to:o.to,insert:d}),o=e.nextMatch(t,o.from,o.to),p.push(st.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(r).number)+".")));let g=n.state.changes(c);return o&&(h=Oe.single(o.from,o.to).map(g),p.push(ay(n,o)),p.push(t.facet(Zo).scrollToMatch(h.main,n))),n.dispatch({changes:g,selection:h,effects:p,userEvent:"input.replace"}),!0}),d2=Vc((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(l=>{let{from:s,to:o}=l;return{from:s,to:o,insert:e.getReplacement(l)}});if(!t.length)return!1;let r=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:st.announce.of(r),userEvent:"input.replace.all"}),!0});function ly(n){return n.state.facet(Zo).createPanel(n)}function dd(n,e){var t,r,l,s,o;let c=n.selection.main,h=c.empty||c.to>c.from+100?"":n.sliceDoc(c.from,c.to);if(e&&!h)return e;let d=n.facet(Zo);return new Lc({search:((t=e?.literal)!==null&&t!==void 0?t:d.literal)?h:h.replace(/\n/g,"\\n"),caseSensitive:(r=e?.caseSensitive)!==null&&r!==void 0?r:d.caseSensitive,literal:(l=e?.literal)!==null&&l!==void 0?l:d.literal,regexp:(s=e?.regexp)!==null&&s!==void 0?s:d.regexp,wholeWord:(o=e?.wholeWord)!==null&&o!==void 0?o:d.wholeWord})}function p2(n){let e=kS(n,ly);return e&&e.dom.querySelector("[main-field]")}function m2(n){let e=p2(n);e&&e==n.root.activeElement&&e.select()}const g2=n=>{let e=n.state.field(Ol,!1);if(e&&e.panel){let t=p2(n);if(t&&t!=n.root.activeElement){let r=dd(n.state,e.query.spec);r.valid&&n.dispatch({effects:ja.of(r)}),t.focus(),t.select()}}else n.dispatch({effects:[iy.of(!0),e?ja.of(dd(n.state,e.query.spec)):fn.appendConfig.of($5)]});return!0},y2=n=>{let e=n.state.field(Ol,!1);if(!e||!e.panel)return!1;let t=kS(n,ly);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:iy.of(!1)}),!0};class Q5{constructor(e){this.view=e;let t=this.query=e.state.field(Ol).query.spec;this.commit=this.commit.bind(this),this.searchField=ii("input",{value:t.search,placeholder:qr(e,"Find"),"aria-label":qr(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ii("input",{value:t.replace,placeholder:qr(e,"Replace"),"aria-label":qr(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ii("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=ii("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=ii("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function r(l,s,o){return ii("button",{class:"cm-button",name:l,onclick:s,type:"button"},o)}this.dom=ii("div",{onkeydown:l=>this.keydown(l),class:"cm-search"},[this.searchField,r("next",()=>wc(e),[qr(e,"next")]),r("prev",()=>fd(e),[qr(e,"previous")]),r("select",()=>Y5(e),[qr(e,"all")]),ii("label",null,[this.caseField,qr(e,"match case")]),ii("label",null,[this.reField,qr(e,"regexp")]),ii("label",null,[this.wordField,qr(e,"by word")]),...e.state.readOnly?[]:[ii("br"),this.replaceField,r("replace",()=>g0(e),[qr(e,"replace")]),r("replaceAll",()=>d2(e),[qr(e,"replace all")])],ii("button",{name:"close",onclick:()=>y2(e),"aria-label":qr(e,"close"),type:"button"},[""])])}commit(){let e=new Lc({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:ja.of(e)}))}keydown(e){k3(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?fd:wc)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),g0(this.view))}update(e){for(let t of e.transactions)for(let r of t.effects)r.is(ja)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Zo).top}}function qr(n,e){return n.state.phrase(e)}const Af=30,Tf=/[\s\.,:;?!]/;function ay(n,{from:e,to:t}){let r=n.state.doc.lineAt(e),l=n.state.doc.lineAt(t).to,s=Math.max(r.from,e-Af),o=Math.min(l,t+Af),c=n.state.sliceDoc(s,o);if(s!=r.from){for(let h=0;h<Af;h++)if(!Tf.test(c[h+1])&&Tf.test(c[h])){c=c.slice(h);break}}if(o!=l){for(let h=c.length-1;h>c.length-Af;h--)if(!Tf.test(c[h-1])&&Tf.test(c[h])){c=c.slice(0,h);break}}return st.announce.of(`${n.state.phrase("current match")}. ${c} ${n.state.phrase("on line")} ${r.number}.`)}const X5=st.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),$5=[Ol,kd.low(G5),X5],Sc=el.define({create:()=>!1,update:(n,e)=>{for(const t of e.effects)if(t.is(pd))return t.value;return n}}),pd=fn.define();function W5(n){const e=n.state.selection.main;return e.from===e.to?null:n.state.doc.sliceString(e.from,e.to)}function y0(n){const e=W5(n),t=zc(n.state);if(e!==null){const r=new Lc({search:e,caseSensitive:t.caseSensitive,wholeWord:t.wholeWord,regexp:t.regexp,replace:t.replace});n.dispatch({effects:[ja.of(r),pd.of(!0)]})}else n.dispatch({effects:pd.of(!0)});return g2(n),!0}function Cc(n){return n.dispatch({effects:pd.of(!1)}),y2(n),!0}function Z5(n){return n.state.field(Sc)?Cc(n):y0(n)}function x2(n,e){if(!e.search)return 0;const t=n.state.doc.toString();let r=0;try{const l=e.regexp?e.search:e.search.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=e.caseSensitive?"g":"gi",o=new RegExp(l,s);let c;for(;(c=o.exec(t))!==null;)r++,c[0].length===0&&o.lastIndex++}catch{return 0}return r}function v2(n,e){if(!e.search)return 0;const t=n.state.selection.main,r=n.state.doc.toString(),l=t.from;try{const s=e.regexp?e.search:e.search.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=e.caseSensitive?"g":"gi",c=new RegExp(s,o);let h=0,d;for(;(d=c.exec(r))!==null;){if(h++,d.index<=l&&l<d.index+d[0].length)return h;d[0].length===0&&c.lastIndex++}}catch{return 0}return 0}function J5(n){const e=document.createElement("div");e.className="cm-toolbar-search-panel";const t=zc(n.state);e.innerHTML=`
    <div class="search-container">
      <div class="search-row">
        <input type="text" class="search-input" placeholder="Find..." value="${t.search||""}" />
        <button class="search-btn prev" title="Previous"></button>
        <button class="search-btn next" title="Next"></button>
        <span class="search-match-count"></span>
        <label class="search-option"><input type="checkbox" class="case-sensitive" ${t.caseSensitive?"checked":""} /><span>Aa</span></label>
        <label class="search-option"><input type="checkbox" class="whole-word" ${t.wholeWord?"checked":""} /><span>ab</span></label>
        <label class="search-option"><input type="checkbox" class="regexp" ${t.regexp?"checked":""} /><span>.*</span></label>
        <button class="search-btn close"></button>
      </div>
      <div class="replace-row">
        <input type="text" class="replace-input" placeholder="Replace..." value="${t.replace||""}" />
        <button class="search-btn replace">Replace</button>
        <button class="search-btn replace-all">Replace All</button>
      </div>
    </div>
  `;const r=e.querySelector(".search-input"),l=e.querySelector(".replace-input"),s=e.querySelector(".case-sensitive"),o=e.querySelector(".whole-word"),c=e.querySelector(".regexp"),h=e.querySelector(".prev"),d=e.querySelector(".next"),p=e.querySelector(".replace"),g=e.querySelector(".replace-all"),b=e.querySelector(".close"),w=e.querySelector(".search-match-count");setTimeout(()=>r.focus(),0);const T=()=>{const D=new Lc({search:r.value,caseSensitive:s.checked,wholeWord:o.checked,regexp:c.checked,replace:l.value});n.dispatch({effects:ja.of(D)}),N()},N=()=>{const D=zc(n.state),j=x2(n,D),U=j>0?v2(n,D):0;D.search?(w.textContent=j>0?`${U||0}/${j}`:"0/0",w.style.display="inline"):w.style.display="none"};return[r,l].forEach(D=>D.addEventListener("input",T)),[s,o,c].forEach(D=>D.addEventListener("change",T)),r.addEventListener("keydown",D=>{D.key==="Enter"?(D.preventDefault(),D.shiftKey?fd(n):wc(n),setTimeout(N,10)):D.key==="Escape"&&(Cc(n),n.focus())}),l.addEventListener("keydown",D=>{D.key==="Escape"&&(Cc(n),n.focus())}),h.addEventListener("click",()=>{fd(n),setTimeout(N,10)}),d.addEventListener("click",()=>{wc(n),setTimeout(N,10)}),b.addEventListener("click",()=>{Cc(n),n.focus()}),p.addEventListener("click",()=>{g0(n),setTimeout(()=>{wc(n),N()},10)}),g.addEventListener("click",()=>{d2(n),n.dispatch({effects:ja.of(new Lc({search:""}))}),r.value="",N()}),N(),e}const e_=Si.fromClass(class{panel=null;parent=null;searchInput=null;constructor(n){this.parent=n.dom.parentElement,n.state.field(Sc)&&this.openPanel(n)}update(n){const e=n.startState.field(Sc),t=n.state.field(Sc);if(t&&!e)this.openPanel(n.view);else if(!t&&e)this.closePanel();else if(t&&this.panel){const r=zc(n.startState),l=zc(n.state);if(r.search!==l.search&&this.searchInput){this.searchInput.value=l.search||"";const s=this.panel.querySelector(".search-match-count");if(s){const o=x2(n.view,l),c=o>0?v2(n.view,l):0;l.search?(s.textContent=o>0?`${c||0}/${o}`:"0/0",s.style.display="inline"):s.style.display="none"}}}}openPanel(n){this.panel||(this.panel=J5(n),this.searchInput=this.panel.querySelector(".search-input"),this.parent?.firstChild&&this.parent.insertBefore(this.panel,this.parent.firstChild))}closePanel(){this.panel?.remove(),this.panel=null,this.searchInput=null}destroy(){this.closePanel()}});function t_(){return[Sc,e_,nd.of([{key:"Mod-f",run:y0},{key:"Mod-h",run:y0},{key:"Escape",run:Cc}])]}function n_(){return st.theme({"& .cm-search":{display:"none !important"},"& .cm-searchMatch":{backgroundColor:"var(--vault-search-match-bg, rgba(253, 224, 71, 0.4))",borderRadius:"2px"},"& .cm-searchMatch-selected":{backgroundColor:"var(--vault-search-match-selected, rgba(253, 224, 71, 0.8))",borderRadius:"2px"}})}const ka={SEPARATE_FIELD:"separate_field",INLINE_TAGS:"inline_tags"};class No{buffer="";isInThinkBlock=!1;reasoningContent="";mainContent="";static THINK_START_VARIATIONS=["<think>","<thinking>","<reasoning>","<thought>"];static THINK_END_VARIATIONS=["</think>","</thinking>","</reasoning>","</thought>"];parseChunk(e,t){const r=t?r_(t):ka.INLINE_TAGS,l=e?.choices?.[0],s=l?.delta,o=s?.content??"",c=s?.reasoning_content??s?.reasoning??l?.reasoning?.content??"";return c||r===ka.SEPARATE_FIELD?(c&&(this.reasoningContent+=c),o&&(this.mainContent+=o),{content:this.mainContent,reasoning:this.reasoningContent,isInThinkBlock:!1}):this.parseInlineTagChunk(e)}findThinkTag(e,t=0){const r=e.toLowerCase();let l=null;for(const s of No.THINK_START_VARIATIONS){const o=r.indexOf(s,t);o!==-1&&(l===null||o<l.index)&&(l={index:o,tag:s})}return l}findCloseTag(e,t=0){const r=e.toLowerCase();let l=null;for(const s of No.THINK_END_VARIATIONS){const o=r.indexOf(s,t);o!==-1&&(l===null||o<l.index)&&(l={index:o,tag:s})}return l}parseInlineTagChunk(e){const r=e?.choices?.[0]?.delta?.content??"";return this.buffer+=r,this.processBuffer(),{content:this.mainContent,reasoning:this.reasoningContent,isInThinkBlock:this.isInThinkBlock}}processBuffer(){for(;this.buffer.length>0;)if(this.isInThinkBlock){const e=this.findCloseTag(this.buffer);if(e===null){const t=Math.max(...No.THINK_END_VARIATIONS.map(s=>s.length)),r=Math.min(this.buffer.length,t-1),l=this.buffer.slice(0,this.buffer.length-r);this.reasoningContent+=l,this.buffer=this.buffer.slice(this.buffer.length-r);break}this.reasoningContent+=this.buffer.slice(0,e.index),this.buffer=this.buffer.slice(e.index+e.tag.length),this.isInThinkBlock=!1}else{const e=this.findThinkTag(this.buffer);if(e===null){const t=Math.max(...No.THINK_START_VARIATIONS.map(s=>s.length)),r=Math.min(this.buffer.length,t-1),l=this.buffer.slice(0,this.buffer.length-r);this.mainContent+=l,this.buffer=this.buffer.slice(this.buffer.length-r);break}this.mainContent+=this.buffer.slice(0,e.index),this.buffer=this.buffer.slice(e.index+e.tag.length),this.isInThinkBlock=!0}}parseInlineTags(e){let t="",r="",l=e;for(;l.length>0;){const s=this.findThinkTag(l);if(s===null){t+=l;break}t+=l.slice(0,s.index);const o=this.findCloseTag(l,s.index+s.tag.length);if(o===null){r+=l.slice(s.index+s.tag.length);break}r+=l.slice(s.index+s.tag.length,o.index),l=l.slice(o.index+o.tag.length)}return{text:t,reasoning:r}}flush(){return this.buffer.length>0&&(this.isInThinkBlock?this.reasoningContent+=this.buffer:this.mainContent+=this.buffer,this.buffer=""),{content:this.mainContent,reasoning:this.reasoningContent,isInThinkBlock:this.isInThinkBlock}}reset(){this.buffer="",this.isInThinkBlock=!1,this.reasoningContent="",this.mainContent=""}}function r_(n){const e=n.toLowerCase();return e.includes("deepseek")||e.includes(":thinking")||e.includes("-thinking")||e.includes("reasoning")?ka.SEPARATE_FIELD:(e.includes("qwen")||e.includes("qwq"),ka.INLINE_TAGS)}const J1={expand:`Please expand and elaborate on the following text, adding more detail and depth while maintaining the same style and tone:

"""
\${text}
"""

Provide only the expanded text without any additional commentary.`,rewrite:`Please rewrite the following text to improve clarity, flow, and impact while preserving the original meaning:

"""
\${text}
"""

Provide only the rewritten text without any additional commentary.`,instruct:`Please apply the following instruction to the text below:

Instruction: \${instruction}

Text:
"""
\${text}
"""

Provide only the modified text without any additional commentary.`,shorten:`Please shorten and condense the following text, making it more concise while preserving the key meaning and essential details:

"""
\${text}
"""

Provide only the shortened text without any additional commentary.`,lengthen:`Please lengthen the following text by adding more detail, depth, and elaboration while maintaining the same style and tone:

"""
\${text}
"""

Provide only the lengthened text without any additional commentary.`,vivid:`Please rewrite the following text to make it more vivid and descriptive, adding sensory details, imagery, and evocative language:

"""
\${text}
"""

Provide only the enhanced text without any additional commentary.`,emotion:`Please rewrite the following text to add more emotional depth, feeling, and character voice while preserving the original meaning:

"""
\${text}
"""

Provide only the enhanced text without any additional commentary.`,grammar:`Please fix any grammar, spelling, and punctuation errors in the following text while preserving the original meaning and style:

"""
\${text}
"""

Provide only the corrected text without any additional commentary.`},i_=`You are Zoggy, a friendly and knowledgeable assistant built into CharacterVault.

# Your Role
You help users create, edit, and understand character cards for roleplay tools like SillyTavern. You answer questions about character card creation, best practices, and how to use CharacterVault's features.

# CharacterVault Features
Users can:
- Upload character cards (JSON or PNG) in v2 or v3 spec format
- Edit cards section by section OR create new cards from scratch
- Export finished cards as JSON or PNG (via top-right corner export)
- Add specific sections to context so you can see and help with their card content

# Available Editing Sections

## Core Character Sections:
- Image, Name, Description, Personality, Scenario, First Message, Examples, System Prompt, Post-History, Greetings, Appearance, Extensions
  - **Note**: Modern cards typically use Description for all character info. Personality/Appearance exist for legacy compatibility. NEVER suggest using them.

## Lorebook:
- Basic editing suite (entry name, trigger keys, priority, position, enabled, case sensitive, constant, content editor)
- Fine-tuning requires SillyTavern or similar tools

## Metadata (doesn't affect character behavior):
- Avatar URL (for Character Hub/Chub), Creator Notes, Creator, Version, Tags

# Your Approach
- Helpful and encouraging, especially for beginners
- Clear, concise explanations with minimal jargon (unless user shows familiarity)
- Non-judgmental about all content types (SFW to NSFW) - you're here to help with quality and functionality, not moderate content
- When users ask about adding themselves to cards, remind them to use {{user}} as the placeholder, not a hardcoded name
- If users ask vague questions about "their card" or need specific help, gently suggest adding relevant sections to context to the **Ai Context** panel (Left Side) so you can provide better assistance
- Offer concrete next steps when users seem stuck
- Explain section purposes and best practices when relevant`;class An extends Error{type;statusCode;constructor(e,t,r){super(e),this.name="AIError",this.type=t,this.statusCode=r}}class Nt{config;sampler;prompts;abortController=null;static SAFETY_MARGIN=100;constructor(e,t,r){this.config=e,this.sampler=t,this.prompts=r?{...J1,...r}:J1}static estimateTokens(e){return e?Math.ceil(e.length/4):0}fitContextToLimit(e,t){if(t<=0)return[];const r=[];let l=0;for(const s of e){const o=Nt.estimateTokens(s)+5;if(l+o<=t)r.push(s),l+=o;else break}return r}truncateTextToLimit(e,t){if(t<=0)return"...";const r=t*4;return e.length<=r?e:e.substring(0,Math.max(0,r-3))+"..."}abort(){this.abortController&&(this.abortController.abort(),console.log("[AIService] Request aborted by user"),this.abortController=null)}updateConfig(e){this.config=e}updateSampler(e){this.sampler=e}updatePrompts(e){this.prompts=e}interpolatePrompt(e,t){return e.replace(/\$\{text\}/g,t)}interpolateInstructPrompt(e,t,r){return e.replace(/\$\{text\}/g,t).replace(/\$\{instruction\}/g,r)}getBaseUrl(){return this.config.baseUrl.replace(/\/$/,"")}getHeaders(){const e={"Content-Type":"application/json"};return this.config.apiKey&&(e.Authorization=`Bearer ${this.config.apiKey}`),e}handleError(e){throw e instanceof An?e:e instanceof Error?e.message.includes("fetch")?new An("Network error. Please check your connection.","network"):new An(e.message,"unknown"):new An("An unknown error occurred","unknown")}async fetchModels(){try{const e=await fetch(`${this.getBaseUrl()}/models`,{method:"GET",headers:this.getHeaders()});if(!e.ok)throw e.status===401?new An("Invalid API key","auth",401):e.status===429?new An("Rate limit exceeded","rate_limit",429):new An(`Failed to fetch models: ${e.statusText}`,"server",e.status);return(await e.json()).data.map(l=>({id:l.id,name:this.formatModelName(l.id)})).sort((l,s)=>l.name.localeCompare(s.name))}catch(e){this.handleError(e)}}formatModelName(e){return e.replace(/^(openai|anthropic|google|meta|mistral)\//,"").replace(/-/g," ").replace(/_/g," ").split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")}async chatCompletion(e,t,r){const l={...this.sampler,...t},s=this.config.enableStreaming&&r;this.abortController=new AbortController;const{signal:o}=this.abortController,c={model:this.config.modelId,messages:e,temperature:l.temperature,top_p:l.topP,min_p:l.minP,top_k:l.topK,repetition_penalty:l.repetitionPenalty,stream:!!s,max_tokens:l.maxTokens,include_reasoning:this.config.enableReasoning??!1,reasoning:this.config.enableReasoning?{enabled:!0}:{enabled:!1}};try{const h=await fetch(`${this.getBaseUrl()}/chat/completions`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(c),signal:o});if(!h.ok){if(h.status===401)throw new An("Invalid API key","auth",401);if(h.status===429)throw new An("Rate limit exceeded","rate_limit",429);if(h.status===400){const N=await h.json().catch(()=>({}));throw new An(N.error?.message||"Invalid request","invalid_request",400)}let T=h.statusText||`HTTP ${h.status}`;try{const N=await h.json().catch(()=>null);N?.error?.message?T=N.error.message:N?.message&&(T=N.message)}catch{}throw new An(`API error: ${T}`,"server",h.status)}if(s&&h.body)return await this.handleStreamingResponse(h.body,r);const d=await h.json();if(!d.choices||d.choices.length===0)throw new An("No response from AI","unknown");const g=d.choices[0].message,b=g.reasoning_content,w=g.reasoning;return{content:g.content,reasoning:b??w??void 0}}catch(h){if(h instanceof Error&&h.name==="AbortError")throw console.log("[AIService] Request aborted - operation cancelled by user"),new An("Request was cancelled","unknown");this.handleError(h)}finally{this.abortController=null}}async handleStreamingResponse(e,t){const r=e.getReader(),l=new TextDecoder;let s="",o="";const c=new No;try{for(;;){const{done:d,value:p}=await r.read();if(d)break;if(this.abortController?.signal.aborted)throw console.log("[AIService] Streaming aborted"),new An("Request was cancelled","unknown");const b=l.decode(p,{stream:!0}).split(`
`).filter(w=>w.trim()!=="");for(let w=0;w<b.length;w++){const T=b[w];if(T.startsWith("data: ")){const N=T.slice(6);if(N==="[DONE]")continue;try{const D=JSON.parse(N),j=c.parseChunk(D,this.config.modelId),U=j.content,I=j.reasoning;if(U!==s||I!==o){const ce=U.slice(s.length),F=I.slice(o.length);s=U,o=I,(ce||F)&&t({content:ce||void 0,reasoning:F||void 0})}}catch(D){console.warn("[AIService] Failed to parse streaming chunk:",D),console.warn("[AIService] Problematic line:",T.slice(0,200))}}}}const h=c.flush();if(h.content.length>s.length){const d=h.content.slice(s.length);s=h.content,t({content:d})}if(h.reasoning.length>o.length){const d=h.reasoning.slice(o.length);o=h.reasoning,t({reasoning:d})}return{content:s,reasoning:o||void 0}}finally{r.releaseLock()}}async expandText(e,t,r,l){const s=this.sampler.contextLength-this.sampler.maxTokens-Nt.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.expand,""),h=Nt.estimateTokens(o+c);let d=s-h,p=e;const g=Nt.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const b=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(b),T=this.interpolatePrompt(this.prompts.expand,p),N=[{role:"system",content:w},{role:"user",content:T}];return this.chatCompletion(N,r,l)}async rewriteText(e,t,r,l){const s=this.sampler.contextLength-this.sampler.maxTokens-Nt.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.rewrite,""),h=Nt.estimateTokens(o+c);let d=s-h,p=e;const g=Nt.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const b=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(b),T=this.interpolatePrompt(this.prompts.rewrite,p),N=[{role:"system",content:w},{role:"user",content:T}];return this.chatCompletion(N,r,l)}async instructText(e,t,r,l,s){const o=this.sampler.contextLength-this.sampler.maxTokens-Nt.SAFETY_MARGIN,c=this.buildSystemPrompt([]),h=this.interpolateInstructPrompt(this.prompts.instruct,"",t),d=Nt.estimateTokens(c+h);let p=o-d,g=e;const b=Nt.estimateTokens(e);b>p?(g=this.truncateTextToLimit(e,p),p=0):p-=b;const w=this.fitContextToLimit(r,p),T=this.buildSystemPrompt(w),N=this.interpolateInstructPrompt(this.prompts.instruct,g,t),D=[{role:"system",content:T},{role:"user",content:N}];return this.chatCompletion(D,l,s)}async shortenText(e,t,r,l){const s=this.sampler.contextLength-this.sampler.maxTokens-Nt.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.shorten,""),h=Nt.estimateTokens(o+c);let d=s-h,p=e;const g=Nt.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const b=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(b),T=this.interpolatePrompt(this.prompts.shorten,p),N=[{role:"system",content:w},{role:"user",content:T}];return this.chatCompletion(N,r,l)}async lengthenText(e,t,r,l){const s=this.sampler.contextLength-this.sampler.maxTokens-Nt.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.lengthen,""),h=Nt.estimateTokens(o+c);let d=s-h,p=e;const g=Nt.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const b=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(b),T=this.interpolatePrompt(this.prompts.lengthen,p),N=[{role:"system",content:w},{role:"user",content:T}];return this.chatCompletion(N,r,l)}async makeVivid(e,t,r,l){const s=this.sampler.contextLength-this.sampler.maxTokens-Nt.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.vivid,""),h=Nt.estimateTokens(o+c);let d=s-h,p=e;const g=Nt.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const b=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(b),T=this.interpolatePrompt(this.prompts.vivid,p),N=[{role:"system",content:w},{role:"user",content:T}];return this.chatCompletion(N,r,l)}async addEmotion(e,t,r,l){const s=this.sampler.contextLength-this.sampler.maxTokens-Nt.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.emotion,""),h=Nt.estimateTokens(o+c);let d=s-h,p=e;const g=Nt.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const b=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(b),T=this.interpolatePrompt(this.prompts.emotion,p),N=[{role:"system",content:w},{role:"user",content:T}];return this.chatCompletion(N,r,l)}async fixGrammar(e,t,r,l){const s=this.sampler.contextLength-this.sampler.maxTokens-Nt.SAFETY_MARGIN,o=this.buildSystemPrompt([]),c=this.interpolatePrompt(this.prompts.grammar,""),h=Nt.estimateTokens(o+c);let d=s-h,p=e;const g=Nt.estimateTokens(e);g>d?(p=this.truncateTextToLimit(e,d),d=0):d-=g;const b=this.fitContextToLimit(t,d),w=this.buildSystemPrompt(b),T=this.interpolatePrompt(this.prompts.grammar,p),N=[{role:"system",content:w},{role:"user",content:T}];return this.chatCompletion(N,r,l)}async askAIWithConversation(e,t,r,l,s){const o=this.sampler.contextLength-this.sampler.maxTokens-Nt.SAFETY_MARGIN,c=i_,h=Nt.estimateTokens(e),p=Nt.estimateTokens(c)+h;let g=o-p;const b=this.fitContextToLimit(t,g),w=b.reduce((j,U)=>j+Nt.estimateTokens(U)+5,0);g-=w;const T=[];for(let j=r.length-1;j>=0;j--){const U=r[j],I=Nt.estimateTokens(U.content)+10;if(g>=I)T.unshift(U),g-=I;else break}let N=c;if(b.length>0){const j=b.map((U,I)=>`--- Context Entry ${I+1} ---
${U}`).join(`

`);N+=`

Use the following context entries to inform your responses:

${j}`}const D=[{role:"system",content:N}];return T.forEach(j=>{D.push({role:j.role==="user"?"user":"assistant",content:j.content})}),D.push({role:"user",content:e}),this.chatCompletion(D,l,s)}buildSystemPrompt(e){const t="You are a helpful AI assistant for a character editing application called CharacterVault. You help users create and edit character cards for roleplay programs.";if(e.length===0)return t;const r=e.map((l,s)=>`--- Context Entry ${s+1} ---
${l}`).join(`

`);return`${t}

Use the following context entries to inform your responses:

${r}`}isReady(){return!!(this.config.apiKey&&this.config.baseUrl&&this.config.modelId)}}const sy=new WeakMap;function l_(n){return sy.get(n)}function a_(n,e,t,r,l,s){const o=document.createElement("div");o.className="ai-toolbar-panel",o.style.cssText=`
    display: flex;
    flex-direction: column;
    background: var(--ai-toolbar-bg);
    border-bottom: 1px solid var(--ai-toolbar-border);
  `;const c={isProcessing:!1,isStreaming:!1,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:null,error:null,showReasoning:!1};let h=e;const d=100,p=document.createElement("div");p.style.cssText=`
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    min-height: 44px;
  `,o.appendChild(p);const g=document.createElement("div");g.className="ai-result-container",g.style.cssText=`
    display: none;
    flex-direction: column;
    padding: 12px;
    border-top: 1px solid var(--ai-toolbar-border);
    background: var(--ai-toolbar-result-bg);
    max-height: 500px;
    overflow-y: auto;
  `,o.appendChild(g);const b=[{id:"expand",label:"Enhance",icon:"",color:"var(--ai-toolbar-accent-primary, #7c3aed)"},{id:"rewrite",label:"Rephrase",icon:"",color:"var(--ai-toolbar-accent-secondary, #2563eb)"},{id:"instruct",label:"Custom",icon:"",color:"var(--ai-toolbar-accent-success, #059669)"}],w=[{id:"shorten",label:"Shorten",icon:"",color:"var(--ai-toolbar-accent-warning, #d97706)"},{id:"lengthen",label:"Lengthen",icon:"",color:"var(--ai-toolbar-accent-info, #0891b2)"},{id:"vivid",label:"Vivid",icon:"",color:"var(--ai-toolbar-accent-pink, #db2777)"},{id:"emotion",label:"Emotion",icon:"",color:"var(--ai-toolbar-accent-rose, #e11d48)"},{id:"grammar",label:"Fix",icon:"",color:"var(--ai-toolbar-accent-neutral, #475569)"}];let T=!1,N=null,D="";function j(be,Ge){const zt=document.createElement("button");return zt.className=`ai-toolbar-btn ai-toolbar-btn-${be.id}`,zt.innerHTML=`<span style="margin-right: 4px;">${be.icon}</span>${be.label}`,zt.style.cssText=`
      display: flex;
      align-items: center;
      padding: ${Ge?"6px 12px":"4px 8px"};
      font-size: ${Ge?"13px":"12px"};
      font-weight: 500;
      color: white;
      background: ${be.color};
      border: none;
      border-radius: 6px;
      cursor: pointer;
      opacity: 0.5;
      pointer-events: none;
      transition: opacity 0.2s, transform 0.1s;
    `,zt.addEventListener("click",()=>{T&&N&&(Ge||(pe.style.display="none"),t(be.id,D,N))}),zt.addEventListener("mousedown",Jt=>{Jt.preventDefault()}),zt}const U=document.createElement("div");U.style.cssText="display: none; align-items: center; gap: 6px; flex: 1; min-width: 200px;";const I=document.createElement("input");I.type="text",I.placeholder="What would you like me to do?",I.style.cssText=`
    flex: 1;
    padding: 6px 10px;
    font-size: 13px;
    background: var(--ai-toolbar-input-bg);
    border: 1px solid var(--ai-toolbar-input-border);
    border-radius: 6px;
    color: var(--ai-toolbar-text);
    outline: none;
  `;const ce=document.createElement("button");ce.innerHTML="Send",ce.style.cssText=`
    padding: 6px 12px;
    font-size: 13px;
    font-weight: 500;
    color: white;
    background: var(--ai-toolbar-accent-success, #059669);
    border: none;
    border-radius: 6px;
    cursor: pointer;
  `;const F=document.createElement("button");F.innerHTML="Cancel",F.style.cssText=`
    padding: 6px 10px;
    font-size: 12px;
    color: var(--ai-toolbar-text-secondary);
    background: transparent;
    border: 1px solid var(--ai-toolbar-input-border);
    border-radius: 6px;
    cursor: pointer;
  `,U.appendChild(I),U.appendChild(ce),U.appendChild(F),p.appendChild(U);const z=document.createElement("div");z.style.cssText="display: flex; flex-wrap: wrap; gap: 6px;";const ee=new Map;for(const be of b){if(be.id==="instruct")continue;const Ge=j(be,!0);ee.set(be.id,Ge),z.appendChild(Ge)}const ye=document.createElement("button");ye.className="ai-toolbar-btn ai-toolbar-btn-instruct",ye.innerHTML='<span style="margin-right: 4px;"></span>Custom',ye.style.cssText=`
    display: flex;
    align-items: center;
    padding: 6px 12px;
    font-size: 13px;
    font-weight: 500;
    color: white;
    background: var(--ai-toolbar-accent-success, #059669);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    opacity: 0.5;
    pointer-events: none;
    transition: opacity 0.2s, transform 0.1s;
  `,ye.addEventListener("mousedown",be=>{be.preventDefault()}),ye.addEventListener("click",()=>{T&&(z.style.display="none",De.style.display="none",q.style.display="none",le.style.display="none",U.style.display="flex",I.focus())}),ee.set("instruct",ye),z.appendChild(ye),p.appendChild(z);const Ce=()=>{const be=I.value.trim();!be||!T||!N||(t("instruct",D,N,be),I.value="",U.style.display="none",z.style.display="flex",De.style.display="block",q.style.display="block",le.style.display="block")};ce.addEventListener("click",Ce),I.addEventListener("keydown",be=>{be.key==="Enter"&&Ce(),be.key==="Escape"&&(I.value="",U.style.display="none",z.style.display="flex",De.style.display="block",q.style.display="block",le.style.display="block")}),F.addEventListener("click",()=>{I.value="",U.style.display="none",z.style.display="flex",De.style.display="block",q.style.display="block",le.style.display="block"});const P=document.createElement("button");P.className="ai-toolbar-btn-more",P.innerHTML=" More",P.style.cssText=`
    display: flex;
    align-items: center;
    padding: 6px 10px;
    font-size: 12px;
    font-weight: 500;
    color: var(--ai-toolbar-text-secondary);
    background: transparent;
    border: 1px solid var(--ai-toolbar-input-border);
    border-radius: 6px;
    cursor: pointer;
    opacity: 0.5;
    pointer-events: none;
  `;const pe=document.createElement("div");pe.style.cssText=`
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 4px;
    background: var(--ai-toolbar-bg);
    border: 1px solid var(--ai-toolbar-border);
    border-radius: 6px;
    padding: 4px;
    display: none;
    flex-direction: column;
    gap: 2px;
    z-index: 100;
    min-width: 120px;
  `;const fe=new Map;for(const be of w){const Ge=j(be,!1);fe.set(be.id,Ge),pe.appendChild(Ge)}const De=document.createElement("div");De.style.cssText="position: relative;",De.appendChild(P),De.appendChild(pe),p.appendChild(De);const ke=document.createElement("button");ke.className="ai-toolbar-btn-search",ke.innerHTML="",ke.title="Search & Replace (Ctrl+F)",ke.style.cssText=`
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 6px 10px;
    font-size: 14px;
    background: transparent;
    border: 1px solid var(--ai-toolbar-input-border);
    border-radius: 6px;
    cursor: pointer;
    color: var(--ai-toolbar-text-secondary);
    transition: all 0.15s ease;
    margin-left: 4px;
  `,ke.addEventListener("click",()=>{Z5(n)}),ke.addEventListener("mousedown",be=>{be.preventDefault()}),p.appendChild(ke);const J=document.createElement("button");J.className="ai-toolbar-btn-abort",J.innerHTML=" Stop",J.title="Stop AI operation",J.style.cssText=`
    display: none;
    align-items: center;
    padding: 6px 12px;
    font-size: 13px;
    font-weight: 500;
    color: white;
    background: #dc2626;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
  `,J.addEventListener("click",()=>{s()}),J.addEventListener("mousedown",be=>{be.preventDefault()}),p.appendChild(J),P.addEventListener("click",()=>{if(!T)return;const be=pe.style.display==="flex";pe.style.display=be?"none":"flex"}),P.addEventListener("mousedown",be=>{be.preventDefault()}),document.addEventListener("click",be=>{De.contains(be.target)||(pe.style.display="none")});const q=document.createElement("div");q.style.cssText="width: 1px; height: 24px; background: var(--ai-toolbar-border); margin: 0 4px;",p.appendChild(q);const le=document.createElement("span");le.className="ai-toolbar-info",le.textContent="Select text to use AI",le.style.cssText=`
    font-size: 12px;
    color: var(--ai-toolbar-text-muted);
    margin-left: auto;
  `,p.appendChild(le);const Ae=document.createElement("div");Ae.style.cssText=`
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 8px;
  `,g.appendChild(Ae);const Se=document.createElement("span");Se.style.cssText=`
    font-size: 12px;
    font-weight: 600;
    color: var(--ai-toolbar-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  `,Ae.appendChild(Se);const B=document.createElement("button");B.innerHTML="",B.style.cssText=`
    padding: 2px 6px;
    font-size: 14px;
    color: var(--ai-toolbar-text-muted);
    background: transparent;
    border: none;
    cursor: pointer;
    border-radius: 4px;
  `,B.addEventListener("click",()=>{l()}),Ae.appendChild(B);const Pe=document.createElement("div");Pe.style.cssText=`
    display: none;
    padding: 8px 12px;
    background: var(--ai-toolbar-error-bg);
    border: 1px solid var(--ai-toolbar-error-border);
    border-radius: 6px;
    color: var(--ai-toolbar-error-text);
    font-size: 13px;
    margin-bottom: 8px;
  `,g.appendChild(Pe);const qe=document.createElement("div");qe.style.cssText=`
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    gap: 12px;
  `,qe.innerHTML=`
    <div style="
      width: 32px;
      height: 32px;
      border: 3px solid var(--ai-toolbar-input-border);
      border-top-color: var(--ai-toolbar-text-muted);
      border-radius: 50%;
      animation: ai-spin 1s linear infinite;
    "></div>
    <span style="font-size: 13px; color: var(--ai-toolbar-text-muted);">AI is working...</span>
    <style>
      @keyframes ai-spin {
        to { transform: rotate(360deg); }
      }
    </style>
  `,g.appendChild(qe);const R=document.createElement("div");R.style.cssText=`
    display: none;
    margin-bottom: 8px;
    border: 1px solid var(--ai-toolbar-border);
    border-radius: 6px;
    overflow: hidden;
    flex-shrink: 0;
  `,g.appendChild(R);const je=document.createElement("button");je.style.cssText=`
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: 8px 12px;
    background: var(--ai-toolbar-reasoning-bg);
    border: none;
    color: var(--ai-toolbar-text-muted);
    font-size: 12px;
    cursor: pointer;
    text-align: left;
  `,je.innerHTML=`
    <span style="display: flex; align-items: center; gap: 4px;">
      <span></span> Thinking process
    </span>
    <span class="reasoning-toggle">Show</span>
  `,R.appendChild(je);const Ee=document.createElement("div");Ee.style.cssText=`
    display: none;
    max-height: 150px;
    overflow-y: auto;
    padding: 8px 12px;
    background: var(--ai-toolbar-reasoning-bg);
    border-top: 1px solid var(--ai-toolbar-border);
  `,R.appendChild(Ee);const Ke=document.createElement("pre");Ke.style.cssText=`
    margin: 0;
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
    font-size: 11px;
    color: var(--ai-toolbar-text-muted);
    white-space: pre-wrap;
    word-break: break-word;
    line-height: 1.5;
  `,Ee.appendChild(Ke),je.addEventListener("click",()=>{const be=Ee.style.display==="block";Ee.style.display=be?"none":"block";const Ge=je.querySelector(".reasoning-toggle");Ge&&(Ge.textContent=be?"Show":"Hide"),c.showReasoning=!be});const $e=document.createElement("div");$e.style.cssText=`
    display: none;
    padding: 12px;
    background: var(--ai-toolbar-bg);
    border: 1px solid var(--ai-toolbar-border);
    border-radius: 6px;
    margin-bottom: 12px;
  `,g.appendChild($e);const ft=document.createElement("p");ft.style.cssText=`
    margin: 0;
    font-size: 13px;
    color: var(--ai-toolbar-text);
    white-space: pre-wrap;
    line-height: 1.6;
  `,$e.appendChild(ft);const et=document.createElement("span");et.style.cssText=`
    display: inline-block;
    width: 2px;
    height: 1.2em;
    background: var(--ai-toolbar-text-muted);
    margin-left: 2px;
    animation: ai-blink 1s step-end infinite;
    vertical-align: text-bottom;
  `,et.innerHTML=`
    <style>
      @keyframes ai-blink {
        50% { opacity: 0; }
      }
    </style>
  `;const ve=document.createElement("div");ve.style.cssText=`
    display: none;
    gap: 8px;
  `,g.appendChild(ve);const gt=document.createElement("button");gt.innerHTML=" Accept",gt.style.cssText=`
    flex: 1;
    padding: 8px 16px;
    font-size: 13px;
    font-weight: 500;
    color: white;
    background: var(--ai-toolbar-accept-bg, #16a34a);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
  `,gt.addEventListener("click",()=>{r()}),ve.appendChild(gt);const nt=document.createElement("button");nt.innerHTML=" Reject",nt.style.cssText=`
    flex: 1;
    padding: 8px 16px;
    font-size: 13px;
    font-weight: 500;
    color: var(--ai-toolbar-text);
    background: var(--ai-toolbar-btn-hover);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s;
  `,nt.addEventListener("click",()=>{l()}),ve.appendChild(nt);let Gt=0,yn=0,wt=!1;g.addEventListener("scroll",()=>{wt=!(g.scrollTop+g.clientHeight>=g.scrollHeight-10)}),Ee.addEventListener("scroll",()=>{Ee.scrollTop+Ee.clientHeight>=Ee.scrollHeight-5||(wt=!0)});function dn(){if(!(c.isProcessing||c.isStreaming||c.aiResult||c.error)){g.style.display="none";return}g.style.display="flex";const Ge=c.currentOperation?{expand:"Enhance",rewrite:"Rephrase",instruct:"Custom",shorten:"Shorten",lengthen:"Lengthen",vivid:"Vivid",emotion:"Emotion",grammar:"Fix"}[c.currentOperation]:"AI Result";if(Se.textContent=c.isStreaming?`${Ge}...`:Ge,c.error){Pe.style.display="block",Pe.textContent=c.error,qe.style.display="none",R.style.display="none",$e.style.display="none",ve.style.display="none";return}else Pe.style.display="none";qe.style.display=c.isProcessing&&!c.isStreaming?"flex":"none";const zt=(c.streamingReasoning?.trim()?.length??0)>0||(c.aiReasoning?.trim()?.length??0)>0;if(R.style.display=zt?"block":"none",zt){if(Ke.textContent=c.isStreaming?c.streamingReasoning:c.aiReasoning,c.isStreaming&&!c.showReasoning){Ee.style.display="block";const vt=je.querySelector(".reasoning-toggle");vt&&(vt.textContent="Hide"),c.showReasoning=!0}else if(!c.isStreaming&&c.aiReasoning&&c.showReasoning){Ee.style.display="block";const vt=je.querySelector(".reasoning-toggle");vt&&(vt.textContent="Hide")}if(c.isStreaming&&c.streamingReasoning){const vt=c.streamingReasoning.length;vt>Gt&&!wt&&requestAnimationFrame(()=>{Ee.scrollTop=Ee.scrollHeight}),Gt=vt}}const Jt=c.isStreaming?c.streamingContent:c.aiResult||"";if(Jt){if($e.style.display="block",ft.textContent=Jt,c.isStreaming&&ft.appendChild(et),c.isStreaming&&c.streamingContent){const vt=c.streamingContent.length;vt>yn&&!wt&&requestAnimationFrame(()=>{$e.scrollTop=$e.scrollHeight,g.scrollTop=g.scrollHeight}),yn=vt}}else $e.style.display="none";const Yt=!c.isProcessing&&!c.isStreaming&&c.aiResult&&!c.error;ve.style.display=Yt?"flex":"none",!c.isStreaming&&(c.aiResult||c.aiReasoning)&&(requestAnimationFrame(()=>{Ee.scrollTop=Ee.scrollHeight,$e.scrollTop=$e.scrollHeight,g.scrollTop=g.scrollHeight}),Gt=0,yn=0,wt=!1)}function Ye(){const be=n.state.selection.main;if(T=be.from!==be.to,T){N=be,D=n.state.doc.sliceString(be.from,be.to);const Jt=D.length,Yt=Nt.estimateTokens(D),vt=Math.max(0,h.contextLength-h.maxTokens-d);h.maxTokens>=h.contextLength?(le.textContent=" Please adjust Max Tokens to be less than Context Length",le.style.color="var(--ai-toolbar-error-text, #ef4444)",le.classList.add("warning"),T=!1):Yt>vt?(vt<=0?le.textContent=" AI needs a larger context window":le.textContent=` Selection is too long (${Yt}/${vt} tokens)`,le.style.color="var(--ai-toolbar-error-text, #ef4444)",le.classList.add("warning"),T=!1):(le.textContent=`${Jt} chars selected`,le.style.color="var(--ai-toolbar-text-muted)",le.classList.remove("warning"))}else N=null,D="",le.textContent="Select text to use AI",le.style.color="var(--ai-toolbar-text-muted)",le.classList.remove("warning"),pe.style.display="none";c.isProcessing?(J.style.display="flex",z.style.display="none",De.style.display="none",q.style.display="none"):(J.style.display="none",z.style.display="flex",De.style.display="block",q.style.display="block");const Ge=T?"1":"0.5",zt=T?"auto":"none";for(const Jt of ee.values())Jt.style.opacity=Ge,Jt.style.pointerEvents=zt;for(const Jt of fe.values())Jt.style.opacity=Ge,Jt.style.pointerEvents=zt;P.style.opacity=Ge,P.style.pointerEvents=zt}const He=be=>{const Ge=c.isProcessing;be.isProcessing!==void 0&&(c.isProcessing=be.isProcessing),be.isStreaming!==void 0&&(c.isStreaming=be.isStreaming),be.streamingContent!==void 0&&(c.streamingContent=be.streamingContent),be.streamingReasoning!==void 0&&(c.streamingReasoning=be.streamingReasoning),be.aiResult!==void 0&&(c.aiResult=be.aiResult),be.aiReasoning!==void 0&&(c.aiReasoning=be.aiReasoning),be.currentOperation!==void 0&&(c.currentOperation=be.currentOperation),be.error!==void 0&&(c.error=be.error),Ge!==c.isProcessing&&Ye(),dn()};Ye(),sy.set(n,He);const at={dom:o,top:!0,update:Ye,updateState:Ye,updateAIState:He,updateSampler:be=>{h=be,Ye()}};return o.__panel=at,at}function s_(n){return Si.fromClass(class{constructor(e){}update(e){e.selectionSet&&sy.get(e.view)}})}function o_(n,e,t,r,l){return[rd.of(s=>a_(s,n,e,t,r,l)),s_()]}function oy(n){const{key:e,value:t,onChange:r,setSelectedText:l,aiConfig:s,samplerSettings:o,promptSettings:c,getContextContent:h,contextSectionIds:d,minHeight:p="100px",editorStyles:g={},isActive:b=!0}=n,w=$.useRef(null),T=$.useRef(null),N=$.useRef(null),D=$.useRef(null),[j,U]=$.useState(!1),[I,ce]=$.useState(!1),[F,z]=$.useState(null),[ee,ye]=$.useState(null),[Ce,P]=$.useState(""),[pe,fe]=$.useState(""),[De,ke]=$.useState(""),[J,q]=$.useState(null),[le,Ae]=$.useState(null),Se=$.useRef(null),B=$.useRef(null),Pe=$.useRef(d);$.useEffect(()=>{Se.current=ee},[ee]),$.useEffect(()=>{B.current=le},[le]),$.useEffect(()=>{Pe.current=d},[d]);const qe=$.useRef(s);$.useEffect(()=>{qe.current=s},[s]);const R=$.useRef(r);$.useEffect(()=>{R.current=r},[r]);const je=$.useCallback(async(et,ve,gt,nt)=>{const Gt=qe.current;q(null),ye(null),P(""),fe(""),ke(""),z(et),U(!0),ce(Gt.enableStreaming),N.current?.({isProcessing:!0,isStreaming:Gt.enableStreaming,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:et,error:null});const yn={from:gt.from,to:gt.to,text:ve};B.current=yn,Ae(yn),l(ve);try{console.log("[useAIEditor] Using model:",Gt.modelId,"Base URL:",Gt.baseUrl);const wt=new Nt(Gt,o,c);D.current=wt;const dn=h(Pe.current),Ye=Gt.enableStreaming?at=>{at.reasoning&&ke(be=>{const Ge=be+at.reasoning;return N.current?.({streamingReasoning:Ge}),Ge}),at.content&&fe(be=>{const Ge=be+at.content;return N.current?.({streamingContent:Ge}),Ge})}:void 0;let He;switch(et){case"expand":He=await wt.expandText(ve,dn,void 0,Ye);break;case"rewrite":He=await wt.rewriteText(ve,dn,void 0,Ye);break;case"instruct":if(!nt)throw new Error("No custom prompt provided");He=await wt.instructText(ve,nt,dn,void 0,Ye);break;case"shorten":He=await wt.shortenText(ve,dn,void 0,Ye);break;case"lengthen":He=await wt.lengthenText(ve,dn,void 0,Ye);break;case"vivid":He=await wt.makeVivid(ve,dn,void 0,Ye);break;case"emotion":He=await wt.addEmotion(ve,dn,void 0,Ye);break;case"grammar":He=await wt.fixGrammar(ve,dn,void 0,Ye);break;default:throw new Error("Unknown operation")}Se.current=He.content,ye(He.content),P(He.reasoning||""),U(!1),ce(!1),N.current?.({isProcessing:!1,isStreaming:!1,aiResult:He.content,aiReasoning:He.reasoning||""})}catch(wt){if(wt instanceof An&&wt.message==="Request was cancelled")console.log("[useAIEditor] AI request cancelled by user"),U(!1),ce(!1),N.current?.({isProcessing:!1,isStreaming:!1,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:null,error:null});else{console.error("AI operation failed:",wt);const dn=wt instanceof An?wt.message:"AI operation failed. Please try again.";q(dn),U(!1),ce(!1),N.current?.({isProcessing:!1,isStreaming:!1,error:dn})}}finally{D.current=null}},[s,o,c,h,l]),Ee=$.useCallback(()=>{const et=Se.current,ve=B.current,gt=T.current;!gt||!et||!ve||(gt.dispatch({changes:{from:ve.from,to:ve.to,insert:et},selection:{anchor:ve.from,head:ve.from+et.length}}),ye(null),P(""),fe(""),ke(""),z(null),q(null),Ae(null),l(""),N.current?.({isProcessing:!1,isStreaming:!1,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:null,error:null}))},[l]),Ke=$.useCallback(()=>{ye(null),P(""),fe(""),ke(""),z(null),q(null),U(!1),ce(!1),Ae(null),l(""),N.current?.({isProcessing:!1,isStreaming:!1,streamingContent:"",streamingReasoning:"",aiResult:null,aiReasoning:"",currentOperation:null,error:null})},[l]),$e=$.useCallback(()=>{D.current&&D.current.abort()},[]),ft=$.useCallback(et=>{const ve=T.current;if(!ve)return;const gt=ve.state.doc.toString();et!==gt&&ve.dispatch({changes:{from:0,to:gt.length,insert:et}})},[]);return $.useEffect(()=>{if(!w.current||!b)return;const et=Ht.create({doc:t,extensions:[nd.of(A5),nd.of(_M),kM(),L5,st.lineWrapping,st.contentAttributes.of({spellcheck:"true"}),st.theme({"&":{fontSize:"18px",height:"100%",overflow:"hidden",...g},".cm-scroller":{height:"100%",overflow:"auto"},".cm-content":{fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace",padding:"12px",minHeight:p},".cm-gutters":{backgroundColor:"transparent",border:"none"},".cm-activeLineGutter":{backgroundColor:"transparent"},".cm-line":{padding:"0 4px"}}),st.updateListener.of(gt=>{gt.docChanged&&R.current(gt.state.doc.toString());const nt=gt.state.selection.main;if(nt.from!==nt.to){const Gt=gt.state.doc.sliceString(nt.from,nt.to);Ae({from:nt.from,to:nt.to,text:Gt}),l(Gt)}else Ae(null),l("")}),o_(o,(gt,nt,Gt,yn)=>{je(gt,nt,Gt,yn)},Ee,Ke,$e),t_(),n_()]}),ve=new st({state:et,parent:w.current});return T.current=ve,setTimeout(()=>{ve.focus()},50),setTimeout(()=>{const gt=l_(ve);gt&&(N.current=gt)},100),()=>{ve.destroy(),T.current=null,N.current=null}},[e,b,p,JSON.stringify(g)]),$.useEffect(()=>{const et=T.current;if(!et)return;const ve=et.state.doc.toString();t!==ve&&et.dispatch({changes:{from:0,to:ve.length,insert:t}})},[t]),$.useEffect(()=>{const et=T.current;if(!et)return;const ve=et.dom.querySelector(".ai-toolbar-panel");ve?.__panel?.updateSampler&&ve.__panel.updateSampler(o)},[o]),{editorRef:w,view:T.current,selection:le,isProcessing:j,isStreaming:I,currentOperation:F,aiResult:ee,accept:Ee,reject:Ke,setContent:ft}}function u_({greeting:n,index:e,isOpen:t,onToggle:r,onUpdate:l,onDelete:s,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,contextSectionIds:p,setSelectedText:g}){const{editorRef:b}=oy({value:n,onChange:l,setSelectedText:g,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,contextSectionIds:p,minHeight:"100px",isActive:t});return k.jsxs("div",{className:"border border-vault-200 dark:border-vault-700 rounded-lg overflow-hidden bg-white dark:bg-vault-800",children:[k.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-vault-50 dark:bg-vault-700/50 border-b border-vault-200 dark:border-vault-700",children:[k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsxs("span",{className:"text-sm font-medium text-vault-700 dark:text-vault-300",children:["Greeting ",e+1]}),k.jsxs("span",{className:"text-xs text-vault-500 dark:text-vault-400",children:["(",n.length," chars)"]})]}),k.jsxs("div",{className:"flex items-center gap-1",children:[k.jsx("button",{onClick:r,className:"p-1 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-700 rounded transition-colors",title:t?"Collapse":"Expand",children:t?k.jsx(zo,{className:"w-4 h-4"}):k.jsx(Ea,{className:"w-4 h-4"})}),k.jsx("button",{onClick:s,className:"p-1 text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"Delete greeting",children:k.jsx($o,{className:"w-4 h-4"})})]})]}),t&&k.jsx("div",{ref:b,className:"min-h-25"}),!t&&k.jsx("div",{className:"px-4 py-3 text-sm text-vault-600 dark:text-vault-400 italic truncate",children:n||k.jsx("span",{className:"text-vault-400",children:"Empty greeting"})})]})}function c_({greetings:n,onChange:e,setSelectedText:t,contextSectionIds:r,aiConfig:l,samplerSettings:s,promptSettings:o,getContextContent:c}){const[h,d]=$.useState(n),[p,g]=$.useState(new Set([0]));$.useEffect(()=>{d(n)},[n]);const b=$.useCallback((D,j)=>{const U=[...h];U[D]=j,d(U),e(U)},[h,e]),w=$.useCallback(()=>{const D=[...h,""],j=new Set(p);j.add(D.length-1),d(D),g(j),e(D)},[h,p,e]),T=$.useCallback(D=>{const j=h.filter((ce,F)=>F!==D),U=new Set(p);U.delete(D);const I=new Set;U.forEach(ce=>{ce>D?I.add(ce-1):I.add(ce)}),d(j),g(I),e(j)},[h,p,e]),N=$.useCallback(D=>{const j=new Set(p);j.has(D)?j.delete(D):j.add(D),g(j)},[p]);return k.jsxs("div",{className:"h-full flex flex-col min-h-0 overflow-hidden",children:[k.jsxs("div",{className:"mb-4 flex items-center justify-between shrink-0",children:[k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:"Greetings"}),k.jsxs("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:["Alternate greetings for your character (",h.length," total)"]})]}),k.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-vault-600 hover:bg-vault-700 text-white text-sm rounded-lg transition-colors",children:[k.jsx(Xo,{className:"w-4 h-4"}),"Add Greeting"]})]}),k.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 min-h-0",children:h.length===0?k.jsxs("div",{className:"text-center py-12 text-vault-400 dark:text-vault-500",children:[k.jsx("p",{className:"text-sm",children:"No alternate greetings yet"}),k.jsx("p",{className:"text-xs mt-1",children:'Click "Add Greeting" to create one'})]}):h.map((D,j)=>k.jsx(u_,{greeting:D,index:j,isOpen:p.has(j),onToggle:()=>N(j),onUpdate:U=>b(j,U),onDelete:()=>T(j),aiConfig:l,samplerSettings:s,promptSettings:o,getContextContent:c,contextSectionIds:r,setSelectedText:t},j))})]})}const h_=[{value:"before_char",label:"Before Character"},{value:"after_char",label:"After Character"},{value:"before_example",label:"Before Example"},{value:"after_example",label:"After Example"}];function f_({entry:n,index:e,isOpen:t,onToggle:r,onUpdate:l,onDelete:s,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,contextSectionIds:p,setSelectedText:g}){const{editorRef:b}=oy({value:n.content,onChange:P=>l({...n,content:P}),setSelectedText:g,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,contextSectionIds:p,minHeight:"150px",isActive:t}),[w,T]=Zi.useState(n.keys.join(", "));Zi.useEffect(()=>{const P=n.keys.join(", ");T(pe=>pe!==P?P:pe)},[n.keys]);const N=P=>l({...n,name:P}),D=P=>{T(P)},j=()=>{const P=w.split(",").map(pe=>pe.trim()).filter(pe=>pe);l({...n,keys:P})},U=P=>l({...n,comment:P}),I=P=>{const pe=parseInt(P,10);l({...n,priority:isNaN(pe)?0:pe})},ce=P=>l({...n,position:P}),F=P=>l({...n,enabled:P}),z=P=>l({...n,case_sensitive:P}),ee=P=>l({...n,constant:P}),ye=n.keys.join(", ")||"No keys",Ce=n.enabled?"Enabled":"Disabled";return k.jsxs("div",{className:"border border-vault-200 dark:border-vault-700 rounded-xl overflow-hidden bg-white dark:bg-vault-800 shadow-sm",children:[k.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-vault-50 dark:bg-vault-700/50 border-b border-vault-200 dark:border-vault-700",children:[k.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[k.jsxs("span",{className:"text-xs font-mono text-vault-400 dark:text-vault-500 shrink-0",children:["(UID: ",n.id,")"]}),k.jsx("span",{className:"text-sm font-medium text-vault-700 dark:text-vault-300 truncate",children:n.name||`Entry ${e+1}`}),k.jsxs("span",{className:"text-xs text-vault-500 dark:text-vault-400 shrink-0",children:["(",n.keys.length," keys)"]}),k.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full shrink-0 ${n.enabled?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}`,children:Ce})]}),k.jsxs("div",{className:"flex items-center gap-1",children:[k.jsx("button",{onClick:r,className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-700 rounded-lg transition-colors",title:t?"Collapse":"Expand",children:t?k.jsx(zo,{className:"w-4 h-4"}):k.jsx(Ea,{className:"w-4 h-4"})}),k.jsx("button",{onClick:s,className:"p-1.5 text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Delete entry",children:k.jsx($o,{className:"w-4 h-4"})})]})]}),t&&k.jsxs("div",{className:"p-4 space-y-4",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Entry Name"}),k.jsx("input",{type:"text",value:n.name||"",onChange:P=>N(P.target.value),placeholder:"Entry display name (optional)",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]}),k.jsxs("div",{children:[k.jsxs("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:["Trigger Keys ",k.jsx("span",{className:"text-vault-400",children:"(comma-separated)"})]}),k.jsx("input",{type:"text",value:w,onChange:P=>D(P.target.value),onBlur:j,placeholder:"castle, fortress, stronghold",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]}),k.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Priority"}),k.jsx("input",{type:"number",value:n.priority??0,onChange:P=>I(P.target.value),className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                  text-vault-900 dark:text-vault-100\r
                  focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Position"}),k.jsx("select",{value:n.position||"before_char",onChange:P=>ce(P.target.value),className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                  text-vault-900 dark:text-vault-100\r
                  focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`,children:h_.map(P=>k.jsx("option",{value:P.value,children:P.label},P.value))})]}),k.jsxs("div",{className:"flex flex-col gap-2",children:[k.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[k.jsx("input",{type:"checkbox",checked:n.enabled,onChange:P=>F(P.target.checked),className:"w-4 h-4 rounded border-vault-300 text-vault-600 focus:ring-vault-500"}),k.jsx("span",{className:"text-xs text-vault-600 dark:text-vault-400",children:"Enabled"})]}),k.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[k.jsx("input",{type:"checkbox",checked:n.case_sensitive,onChange:P=>z(P.target.checked),className:"w-4 h-4 rounded border-vault-300 text-vault-600 focus:ring-vault-500"}),k.jsx("span",{className:"text-xs text-vault-600 dark:text-vault-400",children:"Case Sensitive"})]})]}),k.jsx("div",{className:"flex flex-col gap-2",children:k.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[k.jsx("input",{type:"checkbox",checked:n.constant??!1,onChange:P=>ee(P.target.checked),className:"w-4 h-4 rounded border-vault-300 text-vault-600 focus:ring-vault-500"}),k.jsx("span",{className:"text-xs text-vault-600 dark:text-vault-400",children:"Constant"})]})})]}),k.jsxs("div",{children:[k.jsxs("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:["Content ",k.jsx("span",{className:"text-vault-400",children:"(AI toolbar available when text is selected)"})]}),k.jsx("div",{ref:b,className:"border border-vault-200 dark:border-vault-700 rounded-xl overflow-hidden min-h-50"})]}),k.jsxs("div",{children:[k.jsxs("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:["Comment ",k.jsx("span",{className:"text-vault-400",children:"(internal notes, not included in output)"})]}),k.jsx("input",{type:"text",value:n.comment||"",onChange:P=>U(P.target.value),placeholder:"Internal notes about this entry",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]})]}),!t&&k.jsxs("div",{className:"px-4 py-3 bg-vault-50/50 dark:bg-vault-800/50",children:[k.jsxs("div",{className:"text-xs text-vault-600 dark:text-vault-400 mb-1",children:[k.jsx("strong",{children:"Keys:"})," ",ye]}),k.jsx("div",{className:"text-xs text-vault-500 dark:text-vault-500 truncate",children:n.content||k.jsx("span",{className:"italic",children:"No content"})})]})]})}function d_({lorebook:n,onChange:e,setSelectedText:t,contextSectionIds:r,aiConfig:l,samplerSettings:s,promptSettings:o,getContextContent:c,activeSection:h}){const d=n?`lb-${n.name??"unnamed"}-${n.entries.length}`:"no-lorebook";return k.jsx(p_,{lorebook:n,onChange:e,setSelectedText:t,contextSectionIds:r,aiConfig:l,samplerSettings:s,promptSettings:o,getContextContent:c,activeSection:h},d)}function p_({lorebook:n,onChange:e,setSelectedText:t,contextSectionIds:r,aiConfig:l,samplerSettings:s,promptSettings:o,getContextContent:c}){const[h,d]=$.useState(new Set([0])),p=$.useMemo(()=>n?.entries||[],[n?.entries]),g=n?.name||"",b=n?.description||"",w=$.useCallback((F,z,ee)=>{const ye={name:z,description:ee,entries:F,extensions:n?.extensions||{}};e(ye)},[n?.extensions,e]),T=$.useCallback((F,z)=>{const ee=[...p];ee[F]=z,w(ee,g,b)},[p,g,b,w]),N=$.useCallback(()=>{const F=new Set(p.map(ee=>ee.id));let z=0;for(;F.has(z);)z++;return z},[p]),D=$.useCallback(()=>{const z={id:N(),keys:[],content:"",extensions:{},enabled:!0,insertion_order:p.length,case_sensitive:!1,name:"",priority:0,position:"before_char"},ee=[...p,z],ye=ee.length-1;d(Ce=>new Set([...Ce,ye])),w(ee,g,b)},[p,g,b,w,N]),j=$.useCallback(F=>{const z=p.filter((ye,Ce)=>Ce!==F),ee=new Set;h.forEach(ye=>{ye<F?ee.add(ye):ye>F&&ee.add(ye-1)}),d(ee),w(z,g,b)},[p,h,g,b,w]),U=$.useCallback(F=>{const z=new Set(h);z.has(F)?z.delete(F):z.add(F),d(z)},[h]),I=F=>{w(p,F,b)},ce=F=>{w(p,g,F)};return k.jsxs("div",{className:"h-full flex flex-col min-h-0 overflow-hidden",children:[k.jsxs("div",{className:"mb-4 flex items-center justify-between shrink-0",children:[k.jsxs("div",{children:[k.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:"Lorebook"}),k.jsxs("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:[p.length," entr",p.length===1?"y":"ies"," total"]})]}),k.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 bg-vault-600 hover:bg-vault-700 text-white text-sm rounded-lg transition-colors",children:[k.jsx(Xo,{className:"w-4 h-4"}),"Add Entry"]})]}),k.jsxs("div",{className:"mb-4 p-4 bg-vault-50 dark:bg-vault-800/50 border border-vault-200 dark:border-vault-700 rounded-xl shrink-0",children:[k.jsx("h3",{className:"text-sm font-semibold text-vault-700 dark:text-vault-300 mb-3",children:"Book Settings"}),k.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Book Name"}),k.jsx("input",{type:"text",value:g,onChange:F=>I(F.target.value),placeholder:"Character Lorebook",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]}),k.jsxs("div",{children:[k.jsx("label",{className:"block text-xs font-medium text-vault-600 dark:text-vault-400 mb-1.5",children:"Description"}),k.jsx("input",{type:"text",value:b,onChange:F=>ce(F.target.value),placeholder:"Brief description of this lorebook",className:`w-full px-3 py-2 text-sm bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-700 rounded-lg\r
                text-vault-900 dark:text-vault-100 placeholder:text-vault-400\r
                focus:outline-none focus:ring-2 focus:ring-vault-500 focus:border-transparent`})]})]})]}),k.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 min-h-0",children:p.length===0?k.jsxs("div",{className:"text-center py-12 text-vault-400 dark:text-vault-500",children:[k.jsx(D0,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),k.jsx("p",{className:"text-sm",children:"No lore entries yet"}),k.jsx("p",{className:"text-xs mt-1",children:'Click "Add Entry" to create your first lore entry'})]}):p.map((F,z)=>k.jsx(f_,{entry:F,index:z,isOpen:h.has(z),onToggle:()=>U(z),onUpdate:ee=>T(z,ee),onDelete:()=>j(z),aiConfig:l,samplerSettings:s,promptSettings:o,getContextContent:c,contextSectionIds:r,setSelectedText:t},F.id))}),k.jsx("div",{className:"mt-4 p-3 bg-vault-50 dark:bg-vault-800/50 border border-vault-200 dark:border-vault-700 rounded-lg shrink-0",children:k.jsxs("p",{className:"text-xs text-vault-600 dark:text-vault-400",children:[k.jsx("strong",{children:"Note:"})," This editor provides essential lore management. For advanced logic or complex world-building features, power users may prefer using dedicated tools like SillyTavern's World Info."]})})]})}function m_(n,e){const t=n.data.spec;switch(e){case"name":return String(t.name||"");case"description":return String(t.description||"");case"personality":return String(t.personality||"");case"scenario":return String(t.scenario||"");case"first_mes":return String(t.first_mes||"");case"mes_example":return String(t.mes_example||"");case"system_prompt":return String(t.system_prompt||"");case"post_history_instructions":return String(t.post_history_instructions||"");case"alternate_greetings":return Array.isArray(t.alternate_greetings)?t.alternate_greetings.join(`
---
`):"";case"physical_description":return String(t.physical_description||"");case"extensions":return JSON.stringify(n.data.extensions||{},null,2);case"avatar":return String(t.avatar||"");case"creator_notes":return String(t.creator_notes||"");case"creator":return String(t.creator||"");case"character_version":return String(t.character_version||"");case"tags":return Array.isArray(t.tags)?t.tags.join(", "):"";default:return""}}function g_({section:n}){const{currentCharacter:e,updateCharacter:t,updateSpecField:r,setSelectedText:l,contextSectionIds:s,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,activeSection:p}=bd(),g=Zi.useMemo(()=>e?m_(e,n):"",[e,n]),b=$.useCallback(N=>{n==="image"||n==="extensions"||n==="lorebook"||(n==="alternate_greetings"?r(n,N.split(`
---
`).filter(D=>D.trim())):n==="tags"?r(n,N.split(",").map(D=>D.trim()).filter(D=>D)):r(n,N))},[n,r]),{editorRef:w}=oy({key:n,value:g,onChange:b,setSelectedText:l,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,contextSectionIds:s,minHeight:"400px",editorStyles:{padding:"16px"},isActive:n!=="image"&&n!=="alternate_greetings"&&n!=="lorebook"&&!!e});if(!e)return k.jsx("div",{children:"No character selected"});const T=Mo.find(N=>N.id===n);return n==="image"?k.jsx("div",{className:"h-full flex items-center justify-center text-vault-500 animate-fade-in-slow",children:k.jsx("p",{children:"Use the Image section in the left sidebar to upload a character image."})}):n==="extensions"?k.jsxs("div",{className:"h-full flex flex-col min-h-0 overflow-hidden animate-fade-in-slow",children:[k.jsxs("div",{className:"mb-4 shrink-0",children:[k.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:T?.label}),k.jsx("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:"Extension data (JSON format)"})]}),k.jsx("div",{ref:w,className:"flex-1 min-h-0 border border-vault-200 dark:border-vault-700 rounded-xl overflow-hidden"})]}):n==="alternate_greetings"?k.jsx("div",{className:"h-full animate-fade-in-slow",children:k.jsx(c_,{greetings:e?.data?.spec?.alternate_greetings||[],onChange:N=>{r(n,N)},selectedText:"",setSelectedText:l,contextSectionIds:s,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,activeSection:p})}):n==="lorebook"?k.jsx("div",{className:"h-full animate-fade-in-slow",children:k.jsx(d_,{lorebook:e?.data?.characterBook,onChange:N=>{t({data:{...e.data,characterBook:N}})},setSelectedText:l,contextSectionIds:s,aiConfig:o,samplerSettings:c,promptSettings:h,getContextContent:d,activeSection:p})}):k.jsxs("div",{className:"h-full flex flex-col min-h-0 overflow-hidden animate-fade-in-slow",children:[k.jsxs("div",{className:"mb-4 shrink-0",children:[k.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:T?.label}),k.jsx("p",{className:"text-sm text-vault-500 dark:text-vault-400",children:T?.description})]}),k.jsx("div",{ref:w,className:"flex-1 min-h-0 border border-vault-200 dark:border-vault-700 rounded-xl overflow-hidden"})]})}function y_({onClose:n,isMobile:e=!1}){const{currentCharacter:t,contextSectionIds:r,setContextSectionIds:l,addContextSection:s,removeContextSection:o,samplerSettings:c}=bd(),[h,d]=$.useState(""),[p,g]=$.useState(!0),[b,w]=$.useState(!0),T=c.contextLength,N=Mo.filter(I=>{if(["image","extensions","avatar","character_version","tags"].includes(I.id)||r.includes(I.id)||I.id==="lorebook"&&!(t?.data.characterBook&&t.data.characterBook.entries.length>0))return!1;if(!h.trim())return!0;const F=h.toLowerCase();return I.label.toLowerCase().includes(F)||I.description.toLowerCase().includes(F)}),D=Mo.filter(I=>r.includes(I.id)),j=$.useCallback(()=>{if(!t)return 0;let I=0;return r.forEach(ce=>{const F=t.data.spec;switch(ce){case"name":I+=F.name.length;break;case"description":I+=F.description.length;break;case"personality":I+=F.personality.length;break;case"scenario":I+=F.scenario.length;break;case"first_mes":I+=F.first_mes.length;break;case"mes_example":I+=F.mes_example.length;break;case"system_prompt":I+=F.system_prompt.length;break;case"post_history_instructions":I+=F.post_history_instructions.length;break;case"alternate_greetings":I+=F.alternate_greetings.join(`
---
`).length;break;case"physical_description":I+=F.physical_description.length;break;case"creator":I+=F.creator?.length||0;break;case"creator_notes":I+=F.creator_notes?.length||0;break;case"lorebook":{const z=t.data.characterBook;z&&(I+=z.name?.length||0,I+=z.description?.length||0,z.entries.forEach(ee=>{ee.enabled&&(I+=ee.content.length,I+=ee.keys.join(",").length,I+=ee.name?.length||0,I+=ee.comment?.length||0)}));break}}}),Math.ceil(I/4)},[t,r]),U=Zi.useMemo(()=>{const I=j(),ce=Math.min(100,I/T*100);let F="good";return ce>80?F="danger":ce>50&&(F="warning"),{tokenCount:I,percentage:ce,status:F}},[j,T]);return t?k.jsxs("div",{className:"h-full flex flex-col bg-vault-50 dark:bg-vault-900 border-r border-vault-200 dark:border-vault-800 animate-fade-in-slow",children:[k.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-vault-200 dark:border-vault-800 bg-vault-100 dark:bg-vault-800/50 shrink-0",children:[k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx(jl,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),k.jsx("h2",{className:"font-semibold text-vault-900 dark:text-vault-100",children:"AI Context"})]}),k.jsxs("div",{className:"flex items-center gap-1",children:[k.jsx("button",{onClick:()=>l([]),className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-800 rounded-lg transition-colors disabled:opacity-50",title:"Clear all context",disabled:r.length===0,children:k.jsx(Jk,{className:"w-4 h-4"})}),e&&n&&k.jsx("button",{onClick:n,className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-800 rounded-lg transition-colors",title:"Close Context Panel",children:k.jsx(vs,{className:"w-4 h-4"})})]})]}),k.jsxs("div",{className:"border-b border-vault-200 dark:border-vault-800 shrink-0",children:[k.jsxs("button",{onClick:()=>g(!p),className:"w-full flex items-center justify-between px-4 py-2.5 hover:bg-vault-100 dark:hover:bg-vault-800/50 transition-colors",children:[k.jsxs("h3",{className:"text-xs font-medium text-vault-500 dark:text-vault-400 uppercase tracking-wide",children:["Selected Context (",D.length,")"]}),p?k.jsx(zo,{className:"w-4 h-4 text-vault-400"}):k.jsx(Ea,{className:"w-4 h-4 text-vault-400"})]}),p&&k.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[D.length>0&&k.jsxs("div",{className:"p-3 bg-white dark:bg-vault-800 rounded-lg border border-vault-200 dark:border-vault-700",children:[k.jsxs("div",{className:"flex items-center justify-between mb-2",children:[k.jsx("span",{className:"text-xs text-vault-600 dark:text-vault-400",children:"Context Usage"}),k.jsxs("span",{className:`text-xs font-medium ${U.status==="good"?"text-green-600 dark:text-green-400":U.status==="warning"?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,children:[U.percentage.toFixed(0),"%"]})]}),k.jsx("div",{className:"h-2 bg-vault-200 dark:bg-vault-700 rounded-full overflow-hidden mb-2",children:k.jsx("div",{className:`h-full transition-all duration-300 ${U.status==="good"?"bg-green-500":U.status==="warning"?"bg-yellow-500":"bg-red-500"}`,style:{width:`${U.percentage}%`}})}),k.jsxs("div",{className:"flex items-center justify-between text-xs",children:[k.jsxs("span",{className:"text-vault-500 dark:text-vault-400",children:[U.tokenCount.toLocaleString()," / ",T.toLocaleString()," tokens"]}),U.status==="danger"&&k.jsxs("span",{className:"flex items-center gap-1 text-red-600 dark:text-red-400",children:[k.jsx(Aa,{className:"w-3 h-3"}),"Over limit"]})]})]}),k.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:k.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-700 dark:text-blue-400",children:[k.jsx(Y4,{className:"w-4 h-4 shrink-0"}),k.jsx("span",{children:"Current section is automatically included"})]})}),D.length===0?k.jsxs("div",{className:"text-center py-4 text-vault-400 dark:text-vault-500",children:[k.jsx(qf,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),k.jsx("p",{className:"text-sm",children:"No context selected"}),k.jsx("p",{className:"text-xs mt-1",children:"Add sections to provide context for AI"})]}):k.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:D.map(I=>k.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border bg-white dark:bg-vault-800 border-vault-200 dark:border-vault-700",children:[k.jsx("span",{className:"text-sm font-medium text-vault-900 dark:text-vault-100",children:I.label}),k.jsx("button",{onClick:()=>o(I.id),className:"p-1.5 text-vault-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors ml-2",title:"Remove from context",children:k.jsx($o,{className:"w-3.5 h-3.5"})})]},I.id))})]})]}),k.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[k.jsxs("button",{onClick:()=>w(!b),className:"w-full flex items-center justify-between px-4 py-2.5 border-b border-vault-200 dark:border-vault-800 hover:bg-vault-100 dark:hover:bg-vault-800/50 transition-colors shrink-0",children:[k.jsx("h3",{className:"text-xs font-medium text-vault-500 dark:text-vault-400 uppercase tracking-wide",children:"Add Context"}),b?k.jsx(zo,{className:"w-4 h-4 text-vault-400"}):k.jsx(Ea,{className:"w-4 h-4 text-vault-400"})]}),b&&k.jsxs(k.Fragment,{children:[k.jsx("div",{className:"p-4 border-b border-vault-200 dark:border-vault-800 shrink-0",children:k.jsxs("div",{className:"relative",children:[k.jsx(Ff,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-vault-400"}),k.jsx("input",{type:"text",value:h,onChange:I=>d(I.target.value),placeholder:"Search sections...",className:"w-full pl-9 pr-4 py-2 text-sm border border-vault-300 dark:border-vault-700 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 placeholder-vault-400 focus:outline-none focus:ring-2 focus:ring-vault-500"})]})}),k.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:N.length===0?k.jsx("div",{className:"text-center py-8 text-vault-400 dark:text-vault-500",children:k.jsx("p",{className:"text-sm",children:h.trim()?"No matching sections found":"All sections are in context"})}):k.jsx("div",{className:"space-y-2",children:N.map(I=>k.jsx("button",{onClick:()=>{s(I.id),d("")},className:"w-full text-left p-3 bg-white dark:bg-vault-800 hover:bg-vault-100 dark:hover:bg-vault-700 border border-vault-200 dark:border-vault-700 rounded-lg transition-colors group",children:k.jsxs("div",{className:"flex items-start justify-between gap-2",children:[k.jsxs("div",{className:"flex-1 min-w-0",children:[k.jsx("p",{className:"text-sm font-medium text-vault-900 dark:text-vault-100 truncate group-hover:text-vault-600 dark:group-hover:text-vault-400",children:I.label}),k.jsx("p",{className:"text-xs text-vault-500 mt-1",children:I.description})]}),k.jsx(Xo,{className:"w-4 h-4 text-vault-400 group-hover:text-vault-600 dark:group-hover:text-vault-400 shrink-0 mt-0.5"})]})},I.id))})})]})]})]}):k.jsx(k.Fragment,{})}function x_(n,e){const t={};return(n[n.length-1]===""?[...n,""]:n).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}const v_=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,b_=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,k_={};function ek(n,e){return(k_.jsx?b_:v_).test(n)}const w_=/[ \t\n\f\r]/g;function S_(n){return typeof n=="object"?n.type==="text"?tk(n.value):!1:tk(n)}function tk(n){return n.replace(w_,"")===""}class Kc{constructor(e,t,r){this.normal=t,this.property=e,r&&(this.space=r)}}Kc.prototype.normal={};Kc.prototype.property={};Kc.prototype.space=void 0;function b2(n,e){const t={},r={};for(const l of n)Object.assign(t,l.property),Object.assign(r,l.normal);return new Kc(t,r,e)}function x0(n){return n.toLowerCase()}class Dr{constructor(e,t){this.attribute=t,this.property=e}}Dr.prototype.attribute="";Dr.prototype.booleanish=!1;Dr.prototype.boolean=!1;Dr.prototype.commaOrSpaceSeparated=!1;Dr.prototype.commaSeparated=!1;Dr.prototype.defined=!1;Dr.prototype.mustUseProperty=!1;Dr.prototype.number=!1;Dr.prototype.overloadedBoolean=!1;Dr.prototype.property="";Dr.prototype.spaceSeparated=!1;Dr.prototype.space=void 0;let C_=0;const xt=As(),Bn=As(),v0=As(),Re=As(),an=As(),Lo=As(),Ur=As();function As(){return 2**++C_}const b0=Object.freeze(Object.defineProperty({__proto__:null,boolean:xt,booleanish:Bn,commaOrSpaceSeparated:Ur,commaSeparated:Lo,number:Re,overloadedBoolean:v0,spaceSeparated:an},Symbol.toStringTag,{value:"Module"})),sg=Object.keys(b0);class uy extends Dr{constructor(e,t,r,l){let s=-1;if(super(e,t),nk(this,"space",l),typeof r=="number")for(;++s<sg.length;){const o=sg[s];nk(this,sg[s],(r&b0[o])===b0[o])}}}uy.prototype.defined=!0;function nk(n,e,t){t&&(n[e]=t)}function Jo(n){const e={},t={};for(const[r,l]of Object.entries(n.properties)){const s=new uy(r,n.transform(n.attributes||{},r),l,n.space);n.mustUseProperty&&n.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),e[r]=s,t[x0(r)]=r,t[x0(s.attribute)]=r}return new Kc(e,t,n.space)}const k2=Jo({properties:{ariaActiveDescendant:null,ariaAtomic:Bn,ariaAutoComplete:null,ariaBusy:Bn,ariaChecked:Bn,ariaColCount:Re,ariaColIndex:Re,ariaColSpan:Re,ariaControls:an,ariaCurrent:null,ariaDescribedBy:an,ariaDetails:null,ariaDisabled:Bn,ariaDropEffect:an,ariaErrorMessage:null,ariaExpanded:Bn,ariaFlowTo:an,ariaGrabbed:Bn,ariaHasPopup:null,ariaHidden:Bn,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:an,ariaLevel:Re,ariaLive:null,ariaModal:Bn,ariaMultiLine:Bn,ariaMultiSelectable:Bn,ariaOrientation:null,ariaOwns:an,ariaPlaceholder:null,ariaPosInSet:Re,ariaPressed:Bn,ariaReadOnly:Bn,ariaRelevant:null,ariaRequired:Bn,ariaRoleDescription:an,ariaRowCount:Re,ariaRowIndex:Re,ariaRowSpan:Re,ariaSelected:Bn,ariaSetSize:Re,ariaSort:null,ariaValueMax:Re,ariaValueMin:Re,ariaValueNow:Re,ariaValueText:null,role:null},transform(n,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function w2(n,e){return e in n?n[e]:e}function S2(n,e){return w2(n,e.toLowerCase())}const A_=Jo({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Lo,acceptCharset:an,accessKey:an,action:null,allow:null,allowFullScreen:xt,allowPaymentRequest:xt,allowUserMedia:xt,alt:null,as:null,async:xt,autoCapitalize:null,autoComplete:an,autoFocus:xt,autoPlay:xt,blocking:an,capture:null,charSet:null,checked:xt,cite:null,className:an,cols:Re,colSpan:null,content:null,contentEditable:Bn,controls:xt,controlsList:an,coords:Re|Lo,crossOrigin:null,data:null,dateTime:null,decoding:null,default:xt,defer:xt,dir:null,dirName:null,disabled:xt,download:v0,draggable:Bn,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:xt,formTarget:null,headers:an,height:Re,hidden:v0,high:Re,href:null,hrefLang:null,htmlFor:an,httpEquiv:an,id:null,imageSizes:null,imageSrcSet:null,inert:xt,inputMode:null,integrity:null,is:null,isMap:xt,itemId:null,itemProp:an,itemRef:an,itemScope:xt,itemType:an,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:xt,low:Re,manifest:null,max:null,maxLength:Re,media:null,method:null,min:null,minLength:Re,multiple:xt,muted:xt,name:null,nonce:null,noModule:xt,noValidate:xt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:xt,optimum:Re,pattern:null,ping:an,placeholder:null,playsInline:xt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:xt,referrerPolicy:null,rel:an,required:xt,reversed:xt,rows:Re,rowSpan:Re,sandbox:an,scope:null,scoped:xt,seamless:xt,selected:xt,shadowRootClonable:xt,shadowRootDelegatesFocus:xt,shadowRootMode:null,shape:null,size:Re,sizes:null,slot:null,span:Re,spellCheck:Bn,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Re,step:null,style:null,tabIndex:Re,target:null,title:null,translate:null,type:null,typeMustMatch:xt,useMap:null,value:Bn,width:Re,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:an,axis:null,background:null,bgColor:null,border:Re,borderColor:null,bottomMargin:Re,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:xt,declare:xt,event:null,face:null,frame:null,frameBorder:null,hSpace:Re,leftMargin:Re,link:null,longDesc:null,lowSrc:null,marginHeight:Re,marginWidth:Re,noResize:xt,noHref:xt,noShade:xt,noWrap:xt,object:null,profile:null,prompt:null,rev:null,rightMargin:Re,rules:null,scheme:null,scrolling:Bn,standby:null,summary:null,text:null,topMargin:Re,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Re,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:xt,disableRemotePlayback:xt,prefix:null,property:null,results:Re,security:null,unselectable:null},space:"html",transform:S2}),T_=Jo({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ur,accentHeight:Re,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Re,amplitude:Re,arabicForm:null,ascent:Re,attributeName:null,attributeType:null,azimuth:Re,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Re,by:null,calcMode:null,capHeight:Re,className:an,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Re,diffuseConstant:Re,direction:null,display:null,dur:null,divisor:Re,dominantBaseline:null,download:xt,dx:null,dy:null,edgeMode:null,editable:null,elevation:Re,enableBackground:null,end:null,event:null,exponent:Re,externalResourcesRequired:null,fill:null,fillOpacity:Re,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Lo,g2:Lo,glyphName:Lo,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Re,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Re,horizOriginX:Re,horizOriginY:Re,id:null,ideographic:Re,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Re,k:Re,k1:Re,k2:Re,k3:Re,k4:Re,kernelMatrix:Ur,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Re,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Re,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Re,overlineThickness:Re,paintOrder:null,panose1:null,path:null,pathLength:Re,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:an,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Re,pointsAtY:Re,pointsAtZ:Re,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ur,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ur,rev:Ur,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ur,requiredFeatures:Ur,requiredFonts:Ur,requiredFormats:Ur,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Re,specularExponent:Re,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Re,strikethroughThickness:Re,string:null,stroke:null,strokeDashArray:Ur,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Re,strokeOpacity:Re,strokeWidth:null,style:null,surfaceScale:Re,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ur,tabIndex:Re,tableValues:null,target:null,targetX:Re,targetY:Re,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ur,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Re,underlineThickness:Re,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Re,values:null,vAlphabetic:Re,vMathematical:Re,vectorEffect:null,vHanging:Re,vIdeographic:Re,version:null,vertAdvY:Re,vertOriginX:Re,vertOriginY:Re,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Re,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:w2}),C2=Jo({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(n,e){return"xlink:"+e.slice(5).toLowerCase()}}),A2=Jo({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:S2}),T2=Jo({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(n,e){return"xml:"+e.slice(3).toLowerCase()}}),E_={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},N_=/[A-Z]/g,rk=/-[a-z]/g,M_=/^data[-\w.:]+$/i;function __(n,e){const t=x0(e);let r=e,l=Dr;if(t in n.normal)return n.property[n.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&M_.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(rk,j_);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!rk.test(s)){let o=s.replace(N_,D_);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}l=uy}return new l(r,e)}function D_(n){return"-"+n.toLowerCase()}function j_(n){return n.charAt(1).toUpperCase()}const O_=b2([k2,A_,C2,A2,T2],"html"),cy=b2([k2,T_,C2,A2,T2],"svg");function R_(n){return n.join(" ").trim()}var vo={},og,ik;function B_(){if(ik)return og;ik=1;var n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,t=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,l=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,c=/^\s+|\s+$/g,h=`
`,d="/",p="*",g="",b="comment",w="declaration";function T(D,j){if(typeof D!="string")throw new TypeError("First argument must be a string");if(!D)return[];j=j||{};var U=1,I=1;function ce(ke){var J=ke.match(e);J&&(U+=J.length);var q=ke.lastIndexOf(h);I=~q?ke.length-q:I+ke.length}function F(){var ke={line:U,column:I};return function(J){return J.position=new z(ke),Ce(),J}}function z(ke){this.start=ke,this.end={line:U,column:I},this.source=j.source}z.prototype.content=D;function ee(ke){var J=new Error(j.source+":"+U+":"+I+": "+ke);if(J.reason=ke,J.filename=j.source,J.line=U,J.column=I,J.source=D,!j.silent)throw J}function ye(ke){var J=ke.exec(D);if(J){var q=J[0];return ce(q),D=D.slice(q.length),J}}function Ce(){ye(t)}function P(ke){var J;for(ke=ke||[];J=pe();)J!==!1&&ke.push(J);return ke}function pe(){var ke=F();if(!(d!=D.charAt(0)||p!=D.charAt(1))){for(var J=2;g!=D.charAt(J)&&(p!=D.charAt(J)||d!=D.charAt(J+1));)++J;if(J+=2,g===D.charAt(J-1))return ee("End of comment missing");var q=D.slice(2,J-2);return I+=2,ce(q),D=D.slice(J),I+=2,ke({type:b,comment:q})}}function fe(){var ke=F(),J=ye(r);if(J){if(pe(),!ye(l))return ee("property missing ':'");var q=ye(s),le=ke({type:w,property:N(J[0].replace(n,g)),value:q?N(q[0].replace(n,g)):g});return ye(o),le}}function De(){var ke=[];P(ke);for(var J;J=fe();)J!==!1&&(ke.push(J),P(ke));return ke}return Ce(),De()}function N(D){return D?D.replace(c,g):g}return og=T,og}var lk;function L_(){if(lk)return vo;lk=1;var n=vo&&vo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(vo,"__esModule",{value:!0}),vo.default=t;const e=n(B_());function t(r,l){let s=null;if(!r||typeof r!="string")return s;const o=(0,e.default)(r),c=typeof l=="function";return o.forEach(h=>{if(h.type!=="declaration")return;const{property:d,value:p}=h;c?l(d,p,h):p&&(s=s||{},s[d]=p)}),s}return vo}var oc={},ak;function z_(){if(ak)return oc;ak=1,Object.defineProperty(oc,"__esModule",{value:!0}),oc.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,t=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,l=/^-(ms)-/,s=function(d){return!d||t.test(d)||n.test(d)},o=function(d,p){return p.toUpperCase()},c=function(d,p){return"".concat(p,"-")},h=function(d,p){return p===void 0&&(p={}),s(d)?d:(d=d.toLowerCase(),p.reactCompat?d=d.replace(l,c):d=d.replace(r,c),d.replace(e,o))};return oc.camelCase=h,oc}var uc,sk;function I_(){if(sk)return uc;sk=1;var n=uc&&uc.__importDefault||function(l){return l&&l.__esModule?l:{default:l}},e=n(L_()),t=z_();function r(l,s){var o={};return!l||typeof l!="string"||(0,e.default)(l,function(c,h){c&&h&&(o[(0,t.camelCase)(c,s)]=h)}),o}return r.default=r,uc=r,uc}var P_=I_();const H_=vd(P_),E2=N2("end"),hy=N2("start");function N2(n){return e;function e(t){const r=t&&t.position&&t.position[n]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function q_(n){const e=hy(n),t=E2(n);if(e&&t)return{start:e,end:t}}function Ac(n){return!n||typeof n!="object"?"":"position"in n||"type"in n?ok(n.position):"start"in n||"end"in n?ok(n):"line"in n||"column"in n?k0(n):""}function k0(n){return uk(n&&n.line)+":"+uk(n&&n.column)}function ok(n){return k0(n&&n.start)+"-"+k0(n&&n.end)}function uk(n){return n&&typeof n=="number"?n:1}class pr extends Error{constructor(e,t,r){super(),typeof t=="string"&&(r=t,t=void 0);let l="",s={},o=!1;if(t&&("line"in t&&"column"in t?s={place:t}:"start"in t&&"end"in t?s={place:t}:"type"in t?s={ancestors:[t],place:t.position}:s={...t}),typeof e=="string"?l=e:!s.cause&&e&&(o=!0,l=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof r=="string"){const h=r.indexOf(":");h===-1?s.ruleId=r:(s.source=r.slice(0,h),s.ruleId=r.slice(h+1))}if(!s.place&&s.ancestors&&s.ancestors){const h=s.ancestors[s.ancestors.length-1];h&&(s.place=h.position)}const c=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=c?c.column:void 0,this.fatal=void 0,this.file="",this.message=l,this.line=c?c.line:void 0,this.name=Ac(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=o&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}pr.prototype.file="";pr.prototype.name="";pr.prototype.reason="";pr.prototype.message="";pr.prototype.stack="";pr.prototype.column=void 0;pr.prototype.line=void 0;pr.prototype.ancestors=void 0;pr.prototype.cause=void 0;pr.prototype.fatal=void 0;pr.prototype.place=void 0;pr.prototype.ruleId=void 0;pr.prototype.source=void 0;const fy={}.hasOwnProperty,U_=new Map,F_=/[A-Z]/g,V_=new Set(["table","tbody","thead","tfoot","tr"]),K_=new Set(["td","th"]),M2="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function G_(n,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const t=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=eD(t,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=J_(t,e.jsx,e.jsxs)}const l={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:t,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?cy:O_,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},s=_2(l,n,void 0);return s&&typeof s!="string"?s:l.create(n,l.Fragment,{children:s||void 0},void 0)}function _2(n,e,t){if(e.type==="element")return Y_(n,e,t);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return Q_(n,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return $_(n,e,t);if(e.type==="mdxjsEsm")return X_(n,e);if(e.type==="root")return W_(n,e,t);if(e.type==="text")return Z_(n,e)}function Y_(n,e,t){const r=n.schema;let l=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(l=cy,n.schema=l),n.ancestors.push(e);const s=j2(n,e.tagName,!1),o=tD(n,e);let c=py(n,e);return V_.has(e.tagName)&&(c=c.filter(function(h){return typeof h=="string"?!S_(h):!0})),D2(n,o,s,e),dy(o,c),n.ancestors.pop(),n.schema=r,n.create(e,s,o,t)}function Q_(n,e){if(e.data&&e.data.estree&&n.evaluater){const r=e.data.estree.body[0];return r.type,n.evaluater.evaluateExpression(r.expression)}Ic(n,e.position)}function X_(n,e){if(e.data&&e.data.estree&&n.evaluater)return n.evaluater.evaluateProgram(e.data.estree);Ic(n,e.position)}function $_(n,e,t){const r=n.schema;let l=r;e.name==="svg"&&r.space==="html"&&(l=cy,n.schema=l),n.ancestors.push(e);const s=e.name===null?n.Fragment:j2(n,e.name,!0),o=nD(n,e),c=py(n,e);return D2(n,o,s,e),dy(o,c),n.ancestors.pop(),n.schema=r,n.create(e,s,o,t)}function W_(n,e,t){const r={};return dy(r,py(n,e)),n.create(e,n.Fragment,r,t)}function Z_(n,e){return e.value}function D2(n,e,t,r){typeof t!="string"&&t!==n.Fragment&&n.passNode&&(e.node=r)}function dy(n,e){if(e.length>0){const t=e.length>1?e:e[0];t&&(n.children=t)}}function J_(n,e,t){return r;function r(l,s,o,c){const d=Array.isArray(o.children)?t:e;return c?d(s,o,c):d(s,o)}}function eD(n,e){return t;function t(r,l,s,o){const c=Array.isArray(s.children),h=hy(r);return e(l,s,o,c,{columnNumber:h?h.column-1:void 0,fileName:n,lineNumber:h?h.line:void 0},void 0)}}function tD(n,e){const t={};let r,l;for(l in e.properties)if(l!=="children"&&fy.call(e.properties,l)){const s=rD(n,l,e.properties[l]);if(s){const[o,c]=s;n.tableCellAlignToStyle&&o==="align"&&typeof c=="string"&&K_.has(e.tagName)?r=c:t[o]=c}}if(r){const s=t.style||(t.style={});s[n.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return t}function nD(n,e){const t={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&n.evaluater){const s=r.data.estree.body[0];s.type;const o=s.expression;o.type;const c=o.properties[0];c.type,Object.assign(t,n.evaluater.evaluateExpression(c.argument))}else Ic(n,e.position);else{const l=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&n.evaluater){const c=r.value.data.estree.body[0];c.type,s=n.evaluater.evaluateExpression(c.expression)}else Ic(n,e.position);else s=r.value===null?!0:r.value;t[l]=s}return t}function py(n,e){const t=[];let r=-1;const l=n.passKeys?new Map:U_;for(;++r<e.children.length;){const s=e.children[r];let o;if(n.passKeys){const h=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(h){const d=l.get(h)||0;o=h+"-"+d,l.set(h,d+1)}}const c=_2(n,s,o);c!==void 0&&t.push(c)}return t}function rD(n,e,t){const r=__(n.schema,e);if(!(t==null||typeof t=="number"&&Number.isNaN(t))){if(Array.isArray(t)&&(t=r.commaSeparated?x_(t):R_(t)),r.property==="style"){let l=typeof t=="object"?t:iD(n,String(t));return n.stylePropertyNameCase==="css"&&(l=lD(l)),["style",l]}return[n.elementAttributeNameCase==="react"&&r.space?E_[r.property]||r.property:r.attribute,t]}}function iD(n,e){try{return H_(e,{reactCompat:!0})}catch(t){if(n.ignoreInvalidStyle)return{};const r=t,l=new pr("Cannot parse `style` attribute",{ancestors:n.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw l.file=n.filePath||void 0,l.url=M2+"#cannot-parse-style-attribute",l}}function j2(n,e,t){let r;if(!t)r={type:"Literal",value:e};else if(e.includes(".")){const l=e.split(".");let s=-1,o;for(;++s<l.length;){const c=ek(l[s])?{type:"Identifier",name:l[s]}:{type:"Literal",value:l[s]};o=o?{type:"MemberExpression",object:o,property:c,computed:!!(s&&c.type==="Literal"),optional:!1}:c}r=o}else r=ek(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const l=r.value;return fy.call(n.components,l)?n.components[l]:l}if(n.evaluater)return n.evaluater.evaluateExpression(r);Ic(n)}function Ic(n,e){const t=new pr("Cannot handle MDX estrees without `createEvaluater`",{ancestors:n.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw t.file=n.filePath||void 0,t.url=M2+"#cannot-handle-mdx-estrees-without-createevaluater",t}function lD(n){const e={};let t;for(t in n)fy.call(n,t)&&(e[aD(t)]=n[t]);return e}function aD(n){let e=n.replace(F_,sD);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function sD(n){return"-"+n.toLowerCase()}const ug={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},oD={};function my(n,e){const t=oD,r=typeof t.includeImageAlt=="boolean"?t.includeImageAlt:!0,l=typeof t.includeHtml=="boolean"?t.includeHtml:!0;return O2(n,r,l)}function O2(n,e,t){if(uD(n)){if("value"in n)return n.type==="html"&&!t?"":n.value;if(e&&"alt"in n&&n.alt)return n.alt;if("children"in n)return ck(n.children,e,t)}return Array.isArray(n)?ck(n,e,t):""}function ck(n,e,t){const r=[];let l=-1;for(;++l<n.length;)r[l]=O2(n[l],e,t);return r.join("")}function uD(n){return!!(n&&typeof n=="object")}const hk=document.createElement("i");function gy(n){const e="&"+n+";";hk.innerHTML=e;const t=hk.textContent;return t.charCodeAt(t.length-1)===59&&n!=="semi"||t===e?!1:t}function Kr(n,e,t,r){const l=n.length;let s=0,o;if(e<0?e=-e>l?0:l+e:e=e>l?l:e,t=t>0?t:0,r.length<1e4)o=Array.from(r),o.unshift(e,t),n.splice(...o);else for(t&&n.splice(e,t);s<r.length;)o=r.slice(s,s+1e4),o.unshift(e,0),n.splice(...o),s+=1e4,e+=1e4}function ai(n,e){return n.length>0?(Kr(n,n.length,0,e),n):e}const fk={}.hasOwnProperty;function R2(n){const e={};let t=-1;for(;++t<n.length;)cD(e,n[t]);return e}function cD(n,e){let t;for(t in e){const l=(fk.call(n,t)?n[t]:void 0)||(n[t]={}),s=e[t];let o;if(s)for(o in s){fk.call(l,o)||(l[o]=[]);const c=s[o];hD(l[o],Array.isArray(c)?c:c?[c]:[])}}}function hD(n,e){let t=-1;const r=[];for(;++t<e.length;)(e[t].add==="after"?n:r).push(e[t]);Kr(n,0,0,r)}function B2(n,e){const t=Number.parseInt(n,e);return t<9||t===11||t>13&&t<32||t>126&&t<160||t>55295&&t<57344||t>64975&&t<65008||(t&65535)===65535||(t&65535)===65534||t>1114111?"":String.fromCodePoint(t)}function wi(n){return n.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const vr=Ba(/[A-Za-z]/),fr=Ba(/[\dA-Za-z]/),fD=Ba(/[#-'*+\--9=?A-Z^-~]/);function md(n){return n!==null&&(n<32||n===127)}const w0=Ba(/\d/),dD=Ba(/[\dA-Fa-f]/),pD=Ba(/[!-/:-@[-`{-~]/);function ot(n){return n!==null&&n<-2}function rn(n){return n!==null&&(n<0||n===32)}function At(n){return n===-2||n===-1||n===32}const Ld=Ba(/\p{P}|\p{S}/u),Cs=Ba(/\s/);function Ba(n){return e;function e(t){return t!==null&&t>-1&&n.test(String.fromCharCode(t))}}function eu(n){const e=[];let t=-1,r=0,l=0;for(;++t<n.length;){const s=n.charCodeAt(t);let o="";if(s===37&&fr(n.charCodeAt(t+1))&&fr(n.charCodeAt(t+2)))l=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(o=String.fromCharCode(s));else if(s>55295&&s<57344){const c=n.charCodeAt(t+1);s<56320&&c>56319&&c<57344?(o=String.fromCharCode(s,c),l=1):o=""}else o=String.fromCharCode(s);o&&(e.push(n.slice(r,t),encodeURIComponent(o)),r=t+l+1,o=""),l&&(t+=l,l=0)}return e.join("")+n.slice(r)}function jt(n,e,t,r){const l=r?r-1:Number.POSITIVE_INFINITY;let s=0;return o;function o(h){return At(h)?(n.enter(t),c(h)):e(h)}function c(h){return At(h)&&s++<l?(n.consume(h),c):(n.exit(t),e(h))}}const mD={tokenize:gD};function gD(n){const e=n.attempt(this.parser.constructs.contentInitial,r,l);let t;return e;function r(c){if(c===null){n.consume(c);return}return n.enter("lineEnding"),n.consume(c),n.exit("lineEnding"),jt(n,e,"linePrefix")}function l(c){return n.enter("paragraph"),s(c)}function s(c){const h=n.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=h),t=h,o(c)}function o(c){if(c===null){n.exit("chunkText"),n.exit("paragraph"),n.consume(c);return}return ot(c)?(n.consume(c),n.exit("chunkText"),s):(n.consume(c),o)}}const yD={tokenize:xD},dk={tokenize:vD};function xD(n){const e=this,t=[];let r=0,l,s,o;return c;function c(I){if(r<t.length){const ce=t[r];return e.containerState=ce[1],n.attempt(ce[0].continuation,h,d)(I)}return d(I)}function h(I){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,l&&U();const ce=e.events.length;let F=ce,z;for(;F--;)if(e.events[F][0]==="exit"&&e.events[F][1].type==="chunkFlow"){z=e.events[F][1].end;break}j(r);let ee=ce;for(;ee<e.events.length;)e.events[ee][1].end={...z},ee++;return Kr(e.events,F+1,0,e.events.slice(ce)),e.events.length=ee,d(I)}return c(I)}function d(I){if(r===t.length){if(!l)return b(I);if(l.currentConstruct&&l.currentConstruct.concrete)return T(I);e.interrupt=!!(l.currentConstruct&&!l._gfmTableDynamicInterruptHack)}return e.containerState={},n.check(dk,p,g)(I)}function p(I){return l&&U(),j(r),b(I)}function g(I){return e.parser.lazy[e.now().line]=r!==t.length,o=e.now().offset,T(I)}function b(I){return e.containerState={},n.attempt(dk,w,T)(I)}function w(I){return r++,t.push([e.currentConstruct,e.containerState]),b(I)}function T(I){if(I===null){l&&U(),j(0),n.consume(I);return}return l=l||e.parser.flow(e.now()),n.enter("chunkFlow",{_tokenizer:l,contentType:"flow",previous:s}),N(I)}function N(I){if(I===null){D(n.exit("chunkFlow"),!0),j(0),n.consume(I);return}return ot(I)?(n.consume(I),D(n.exit("chunkFlow")),r=0,e.interrupt=void 0,c):(n.consume(I),N)}function D(I,ce){const F=e.sliceStream(I);if(ce&&F.push(null),I.previous=s,s&&(s.next=I),s=I,l.defineSkip(I.start),l.write(F),e.parser.lazy[I.start.line]){let z=l.events.length;for(;z--;)if(l.events[z][1].start.offset<o&&(!l.events[z][1].end||l.events[z][1].end.offset>o))return;const ee=e.events.length;let ye=ee,Ce,P;for(;ye--;)if(e.events[ye][0]==="exit"&&e.events[ye][1].type==="chunkFlow"){if(Ce){P=e.events[ye][1].end;break}Ce=!0}for(j(r),z=ee;z<e.events.length;)e.events[z][1].end={...P},z++;Kr(e.events,ye+1,0,e.events.slice(ee)),e.events.length=z}}function j(I){let ce=t.length;for(;ce-- >I;){const F=t[ce];e.containerState=F[1],F[0].exit.call(e,n)}t.length=I}function U(){l.write([null]),s=void 0,l=void 0,e.containerState._closeFlow=void 0}}function vD(n,e,t){return jt(n,n.attempt(this.parser.constructs.document,e,t),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Yo(n){if(n===null||rn(n)||Cs(n))return 1;if(Ld(n))return 2}function zd(n,e,t){const r=[];let l=-1;for(;++l<n.length;){const s=n[l].resolveAll;s&&!r.includes(s)&&(e=s(e,t),r.push(s))}return e}const S0={name:"attention",resolveAll:bD,tokenize:kD};function bD(n,e){let t=-1,r,l,s,o,c,h,d,p;for(;++t<n.length;)if(n[t][0]==="enter"&&n[t][1].type==="attentionSequence"&&n[t][1]._close){for(r=t;r--;)if(n[r][0]==="exit"&&n[r][1].type==="attentionSequence"&&n[r][1]._open&&e.sliceSerialize(n[r][1]).charCodeAt(0)===e.sliceSerialize(n[t][1]).charCodeAt(0)){if((n[r][1]._close||n[t][1]._open)&&(n[t][1].end.offset-n[t][1].start.offset)%3&&!((n[r][1].end.offset-n[r][1].start.offset+n[t][1].end.offset-n[t][1].start.offset)%3))continue;h=n[r][1].end.offset-n[r][1].start.offset>1&&n[t][1].end.offset-n[t][1].start.offset>1?2:1;const g={...n[r][1].end},b={...n[t][1].start};pk(g,-h),pk(b,h),o={type:h>1?"strongSequence":"emphasisSequence",start:g,end:{...n[r][1].end}},c={type:h>1?"strongSequence":"emphasisSequence",start:{...n[t][1].start},end:b},s={type:h>1?"strongText":"emphasisText",start:{...n[r][1].end},end:{...n[t][1].start}},l={type:h>1?"strong":"emphasis",start:{...o.start},end:{...c.end}},n[r][1].end={...o.start},n[t][1].start={...c.end},d=[],n[r][1].end.offset-n[r][1].start.offset&&(d=ai(d,[["enter",n[r][1],e],["exit",n[r][1],e]])),d=ai(d,[["enter",l,e],["enter",o,e],["exit",o,e],["enter",s,e]]),d=ai(d,zd(e.parser.constructs.insideSpan.null,n.slice(r+1,t),e)),d=ai(d,[["exit",s,e],["enter",c,e],["exit",c,e],["exit",l,e]]),n[t][1].end.offset-n[t][1].start.offset?(p=2,d=ai(d,[["enter",n[t][1],e],["exit",n[t][1],e]])):p=0,Kr(n,r-1,t-r+3,d),t=r+d.length-p-2;break}}for(t=-1;++t<n.length;)n[t][1].type==="attentionSequence"&&(n[t][1].type="data");return n}function kD(n,e){const t=this.parser.constructs.attentionMarkers.null,r=this.previous,l=Yo(r);let s;return o;function o(h){return s=h,n.enter("attentionSequence"),c(h)}function c(h){if(h===s)return n.consume(h),c;const d=n.exit("attentionSequence"),p=Yo(h),g=!p||p===2&&l||t.includes(h),b=!l||l===2&&p||t.includes(r);return d._open=!!(s===42?g:g&&(l||!b)),d._close=!!(s===42?b:b&&(p||!g)),e(h)}}function pk(n,e){n.column+=e,n.offset+=e,n._bufferIndex+=e}const wD={name:"autolink",tokenize:SD};function SD(n,e,t){let r=0;return l;function l(w){return n.enter("autolink"),n.enter("autolinkMarker"),n.consume(w),n.exit("autolinkMarker"),n.enter("autolinkProtocol"),s}function s(w){return vr(w)?(n.consume(w),o):w===64?t(w):d(w)}function o(w){return w===43||w===45||w===46||fr(w)?(r=1,c(w)):d(w)}function c(w){return w===58?(n.consume(w),r=0,h):(w===43||w===45||w===46||fr(w))&&r++<32?(n.consume(w),c):(r=0,d(w))}function h(w){return w===62?(n.exit("autolinkProtocol"),n.enter("autolinkMarker"),n.consume(w),n.exit("autolinkMarker"),n.exit("autolink"),e):w===null||w===32||w===60||md(w)?t(w):(n.consume(w),h)}function d(w){return w===64?(n.consume(w),p):fD(w)?(n.consume(w),d):t(w)}function p(w){return fr(w)?g(w):t(w)}function g(w){return w===46?(n.consume(w),r=0,p):w===62?(n.exit("autolinkProtocol").type="autolinkEmail",n.enter("autolinkMarker"),n.consume(w),n.exit("autolinkMarker"),n.exit("autolink"),e):b(w)}function b(w){if((w===45||fr(w))&&r++<63){const T=w===45?b:g;return n.consume(w),T}return t(w)}}const Gc={partial:!0,tokenize:CD};function CD(n,e,t){return r;function r(s){return At(s)?jt(n,l,"linePrefix")(s):l(s)}function l(s){return s===null||ot(s)?e(s):t(s)}}const L2={continuation:{tokenize:TD},exit:ED,name:"blockQuote",tokenize:AD};function AD(n,e,t){const r=this;return l;function l(o){if(o===62){const c=r.containerState;return c.open||(n.enter("blockQuote",{_container:!0}),c.open=!0),n.enter("blockQuotePrefix"),n.enter("blockQuoteMarker"),n.consume(o),n.exit("blockQuoteMarker"),s}return t(o)}function s(o){return At(o)?(n.enter("blockQuotePrefixWhitespace"),n.consume(o),n.exit("blockQuotePrefixWhitespace"),n.exit("blockQuotePrefix"),e):(n.exit("blockQuotePrefix"),e(o))}}function TD(n,e,t){const r=this;return l;function l(o){return At(o)?jt(n,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):s(o)}function s(o){return n.attempt(L2,e,t)(o)}}function ED(n){n.exit("blockQuote")}const z2={name:"characterEscape",tokenize:ND};function ND(n,e,t){return r;function r(s){return n.enter("characterEscape"),n.enter("escapeMarker"),n.consume(s),n.exit("escapeMarker"),l}function l(s){return pD(s)?(n.enter("characterEscapeValue"),n.consume(s),n.exit("characterEscapeValue"),n.exit("characterEscape"),e):t(s)}}const I2={name:"characterReference",tokenize:MD};function MD(n,e,t){const r=this;let l=0,s,o;return c;function c(g){return n.enter("characterReference"),n.enter("characterReferenceMarker"),n.consume(g),n.exit("characterReferenceMarker"),h}function h(g){return g===35?(n.enter("characterReferenceMarkerNumeric"),n.consume(g),n.exit("characterReferenceMarkerNumeric"),d):(n.enter("characterReferenceValue"),s=31,o=fr,p(g))}function d(g){return g===88||g===120?(n.enter("characterReferenceMarkerHexadecimal"),n.consume(g),n.exit("characterReferenceMarkerHexadecimal"),n.enter("characterReferenceValue"),s=6,o=dD,p):(n.enter("characterReferenceValue"),s=7,o=w0,p(g))}function p(g){if(g===59&&l){const b=n.exit("characterReferenceValue");return o===fr&&!gy(r.sliceSerialize(b))?t(g):(n.enter("characterReferenceMarker"),n.consume(g),n.exit("characterReferenceMarker"),n.exit("characterReference"),e)}return o(g)&&l++<s?(n.consume(g),p):t(g)}}const mk={partial:!0,tokenize:DD},gk={concrete:!0,name:"codeFenced",tokenize:_D};function _D(n,e,t){const r=this,l={partial:!0,tokenize:F};let s=0,o=0,c;return h;function h(z){return d(z)}function d(z){const ee=r.events[r.events.length-1];return s=ee&&ee[1].type==="linePrefix"?ee[2].sliceSerialize(ee[1],!0).length:0,c=z,n.enter("codeFenced"),n.enter("codeFencedFence"),n.enter("codeFencedFenceSequence"),p(z)}function p(z){return z===c?(o++,n.consume(z),p):o<3?t(z):(n.exit("codeFencedFenceSequence"),At(z)?jt(n,g,"whitespace")(z):g(z))}function g(z){return z===null||ot(z)?(n.exit("codeFencedFence"),r.interrupt?e(z):n.check(mk,N,ce)(z)):(n.enter("codeFencedFenceInfo"),n.enter("chunkString",{contentType:"string"}),b(z))}function b(z){return z===null||ot(z)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),g(z)):At(z)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),jt(n,w,"whitespace")(z)):z===96&&z===c?t(z):(n.consume(z),b)}function w(z){return z===null||ot(z)?g(z):(n.enter("codeFencedFenceMeta"),n.enter("chunkString",{contentType:"string"}),T(z))}function T(z){return z===null||ot(z)?(n.exit("chunkString"),n.exit("codeFencedFenceMeta"),g(z)):z===96&&z===c?t(z):(n.consume(z),T)}function N(z){return n.attempt(l,ce,D)(z)}function D(z){return n.enter("lineEnding"),n.consume(z),n.exit("lineEnding"),j}function j(z){return s>0&&At(z)?jt(n,U,"linePrefix",s+1)(z):U(z)}function U(z){return z===null||ot(z)?n.check(mk,N,ce)(z):(n.enter("codeFlowValue"),I(z))}function I(z){return z===null||ot(z)?(n.exit("codeFlowValue"),U(z)):(n.consume(z),I)}function ce(z){return n.exit("codeFenced"),e(z)}function F(z,ee,ye){let Ce=0;return P;function P(J){return z.enter("lineEnding"),z.consume(J),z.exit("lineEnding"),pe}function pe(J){return z.enter("codeFencedFence"),At(J)?jt(z,fe,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(J):fe(J)}function fe(J){return J===c?(z.enter("codeFencedFenceSequence"),De(J)):ye(J)}function De(J){return J===c?(Ce++,z.consume(J),De):Ce>=o?(z.exit("codeFencedFenceSequence"),At(J)?jt(z,ke,"whitespace")(J):ke(J)):ye(J)}function ke(J){return J===null||ot(J)?(z.exit("codeFencedFence"),ee(J)):ye(J)}}}function DD(n,e,t){const r=this;return l;function l(o){return o===null?t(o):(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),s)}function s(o){return r.parser.lazy[r.now().line]?t(o):e(o)}}const cg={name:"codeIndented",tokenize:OD},jD={partial:!0,tokenize:RD};function OD(n,e,t){const r=this;return l;function l(d){return n.enter("codeIndented"),jt(n,s,"linePrefix",5)(d)}function s(d){const p=r.events[r.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?o(d):t(d)}function o(d){return d===null?h(d):ot(d)?n.attempt(jD,o,h)(d):(n.enter("codeFlowValue"),c(d))}function c(d){return d===null||ot(d)?(n.exit("codeFlowValue"),o(d)):(n.consume(d),c)}function h(d){return n.exit("codeIndented"),e(d)}}function RD(n,e,t){const r=this;return l;function l(o){return r.parser.lazy[r.now().line]?t(o):ot(o)?(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),l):jt(n,s,"linePrefix",5)(o)}function s(o){const c=r.events[r.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?e(o):ot(o)?l(o):t(o)}}const BD={name:"codeText",previous:zD,resolve:LD,tokenize:ID};function LD(n){let e=n.length-4,t=3,r,l;if((n[t][1].type==="lineEnding"||n[t][1].type==="space")&&(n[e][1].type==="lineEnding"||n[e][1].type==="space")){for(r=t;++r<e;)if(n[r][1].type==="codeTextData"){n[t][1].type="codeTextPadding",n[e][1].type="codeTextPadding",t+=2,e-=2;break}}for(r=t-1,e++;++r<=e;)l===void 0?r!==e&&n[r][1].type!=="lineEnding"&&(l=r):(r===e||n[r][1].type==="lineEnding")&&(n[l][1].type="codeTextData",r!==l+2&&(n[l][1].end=n[r-1][1].end,n.splice(l+2,r-l-2),e-=r-l-2,r=l+2),l=void 0);return n}function zD(n){return n!==96||this.events[this.events.length-1][1].type==="characterEscape"}function ID(n,e,t){let r=0,l,s;return o;function o(g){return n.enter("codeText"),n.enter("codeTextSequence"),c(g)}function c(g){return g===96?(n.consume(g),r++,c):(n.exit("codeTextSequence"),h(g))}function h(g){return g===null?t(g):g===32?(n.enter("space"),n.consume(g),n.exit("space"),h):g===96?(s=n.enter("codeTextSequence"),l=0,p(g)):ot(g)?(n.enter("lineEnding"),n.consume(g),n.exit("lineEnding"),h):(n.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||ot(g)?(n.exit("codeTextData"),h(g)):(n.consume(g),d)}function p(g){return g===96?(n.consume(g),l++,p):l===r?(n.exit("codeTextSequence"),n.exit("codeText"),e(g)):(s.type="codeTextData",d(g))}}class PD{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const r=t??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,t,r){const l=t||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-l,Number.POSITIVE_INFINITY);return r&&cc(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),cc(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),cc(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);cc(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);cc(this.left,t.reverse())}}}function cc(n,e){let t=0;if(e.length<1e4)n.push(...e);else for(;t<e.length;)n.push(...e.slice(t,t+1e4)),t+=1e4}function P2(n){const e={};let t=-1,r,l,s,o,c,h,d;const p=new PD(n);for(;++t<p.length;){for(;t in e;)t=e[t];if(r=p.get(t),t&&r[1].type==="chunkFlow"&&p.get(t-1)[1].type==="listItemPrefix"&&(h=r[1]._tokenizer.events,s=0,s<h.length&&h[s][1].type==="lineEndingBlank"&&(s+=2),s<h.length&&h[s][1].type==="content"))for(;++s<h.length&&h[s][1].type!=="content";)h[s][1].type==="chunkText"&&(h[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,HD(p,t)),t=e[t],d=!0);else if(r[1]._container){for(s=t,l=void 0;s--;)if(o=p.get(s),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(l&&(p.get(l)[1].type="lineEndingBlank"),o[1].type="lineEnding",l=s);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;l&&(r[1].end={...p.get(l)[1].start},c=p.slice(l,t),c.unshift(r),p.splice(l,t-l+1,c))}}return Kr(n,0,Number.POSITIVE_INFINITY,p.slice(0)),!d}function HD(n,e){const t=n.get(e)[1],r=n.get(e)[2];let l=e-1;const s=[];let o=t._tokenizer;o||(o=r.parser[t.contentType](t.start),t._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const c=o.events,h=[],d={};let p,g,b=-1,w=t,T=0,N=0;const D=[N];for(;w;){for(;n.get(++l)[1]!==w;);s.push(l),w._tokenizer||(p=r.sliceStream(w),w.next||p.push(null),g&&o.defineSkip(w.start),w._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(p),w._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),g=w,w=w.next}for(w=t;++b<c.length;)c[b][0]==="exit"&&c[b-1][0]==="enter"&&c[b][1].type===c[b-1][1].type&&c[b][1].start.line!==c[b][1].end.line&&(N=b+1,D.push(N),w._tokenizer=void 0,w.previous=void 0,w=w.next);for(o.events=[],w?(w._tokenizer=void 0,w.previous=void 0):D.pop(),b=D.length;b--;){const j=c.slice(D[b],D[b+1]),U=s.pop();h.push([U,U+j.length-1]),n.splice(U,2,j)}for(h.reverse(),b=-1;++b<h.length;)d[T+h[b][0]]=T+h[b][1],T+=h[b][1]-h[b][0]-1;return d}const qD={resolve:FD,tokenize:VD},UD={partial:!0,tokenize:KD};function FD(n){return P2(n),n}function VD(n,e){let t;return r;function r(c){return n.enter("content"),t=n.enter("chunkContent",{contentType:"content"}),l(c)}function l(c){return c===null?s(c):ot(c)?n.check(UD,o,s)(c):(n.consume(c),l)}function s(c){return n.exit("chunkContent"),n.exit("content"),e(c)}function o(c){return n.consume(c),n.exit("chunkContent"),t.next=n.enter("chunkContent",{contentType:"content",previous:t}),t=t.next,l}}function KD(n,e,t){const r=this;return l;function l(o){return n.exit("chunkContent"),n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),jt(n,s,"linePrefix")}function s(o){if(o===null||ot(o))return t(o);const c=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?e(o):n.interrupt(r.parser.constructs.flow,t,e)(o)}}function H2(n,e,t,r,l,s,o,c,h){const d=h||Number.POSITIVE_INFINITY;let p=0;return g;function g(j){return j===60?(n.enter(r),n.enter(l),n.enter(s),n.consume(j),n.exit(s),b):j===null||j===32||j===41||md(j)?t(j):(n.enter(r),n.enter(o),n.enter(c),n.enter("chunkString",{contentType:"string"}),N(j))}function b(j){return j===62?(n.enter(s),n.consume(j),n.exit(s),n.exit(l),n.exit(r),e):(n.enter(c),n.enter("chunkString",{contentType:"string"}),w(j))}function w(j){return j===62?(n.exit("chunkString"),n.exit(c),b(j)):j===null||j===60||ot(j)?t(j):(n.consume(j),j===92?T:w)}function T(j){return j===60||j===62||j===92?(n.consume(j),w):w(j)}function N(j){return!p&&(j===null||j===41||rn(j))?(n.exit("chunkString"),n.exit(c),n.exit(o),n.exit(r),e(j)):p<d&&j===40?(n.consume(j),p++,N):j===41?(n.consume(j),p--,N):j===null||j===32||j===40||md(j)?t(j):(n.consume(j),j===92?D:N)}function D(j){return j===40||j===41||j===92?(n.consume(j),N):N(j)}}function q2(n,e,t,r,l,s){const o=this;let c=0,h;return d;function d(w){return n.enter(r),n.enter(l),n.consume(w),n.exit(l),n.enter(s),p}function p(w){return c>999||w===null||w===91||w===93&&!h||w===94&&!c&&"_hiddenFootnoteSupport"in o.parser.constructs?t(w):w===93?(n.exit(s),n.enter(l),n.consume(w),n.exit(l),n.exit(r),e):ot(w)?(n.enter("lineEnding"),n.consume(w),n.exit("lineEnding"),p):(n.enter("chunkString",{contentType:"string"}),g(w))}function g(w){return w===null||w===91||w===93||ot(w)||c++>999?(n.exit("chunkString"),p(w)):(n.consume(w),h||(h=!At(w)),w===92?b:g)}function b(w){return w===91||w===92||w===93?(n.consume(w),c++,g):g(w)}}function U2(n,e,t,r,l,s){let o;return c;function c(b){return b===34||b===39||b===40?(n.enter(r),n.enter(l),n.consume(b),n.exit(l),o=b===40?41:b,h):t(b)}function h(b){return b===o?(n.enter(l),n.consume(b),n.exit(l),n.exit(r),e):(n.enter(s),d(b))}function d(b){return b===o?(n.exit(s),h(o)):b===null?t(b):ot(b)?(n.enter("lineEnding"),n.consume(b),n.exit("lineEnding"),jt(n,d,"linePrefix")):(n.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===o||b===null||ot(b)?(n.exit("chunkString"),d(b)):(n.consume(b),b===92?g:p)}function g(b){return b===o||b===92?(n.consume(b),p):p(b)}}function Tc(n,e){let t;return r;function r(l){return ot(l)?(n.enter("lineEnding"),n.consume(l),n.exit("lineEnding"),t=!0,r):At(l)?jt(n,r,t?"linePrefix":"lineSuffix")(l):e(l)}}const GD={name:"definition",tokenize:QD},YD={partial:!0,tokenize:XD};function QD(n,e,t){const r=this;let l;return s;function s(w){return n.enter("definition"),o(w)}function o(w){return q2.call(r,n,c,t,"definitionLabel","definitionLabelMarker","definitionLabelString")(w)}function c(w){return l=wi(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),w===58?(n.enter("definitionMarker"),n.consume(w),n.exit("definitionMarker"),h):t(w)}function h(w){return rn(w)?Tc(n,d)(w):d(w)}function d(w){return H2(n,p,t,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(w)}function p(w){return n.attempt(YD,g,g)(w)}function g(w){return At(w)?jt(n,b,"whitespace")(w):b(w)}function b(w){return w===null||ot(w)?(n.exit("definition"),r.parser.defined.push(l),e(w)):t(w)}}function XD(n,e,t){return r;function r(c){return rn(c)?Tc(n,l)(c):t(c)}function l(c){return U2(n,s,t,"definitionTitle","definitionTitleMarker","definitionTitleString")(c)}function s(c){return At(c)?jt(n,o,"whitespace")(c):o(c)}function o(c){return c===null||ot(c)?e(c):t(c)}}const $D={name:"hardBreakEscape",tokenize:WD};function WD(n,e,t){return r;function r(s){return n.enter("hardBreakEscape"),n.consume(s),l}function l(s){return ot(s)?(n.exit("hardBreakEscape"),e(s)):t(s)}}const ZD={name:"headingAtx",resolve:JD,tokenize:ej};function JD(n,e){let t=n.length-2,r=3,l,s;return n[r][1].type==="whitespace"&&(r+=2),t-2>r&&n[t][1].type==="whitespace"&&(t-=2),n[t][1].type==="atxHeadingSequence"&&(r===t-1||t-4>r&&n[t-2][1].type==="whitespace")&&(t-=r+1===t?2:4),t>r&&(l={type:"atxHeadingText",start:n[r][1].start,end:n[t][1].end},s={type:"chunkText",start:n[r][1].start,end:n[t][1].end,contentType:"text"},Kr(n,r,t-r+1,[["enter",l,e],["enter",s,e],["exit",s,e],["exit",l,e]])),n}function ej(n,e,t){let r=0;return l;function l(p){return n.enter("atxHeading"),s(p)}function s(p){return n.enter("atxHeadingSequence"),o(p)}function o(p){return p===35&&r++<6?(n.consume(p),o):p===null||rn(p)?(n.exit("atxHeadingSequence"),c(p)):t(p)}function c(p){return p===35?(n.enter("atxHeadingSequence"),h(p)):p===null||ot(p)?(n.exit("atxHeading"),e(p)):At(p)?jt(n,c,"whitespace")(p):(n.enter("atxHeadingText"),d(p))}function h(p){return p===35?(n.consume(p),h):(n.exit("atxHeadingSequence"),c(p))}function d(p){return p===null||p===35||rn(p)?(n.exit("atxHeadingText"),c(p)):(n.consume(p),d)}}const tj=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],yk=["pre","script","style","textarea"],nj={concrete:!0,name:"htmlFlow",resolveTo:lj,tokenize:aj},rj={partial:!0,tokenize:oj},ij={partial:!0,tokenize:sj};function lj(n){let e=n.length;for(;e--&&!(n[e][0]==="enter"&&n[e][1].type==="htmlFlow"););return e>1&&n[e-2][1].type==="linePrefix"&&(n[e][1].start=n[e-2][1].start,n[e+1][1].start=n[e-2][1].start,n.splice(e-2,2)),n}function aj(n,e,t){const r=this;let l,s,o,c,h;return d;function d(R){return p(R)}function p(R){return n.enter("htmlFlow"),n.enter("htmlFlowData"),n.consume(R),g}function g(R){return R===33?(n.consume(R),b):R===47?(n.consume(R),s=!0,N):R===63?(n.consume(R),l=3,r.interrupt?e:B):vr(R)?(n.consume(R),o=String.fromCharCode(R),D):t(R)}function b(R){return R===45?(n.consume(R),l=2,w):R===91?(n.consume(R),l=5,c=0,T):vr(R)?(n.consume(R),l=4,r.interrupt?e:B):t(R)}function w(R){return R===45?(n.consume(R),r.interrupt?e:B):t(R)}function T(R){const je="CDATA[";return R===je.charCodeAt(c++)?(n.consume(R),c===je.length?r.interrupt?e:fe:T):t(R)}function N(R){return vr(R)?(n.consume(R),o=String.fromCharCode(R),D):t(R)}function D(R){if(R===null||R===47||R===62||rn(R)){const je=R===47,Ee=o.toLowerCase();return!je&&!s&&yk.includes(Ee)?(l=1,r.interrupt?e(R):fe(R)):tj.includes(o.toLowerCase())?(l=6,je?(n.consume(R),j):r.interrupt?e(R):fe(R)):(l=7,r.interrupt&&!r.parser.lazy[r.now().line]?t(R):s?U(R):I(R))}return R===45||fr(R)?(n.consume(R),o+=String.fromCharCode(R),D):t(R)}function j(R){return R===62?(n.consume(R),r.interrupt?e:fe):t(R)}function U(R){return At(R)?(n.consume(R),U):P(R)}function I(R){return R===47?(n.consume(R),P):R===58||R===95||vr(R)?(n.consume(R),ce):At(R)?(n.consume(R),I):P(R)}function ce(R){return R===45||R===46||R===58||R===95||fr(R)?(n.consume(R),ce):F(R)}function F(R){return R===61?(n.consume(R),z):At(R)?(n.consume(R),F):I(R)}function z(R){return R===null||R===60||R===61||R===62||R===96?t(R):R===34||R===39?(n.consume(R),h=R,ee):At(R)?(n.consume(R),z):ye(R)}function ee(R){return R===h?(n.consume(R),h=null,Ce):R===null||ot(R)?t(R):(n.consume(R),ee)}function ye(R){return R===null||R===34||R===39||R===47||R===60||R===61||R===62||R===96||rn(R)?F(R):(n.consume(R),ye)}function Ce(R){return R===47||R===62||At(R)?I(R):t(R)}function P(R){return R===62?(n.consume(R),pe):t(R)}function pe(R){return R===null||ot(R)?fe(R):At(R)?(n.consume(R),pe):t(R)}function fe(R){return R===45&&l===2?(n.consume(R),q):R===60&&l===1?(n.consume(R),le):R===62&&l===4?(n.consume(R),Pe):R===63&&l===3?(n.consume(R),B):R===93&&l===5?(n.consume(R),Se):ot(R)&&(l===6||l===7)?(n.exit("htmlFlowData"),n.check(rj,qe,De)(R)):R===null||ot(R)?(n.exit("htmlFlowData"),De(R)):(n.consume(R),fe)}function De(R){return n.check(ij,ke,qe)(R)}function ke(R){return n.enter("lineEnding"),n.consume(R),n.exit("lineEnding"),J}function J(R){return R===null||ot(R)?De(R):(n.enter("htmlFlowData"),fe(R))}function q(R){return R===45?(n.consume(R),B):fe(R)}function le(R){return R===47?(n.consume(R),o="",Ae):fe(R)}function Ae(R){if(R===62){const je=o.toLowerCase();return yk.includes(je)?(n.consume(R),Pe):fe(R)}return vr(R)&&o.length<8?(n.consume(R),o+=String.fromCharCode(R),Ae):fe(R)}function Se(R){return R===93?(n.consume(R),B):fe(R)}function B(R){return R===62?(n.consume(R),Pe):R===45&&l===2?(n.consume(R),B):fe(R)}function Pe(R){return R===null||ot(R)?(n.exit("htmlFlowData"),qe(R)):(n.consume(R),Pe)}function qe(R){return n.exit("htmlFlow"),e(R)}}function sj(n,e,t){const r=this;return l;function l(o){return ot(o)?(n.enter("lineEnding"),n.consume(o),n.exit("lineEnding"),s):t(o)}function s(o){return r.parser.lazy[r.now().line]?t(o):e(o)}}function oj(n,e,t){return r;function r(l){return n.enter("lineEnding"),n.consume(l),n.exit("lineEnding"),n.attempt(Gc,e,t)}}const uj={name:"htmlText",tokenize:cj};function cj(n,e,t){const r=this;let l,s,o;return c;function c(B){return n.enter("htmlText"),n.enter("htmlTextData"),n.consume(B),h}function h(B){return B===33?(n.consume(B),d):B===47?(n.consume(B),F):B===63?(n.consume(B),I):vr(B)?(n.consume(B),ye):t(B)}function d(B){return B===45?(n.consume(B),p):B===91?(n.consume(B),s=0,T):vr(B)?(n.consume(B),U):t(B)}function p(B){return B===45?(n.consume(B),w):t(B)}function g(B){return B===null?t(B):B===45?(n.consume(B),b):ot(B)?(o=g,le(B)):(n.consume(B),g)}function b(B){return B===45?(n.consume(B),w):g(B)}function w(B){return B===62?q(B):B===45?b(B):g(B)}function T(B){const Pe="CDATA[";return B===Pe.charCodeAt(s++)?(n.consume(B),s===Pe.length?N:T):t(B)}function N(B){return B===null?t(B):B===93?(n.consume(B),D):ot(B)?(o=N,le(B)):(n.consume(B),N)}function D(B){return B===93?(n.consume(B),j):N(B)}function j(B){return B===62?q(B):B===93?(n.consume(B),j):N(B)}function U(B){return B===null||B===62?q(B):ot(B)?(o=U,le(B)):(n.consume(B),U)}function I(B){return B===null?t(B):B===63?(n.consume(B),ce):ot(B)?(o=I,le(B)):(n.consume(B),I)}function ce(B){return B===62?q(B):I(B)}function F(B){return vr(B)?(n.consume(B),z):t(B)}function z(B){return B===45||fr(B)?(n.consume(B),z):ee(B)}function ee(B){return ot(B)?(o=ee,le(B)):At(B)?(n.consume(B),ee):q(B)}function ye(B){return B===45||fr(B)?(n.consume(B),ye):B===47||B===62||rn(B)?Ce(B):t(B)}function Ce(B){return B===47?(n.consume(B),q):B===58||B===95||vr(B)?(n.consume(B),P):ot(B)?(o=Ce,le(B)):At(B)?(n.consume(B),Ce):q(B)}function P(B){return B===45||B===46||B===58||B===95||fr(B)?(n.consume(B),P):pe(B)}function pe(B){return B===61?(n.consume(B),fe):ot(B)?(o=pe,le(B)):At(B)?(n.consume(B),pe):Ce(B)}function fe(B){return B===null||B===60||B===61||B===62||B===96?t(B):B===34||B===39?(n.consume(B),l=B,De):ot(B)?(o=fe,le(B)):At(B)?(n.consume(B),fe):(n.consume(B),ke)}function De(B){return B===l?(n.consume(B),l=void 0,J):B===null?t(B):ot(B)?(o=De,le(B)):(n.consume(B),De)}function ke(B){return B===null||B===34||B===39||B===60||B===61||B===96?t(B):B===47||B===62||rn(B)?Ce(B):(n.consume(B),ke)}function J(B){return B===47||B===62||rn(B)?Ce(B):t(B)}function q(B){return B===62?(n.consume(B),n.exit("htmlTextData"),n.exit("htmlText"),e):t(B)}function le(B){return n.exit("htmlTextData"),n.enter("lineEnding"),n.consume(B),n.exit("lineEnding"),Ae}function Ae(B){return At(B)?jt(n,Se,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(B):Se(B)}function Se(B){return n.enter("htmlTextData"),o(B)}}const yy={name:"labelEnd",resolveAll:pj,resolveTo:mj,tokenize:gj},hj={tokenize:yj},fj={tokenize:xj},dj={tokenize:vj};function pj(n){let e=-1;const t=[];for(;++e<n.length;){const r=n[e][1];if(t.push(n[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const l=r.type==="labelImage"?4:2;r.type="data",e+=l}}return n.length!==t.length&&Kr(n,0,n.length,t),n}function mj(n,e){let t=n.length,r=0,l,s,o,c;for(;t--;)if(l=n[t][1],s){if(l.type==="link"||l.type==="labelLink"&&l._inactive)break;n[t][0]==="enter"&&l.type==="labelLink"&&(l._inactive=!0)}else if(o){if(n[t][0]==="enter"&&(l.type==="labelImage"||l.type==="labelLink")&&!l._balanced&&(s=t,l.type!=="labelLink")){r=2;break}}else l.type==="labelEnd"&&(o=t);const h={type:n[s][1].type==="labelLink"?"link":"image",start:{...n[s][1].start},end:{...n[n.length-1][1].end}},d={type:"label",start:{...n[s][1].start},end:{...n[o][1].end}},p={type:"labelText",start:{...n[s+r+2][1].end},end:{...n[o-2][1].start}};return c=[["enter",h,e],["enter",d,e]],c=ai(c,n.slice(s+1,s+r+3)),c=ai(c,[["enter",p,e]]),c=ai(c,zd(e.parser.constructs.insideSpan.null,n.slice(s+r+4,o-3),e)),c=ai(c,[["exit",p,e],n[o-2],n[o-1],["exit",d,e]]),c=ai(c,n.slice(o+1)),c=ai(c,[["exit",h,e]]),Kr(n,s,n.length,c),n}function gj(n,e,t){const r=this;let l=r.events.length,s,o;for(;l--;)if((r.events[l][1].type==="labelImage"||r.events[l][1].type==="labelLink")&&!r.events[l][1]._balanced){s=r.events[l][1];break}return c;function c(b){return s?s._inactive?g(b):(o=r.parser.defined.includes(wi(r.sliceSerialize({start:s.end,end:r.now()}))),n.enter("labelEnd"),n.enter("labelMarker"),n.consume(b),n.exit("labelMarker"),n.exit("labelEnd"),h):t(b)}function h(b){return b===40?n.attempt(hj,p,o?p:g)(b):b===91?n.attempt(fj,p,o?d:g)(b):o?p(b):g(b)}function d(b){return n.attempt(dj,p,g)(b)}function p(b){return e(b)}function g(b){return s._balanced=!0,t(b)}}function yj(n,e,t){return r;function r(g){return n.enter("resource"),n.enter("resourceMarker"),n.consume(g),n.exit("resourceMarker"),l}function l(g){return rn(g)?Tc(n,s)(g):s(g)}function s(g){return g===41?p(g):H2(n,o,c,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function o(g){return rn(g)?Tc(n,h)(g):p(g)}function c(g){return t(g)}function h(g){return g===34||g===39||g===40?U2(n,d,t,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function d(g){return rn(g)?Tc(n,p)(g):p(g)}function p(g){return g===41?(n.enter("resourceMarker"),n.consume(g),n.exit("resourceMarker"),n.exit("resource"),e):t(g)}}function xj(n,e,t){const r=this;return l;function l(c){return q2.call(r,n,s,o,"reference","referenceMarker","referenceString")(c)}function s(c){return r.parser.defined.includes(wi(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(c):t(c)}function o(c){return t(c)}}function vj(n,e,t){return r;function r(s){return n.enter("reference"),n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),l}function l(s){return s===93?(n.enter("referenceMarker"),n.consume(s),n.exit("referenceMarker"),n.exit("reference"),e):t(s)}}const bj={name:"labelStartImage",resolveAll:yy.resolveAll,tokenize:kj};function kj(n,e,t){const r=this;return l;function l(c){return n.enter("labelImage"),n.enter("labelImageMarker"),n.consume(c),n.exit("labelImageMarker"),s}function s(c){return c===91?(n.enter("labelMarker"),n.consume(c),n.exit("labelMarker"),n.exit("labelImage"),o):t(c)}function o(c){return c===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(c):e(c)}}const wj={name:"labelStartLink",resolveAll:yy.resolveAll,tokenize:Sj};function Sj(n,e,t){const r=this;return l;function l(o){return n.enter("labelLink"),n.enter("labelMarker"),n.consume(o),n.exit("labelMarker"),n.exit("labelLink"),s}function s(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?t(o):e(o)}}const hg={name:"lineEnding",tokenize:Cj};function Cj(n,e){return t;function t(r){return n.enter("lineEnding"),n.consume(r),n.exit("lineEnding"),jt(n,e,"linePrefix")}}const Pf={name:"thematicBreak",tokenize:Aj};function Aj(n,e,t){let r=0,l;return s;function s(d){return n.enter("thematicBreak"),o(d)}function o(d){return l=d,c(d)}function c(d){return d===l?(n.enter("thematicBreakSequence"),h(d)):r>=3&&(d===null||ot(d))?(n.exit("thematicBreak"),e(d)):t(d)}function h(d){return d===l?(n.consume(d),r++,h):(n.exit("thematicBreakSequence"),At(d)?jt(n,c,"whitespace")(d):c(d))}}const Nr={continuation:{tokenize:Mj},exit:Dj,name:"list",tokenize:Nj},Tj={partial:!0,tokenize:jj},Ej={partial:!0,tokenize:_j};function Nj(n,e,t){const r=this,l=r.events[r.events.length-1];let s=l&&l[1].type==="linePrefix"?l[2].sliceSerialize(l[1],!0).length:0,o=0;return c;function c(w){const T=r.containerState.type||(w===42||w===43||w===45?"listUnordered":"listOrdered");if(T==="listUnordered"?!r.containerState.marker||w===r.containerState.marker:w0(w)){if(r.containerState.type||(r.containerState.type=T,n.enter(T,{_container:!0})),T==="listUnordered")return n.enter("listItemPrefix"),w===42||w===45?n.check(Pf,t,d)(w):d(w);if(!r.interrupt||w===49)return n.enter("listItemPrefix"),n.enter("listItemValue"),h(w)}return t(w)}function h(w){return w0(w)&&++o<10?(n.consume(w),h):(!r.interrupt||o<2)&&(r.containerState.marker?w===r.containerState.marker:w===41||w===46)?(n.exit("listItemValue"),d(w)):t(w)}function d(w){return n.enter("listItemMarker"),n.consume(w),n.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||w,n.check(Gc,r.interrupt?t:p,n.attempt(Tj,b,g))}function p(w){return r.containerState.initialBlankLine=!0,s++,b(w)}function g(w){return At(w)?(n.enter("listItemPrefixWhitespace"),n.consume(w),n.exit("listItemPrefixWhitespace"),b):t(w)}function b(w){return r.containerState.size=s+r.sliceSerialize(n.exit("listItemPrefix"),!0).length,e(w)}}function Mj(n,e,t){const r=this;return r.containerState._closeFlow=void 0,n.check(Gc,l,s);function l(c){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,jt(n,e,"listItemIndent",r.containerState.size+1)(c)}function s(c){return r.containerState.furtherBlankLines||!At(c)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(c)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,n.attempt(Ej,e,o)(c))}function o(c){return r.containerState._closeFlow=!0,r.interrupt=void 0,jt(n,n.attempt(Nr,e,t),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(c)}}function _j(n,e,t){const r=this;return jt(n,l,"listItemIndent",r.containerState.size+1);function l(s){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(s):t(s)}}function Dj(n){n.exit(this.containerState.type)}function jj(n,e,t){const r=this;return jt(n,l,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function l(s){const o=r.events[r.events.length-1];return!At(s)&&o&&o[1].type==="listItemPrefixWhitespace"?e(s):t(s)}}const xk={name:"setextUnderline",resolveTo:Oj,tokenize:Rj};function Oj(n,e){let t=n.length,r,l,s;for(;t--;)if(n[t][0]==="enter"){if(n[t][1].type==="content"){r=t;break}n[t][1].type==="paragraph"&&(l=t)}else n[t][1].type==="content"&&n.splice(t,1),!s&&n[t][1].type==="definition"&&(s=t);const o={type:"setextHeading",start:{...n[r][1].start},end:{...n[n.length-1][1].end}};return n[l][1].type="setextHeadingText",s?(n.splice(l,0,["enter",o,e]),n.splice(s+1,0,["exit",n[r][1],e]),n[r][1].end={...n[s][1].end}):n[r][1]=o,n.push(["exit",o,e]),n}function Rj(n,e,t){const r=this;let l;return s;function s(d){let p=r.events.length,g;for(;p--;)if(r.events[p][1].type!=="lineEnding"&&r.events[p][1].type!=="linePrefix"&&r.events[p][1].type!=="content"){g=r.events[p][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||g)?(n.enter("setextHeadingLine"),l=d,o(d)):t(d)}function o(d){return n.enter("setextHeadingLineSequence"),c(d)}function c(d){return d===l?(n.consume(d),c):(n.exit("setextHeadingLineSequence"),At(d)?jt(n,h,"lineSuffix")(d):h(d))}function h(d){return d===null||ot(d)?(n.exit("setextHeadingLine"),e(d)):t(d)}}const Bj={tokenize:Lj};function Lj(n){const e=this,t=n.attempt(Gc,r,n.attempt(this.parser.constructs.flowInitial,l,jt(n,n.attempt(this.parser.constructs.flow,l,n.attempt(qD,l)),"linePrefix")));return t;function r(s){if(s===null){n.consume(s);return}return n.enter("lineEndingBlank"),n.consume(s),n.exit("lineEndingBlank"),e.currentConstruct=void 0,t}function l(s){if(s===null){n.consume(s);return}return n.enter("lineEnding"),n.consume(s),n.exit("lineEnding"),e.currentConstruct=void 0,t}}const zj={resolveAll:V2()},Ij=F2("string"),Pj=F2("text");function F2(n){return{resolveAll:V2(n==="text"?Hj:void 0),tokenize:e};function e(t){const r=this,l=this.parser.constructs[n],s=t.attempt(l,o,c);return o;function o(p){return d(p)?s(p):c(p)}function c(p){if(p===null){t.consume(p);return}return t.enter("data"),t.consume(p),h}function h(p){return d(p)?(t.exit("data"),s(p)):(t.consume(p),h)}function d(p){if(p===null)return!0;const g=l[p];let b=-1;if(g)for(;++b<g.length;){const w=g[b];if(!w.previous||w.previous.call(r,r.previous))return!0}return!1}}}function V2(n){return e;function e(t,r){let l=-1,s;for(;++l<=t.length;)s===void 0?t[l]&&t[l][1].type==="data"&&(s=l,l++):(!t[l]||t[l][1].type!=="data")&&(l!==s+2&&(t[s][1].end=t[l-1][1].end,t.splice(s+2,l-s-2),l=s+2),s=void 0);return n?n(t,r):t}}function Hj(n,e){let t=0;for(;++t<=n.length;)if((t===n.length||n[t][1].type==="lineEnding")&&n[t-1][1].type==="data"){const r=n[t-1][1],l=e.sliceStream(r);let s=l.length,o=-1,c=0,h;for(;s--;){const d=l[s];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)c++,o--;if(o)break;o=-1}else if(d===-2)h=!0,c++;else if(d!==-1){s++;break}}if(e._contentTypeTextTrailing&&t===n.length&&(c=0),c){const d={type:t===n.length||h||c<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?o:r.start._bufferIndex+o,_index:r.start._index+s,line:r.end.line,column:r.end.column-c,offset:r.end.offset-c},end:{...r.end}};r.end={...d.start},r.start.offset===r.end.offset?Object.assign(r,d):(n.splice(t,0,["enter",d,e],["exit",d,e]),t+=2)}t++}return n}const qj={42:Nr,43:Nr,45:Nr,48:Nr,49:Nr,50:Nr,51:Nr,52:Nr,53:Nr,54:Nr,55:Nr,56:Nr,57:Nr,62:L2},Uj={91:GD},Fj={[-2]:cg,[-1]:cg,32:cg},Vj={35:ZD,42:Pf,45:[xk,Pf],60:nj,61:xk,95:Pf,96:gk,126:gk},Kj={38:I2,92:z2},Gj={[-5]:hg,[-4]:hg,[-3]:hg,33:bj,38:I2,42:S0,60:[wD,uj],91:wj,92:[$D,z2],93:yy,95:S0,96:BD},Yj={null:[S0,zj]},Qj={null:[42,95]},Xj={null:[]},$j=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Qj,contentInitial:Uj,disable:Xj,document:qj,flow:Vj,flowInitial:Fj,insideSpan:Yj,string:Kj,text:Gj},Symbol.toStringTag,{value:"Module"}));function Wj(n,e,t){let r={_bufferIndex:-1,_index:0,line:t&&t.line||1,column:t&&t.column||1,offset:t&&t.offset||0};const l={},s=[];let o=[],c=[];const h={attempt:ee(F),check:ee(z),consume:U,enter:I,exit:ce,interrupt:ee(z,{interrupt:!0})},d={code:null,containerState:{},defineSkip:N,events:[],now:T,parser:n,previous:null,sliceSerialize:b,sliceStream:w,write:g};let p=e.tokenize.call(d,h);return e.resolveAll&&s.push(e),d;function g(pe){return o=ai(o,pe),D(),o[o.length-1]!==null?[]:(ye(e,0),d.events=zd(s,d.events,d),d.events)}function b(pe,fe){return Jj(w(pe),fe)}function w(pe){return Zj(o,pe)}function T(){const{_bufferIndex:pe,_index:fe,line:De,column:ke,offset:J}=r;return{_bufferIndex:pe,_index:fe,line:De,column:ke,offset:J}}function N(pe){l[pe.line]=pe.column,P()}function D(){let pe;for(;r._index<o.length;){const fe=o[r._index];if(typeof fe=="string")for(pe=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===pe&&r._bufferIndex<fe.length;)j(fe.charCodeAt(r._bufferIndex));else j(fe)}}function j(pe){p=p(pe)}function U(pe){ot(pe)?(r.line++,r.column=1,r.offset+=pe===-3?2:1,P()):pe!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),d.previous=pe}function I(pe,fe){const De=fe||{};return De.type=pe,De.start=T(),d.events.push(["enter",De,d]),c.push(De),De}function ce(pe){const fe=c.pop();return fe.end=T(),d.events.push(["exit",fe,d]),fe}function F(pe,fe){ye(pe,fe.from)}function z(pe,fe){fe.restore()}function ee(pe,fe){return De;function De(ke,J,q){let le,Ae,Se,B;return Array.isArray(ke)?qe(ke):"tokenize"in ke?qe([ke]):Pe(ke);function Pe(Ke){return $e;function $e(ft){const et=ft!==null&&Ke[ft],ve=ft!==null&&Ke.null,gt=[...Array.isArray(et)?et:et?[et]:[],...Array.isArray(ve)?ve:ve?[ve]:[]];return qe(gt)(ft)}}function qe(Ke){return le=Ke,Ae=0,Ke.length===0?q:R(Ke[Ae])}function R(Ke){return $e;function $e(ft){return B=Ce(),Se=Ke,Ke.partial||(d.currentConstruct=Ke),Ke.name&&d.parser.constructs.disable.null.includes(Ke.name)?Ee():Ke.tokenize.call(fe?Object.assign(Object.create(d),fe):d,h,je,Ee)(ft)}}function je(Ke){return pe(Se,B),J}function Ee(Ke){return B.restore(),++Ae<le.length?R(le[Ae]):q}}}function ye(pe,fe){pe.resolveAll&&!s.includes(pe)&&s.push(pe),pe.resolve&&Kr(d.events,fe,d.events.length-fe,pe.resolve(d.events.slice(fe),d)),pe.resolveTo&&(d.events=pe.resolveTo(d.events,d))}function Ce(){const pe=T(),fe=d.previous,De=d.currentConstruct,ke=d.events.length,J=Array.from(c);return{from:ke,restore:q};function q(){r=pe,d.previous=fe,d.currentConstruct=De,d.events.length=ke,c=J,P()}}function P(){r.line in l&&r.column<2&&(r.column=l[r.line],r.offset+=l[r.line]-1)}}function Zj(n,e){const t=e.start._index,r=e.start._bufferIndex,l=e.end._index,s=e.end._bufferIndex;let o;if(t===l)o=[n[t].slice(r,s)];else{if(o=n.slice(t,l),r>-1){const c=o[0];typeof c=="string"?o[0]=c.slice(r):o.shift()}s>0&&o.push(n[l].slice(0,s))}return o}function Jj(n,e){let t=-1;const r=[];let l;for(;++t<n.length;){const s=n[t];let o;if(typeof s=="string")o=s;else switch(s){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&l)continue;o=" ";break}default:o=String.fromCharCode(s)}l=s===-2,r.push(o)}return r.join("")}function eO(n){const r={constructs:R2([$j,...(n||{}).extensions||[]]),content:l(mD),defined:[],document:l(yD),flow:l(Bj),lazy:{},string:l(Ij),text:l(Pj)};return r;function l(s){return o;function o(c){return Wj(r,s,c)}}}function tO(n){for(;!P2(n););return n}const vk=/[\0\t\n\r]/g;function nO(){let n=1,e="",t=!0,r;return l;function l(s,o,c){const h=[];let d,p,g,b,w;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(o||void 0).decode(s)),g=0,e="",t&&(s.charCodeAt(0)===65279&&g++,t=void 0);g<s.length;){if(vk.lastIndex=g,d=vk.exec(s),b=d&&d.index!==void 0?d.index:s.length,w=s.charCodeAt(b),!d){e=s.slice(g);break}if(w===10&&g===b&&r)h.push(-3),r=void 0;else switch(r&&(h.push(-5),r=void 0),g<b&&(h.push(s.slice(g,b)),n+=b-g),w){case 0:{h.push(65533),n++;break}case 9:{for(p=Math.ceil(n/4)*4,h.push(-2);n++<p;)h.push(-1);break}case 10:{h.push(-4),n=1;break}default:r=!0,n=1}g=b+1}return c&&(r&&h.push(-5),e&&h.push(e),h.push(null)),h}}const rO=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function iO(n){return n.replace(rO,lO)}function lO(n,e,t){if(e)return e;if(t.charCodeAt(0)===35){const l=t.charCodeAt(1),s=l===120||l===88;return B2(t.slice(s?2:1),s?16:10)}return gy(t)||n}const K2={}.hasOwnProperty;function aO(n,e,t){return typeof e!="string"&&(t=e,e=void 0),sO(t)(tO(eO(t).document().write(nO()(n,e,!0))))}function sO(n){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(at),autolinkProtocol:Ce,autolinkEmail:Ce,atxHeading:s(wt),blockQuote:s(ve),characterEscape:Ce,characterReference:Ce,codeFenced:s(gt),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:s(gt,o),codeText:s(nt,o),codeTextData:Ce,data:Ce,codeFlowValue:Ce,definition:s(Gt),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:s(yn),hardBreakEscape:s(dn),hardBreakTrailing:s(dn),htmlFlow:s(Ye,o),htmlFlowData:Ce,htmlText:s(Ye,o),htmlTextData:Ce,image:s(He),label:o,link:s(at),listItem:s(Ge),listItemValue:b,listOrdered:s(be,g),listUnordered:s(be),paragraph:s(zt),reference:R,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:s(wt),strong:s(Jt),thematicBreak:s(vt)},exit:{atxHeading:h(),atxHeadingSequence:F,autolink:h(),autolinkEmail:et,autolinkProtocol:ft,blockQuote:h(),characterEscapeValue:P,characterReferenceMarkerHexadecimal:Ee,characterReferenceMarkerNumeric:Ee,characterReferenceValue:Ke,characterReference:$e,codeFenced:h(D),codeFencedFence:N,codeFencedFenceInfo:w,codeFencedFenceMeta:T,codeFlowValue:P,codeIndented:h(j),codeText:h(J),codeTextData:P,data:P,definition:h(),definitionDestinationString:ce,definitionLabelString:U,definitionTitleString:I,emphasis:h(),hardBreakEscape:h(fe),hardBreakTrailing:h(fe),htmlFlow:h(De),htmlFlowData:P,htmlText:h(ke),htmlTextData:P,image:h(le),label:Se,labelText:Ae,lineEnding:pe,link:h(q),listItem:h(),listOrdered:h(),listUnordered:h(),paragraph:h(),referenceString:je,resourceDestinationString:B,resourceTitleString:Pe,resource:qe,setextHeading:h(ye),setextHeadingLineSequence:ee,setextHeadingText:z,strong:h(),thematicBreak:h()}};G2(e,(n||{}).mdastExtensions||[]);const t={};return r;function r(ue){let Ne={type:"root",children:[]};const rt={stack:[Ne],tokenStack:[],config:e,enter:c,exit:d,buffer:o,resume:p,data:t},pt=[];let Dt=-1;for(;++Dt<ue.length;)if(ue[Dt][1].type==="listOrdered"||ue[Dt][1].type==="listUnordered")if(ue[Dt][0]==="enter")pt.push(Dt);else{const Fn=pt.pop();Dt=l(ue,Fn,Dt)}for(Dt=-1;++Dt<ue.length;){const Fn=e[ue[Dt][0]];K2.call(Fn,ue[Dt][1].type)&&Fn[ue[Dt][1].type].call(Object.assign({sliceSerialize:ue[Dt][2].sliceSerialize},rt),ue[Dt][1])}if(rt.tokenStack.length>0){const Fn=rt.tokenStack[rt.tokenStack.length-1];(Fn[1]||bk).call(rt,void 0,Fn[0])}for(Ne.position={start:xa(ue.length>0?ue[0][1].start:{line:1,column:1,offset:0}),end:xa(ue.length>0?ue[ue.length-2][1].end:{line:1,column:1,offset:0})},Dt=-1;++Dt<e.transforms.length;)Ne=e.transforms[Dt](Ne)||Ne;return Ne}function l(ue,Ne,rt){let pt=Ne-1,Dt=-1,Fn=!1,Qn,Mn,mn,gn;for(;++pt<=rt;){const Le=ue[pt];switch(Le[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Le[0]==="enter"?Dt++:Dt--,gn=void 0;break}case"lineEndingBlank":{Le[0]==="enter"&&(Qn&&!gn&&!Dt&&!mn&&(mn=pt),gn=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:gn=void 0}if(!Dt&&Le[0]==="enter"&&Le[1].type==="listItemPrefix"||Dt===-1&&Le[0]==="exit"&&(Le[1].type==="listUnordered"||Le[1].type==="listOrdered")){if(Qn){let kr=pt;for(Mn=void 0;kr--;){const In=ue[kr];if(In[1].type==="lineEnding"||In[1].type==="lineEndingBlank"){if(In[0]==="exit")continue;Mn&&(ue[Mn][1].type="lineEndingBlank",Fn=!0),In[1].type="lineEnding",Mn=kr}else if(!(In[1].type==="linePrefix"||In[1].type==="blockQuotePrefix"||In[1].type==="blockQuotePrefixWhitespace"||In[1].type==="blockQuoteMarker"||In[1].type==="listItemIndent"))break}mn&&(!Mn||mn<Mn)&&(Qn._spread=!0),Qn.end=Object.assign({},Mn?ue[Mn][1].start:Le[1].end),ue.splice(Mn||pt,0,["exit",Qn,Le[2]]),pt++,rt++}if(Le[1].type==="listItemPrefix"){const kr={type:"listItem",_spread:!1,start:Object.assign({},Le[1].start),end:void 0};Qn=kr,ue.splice(pt,0,["enter",kr,Le[2]]),pt++,rt++,mn=void 0,gn=!0}}}return ue[Ne][1]._spread=Fn,rt}function s(ue,Ne){return rt;function rt(pt){c.call(this,ue(pt),pt),Ne&&Ne.call(this,pt)}}function o(){this.stack.push({type:"fragment",children:[]})}function c(ue,Ne,rt){this.stack[this.stack.length-1].children.push(ue),this.stack.push(ue),this.tokenStack.push([Ne,rt||void 0]),ue.position={start:xa(Ne.start),end:void 0}}function h(ue){return Ne;function Ne(rt){ue&&ue.call(this,rt),d.call(this,rt)}}function d(ue,Ne){const rt=this.stack.pop(),pt=this.tokenStack.pop();if(pt)pt[0].type!==ue.type&&(Ne?Ne.call(this,ue,pt[0]):(pt[1]||bk).call(this,ue,pt[0]));else throw new Error("Cannot close `"+ue.type+"` ("+Ac({start:ue.start,end:ue.end})+"): its not open");rt.position.end=xa(ue.end)}function p(){return my(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function b(ue){if(this.data.expectingFirstListItemValue){const Ne=this.stack[this.stack.length-2];Ne.start=Number.parseInt(this.sliceSerialize(ue),10),this.data.expectingFirstListItemValue=void 0}}function w(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.lang=ue}function T(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.meta=ue}function N(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function D(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.value=ue.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function j(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.value=ue.replace(/(\r?\n|\r)$/g,"")}function U(ue){const Ne=this.resume(),rt=this.stack[this.stack.length-1];rt.label=Ne,rt.identifier=wi(this.sliceSerialize(ue)).toLowerCase()}function I(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.title=ue}function ce(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.url=ue}function F(ue){const Ne=this.stack[this.stack.length-1];if(!Ne.depth){const rt=this.sliceSerialize(ue).length;Ne.depth=rt}}function z(){this.data.setextHeadingSlurpLineEnding=!0}function ee(ue){const Ne=this.stack[this.stack.length-1];Ne.depth=this.sliceSerialize(ue).codePointAt(0)===61?1:2}function ye(){this.data.setextHeadingSlurpLineEnding=void 0}function Ce(ue){const rt=this.stack[this.stack.length-1].children;let pt=rt[rt.length-1];(!pt||pt.type!=="text")&&(pt=Yt(),pt.position={start:xa(ue.start),end:void 0},rt.push(pt)),this.stack.push(pt)}function P(ue){const Ne=this.stack.pop();Ne.value+=this.sliceSerialize(ue),Ne.position.end=xa(ue.end)}function pe(ue){const Ne=this.stack[this.stack.length-1];if(this.data.atHardBreak){const rt=Ne.children[Ne.children.length-1];rt.position.end=xa(ue.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(Ne.type)&&(Ce.call(this,ue),P.call(this,ue))}function fe(){this.data.atHardBreak=!0}function De(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.value=ue}function ke(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.value=ue}function J(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.value=ue}function q(){const ue=this.stack[this.stack.length-1];if(this.data.inReference){const Ne=this.data.referenceType||"shortcut";ue.type+="Reference",ue.referenceType=Ne,delete ue.url,delete ue.title}else delete ue.identifier,delete ue.label;this.data.referenceType=void 0}function le(){const ue=this.stack[this.stack.length-1];if(this.data.inReference){const Ne=this.data.referenceType||"shortcut";ue.type+="Reference",ue.referenceType=Ne,delete ue.url,delete ue.title}else delete ue.identifier,delete ue.label;this.data.referenceType=void 0}function Ae(ue){const Ne=this.sliceSerialize(ue),rt=this.stack[this.stack.length-2];rt.label=iO(Ne),rt.identifier=wi(Ne).toLowerCase()}function Se(){const ue=this.stack[this.stack.length-1],Ne=this.resume(),rt=this.stack[this.stack.length-1];if(this.data.inReference=!0,rt.type==="link"){const pt=ue.children;rt.children=pt}else rt.alt=Ne}function B(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.url=ue}function Pe(){const ue=this.resume(),Ne=this.stack[this.stack.length-1];Ne.title=ue}function qe(){this.data.inReference=void 0}function R(){this.data.referenceType="collapsed"}function je(ue){const Ne=this.resume(),rt=this.stack[this.stack.length-1];rt.label=Ne,rt.identifier=wi(this.sliceSerialize(ue)).toLowerCase(),this.data.referenceType="full"}function Ee(ue){this.data.characterReferenceType=ue.type}function Ke(ue){const Ne=this.sliceSerialize(ue),rt=this.data.characterReferenceType;let pt;rt?(pt=B2(Ne,rt==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):pt=gy(Ne);const Dt=this.stack[this.stack.length-1];Dt.value+=pt}function $e(ue){const Ne=this.stack.pop();Ne.position.end=xa(ue.end)}function ft(ue){P.call(this,ue);const Ne=this.stack[this.stack.length-1];Ne.url=this.sliceSerialize(ue)}function et(ue){P.call(this,ue);const Ne=this.stack[this.stack.length-1];Ne.url="mailto:"+this.sliceSerialize(ue)}function ve(){return{type:"blockquote",children:[]}}function gt(){return{type:"code",lang:null,meta:null,value:""}}function nt(){return{type:"inlineCode",value:""}}function Gt(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function yn(){return{type:"emphasis",children:[]}}function wt(){return{type:"heading",depth:0,children:[]}}function dn(){return{type:"break"}}function Ye(){return{type:"html",value:""}}function He(){return{type:"image",title:null,url:"",alt:null}}function at(){return{type:"link",title:null,url:"",children:[]}}function be(ue){return{type:"list",ordered:ue.type==="listOrdered",start:null,spread:ue._spread,children:[]}}function Ge(ue){return{type:"listItem",spread:ue._spread,checked:null,children:[]}}function zt(){return{type:"paragraph",children:[]}}function Jt(){return{type:"strong",children:[]}}function Yt(){return{type:"text",value:""}}function vt(){return{type:"thematicBreak"}}}function xa(n){return{line:n.line,column:n.column,offset:n.offset}}function G2(n,e){let t=-1;for(;++t<e.length;){const r=e[t];Array.isArray(r)?G2(n,r):oO(n,r)}}function oO(n,e){let t;for(t in e)if(K2.call(e,t))switch(t){case"canContainEols":{const r=e[t];r&&n[t].push(...r);break}case"transforms":{const r=e[t];r&&n[t].push(...r);break}case"enter":case"exit":{const r=e[t];r&&Object.assign(n[t],r);break}}}function bk(n,e){throw n?new Error("Cannot close `"+n.type+"` ("+Ac({start:n.start,end:n.end})+"): a different token (`"+e.type+"`, "+Ac({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Ac({start:e.start,end:e.end})+") is still open")}function uO(n){const e=this;e.parser=t;function t(r){return aO(r,{...e.data("settings"),...n,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function cO(n,e){const t={type:"element",tagName:"blockquote",properties:{},children:n.wrap(n.all(e),!0)};return n.patch(e,t),n.applyData(e,t)}function hO(n,e){const t={type:"element",tagName:"br",properties:{},children:[]};return n.patch(e,t),[n.applyData(e,t),{type:"text",value:`
`}]}function fO(n,e){const t=e.value?e.value+`
`:"",r={},l=e.lang?e.lang.split(/\s+/):[];l.length>0&&(r.className=["language-"+l[0]]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:t}]};return e.meta&&(s.data={meta:e.meta}),n.patch(e,s),s=n.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},n.patch(e,s),s}function dO(n,e){const t={type:"element",tagName:"del",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function pO(n,e){const t={type:"element",tagName:"em",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function mO(n,e){const t=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),l=eu(r.toLowerCase()),s=n.footnoteOrder.indexOf(r);let o,c=n.footnoteCounts.get(r);c===void 0?(c=0,n.footnoteOrder.push(r),o=n.footnoteOrder.length):o=s+1,c+=1,n.footnoteCounts.set(r,c);const h={type:"element",tagName:"a",properties:{href:"#"+t+"fn-"+l,id:t+"fnref-"+l+(c>1?"-"+c:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};n.patch(e,h);const d={type:"element",tagName:"sup",properties:{},children:[h]};return n.patch(e,d),n.applyData(e,d)}function gO(n,e){const t={type:"element",tagName:"h"+e.depth,properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function yO(n,e){if(n.options.allowDangerousHtml){const t={type:"raw",value:e.value};return n.patch(e,t),n.applyData(e,t)}}function Y2(n,e){const t=e.referenceType;let r="]";if(t==="collapsed"?r+="[]":t==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const l=n.all(e),s=l[0];s&&s.type==="text"?s.value="["+s.value:l.unshift({type:"text",value:"["});const o=l[l.length-1];return o&&o.type==="text"?o.value+=r:l.push({type:"text",value:r}),l}function xO(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return Y2(n,e);const l={src:eu(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(l.title=r.title);const s={type:"element",tagName:"img",properties:l,children:[]};return n.patch(e,s),n.applyData(e,s)}function vO(n,e){const t={src:eu(e.url)};e.alt!==null&&e.alt!==void 0&&(t.alt=e.alt),e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"img",properties:t,children:[]};return n.patch(e,r),n.applyData(e,r)}function bO(n,e){const t={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};n.patch(e,t);const r={type:"element",tagName:"code",properties:{},children:[t]};return n.patch(e,r),n.applyData(e,r)}function kO(n,e){const t=String(e.identifier).toUpperCase(),r=n.definitionById.get(t);if(!r)return Y2(n,e);const l={href:eu(r.url||"")};r.title!==null&&r.title!==void 0&&(l.title=r.title);const s={type:"element",tagName:"a",properties:l,children:n.all(e)};return n.patch(e,s),n.applyData(e,s)}function wO(n,e){const t={href:eu(e.url)};e.title!==null&&e.title!==void 0&&(t.title=e.title);const r={type:"element",tagName:"a",properties:t,children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function SO(n,e,t){const r=n.all(e),l=t?CO(t):Q2(e),s={},o=[];if(typeof e.checked=="boolean"){const p=r[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},r.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let c=-1;for(;++c<r.length;){const p=r[c];(l||c!==0||p.type!=="element"||p.tagName!=="p")&&o.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!l?o.push(...p.children):o.push(p)}const h=r[r.length-1];h&&(l||h.type!=="element"||h.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:s,children:o};return n.patch(e,d),n.applyData(e,d)}function CO(n){let e=!1;if(n.type==="list"){e=n.spread||!1;const t=n.children;let r=-1;for(;!e&&++r<t.length;)e=Q2(t[r])}return e}function Q2(n){const e=n.spread;return e??n.children.length>1}function AO(n,e){const t={},r=n.all(e);let l=-1;for(typeof e.start=="number"&&e.start!==1&&(t.start=e.start);++l<r.length;){const o=r[l];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){t.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:t,children:n.wrap(r,!0)};return n.patch(e,s),n.applyData(e,s)}function TO(n,e){const t={type:"element",tagName:"p",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function EO(n,e){const t={type:"root",children:n.wrap(n.all(e))};return n.patch(e,t),n.applyData(e,t)}function NO(n,e){const t={type:"element",tagName:"strong",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}function MO(n,e){const t=n.all(e),r=t.shift(),l=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:n.wrap([r],!0)};n.patch(e.children[0],o),l.push(o)}if(t.length>0){const o={type:"element",tagName:"tbody",properties:{},children:n.wrap(t,!0)},c=hy(e.children[1]),h=E2(e.children[e.children.length-1]);c&&h&&(o.position={start:c,end:h}),l.push(o)}const s={type:"element",tagName:"table",properties:{},children:n.wrap(l,!0)};return n.patch(e,s),n.applyData(e,s)}function _O(n,e,t){const r=t?t.children:void 0,s=(r?r.indexOf(e):1)===0?"th":"td",o=t&&t.type==="table"?t.align:void 0,c=o?o.length:e.children.length;let h=-1;const d=[];for(;++h<c;){const g=e.children[h],b={},w=o?o[h]:void 0;w&&(b.align=w);let T={type:"element",tagName:s,properties:b,children:[]};g&&(T.children=n.all(g),n.patch(g,T),T=n.applyData(g,T)),d.push(T)}const p={type:"element",tagName:"tr",properties:{},children:n.wrap(d,!0)};return n.patch(e,p),n.applyData(e,p)}function DO(n,e){const t={type:"element",tagName:"td",properties:{},children:n.all(e)};return n.patch(e,t),n.applyData(e,t)}const kk=9,wk=32;function jO(n){const e=String(n),t=/\r?\n|\r/g;let r=t.exec(e),l=0;const s=[];for(;r;)s.push(Sk(e.slice(l,r.index),l>0,!0),r[0]),l=r.index+r[0].length,r=t.exec(e);return s.push(Sk(e.slice(l),l>0,!1)),s.join("")}function Sk(n,e,t){let r=0,l=n.length;if(e){let s=n.codePointAt(r);for(;s===kk||s===wk;)r++,s=n.codePointAt(r)}if(t){let s=n.codePointAt(l-1);for(;s===kk||s===wk;)l--,s=n.codePointAt(l-1)}return l>r?n.slice(r,l):""}function OO(n,e){const t={type:"text",value:jO(String(e.value))};return n.patch(e,t),n.applyData(e,t)}function RO(n,e){const t={type:"element",tagName:"hr",properties:{},children:[]};return n.patch(e,t),n.applyData(e,t)}const BO={blockquote:cO,break:hO,code:fO,delete:dO,emphasis:pO,footnoteReference:mO,heading:gO,html:yO,imageReference:xO,image:vO,inlineCode:bO,linkReference:kO,link:wO,listItem:SO,list:AO,paragraph:TO,root:EO,strong:NO,table:MO,tableCell:DO,tableRow:_O,text:OO,thematicBreak:RO,toml:Ef,yaml:Ef,definition:Ef,footnoteDefinition:Ef};function Ef(){}const X2=-1,Id=0,Ec=1,gd=2,xy=3,vy=4,by=5,ky=6,$2=7,W2=8,Ck=typeof self=="object"?self:globalThis,LO=(n,e)=>{const t=(l,s)=>(n.set(s,l),l),r=l=>{if(n.has(l))return n.get(l);const[s,o]=e[l];switch(s){case Id:case X2:return t(o,l);case Ec:{const c=t([],l);for(const h of o)c.push(r(h));return c}case gd:{const c=t({},l);for(const[h,d]of o)c[r(h)]=r(d);return c}case xy:return t(new Date(o),l);case vy:{const{source:c,flags:h}=o;return t(new RegExp(c,h),l)}case by:{const c=t(new Map,l);for(const[h,d]of o)c.set(r(h),r(d));return c}case ky:{const c=t(new Set,l);for(const h of o)c.add(r(h));return c}case $2:{const{name:c,message:h}=o;return t(new Ck[c](h),l)}case W2:return t(BigInt(o),l);case"BigInt":return t(Object(BigInt(o)),l);case"ArrayBuffer":return t(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:c}=new Uint8Array(o);return t(new DataView(c),o)}}return t(new Ck[s](o),l)};return r},Ak=n=>LO(new Map,n)(0),bo="",{toString:zO}={},{keys:IO}=Object,hc=n=>{const e=typeof n;if(e!=="object"||!n)return[Id,e];const t=zO.call(n).slice(8,-1);switch(t){case"Array":return[Ec,bo];case"Object":return[gd,bo];case"Date":return[xy,bo];case"RegExp":return[vy,bo];case"Map":return[by,bo];case"Set":return[ky,bo];case"DataView":return[Ec,t]}return t.includes("Array")?[Ec,t]:t.includes("Error")?[$2,t]:[gd,t]},Nf=([n,e])=>n===Id&&(e==="function"||e==="symbol"),PO=(n,e,t,r)=>{const l=(o,c)=>{const h=r.push(o)-1;return t.set(c,h),h},s=o=>{if(t.has(o))return t.get(o);let[c,h]=hc(o);switch(c){case Id:{let p=o;switch(h){case"bigint":c=W2,p=o.toString();break;case"function":case"symbol":if(n)throw new TypeError("unable to serialize "+h);p=null;break;case"undefined":return l([X2],o)}return l([c,p],o)}case Ec:{if(h){let b=o;return h==="DataView"?b=new Uint8Array(o.buffer):h==="ArrayBuffer"&&(b=new Uint8Array(o)),l([h,[...b]],o)}const p=[],g=l([c,p],o);for(const b of o)p.push(s(b));return g}case gd:{if(h)switch(h){case"BigInt":return l([h,o.toString()],o);case"Boolean":case"Number":case"String":return l([h,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const p=[],g=l([c,p],o);for(const b of IO(o))(n||!Nf(hc(o[b])))&&p.push([s(b),s(o[b])]);return g}case xy:return l([c,o.toISOString()],o);case vy:{const{source:p,flags:g}=o;return l([c,{source:p,flags:g}],o)}case by:{const p=[],g=l([c,p],o);for(const[b,w]of o)(n||!(Nf(hc(b))||Nf(hc(w))))&&p.push([s(b),s(w)]);return g}case ky:{const p=[],g=l([c,p],o);for(const b of o)(n||!Nf(hc(b)))&&p.push(s(b));return g}}const{message:d}=o;return l([c,{name:h,message:d}],o)};return s},Tk=(n,{json:e,lossy:t}={})=>{const r=[];return PO(!(e||t),!!e,new Map,r)(n),r},yd=typeof structuredClone=="function"?(n,e)=>e&&("json"in e||"lossy"in e)?Ak(Tk(n,e)):structuredClone(n):(n,e)=>Ak(Tk(n,e));function HO(n,e){const t=[{type:"text",value:""}];return e>1&&t.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),t}function qO(n,e){return"Back to reference "+(n+1)+(e>1?"-"+e:"")}function UO(n){const e=typeof n.options.clobberPrefix=="string"?n.options.clobberPrefix:"user-content-",t=n.options.footnoteBackContent||HO,r=n.options.footnoteBackLabel||qO,l=n.options.footnoteLabel||"Footnotes",s=n.options.footnoteLabelTagName||"h2",o=n.options.footnoteLabelProperties||{className:["sr-only"]},c=[];let h=-1;for(;++h<n.footnoteOrder.length;){const d=n.footnoteById.get(n.footnoteOrder[h]);if(!d)continue;const p=n.all(d),g=String(d.identifier).toUpperCase(),b=eu(g.toLowerCase());let w=0;const T=[],N=n.footnoteCounts.get(g);for(;N!==void 0&&++w<=N;){T.length>0&&T.push({type:"text",value:" "});let U=typeof t=="string"?t:t(h,w);typeof U=="string"&&(U={type:"text",value:U}),T.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+b+(w>1?"-"+w:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(h,w),className:["data-footnote-backref"]},children:Array.isArray(U)?U:[U]})}const D=p[p.length-1];if(D&&D.type==="element"&&D.tagName==="p"){const U=D.children[D.children.length-1];U&&U.type==="text"?U.value+=" ":D.children.push({type:"text",value:" "}),D.children.push(...T)}else p.push(...T);const j={type:"element",tagName:"li",properties:{id:e+"fn-"+b},children:n.wrap(p,!0)};n.patch(d,j),c.push(j)}if(c.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...yd(o),id:"footnote-label"},children:[{type:"text",value:l}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:n.wrap(c,!0)},{type:"text",value:`
`}]}}const Pd=(function(n){if(n==null)return GO;if(typeof n=="function")return Hd(n);if(typeof n=="object")return Array.isArray(n)?FO(n):VO(n);if(typeof n=="string")return KO(n);throw new Error("Expected function, string, or object as test")});function FO(n){const e=[];let t=-1;for(;++t<n.length;)e[t]=Pd(n[t]);return Hd(r);function r(...l){let s=-1;for(;++s<e.length;)if(e[s].apply(this,l))return!0;return!1}}function VO(n){const e=n;return Hd(t);function t(r){const l=r;let s;for(s in n)if(l[s]!==e[s])return!1;return!0}}function KO(n){return Hd(e);function e(t){return t&&t.type===n}}function Hd(n){return e;function e(t,r,l){return!!(YO(t)&&n.call(this,t,typeof r=="number"?r:void 0,l||void 0))}}function GO(){return!0}function YO(n){return n!==null&&typeof n=="object"&&"type"in n}const Z2=[],QO=!0,C0=!1,XO="skip";function J2(n,e,t,r){let l;typeof e=="function"&&typeof t!="function"?(r=t,t=e):l=e;const s=Pd(l),o=r?-1:1;c(n,void 0,[])();function c(h,d,p){const g=h&&typeof h=="object"?h:{};if(typeof g.type=="string"){const w=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(b,"name",{value:"node ("+(h.type+(w?"<"+w+">":""))+")"})}return b;function b(){let w=Z2,T,N,D;if((!e||s(h,d,p[p.length-1]||void 0))&&(w=$O(t(h,p)),w[0]===C0))return w;if("children"in h&&h.children){const j=h;if(j.children&&w[0]!==XO)for(N=(r?j.children.length:-1)+o,D=p.concat(j);N>-1&&N<j.children.length;){const U=j.children[N];if(T=c(U,N,D)(),T[0]===C0)return T;N=typeof T[1]=="number"?T[1]:N+o}}return w}}}function $O(n){return Array.isArray(n)?n:typeof n=="number"?[QO,n]:n==null?Z2:[n]}function wy(n,e,t,r){let l,s,o;typeof e=="function"&&typeof t!="function"?(s=void 0,o=e,l=t):(s=e,o=t,l=r),J2(n,s,c,l);function c(h,d){const p=d[d.length-1],g=p?p.children.indexOf(h):void 0;return o(h,g,p)}}const A0={}.hasOwnProperty,WO={};function ZO(n,e){const t=e||WO,r=new Map,l=new Map,s=new Map,o={...BO,...t.handlers},c={all:d,applyData:e6,definitionById:r,footnoteById:l,footnoteCounts:s,footnoteOrder:[],handlers:o,one:h,options:t,patch:JO,wrap:n6};return wy(n,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?r:l,b=String(p.identifier).toUpperCase();g.has(b)||g.set(b,p)}}),c;function h(p,g){const b=p.type,w=c.handlers[b];if(A0.call(c.handlers,b)&&w)return w(c,p,g);if(c.options.passThrough&&c.options.passThrough.includes(b)){if("children"in p){const{children:N,...D}=p,j=yd(D);return j.children=c.all(p),j}return yd(p)}return(c.options.unknownHandler||t6)(c,p,g)}function d(p){const g=[];if("children"in p){const b=p.children;let w=-1;for(;++w<b.length;){const T=c.one(b[w],p);if(T){if(w&&b[w-1].type==="break"&&(!Array.isArray(T)&&T.type==="text"&&(T.value=Ek(T.value)),!Array.isArray(T)&&T.type==="element")){const N=T.children[0];N&&N.type==="text"&&(N.value=Ek(N.value))}Array.isArray(T)?g.push(...T):g.push(T)}}}return g}}function JO(n,e){n.position&&(e.position=q_(n))}function e6(n,e){let t=e;if(n&&n.data){const r=n.data.hName,l=n.data.hChildren,s=n.data.hProperties;if(typeof r=="string")if(t.type==="element")t.tagName=r;else{const o="children"in t?t.children:[t];t={type:"element",tagName:r,properties:{},children:o}}t.type==="element"&&s&&Object.assign(t.properties,yd(s)),"children"in t&&t.children&&l!==null&&l!==void 0&&(t.children=l)}return t}function t6(n,e){const t=e.data||{},r="value"in e&&!(A0.call(t,"hProperties")||A0.call(t,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:n.all(e)};return n.patch(e,r),n.applyData(e,r)}function n6(n,e){const t=[];let r=-1;for(e&&t.push({type:"text",value:`
`});++r<n.length;)r&&t.push({type:"text",value:`
`}),t.push(n[r]);return e&&n.length>0&&t.push({type:"text",value:`
`}),t}function Ek(n){let e=0,t=n.charCodeAt(e);for(;t===9||t===32;)e++,t=n.charCodeAt(e);return n.slice(e)}function Nk(n,e){const t=ZO(n,e),r=t.one(n,void 0),l=UO(t),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return l&&s.children.push({type:"text",value:`
`},l),s}function r6(n,e){return n&&"run"in n?async function(t,r){const l=Nk(t,{file:r,...e});await n.run(l,r)}:function(t,r){return Nk(t,{file:r,...n||e})}}function Mk(n){if(n)throw n}var fg,_k;function i6(){if(_k)return fg;_k=1;var n=Object.prototype.hasOwnProperty,e=Object.prototype.toString,t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,l=function(d){return typeof Array.isArray=="function"?Array.isArray(d):e.call(d)==="[object Array]"},s=function(d){if(!d||e.call(d)!=="[object Object]")return!1;var p=n.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&n.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!p&&!g)return!1;var b;for(b in d);return typeof b>"u"||n.call(d,b)},o=function(d,p){t&&p.name==="__proto__"?t(d,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):d[p.name]=p.newValue},c=function(d,p){if(p==="__proto__")if(n.call(d,p)){if(r)return r(d,p).value}else return;return d[p]};return fg=function h(){var d,p,g,b,w,T,N=arguments[0],D=1,j=arguments.length,U=!1;for(typeof N=="boolean"&&(U=N,N=arguments[1]||{},D=2),(N==null||typeof N!="object"&&typeof N!="function")&&(N={});D<j;++D)if(d=arguments[D],d!=null)for(p in d)g=c(N,p),b=c(d,p),N!==b&&(U&&b&&(s(b)||(w=l(b)))?(w?(w=!1,T=g&&l(g)?g:[]):T=g&&s(g)?g:{},o(N,{name:p,newValue:h(U,T,b)})):typeof b<"u"&&o(N,{name:p,newValue:b}));return N},fg}var l6=i6();const dg=vd(l6);function T0(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)}function a6(){const n=[],e={run:t,use:r};return e;function t(...l){let s=-1;const o=l.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);c(null,...l);function c(h,...d){const p=n[++s];let g=-1;if(h){o(h);return}for(;++g<l.length;)(d[g]===null||d[g]===void 0)&&(d[g]=l[g]);l=d,p?s6(p,c)(...d):o(null,...d)}}function r(l){if(typeof l!="function")throw new TypeError("Expected `middelware` to be a function, not "+l);return n.push(l),e}}function s6(n,e){let t;return r;function r(...o){const c=n.length>o.length;let h;c&&o.push(l);try{h=n.apply(this,o)}catch(d){const p=d;if(c&&t)throw p;return l(p)}c||(h&&h.then&&typeof h.then=="function"?h.then(s,l):h instanceof Error?l(h):s(h))}function l(o,...c){t||(t=!0,e(o,...c))}function s(o){l(null,o)}}const Ki={basename:o6,dirname:u6,extname:c6,join:h6,sep:"/"};function o6(n,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Yc(n);let t=0,r=-1,l=n.length,s;if(e===void 0||e.length===0||e.length>n.length){for(;l--;)if(n.codePointAt(l)===47){if(s){t=l+1;break}}else r<0&&(s=!0,r=l+1);return r<0?"":n.slice(t,r)}if(e===n)return"";let o=-1,c=e.length-1;for(;l--;)if(n.codePointAt(l)===47){if(s){t=l+1;break}}else o<0&&(s=!0,o=l+1),c>-1&&(n.codePointAt(l)===e.codePointAt(c--)?c<0&&(r=l):(c=-1,r=o));return t===r?r=o:r<0&&(r=n.length),n.slice(t,r)}function u6(n){if(Yc(n),n.length===0)return".";let e=-1,t=n.length,r;for(;--t;)if(n.codePointAt(t)===47){if(r){e=t;break}}else r||(r=!0);return e<0?n.codePointAt(0)===47?"/":".":e===1&&n.codePointAt(0)===47?"//":n.slice(0,e)}function c6(n){Yc(n);let e=n.length,t=-1,r=0,l=-1,s=0,o;for(;e--;){const c=n.codePointAt(e);if(c===47){if(o){r=e+1;break}continue}t<0&&(o=!0,t=e+1),c===46?l<0?l=e:s!==1&&(s=1):l>-1&&(s=-1)}return l<0||t<0||s===0||s===1&&l===t-1&&l===r+1?"":n.slice(l,t)}function h6(...n){let e=-1,t;for(;++e<n.length;)Yc(n[e]),n[e]&&(t=t===void 0?n[e]:t+"/"+n[e]);return t===void 0?".":f6(t)}function f6(n){Yc(n);const e=n.codePointAt(0)===47;let t=d6(n,!e);return t.length===0&&!e&&(t="."),t.length>0&&n.codePointAt(n.length-1)===47&&(t+="/"),e?"/"+t:t}function d6(n,e){let t="",r=0,l=-1,s=0,o=-1,c,h;for(;++o<=n.length;){if(o<n.length)c=n.codePointAt(o);else{if(c===47)break;c=47}if(c===47){if(!(l===o-1||s===1))if(l!==o-1&&s===2){if(t.length<2||r!==2||t.codePointAt(t.length-1)!==46||t.codePointAt(t.length-2)!==46){if(t.length>2){if(h=t.lastIndexOf("/"),h!==t.length-1){h<0?(t="",r=0):(t=t.slice(0,h),r=t.length-1-t.lastIndexOf("/")),l=o,s=0;continue}}else if(t.length>0){t="",r=0,l=o,s=0;continue}}e&&(t=t.length>0?t+"/..":"..",r=2)}else t.length>0?t+="/"+n.slice(l+1,o):t=n.slice(l+1,o),r=o-l-1;l=o,s=0}else c===46&&s>-1?s++:s=-1}return t}function Yc(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}const p6={cwd:m6};function m6(){return"/"}function E0(n){return!!(n!==null&&typeof n=="object"&&"href"in n&&n.href&&"protocol"in n&&n.protocol&&n.auth===void 0)}function g6(n){if(typeof n=="string")n=new URL(n);else if(!E0(n)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+n+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(n.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return y6(n)}function y6(n){if(n.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=n.pathname;let t=-1;for(;++t<e.length;)if(e.codePointAt(t)===37&&e.codePointAt(t+1)===50){const r=e.codePointAt(t+2);if(r===70||r===102){const l=new TypeError("File URL path must not include encoded / characters");throw l.code="ERR_INVALID_FILE_URL_PATH",l}}return decodeURIComponent(e)}const pg=["history","path","basename","stem","extname","dirname"];class eC{constructor(e){let t;e?E0(e)?t={path:e}:typeof e=="string"||x6(e)?t={value:e}:t=e:t={},this.cwd="cwd"in t?"":p6.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<pg.length;){const s=pg[r];s in t&&t[s]!==void 0&&t[s]!==null&&(this[s]=s==="history"?[...t[s]]:t[s])}let l;for(l in t)pg.includes(l)||(this[l]=t[l])}get basename(){return typeof this.path=="string"?Ki.basename(this.path):void 0}set basename(e){gg(e,"basename"),mg(e,"basename"),this.path=Ki.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Ki.dirname(this.path):void 0}set dirname(e){Dk(this.basename,"dirname"),this.path=Ki.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Ki.extname(this.path):void 0}set extname(e){if(mg(e,"extname"),Dk(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Ki.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){E0(e)&&(e=g6(e)),gg(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Ki.basename(this.path,this.extname):void 0}set stem(e){gg(e,"stem"),mg(e,"stem"),this.path=Ki.join(this.dirname||"",e+(this.extname||""))}fail(e,t,r){const l=this.message(e,t,r);throw l.fatal=!0,l}info(e,t,r){const l=this.message(e,t,r);return l.fatal=void 0,l}message(e,t,r){const l=new pr(e,t,r);return this.path&&(l.name=this.path+":"+l.name,l.file=this.path),l.fatal=!1,this.messages.push(l),l}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function mg(n,e){if(n&&n.includes(Ki.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Ki.sep+"`")}function gg(n,e){if(!n)throw new Error("`"+e+"` cannot be empty")}function Dk(n,e){if(!n)throw new Error("Setting `"+e+"` requires `path` to be set too")}function x6(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const v6=(function(n){const r=this.constructor.prototype,l=r[n],s=function(){return l.apply(s,arguments)};return Object.setPrototypeOf(s,r),s}),b6={}.hasOwnProperty;class Sy extends v6{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=a6()}copy(){const e=new Sy;let t=-1;for(;++t<this.attachers.length;){const r=this.attachers[t];e.use(...r)}return e.data(dg(!0,{},this.namespace)),e}data(e,t){return typeof e=="string"?arguments.length===2?(vg("data",this.frozen),this.namespace[e]=t,this):b6.call(this.namespace,e)&&this.namespace[e]||void 0:e?(vg("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const l=t.call(e,...r);typeof l=="function"&&this.transformers.use(l)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=Mf(e),r=this.parser||this.Parser;return yg("parse",r),r(String(t),t)}process(e,t){const r=this;return this.freeze(),yg("process",this.parser||this.Parser),xg("process",this.compiler||this.Compiler),t?l(void 0,t):new Promise(l);function l(s,o){const c=Mf(e),h=r.parse(c);r.run(h,c,function(p,g,b){if(p||!g||!b)return d(p);const w=g,T=r.stringify(w,b);S6(T)?b.value=T:b.result=T,d(p,b)});function d(p,g){p||!g?o(p):s?s(g):t(void 0,g)}}}processSync(e){let t=!1,r;return this.freeze(),yg("processSync",this.parser||this.Parser),xg("processSync",this.compiler||this.Compiler),this.process(e,l),Ok("processSync","process",t),r;function l(s,o){t=!0,Mk(s),r=o}}run(e,t,r){jk(e),this.freeze();const l=this.transformers;return!r&&typeof t=="function"&&(r=t,t=void 0),r?s(void 0,r):new Promise(s);function s(o,c){const h=Mf(t);l.run(e,h,d);function d(p,g,b){const w=g||e;p?c(p):o?o(w):r(void 0,w,b)}}}runSync(e,t){let r=!1,l;return this.run(e,t,s),Ok("runSync","run",r),l;function s(o,c){Mk(o),l=c,r=!0}}stringify(e,t){this.freeze();const r=Mf(t),l=this.compiler||this.Compiler;return xg("stringify",l),jk(e),l(e,r)}use(e,...t){const r=this.attachers,l=this.namespace;if(vg("use",this.frozen),e!=null)if(typeof e=="function")h(e,t);else if(typeof e=="object")Array.isArray(e)?c(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(d){if(typeof d=="function")h(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[p,...g]=d;h(p,g)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");c(d.plugins),d.settings&&(l.settings=dg(!0,l.settings,d.settings))}function c(d){let p=-1;if(d!=null)if(Array.isArray(d))for(;++p<d.length;){const g=d[p];s(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function h(d,p){let g=-1,b=-1;for(;++g<r.length;)if(r[g][0]===d){b=g;break}if(b===-1)r.push([d,...p]);else if(p.length>0){let[w,...T]=p;const N=r[b][1];T0(N)&&T0(w)&&(w=dg(!0,N,w)),r[b]=[d,w,...T]}}}}const k6=new Sy().freeze();function yg(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `parser`")}function xg(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `compiler`")}function vg(n,e){if(e)throw new Error("Cannot call `"+n+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function jk(n){if(!T0(n)||typeof n.type!="string")throw new TypeError("Expected node, got `"+n+"`")}function Ok(n,e,t){if(!t)throw new Error("`"+n+"` finished async. Use `"+e+"` instead")}function Mf(n){return w6(n)?n:new eC(n)}function w6(n){return!!(n&&typeof n=="object"&&"message"in n&&"messages"in n)}function S6(n){return typeof n=="string"||C6(n)}function C6(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}const A6="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Rk=[],Bk={allowDangerousHtml:!0},T6=/^(https?|ircs?|mailto|xmpp)$/i,E6=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function N0(n){const e=N6(n),t=M6(n);return _6(e.runSync(e.parse(t),t),n)}function N6(n){const e=n.rehypePlugins||Rk,t=n.remarkPlugins||Rk,r=n.remarkRehypeOptions?{...n.remarkRehypeOptions,...Bk}:Bk;return k6().use(uO).use(t).use(r6,r).use(e)}function M6(n){const e=n.children||"",t=new eC;return typeof e=="string"&&(t.value=e),t}function _6(n,e){const t=e.allowedElements,r=e.allowElement,l=e.components,s=e.disallowedElements,o=e.skipHtml,c=e.unwrapDisallowed,h=e.urlTransform||D6;for(const p of E6)Object.hasOwn(e,p.from)&&(""+p.from+(p.to?"use `"+p.to+"` instead":"remove it")+A6+p.id,void 0);return wy(n,d),G_(n,{Fragment:k.Fragment,components:l,ignoreInvalidStyle:!0,jsx:k.jsx,jsxs:k.jsxs,passKeys:!0,passNode:!0});function d(p,g,b){if(p.type==="raw"&&b&&typeof g=="number")return o?b.children.splice(g,1):b.children[g]={type:"text",value:p.value},g;if(p.type==="element"){let w;for(w in ug)if(Object.hasOwn(ug,w)&&Object.hasOwn(p.properties,w)){const T=p.properties[w],N=ug[w];(N===null||N.includes(p.tagName))&&(p.properties[w]=h(String(T||""),w,p))}}if(p.type==="element"){let w=t?!t.includes(p.tagName):s?s.includes(p.tagName):!1;if(!w&&r&&typeof g=="number"&&(w=!r(p,g,b)),w&&b&&typeof g=="number")return c&&p.children?b.children.splice(g,1,...p.children):b.children.splice(g,1),g}}}function D6(n){const e=n.indexOf(":"),t=n.indexOf("?"),r=n.indexOf("#"),l=n.indexOf("/");return e===-1||l!==-1&&e>l||t!==-1&&e>t||r!==-1&&e>r||T6.test(n.slice(0,e))?n:""}function Lk(n,e){const t=String(n);if(typeof e!="string")throw new TypeError("Expected character");let r=0,l=t.indexOf(e);for(;l!==-1;)r++,l=t.indexOf(e,l+e.length);return r}function j6(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function O6(n,e,t){const l=Pd((t||{}).ignore||[]),s=R6(e);let o=-1;for(;++o<s.length;)J2(n,"text",c);function c(d,p){let g=-1,b;for(;++g<p.length;){const w=p[g],T=b?b.children:void 0;if(l(w,T?T.indexOf(w):void 0,b))return;b=w}if(b)return h(d,p)}function h(d,p){const g=p[p.length-1],b=s[o][0],w=s[o][1];let T=0;const D=g.children.indexOf(d);let j=!1,U=[];b.lastIndex=0;let I=b.exec(d.value);for(;I;){const ce=I.index,F={index:I.index,input:I.input,stack:[...p,d]};let z=w(...I,F);if(typeof z=="string"&&(z=z.length>0?{type:"text",value:z}:void 0),z===!1?b.lastIndex=ce+1:(T!==ce&&U.push({type:"text",value:d.value.slice(T,ce)}),Array.isArray(z)?U.push(...z):z&&U.push(z),T=ce+I[0].length,j=!0),!b.global)break;I=b.exec(d.value)}return j?(T<d.value.length&&U.push({type:"text",value:d.value.slice(T)}),g.children.splice(D,1,...U)):U=[d],D+U.length}}function R6(n){const e=[];if(!Array.isArray(n))throw new TypeError("Expected find and replace tuple or list of tuples");const t=!n[0]||Array.isArray(n[0])?n:[n];let r=-1;for(;++r<t.length;){const l=t[r];e.push([B6(l[0]),L6(l[1])])}return e}function B6(n){return typeof n=="string"?new RegExp(j6(n),"g"):n}function L6(n){return typeof n=="function"?n:function(){return n}}const bg="phrasing",kg=["autolink","link","image","label"];function z6(){return{transforms:[V6],enter:{literalAutolink:P6,literalAutolinkEmail:wg,literalAutolinkHttp:wg,literalAutolinkWww:wg},exit:{literalAutolink:F6,literalAutolinkEmail:U6,literalAutolinkHttp:H6,literalAutolinkWww:q6}}}function I6(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:bg,notInConstruct:kg},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:bg,notInConstruct:kg},{character:":",before:"[ps]",after:"\\/",inConstruct:bg,notInConstruct:kg}]}}function P6(n){this.enter({type:"link",title:null,url:"",children:[]},n)}function wg(n){this.config.enter.autolinkProtocol.call(this,n)}function H6(n){this.config.exit.autolinkProtocol.call(this,n)}function q6(n){this.config.exit.data.call(this,n);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(n)}function U6(n){this.config.exit.autolinkEmail.call(this,n)}function F6(n){this.exit(n)}function V6(n){O6(n,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,K6],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,G6]],{ignore:["link","linkReference"]})}function K6(n,e,t,r,l){let s="";if(!tC(l)||(/^w/i.test(e)&&(t=e+t,e="",s="http://"),!Y6(t)))return!1;const o=Q6(t+r);if(!o[0])return!1;const c={type:"link",title:null,url:s+e+o[0],children:[{type:"text",value:e+o[0]}]};return o[1]?[c,{type:"text",value:o[1]}]:c}function G6(n,e,t,r){return!tC(r,!0)||/[-\d_]$/.test(t)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+t,children:[{type:"text",value:e+"@"+t}]}}function Y6(n){const e=n.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function Q6(n){const e=/[!"&'),.:;<>?\]}]+$/.exec(n);if(!e)return[n,void 0];n=n.slice(0,e.index);let t=e[0],r=t.indexOf(")");const l=Lk(n,"(");let s=Lk(n,")");for(;r!==-1&&l>s;)n+=t.slice(0,r+1),t=t.slice(r+1),r=t.indexOf(")"),s++;return[n,t]}function tC(n,e){const t=n.input.charCodeAt(n.index-1);return(n.index===0||Cs(t)||Ld(t))&&(!e||t!==47)}nC.peek=r8;function X6(){this.buffer()}function $6(n){this.enter({type:"footnoteReference",identifier:"",label:""},n)}function W6(){this.buffer()}function Z6(n){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},n)}function J6(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=wi(this.sliceSerialize(n)).toLowerCase(),t.label=e}function e8(n){this.exit(n)}function t8(n){const e=this.resume(),t=this.stack[this.stack.length-1];t.type,t.identifier=wi(this.sliceSerialize(n)).toLowerCase(),t.label=e}function n8(n){this.exit(n)}function r8(){return"["}function nC(n,e,t,r){const l=t.createTracker(r);let s=l.move("[^");const o=t.enter("footnoteReference"),c=t.enter("reference");return s+=l.move(t.safe(t.associationId(n),{after:"]",before:s})),c(),o(),s+=l.move("]"),s}function i8(){return{enter:{gfmFootnoteCallString:X6,gfmFootnoteCall:$6,gfmFootnoteDefinitionLabelString:W6,gfmFootnoteDefinition:Z6},exit:{gfmFootnoteCallString:J6,gfmFootnoteCall:e8,gfmFootnoteDefinitionLabelString:t8,gfmFootnoteDefinition:n8}}}function l8(n){let e=!1;return n&&n.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:t,footnoteReference:nC},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function t(r,l,s,o){const c=s.createTracker(o);let h=c.move("[^");const d=s.enter("footnoteDefinition"),p=s.enter("label");return h+=c.move(s.safe(s.associationId(r),{before:h,after:"]"})),p(),h+=c.move("]:"),r.children&&r.children.length>0&&(c.shift(4),h+=c.move((e?`
`:" ")+s.indentLines(s.containerFlow(r,c.current()),e?rC:a8))),d(),h}}function a8(n,e,t){return e===0?n:rC(n,e,t)}function rC(n,e,t){return(t?"":"    ")+n}const s8=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];iC.peek=f8;function o8(){return{canContainEols:["delete"],enter:{strikethrough:c8},exit:{strikethrough:h8}}}function u8(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:s8}],handlers:{delete:iC}}}function c8(n){this.enter({type:"delete",children:[]},n)}function h8(n){this.exit(n)}function iC(n,e,t,r){const l=t.createTracker(r),s=t.enter("strikethrough");let o=l.move("~~");return o+=t.containerPhrasing(n,{...l.current(),before:o,after:"~"}),o+=l.move("~~"),s(),o}function f8(){return"~"}function d8(n){return n.length}function p8(n,e){const t=e||{},r=(t.align||[]).concat(),l=t.stringLength||d8,s=[],o=[],c=[],h=[];let d=0,p=-1;for(;++p<n.length;){const N=[],D=[];let j=-1;for(n[p].length>d&&(d=n[p].length);++j<n[p].length;){const U=m8(n[p][j]);if(t.alignDelimiters!==!1){const I=l(U);D[j]=I,(h[j]===void 0||I>h[j])&&(h[j]=I)}N.push(U)}o[p]=N,c[p]=D}let g=-1;if(typeof r=="object"&&"length"in r)for(;++g<d;)s[g]=zk(r[g]);else{const N=zk(r);for(;++g<d;)s[g]=N}g=-1;const b=[],w=[];for(;++g<d;){const N=s[g];let D="",j="";N===99?(D=":",j=":"):N===108?D=":":N===114&&(j=":");let U=t.alignDelimiters===!1?1:Math.max(1,h[g]-D.length-j.length);const I=D+"-".repeat(U)+j;t.alignDelimiters!==!1&&(U=D.length+U+j.length,U>h[g]&&(h[g]=U),w[g]=U),b[g]=I}o.splice(1,0,b),c.splice(1,0,w),p=-1;const T=[];for(;++p<o.length;){const N=o[p],D=c[p];g=-1;const j=[];for(;++g<d;){const U=N[g]||"";let I="",ce="";if(t.alignDelimiters!==!1){const F=h[g]-(D[g]||0),z=s[g];z===114?I=" ".repeat(F):z===99?F%2?(I=" ".repeat(F/2+.5),ce=" ".repeat(F/2-.5)):(I=" ".repeat(F/2),ce=I):ce=" ".repeat(F)}t.delimiterStart!==!1&&!g&&j.push("|"),t.padding!==!1&&!(t.alignDelimiters===!1&&U==="")&&(t.delimiterStart!==!1||g)&&j.push(" "),t.alignDelimiters!==!1&&j.push(I),j.push(U),t.alignDelimiters!==!1&&j.push(ce),t.padding!==!1&&j.push(" "),(t.delimiterEnd!==!1||g!==d-1)&&j.push("|")}T.push(t.delimiterEnd===!1?j.join("").replace(/ +$/,""):j.join(""))}return T.join(`
`)}function m8(n){return n==null?"":String(n)}function zk(n){const e=typeof n=="string"?n.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function g8(n,e,t,r){const l=t.enter("blockquote"),s=t.createTracker(r);s.move("> "),s.shift(2);const o=t.indentLines(t.containerFlow(n,s.current()),y8);return l(),o}function y8(n,e,t){return">"+(t?"":" ")+n}function x8(n,e){return Ik(n,e.inConstruct,!0)&&!Ik(n,e.notInConstruct,!1)}function Ik(n,e,t){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return t;let r=-1;for(;++r<e.length;)if(n.includes(e[r]))return!0;return!1}function Pk(n,e,t,r){let l=-1;for(;++l<t.unsafe.length;)if(t.unsafe[l].character===`
`&&x8(t.stack,t.unsafe[l]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function v8(n,e){const t=String(n);let r=t.indexOf(e),l=r,s=0,o=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===l?++s>o&&(o=s):s=1,l=r+e.length,r=t.indexOf(e,l);return o}function b8(n,e){return!!(e.options.fences===!1&&n.value&&!n.lang&&/[^ \r\n]/.test(n.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(n.value))}function k8(n){const e=n.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function w8(n,e,t,r){const l=k8(t),s=n.value||"",o=l==="`"?"GraveAccent":"Tilde";if(b8(n,t)){const g=t.enter("codeIndented"),b=t.indentLines(s,S8);return g(),b}const c=t.createTracker(r),h=l.repeat(Math.max(v8(s,l)+1,3)),d=t.enter("codeFenced");let p=c.move(h);if(n.lang){const g=t.enter(`codeFencedLang${o}`);p+=c.move(t.safe(n.lang,{before:p,after:" ",encode:["`"],...c.current()})),g()}if(n.lang&&n.meta){const g=t.enter(`codeFencedMeta${o}`);p+=c.move(" "),p+=c.move(t.safe(n.meta,{before:p,after:`
`,encode:["`"],...c.current()})),g()}return p+=c.move(`
`),s&&(p+=c.move(s+`
`)),p+=c.move(h),d(),p}function S8(n,e,t){return(t?"":"    ")+n}function Cy(n){const e=n.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function C8(n,e,t,r){const l=Cy(t),s=l==='"'?"Quote":"Apostrophe",o=t.enter("definition");let c=t.enter("label");const h=t.createTracker(r);let d=h.move("[");return d+=h.move(t.safe(t.associationId(n),{before:d,after:"]",...h.current()})),d+=h.move("]: "),c(),!n.url||/[\0- \u007F]/.test(n.url)?(c=t.enter("destinationLiteral"),d+=h.move("<"),d+=h.move(t.safe(n.url,{before:d,after:">",...h.current()})),d+=h.move(">")):(c=t.enter("destinationRaw"),d+=h.move(t.safe(n.url,{before:d,after:n.title?" ":`
`,...h.current()}))),c(),n.title&&(c=t.enter(`title${s}`),d+=h.move(" "+l),d+=h.move(t.safe(n.title,{before:d,after:l,...h.current()})),d+=h.move(l),c()),o(),d}function A8(n){const e=n.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function Pc(n){return"&#x"+n.toString(16).toUpperCase()+";"}function xd(n,e,t){const r=Yo(n),l=Yo(e);return r===void 0?l===void 0?t==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:l===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?l===void 0?{inside:!1,outside:!1}:l===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:l===void 0?{inside:!1,outside:!1}:l===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}lC.peek=T8;function lC(n,e,t,r){const l=A8(t),s=t.enter("emphasis"),o=t.createTracker(r),c=o.move(l);let h=o.move(t.containerPhrasing(n,{after:l,before:c,...o.current()}));const d=h.charCodeAt(0),p=xd(r.before.charCodeAt(r.before.length-1),d,l);p.inside&&(h=Pc(d)+h.slice(1));const g=h.charCodeAt(h.length-1),b=xd(r.after.charCodeAt(0),g,l);b.inside&&(h=h.slice(0,-1)+Pc(g));const w=o.move(l);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},c+h+w}function T8(n,e,t){return t.options.emphasis||"*"}function E8(n,e){let t=!1;return wy(n,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return t=!0,C0}),!!((!n.depth||n.depth<3)&&my(n)&&(e.options.setext||t))}function N8(n,e,t,r){const l=Math.max(Math.min(6,n.depth||1),1),s=t.createTracker(r);if(E8(n,t)){const p=t.enter("headingSetext"),g=t.enter("phrasing"),b=t.containerPhrasing(n,{...s.current(),before:`
`,after:`
`});return g(),p(),b+`
`+(l===1?"=":"-").repeat(b.length-(Math.max(b.lastIndexOf("\r"),b.lastIndexOf(`
`))+1))}const o="#".repeat(l),c=t.enter("headingAtx"),h=t.enter("phrasing");s.move(o+" ");let d=t.containerPhrasing(n,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(d)&&(d=Pc(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,t.options.closeAtx&&(d+=" "+o),h(),c(),d}aC.peek=M8;function aC(n){return n.value||""}function M8(){return"<"}sC.peek=_8;function sC(n,e,t,r){const l=Cy(t),s=l==='"'?"Quote":"Apostrophe",o=t.enter("image");let c=t.enter("label");const h=t.createTracker(r);let d=h.move("![");return d+=h.move(t.safe(n.alt,{before:d,after:"]",...h.current()})),d+=h.move("]("),c(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(c=t.enter("destinationLiteral"),d+=h.move("<"),d+=h.move(t.safe(n.url,{before:d,after:">",...h.current()})),d+=h.move(">")):(c=t.enter("destinationRaw"),d+=h.move(t.safe(n.url,{before:d,after:n.title?" ":")",...h.current()}))),c(),n.title&&(c=t.enter(`title${s}`),d+=h.move(" "+l),d+=h.move(t.safe(n.title,{before:d,after:l,...h.current()})),d+=h.move(l),c()),d+=h.move(")"),o(),d}function _8(){return"!"}oC.peek=D8;function oC(n,e,t,r){const l=n.referenceType,s=t.enter("imageReference");let o=t.enter("label");const c=t.createTracker(r);let h=c.move("![");const d=t.safe(n.alt,{before:h,after:"]",...c.current()});h+=c.move(d+"]["),o();const p=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(n),{before:h,after:"]",...c.current()});return o(),t.stack=p,s(),l==="full"||!d||d!==g?h+=c.move(g+"]"):l==="shortcut"?h=h.slice(0,-1):h+=c.move("]"),h}function D8(){return"!"}uC.peek=j8;function uC(n,e,t){let r=n.value||"",l="`",s=-1;for(;new RegExp("(^|[^`])"+l+"([^`]|$)").test(r);)l+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++s<t.unsafe.length;){const o=t.unsafe[s],c=t.compilePattern(o);let h;if(o.atBreak)for(;h=c.exec(r);){let d=h.index;r.charCodeAt(d)===10&&r.charCodeAt(d-1)===13&&d--,r=r.slice(0,d)+" "+r.slice(h.index+1)}}return l+r+l}function j8(){return"`"}function cC(n,e){const t=my(n);return!!(!e.options.resourceLink&&n.url&&!n.title&&n.children&&n.children.length===1&&n.children[0].type==="text"&&(t===n.url||"mailto:"+t===n.url)&&/^[a-z][a-z+.-]+:/i.test(n.url)&&!/[\0- <>\u007F]/.test(n.url))}hC.peek=O8;function hC(n,e,t,r){const l=Cy(t),s=l==='"'?"Quote":"Apostrophe",o=t.createTracker(r);let c,h;if(cC(n,t)){const p=t.stack;t.stack=[],c=t.enter("autolink");let g=o.move("<");return g+=o.move(t.containerPhrasing(n,{before:g,after:">",...o.current()})),g+=o.move(">"),c(),t.stack=p,g}c=t.enter("link"),h=t.enter("label");let d=o.move("[");return d+=o.move(t.containerPhrasing(n,{before:d,after:"](",...o.current()})),d+=o.move("]("),h(),!n.url&&n.title||/[\0- \u007F]/.test(n.url)?(h=t.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(t.safe(n.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(h=t.enter("destinationRaw"),d+=o.move(t.safe(n.url,{before:d,after:n.title?" ":")",...o.current()}))),h(),n.title&&(h=t.enter(`title${s}`),d+=o.move(" "+l),d+=o.move(t.safe(n.title,{before:d,after:l,...o.current()})),d+=o.move(l),h()),d+=o.move(")"),c(),d}function O8(n,e,t){return cC(n,t)?"<":"["}fC.peek=R8;function fC(n,e,t,r){const l=n.referenceType,s=t.enter("linkReference");let o=t.enter("label");const c=t.createTracker(r);let h=c.move("[");const d=t.containerPhrasing(n,{before:h,after:"]",...c.current()});h+=c.move(d+"]["),o();const p=t.stack;t.stack=[],o=t.enter("reference");const g=t.safe(t.associationId(n),{before:h,after:"]",...c.current()});return o(),t.stack=p,s(),l==="full"||!d||d!==g?h+=c.move(g+"]"):l==="shortcut"?h=h.slice(0,-1):h+=c.move("]"),h}function R8(){return"["}function Ay(n){const e=n.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function B8(n){const e=Ay(n),t=n.options.bulletOther;if(!t)return e==="*"?"-":"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(t===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+t+"`) to be different");return t}function L8(n){const e=n.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function dC(n){const e=n.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function z8(n,e,t,r){const l=t.enter("list"),s=t.bulletCurrent;let o=n.ordered?L8(t):Ay(t);const c=n.ordered?o==="."?")":".":B8(t);let h=e&&t.bulletLastUsed?o===t.bulletLastUsed:!1;if(!n.ordered){const p=n.children?n.children[0]:void 0;if((o==="*"||o==="-")&&p&&(!p.children||!p.children[0])&&t.stack[t.stack.length-1]==="list"&&t.stack[t.stack.length-2]==="listItem"&&t.stack[t.stack.length-3]==="list"&&t.stack[t.stack.length-4]==="listItem"&&t.indexStack[t.indexStack.length-1]===0&&t.indexStack[t.indexStack.length-2]===0&&t.indexStack[t.indexStack.length-3]===0&&(h=!0),dC(t)===o&&p){let g=-1;for(;++g<n.children.length;){const b=n.children[g];if(b&&b.type==="listItem"&&b.children&&b.children[0]&&b.children[0].type==="thematicBreak"){h=!0;break}}}}h&&(o=c),t.bulletCurrent=o;const d=t.containerFlow(n,r);return t.bulletLastUsed=o,t.bulletCurrent=s,l(),d}function I8(n){const e=n.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function P8(n,e,t,r){const l=I8(t);let s=t.bulletCurrent||Ay(t);e&&e.type==="list"&&e.ordered&&(s=(typeof e.start=="number"&&e.start>-1?e.start:1)+(t.options.incrementListMarker===!1?0:e.children.indexOf(n))+s);let o=s.length+1;(l==="tab"||l==="mixed"&&(e&&e.type==="list"&&e.spread||n.spread))&&(o=Math.ceil(o/4)*4);const c=t.createTracker(r);c.move(s+" ".repeat(o-s.length)),c.shift(o);const h=t.enter("listItem"),d=t.indentLines(t.containerFlow(n,c.current()),p);return h(),d;function p(g,b,w){return b?(w?"":" ".repeat(o))+g:(w?s:s+" ".repeat(o-s.length))+g}}function H8(n,e,t,r){const l=t.enter("paragraph"),s=t.enter("phrasing"),o=t.containerPhrasing(n,r);return s(),l(),o}const q8=Pd(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function U8(n,e,t,r){return(n.children.some(function(o){return q8(o)})?t.containerPhrasing:t.containerFlow).call(t,n,r)}function F8(n){const e=n.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}pC.peek=V8;function pC(n,e,t,r){const l=F8(t),s=t.enter("strong"),o=t.createTracker(r),c=o.move(l+l);let h=o.move(t.containerPhrasing(n,{after:l,before:c,...o.current()}));const d=h.charCodeAt(0),p=xd(r.before.charCodeAt(r.before.length-1),d,l);p.inside&&(h=Pc(d)+h.slice(1));const g=h.charCodeAt(h.length-1),b=xd(r.after.charCodeAt(0),g,l);b.inside&&(h=h.slice(0,-1)+Pc(g));const w=o.move(l+l);return s(),t.attentionEncodeSurroundingInfo={after:b.outside,before:p.outside},c+h+w}function V8(n,e,t){return t.options.strong||"*"}function K8(n,e,t,r){return t.safe(n.value,r)}function G8(n){const e=n.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function Y8(n,e,t){const r=(dC(t)+(t.options.ruleSpaces?" ":"")).repeat(G8(t));return t.options.ruleSpaces?r.slice(0,-1):r}const mC={blockquote:g8,break:Pk,code:w8,definition:C8,emphasis:lC,hardBreak:Pk,heading:N8,html:aC,image:sC,imageReference:oC,inlineCode:uC,link:hC,linkReference:fC,list:z8,listItem:P8,paragraph:H8,root:U8,strong:pC,text:K8,thematicBreak:Y8};function Q8(){return{enter:{table:X8,tableData:Hk,tableHeader:Hk,tableRow:W8},exit:{codeText:Z8,table:$8,tableData:Sg,tableHeader:Sg,tableRow:Sg}}}function X8(n){const e=n._align;this.enter({type:"table",align:e.map(function(t){return t==="none"?null:t}),children:[]},n),this.data.inTable=!0}function $8(n){this.exit(n),this.data.inTable=void 0}function W8(n){this.enter({type:"tableRow",children:[]},n)}function Sg(n){this.exit(n)}function Hk(n){this.enter({type:"tableCell",children:[]},n)}function Z8(n){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,J8));const t=this.stack[this.stack.length-1];t.type,t.value=e,this.exit(n)}function J8(n,e){return e==="|"?e:n}function eR(n){const e=n||{},t=e.tableCellPadding,r=e.tablePipeAlign,l=e.stringLength,s=t?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:b,table:o,tableCell:h,tableRow:c}};function o(w,T,N,D){return d(p(w,N,D),w.align)}function c(w,T,N,D){const j=g(w,N,D),U=d([j]);return U.slice(0,U.indexOf(`
`))}function h(w,T,N,D){const j=N.enter("tableCell"),U=N.enter("phrasing"),I=N.containerPhrasing(w,{...D,before:s,after:s});return U(),j(),I}function d(w,T){return p8(w,{align:T,alignDelimiters:r,padding:t,stringLength:l})}function p(w,T,N){const D=w.children;let j=-1;const U=[],I=T.enter("table");for(;++j<D.length;)U[j]=g(D[j],T,N);return I(),U}function g(w,T,N){const D=w.children;let j=-1;const U=[],I=T.enter("tableRow");for(;++j<D.length;)U[j]=h(D[j],w,T,N);return I(),U}function b(w,T,N){let D=mC.inlineCode(w,T,N);return N.stack.includes("tableCell")&&(D=D.replace(/\|/g,"\\$&")),D}}function tR(){return{exit:{taskListCheckValueChecked:qk,taskListCheckValueUnchecked:qk,paragraph:rR}}}function nR(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:iR}}}function qk(n){const e=this.stack[this.stack.length-2];e.type,e.checked=n.type==="taskListCheckValueChecked"}function rR(n){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const t=this.stack[this.stack.length-1];t.type;const r=t.children[0];if(r&&r.type==="text"){const l=e.children;let s=-1,o;for(;++s<l.length;){const c=l[s];if(c.type==="paragraph"){o=c;break}}o===t&&(r.value=r.value.slice(1),r.value.length===0?t.children.shift():t.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,t.position.start=Object.assign({},r.position.start)))}}this.exit(n)}function iR(n,e,t,r){const l=n.children[0],s=typeof n.checked=="boolean"&&l&&l.type==="paragraph",o="["+(n.checked?"x":" ")+"] ",c=t.createTracker(r);s&&c.move(o);let h=mC.listItem(n,e,t,{...r,...c.current()});return s&&(h=h.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),h;function d(p){return p+o}}function lR(){return[z6(),i8(),o8(),Q8(),tR()]}function aR(n){return{extensions:[I6(),l8(n),u8(),eR(n),nR()]}}const sR={tokenize:dR,partial:!0},gC={tokenize:pR,partial:!0},yC={tokenize:mR,partial:!0},xC={tokenize:gR,partial:!0},oR={tokenize:yR,partial:!0},vC={name:"wwwAutolink",tokenize:hR,previous:kC},bC={name:"protocolAutolink",tokenize:fR,previous:wC},Bl={name:"emailAutolink",tokenize:cR,previous:SC},tl={};function uR(){return{text:tl}}let ds=48;for(;ds<123;)tl[ds]=Bl,ds++,ds===58?ds=65:ds===91&&(ds=97);tl[43]=Bl;tl[45]=Bl;tl[46]=Bl;tl[95]=Bl;tl[72]=[Bl,bC];tl[104]=[Bl,bC];tl[87]=[Bl,vC];tl[119]=[Bl,vC];function cR(n,e,t){const r=this;let l,s;return o;function o(g){return!M0(g)||!SC.call(r,r.previous)||Ty(r.events)?t(g):(n.enter("literalAutolink"),n.enter("literalAutolinkEmail"),c(g))}function c(g){return M0(g)?(n.consume(g),c):g===64?(n.consume(g),h):t(g)}function h(g){return g===46?n.check(oR,p,d)(g):g===45||g===95||fr(g)?(s=!0,n.consume(g),h):p(g)}function d(g){return n.consume(g),l=!0,h}function p(g){return s&&l&&vr(r.previous)?(n.exit("literalAutolinkEmail"),n.exit("literalAutolink"),e(g)):t(g)}}function hR(n,e,t){const r=this;return l;function l(o){return o!==87&&o!==119||!kC.call(r,r.previous)||Ty(r.events)?t(o):(n.enter("literalAutolink"),n.enter("literalAutolinkWww"),n.check(sR,n.attempt(gC,n.attempt(yC,s),t),t)(o))}function s(o){return n.exit("literalAutolinkWww"),n.exit("literalAutolink"),e(o)}}function fR(n,e,t){const r=this;let l="",s=!1;return o;function o(g){return(g===72||g===104)&&wC.call(r,r.previous)&&!Ty(r.events)?(n.enter("literalAutolink"),n.enter("literalAutolinkHttp"),l+=String.fromCodePoint(g),n.consume(g),c):t(g)}function c(g){if(vr(g)&&l.length<5)return l+=String.fromCodePoint(g),n.consume(g),c;if(g===58){const b=l.toLowerCase();if(b==="http"||b==="https")return n.consume(g),h}return t(g)}function h(g){return g===47?(n.consume(g),s?d:(s=!0,h)):t(g)}function d(g){return g===null||md(g)||rn(g)||Cs(g)||Ld(g)?t(g):n.attempt(gC,n.attempt(yC,p),t)(g)}function p(g){return n.exit("literalAutolinkHttp"),n.exit("literalAutolink"),e(g)}}function dR(n,e,t){let r=0;return l;function l(o){return(o===87||o===119)&&r<3?(r++,n.consume(o),l):o===46&&r===3?(n.consume(o),s):t(o)}function s(o){return o===null?t(o):e(o)}}function pR(n,e,t){let r,l,s;return o;function o(d){return d===46||d===95?n.check(xC,h,c)(d):d===null||rn(d)||Cs(d)||d!==45&&Ld(d)?h(d):(s=!0,n.consume(d),o)}function c(d){return d===95?r=!0:(l=r,r=void 0),n.consume(d),o}function h(d){return l||r||!s?t(d):e(d)}}function mR(n,e){let t=0,r=0;return l;function l(o){return o===40?(t++,n.consume(o),l):o===41&&r<t?s(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?n.check(xC,e,s)(o):o===null||rn(o)||Cs(o)?e(o):(n.consume(o),l)}function s(o){return o===41&&r++,n.consume(o),l}}function gR(n,e,t){return r;function r(c){return c===33||c===34||c===39||c===41||c===42||c===44||c===46||c===58||c===59||c===63||c===95||c===126?(n.consume(c),r):c===38?(n.consume(c),s):c===93?(n.consume(c),l):c===60||c===null||rn(c)||Cs(c)?e(c):t(c)}function l(c){return c===null||c===40||c===91||rn(c)||Cs(c)?e(c):r(c)}function s(c){return vr(c)?o(c):t(c)}function o(c){return c===59?(n.consume(c),r):vr(c)?(n.consume(c),o):t(c)}}function yR(n,e,t){return r;function r(s){return n.consume(s),l}function l(s){return fr(s)?t(s):e(s)}}function kC(n){return n===null||n===40||n===42||n===95||n===91||n===93||n===126||rn(n)}function wC(n){return!vr(n)}function SC(n){return!(n===47||M0(n))}function M0(n){return n===43||n===45||n===46||n===95||fr(n)}function Ty(n){let e=n.length,t=!1;for(;e--;){const r=n[e][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){t=!0;break}if(r._gfmAutolinkLiteralWalkedInto){t=!1;break}}return n.length>0&&!t&&(n[n.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),t}const xR={tokenize:TR,partial:!0};function vR(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:SR,continuation:{tokenize:CR},exit:AR}},text:{91:{name:"gfmFootnoteCall",tokenize:wR},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:bR,resolveTo:kR}}}}function bR(n,e,t){const r=this;let l=r.events.length;const s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;l--;){const h=r.events[l][1];if(h.type==="labelImage"){o=h;break}if(h.type==="gfmFootnoteCall"||h.type==="labelLink"||h.type==="label"||h.type==="image"||h.type==="link")break}return c;function c(h){if(!o||!o._balanced)return t(h);const d=wi(r.sliceSerialize({start:o.end,end:r.now()}));return d.codePointAt(0)!==94||!s.includes(d.slice(1))?t(h):(n.enter("gfmFootnoteCallLabelMarker"),n.consume(h),n.exit("gfmFootnoteCallLabelMarker"),e(h))}}function kR(n,e){let t=n.length;for(;t--;)if(n[t][1].type==="labelImage"&&n[t][0]==="enter"){n[t][1];break}n[t+1][1].type="data",n[t+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},n[t+3][1].start),end:Object.assign({},n[n.length-1][1].end)},l={type:"gfmFootnoteCallMarker",start:Object.assign({},n[t+3][1].end),end:Object.assign({},n[t+3][1].end)};l.end.column++,l.end.offset++,l.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},l.end),end:Object.assign({},n[n.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},c=[n[t+1],n[t+2],["enter",r,e],n[t+3],n[t+4],["enter",l,e],["exit",l,e],["enter",s,e],["enter",o,e],["exit",o,e],["exit",s,e],n[n.length-2],n[n.length-1],["exit",r,e]];return n.splice(t,n.length-t+1,...c),n}function wR(n,e,t){const r=this,l=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s=0,o;return c;function c(g){return n.enter("gfmFootnoteCall"),n.enter("gfmFootnoteCallLabelMarker"),n.consume(g),n.exit("gfmFootnoteCallLabelMarker"),h}function h(g){return g!==94?t(g):(n.enter("gfmFootnoteCallMarker"),n.consume(g),n.exit("gfmFootnoteCallMarker"),n.enter("gfmFootnoteCallString"),n.enter("chunkString").contentType="string",d)}function d(g){if(s>999||g===93&&!o||g===null||g===91||rn(g))return t(g);if(g===93){n.exit("chunkString");const b=n.exit("gfmFootnoteCallString");return l.includes(wi(r.sliceSerialize(b)))?(n.enter("gfmFootnoteCallLabelMarker"),n.consume(g),n.exit("gfmFootnoteCallLabelMarker"),n.exit("gfmFootnoteCall"),e):t(g)}return rn(g)||(o=!0),s++,n.consume(g),g===92?p:d}function p(g){return g===91||g===92||g===93?(n.consume(g),s++,d):d(g)}}function SR(n,e,t){const r=this,l=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s,o=0,c;return h;function h(T){return n.enter("gfmFootnoteDefinition")._container=!0,n.enter("gfmFootnoteDefinitionLabel"),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(T),n.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(T){return T===94?(n.enter("gfmFootnoteDefinitionMarker"),n.consume(T),n.exit("gfmFootnoteDefinitionMarker"),n.enter("gfmFootnoteDefinitionLabelString"),n.enter("chunkString").contentType="string",p):t(T)}function p(T){if(o>999||T===93&&!c||T===null||T===91||rn(T))return t(T);if(T===93){n.exit("chunkString");const N=n.exit("gfmFootnoteDefinitionLabelString");return s=wi(r.sliceSerialize(N)),n.enter("gfmFootnoteDefinitionLabelMarker"),n.consume(T),n.exit("gfmFootnoteDefinitionLabelMarker"),n.exit("gfmFootnoteDefinitionLabel"),b}return rn(T)||(c=!0),o++,n.consume(T),T===92?g:p}function g(T){return T===91||T===92||T===93?(n.consume(T),o++,p):p(T)}function b(T){return T===58?(n.enter("definitionMarker"),n.consume(T),n.exit("definitionMarker"),l.includes(s)||l.push(s),jt(n,w,"gfmFootnoteDefinitionWhitespace")):t(T)}function w(T){return e(T)}}function CR(n,e,t){return n.check(Gc,e,n.attempt(xR,e,t))}function AR(n){n.exit("gfmFootnoteDefinition")}function TR(n,e,t){const r=this;return jt(n,l,"gfmFootnoteDefinitionIndent",5);function l(s){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?e(s):t(s)}}function ER(n){let t=(n||{}).singleTilde;const r={name:"strikethrough",tokenize:s,resolveAll:l};return t==null&&(t=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function l(o,c){let h=-1;for(;++h<o.length;)if(o[h][0]==="enter"&&o[h][1].type==="strikethroughSequenceTemporary"&&o[h][1]._close){let d=h;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[h][1].end.offset-o[h][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[h][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const p={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[h][1].end)},g={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[h][1].start)},b=[["enter",p,c],["enter",o[d][1],c],["exit",o[d][1],c],["enter",g,c]],w=c.parser.constructs.insideSpan.null;w&&Kr(b,b.length,0,zd(w,o.slice(d+1,h),c)),Kr(b,b.length,0,[["exit",g,c],["enter",o[h][1],c],["exit",o[h][1],c],["exit",p,c]]),Kr(o,d-1,h-d+3,b),h=d+b.length-2;break}}for(h=-1;++h<o.length;)o[h][1].type==="strikethroughSequenceTemporary"&&(o[h][1].type="data");return o}function s(o,c,h){const d=this.previous,p=this.events;let g=0;return b;function b(T){return d===126&&p[p.length-1][1].type!=="characterEscape"?h(T):(o.enter("strikethroughSequenceTemporary"),w(T))}function w(T){const N=Yo(d);if(T===126)return g>1?h(T):(o.consume(T),g++,w);if(g<2&&!t)return h(T);const D=o.exit("strikethroughSequenceTemporary"),j=Yo(T);return D._open=!j||j===2&&!!N,D._close=!N||N===2&&!!j,c(T)}}}class NR{constructor(){this.map=[]}add(e,t,r){MR(this,e,t,r)}consume(e){if(this.map.sort(function(s,o){return s[0]-o[0]}),this.map.length===0)return;let t=this.map.length;const r=[];for(;t>0;)t-=1,r.push(e.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),e.length=this.map[t][0];r.push(e.slice()),e.length=0;let l=r.pop();for(;l;){for(const s of l)e.push(s);l=r.pop()}this.map.length=0}}function MR(n,e,t,r){let l=0;if(!(t===0&&r.length===0)){for(;l<n.map.length;){if(n.map[l][0]===e){n.map[l][1]+=t,n.map[l][2].push(...r);return}l+=1}n.map.push([e,t,r])}}function _R(n,e){let t=!1;const r=[];for(;e<n.length;){const l=n[e];if(t){if(l[0]==="enter")l[1].type==="tableContent"&&r.push(n[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(l[1].type==="tableContent"){if(n[e-1][1].type==="tableDelimiterMarker"){const s=r.length-1;r[s]=r[s]==="left"?"center":"right"}}else if(l[1].type==="tableDelimiterRow")break}else l[0]==="enter"&&l[1].type==="tableDelimiterRow"&&(t=!0);e+=1}return r}function DR(){return{flow:{null:{name:"table",tokenize:jR,resolveAll:OR}}}}function jR(n,e,t){const r=this;let l=0,s=0,o;return c;function c(P){let pe=r.events.length-1;for(;pe>-1;){const ke=r.events[pe][1].type;if(ke==="lineEnding"||ke==="linePrefix")pe--;else break}const fe=pe>-1?r.events[pe][1].type:null,De=fe==="tableHead"||fe==="tableRow"?z:h;return De===z&&r.parser.lazy[r.now().line]?t(P):De(P)}function h(P){return n.enter("tableHead"),n.enter("tableRow"),d(P)}function d(P){return P===124||(o=!0,s+=1),p(P)}function p(P){return P===null?t(P):ot(P)?s>1?(s=0,r.interrupt=!0,n.exit("tableRow"),n.enter("lineEnding"),n.consume(P),n.exit("lineEnding"),w):t(P):At(P)?jt(n,p,"whitespace")(P):(s+=1,o&&(o=!1,l+=1),P===124?(n.enter("tableCellDivider"),n.consume(P),n.exit("tableCellDivider"),o=!0,p):(n.enter("data"),g(P)))}function g(P){return P===null||P===124||rn(P)?(n.exit("data"),p(P)):(n.consume(P),P===92?b:g)}function b(P){return P===92||P===124?(n.consume(P),g):g(P)}function w(P){return r.interrupt=!1,r.parser.lazy[r.now().line]?t(P):(n.enter("tableDelimiterRow"),o=!1,At(P)?jt(n,T,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(P):T(P))}function T(P){return P===45||P===58?D(P):P===124?(o=!0,n.enter("tableCellDivider"),n.consume(P),n.exit("tableCellDivider"),N):F(P)}function N(P){return At(P)?jt(n,D,"whitespace")(P):D(P)}function D(P){return P===58?(s+=1,o=!0,n.enter("tableDelimiterMarker"),n.consume(P),n.exit("tableDelimiterMarker"),j):P===45?(s+=1,j(P)):P===null||ot(P)?ce(P):F(P)}function j(P){return P===45?(n.enter("tableDelimiterFiller"),U(P)):F(P)}function U(P){return P===45?(n.consume(P),U):P===58?(o=!0,n.exit("tableDelimiterFiller"),n.enter("tableDelimiterMarker"),n.consume(P),n.exit("tableDelimiterMarker"),I):(n.exit("tableDelimiterFiller"),I(P))}function I(P){return At(P)?jt(n,ce,"whitespace")(P):ce(P)}function ce(P){return P===124?T(P):P===null||ot(P)?!o||l!==s?F(P):(n.exit("tableDelimiterRow"),n.exit("tableHead"),e(P)):F(P)}function F(P){return t(P)}function z(P){return n.enter("tableRow"),ee(P)}function ee(P){return P===124?(n.enter("tableCellDivider"),n.consume(P),n.exit("tableCellDivider"),ee):P===null||ot(P)?(n.exit("tableRow"),e(P)):At(P)?jt(n,ee,"whitespace")(P):(n.enter("data"),ye(P))}function ye(P){return P===null||P===124||rn(P)?(n.exit("data"),ee(P)):(n.consume(P),P===92?Ce:ye)}function Ce(P){return P===92||P===124?(n.consume(P),ye):ye(P)}}function OR(n,e){let t=-1,r=!0,l=0,s=[0,0,0,0],o=[0,0,0,0],c=!1,h=0,d,p,g;const b=new NR;for(;++t<n.length;){const w=n[t],T=w[1];w[0]==="enter"?T.type==="tableHead"?(c=!1,h!==0&&(Uk(b,e,h,d,p),p=void 0,h=0),d={type:"table",start:Object.assign({},T.start),end:Object.assign({},T.end)},b.add(t,0,[["enter",d,e]])):T.type==="tableRow"||T.type==="tableDelimiterRow"?(r=!0,g=void 0,s=[0,0,0,0],o=[0,t+1,0,0],c&&(c=!1,p={type:"tableBody",start:Object.assign({},T.start),end:Object.assign({},T.end)},b.add(t,0,[["enter",p,e]])),l=T.type==="tableDelimiterRow"?2:p?3:1):l&&(T.type==="data"||T.type==="tableDelimiterMarker"||T.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(s[1]!==0&&(o[0]=o[1],g=_f(b,e,s,l,void 0,g),s=[0,0,0,0]),o[2]=t)):T.type==="tableCellDivider"&&(r?r=!1:(s[1]!==0&&(o[0]=o[1],g=_f(b,e,s,l,void 0,g)),s=o,o=[s[1],t,0,0])):T.type==="tableHead"?(c=!0,h=t):T.type==="tableRow"||T.type==="tableDelimiterRow"?(h=t,s[1]!==0?(o[0]=o[1],g=_f(b,e,s,l,t,g)):o[1]!==0&&(g=_f(b,e,o,l,t,g)),l=0):l&&(T.type==="data"||T.type==="tableDelimiterMarker"||T.type==="tableDelimiterFiller")&&(o[3]=t)}for(h!==0&&Uk(b,e,h,d,p),b.consume(e.events),t=-1;++t<e.events.length;){const w=e.events[t];w[0]==="enter"&&w[1].type==="table"&&(w[1]._align=_R(e.events,t))}return n}function _f(n,e,t,r,l,s){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",c="tableContent";t[0]!==0&&(s.end=Object.assign({},Co(e.events,t[0])),n.add(t[0],0,[["exit",s,e]]));const h=Co(e.events,t[1]);if(s={type:o,start:Object.assign({},h),end:Object.assign({},h)},n.add(t[1],0,[["enter",s,e]]),t[2]!==0){const d=Co(e.events,t[2]),p=Co(e.events,t[3]),g={type:c,start:Object.assign({},d),end:Object.assign({},p)};if(n.add(t[2],0,[["enter",g,e]]),r!==2){const b=e.events[t[2]],w=e.events[t[3]];if(b[1].end=Object.assign({},w[1].end),b[1].type="chunkText",b[1].contentType="text",t[3]>t[2]+1){const T=t[2]+1,N=t[3]-t[2]-1;n.add(T,N,[])}}n.add(t[3]+1,0,[["exit",g,e]])}return l!==void 0&&(s.end=Object.assign({},Co(e.events,l)),n.add(l,0,[["exit",s,e]]),s=void 0),s}function Uk(n,e,t,r,l){const s=[],o=Co(e.events,t);l&&(l.end=Object.assign({},o),s.push(["exit",l,e])),r.end=Object.assign({},o),s.push(["exit",r,e]),n.add(t+1,0,s)}function Co(n,e){const t=n[e],r=t[0]==="enter"?"start":"end";return t[1][r]}const RR={name:"tasklistCheck",tokenize:LR};function BR(){return{text:{91:RR}}}function LR(n,e,t){const r=this;return l;function l(h){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?t(h):(n.enter("taskListCheck"),n.enter("taskListCheckMarker"),n.consume(h),n.exit("taskListCheckMarker"),s)}function s(h){return rn(h)?(n.enter("taskListCheckValueUnchecked"),n.consume(h),n.exit("taskListCheckValueUnchecked"),o):h===88||h===120?(n.enter("taskListCheckValueChecked"),n.consume(h),n.exit("taskListCheckValueChecked"),o):t(h)}function o(h){return h===93?(n.enter("taskListCheckMarker"),n.consume(h),n.exit("taskListCheckMarker"),n.exit("taskListCheck"),c):t(h)}function c(h){return ot(h)?e(h):At(h)?n.check({tokenize:zR},e,t)(h):t(h)}}function zR(n,e,t){return jt(n,r,"whitespace");function r(l){return l===null?t(l):e(l)}}function IR(n){return R2([uR(),vR(),ER(n),DR(),BR()])}const PR={};function _0(n){const e=this,t=n||PR,r=e.data(),l=r.micromarkExtensions||(r.micromarkExtensions=[]),s=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);l.push(IR(t)),s.push(lR()),o.push(aR(t))}function HR({content:n,isStreaming:e,showCursor:t=!1,className:r="",renderMarkdown:l=!1,components:s={}}){const[o,c]=$.useState({previous:"",new:n,key:0}),h=$.useRef(n),d=$.useRef(0);$.useEffect(()=>{const g=h.current;if(n!==g){const b=n.startsWith(g);if(e&&b&&g.length>0){const w=n.slice(g.length);d.current+=1,c({previous:g,new:w,key:d.current})}else c({previous:"",new:n,key:d.current});h.current=n}},[n,e]),$.useEffect(()=>{e&&(h.current="",c({previous:"",new:n,key:d.current}))},[e,n]);const p=t&&e?k.jsx("span",{className:"inline-block w-2 h-4 ml-1 bg-vault-600 animate-pulse"}):null;return l?k.jsxs("div",{className:r,children:[o.previous&&k.jsx(N0,{remarkPlugins:[_0],components:s,children:o.previous}),o.new&&k.jsx("span",{className:"animate-fade-in-fast",children:k.jsx(N0,{remarkPlugins:[_0],components:s,children:o.new})},o.key),p]}):k.jsxs("span",{className:r,children:[o.previous,o.new&&k.jsx("span",{className:"animate-fade-in-fast",children:o.new},o.key),p]})}function qR({content:n,isStreaming:e,showCursor:t=!1,className:r=""}){const l={code({className:s,children:o,...c}){const h=!s?.includes("language-");return k.jsx("code",{className:`${s||""} ${h?"bg-vault-100 dark:bg-vault-700 px-1 py-0.5 rounded text-vault-800 dark:text-vault-200":"block bg-vault-900 text-vault-100 p-3 rounded-lg overflow-x-auto"} font-mono text-sm`,...c,children:o})},pre({children:s}){return k.jsx("pre",{className:"bg-vault-900 text-vault-100 p-3 rounded-lg overflow-x-auto my-2",children:s})},a({href:s,children:o,...c}){return k.jsx("a",{href:s,className:"text-vault-600 dark:text-vault-400 hover:underline",target:"_blank",rel:"noopener noreferrer",...c,children:o})},ul({children:s}){return k.jsx("ul",{className:"list-disc pl-5 my-2",children:s})},ol({children:s}){return k.jsx("ol",{className:"list-decimal pl-5 my-2",children:s})},blockquote({children:s}){return k.jsx("blockquote",{className:"border-l-4 border-vault-300 dark:border-vault-600 pl-4 italic my-2 text-vault-600 dark:text-vault-400",children:s})},hr(){return k.jsx("hr",{className:"border-vault-200 dark:border-vault-700 my-4"})},h1({children:s}){return k.jsx("h1",{className:"text-lg font-bold my-3",children:s})},h2({children:s}){return k.jsx("h2",{className:"text-base font-bold my-2",children:s})},h3({children:s}){return k.jsx("h3",{className:"text-sm font-bold my-2",children:s})},p({children:s}){return k.jsx("p",{className:"my-1.5",children:s})},table({children:s}){return k.jsx("div",{className:"overflow-x-auto my-4 rounded-lg border border-vault-200 dark:border-vault-700",children:k.jsx("table",{className:"min-w-full divide-y divide-vault-200 dark:divide-vault-700",children:s})})},thead({children:s}){return k.jsx("thead",{className:"bg-vault-100 dark:bg-vault-800",children:s})},tbody({children:s}){return k.jsx("tbody",{className:"divide-y divide-vault-200 dark:divide-vault-700",children:s})},tr({children:s}){return k.jsx("tr",{children:s})},th({children:s}){return k.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-vault-500 dark:text-vault-400 uppercase tracking-wider bg-vault-50 dark:bg-vault-900/50",children:s})},td({children:s}){return k.jsx("td",{className:"px-3 py-2 text-sm text-vault-700 dark:text-vault-300",children:s})}};return k.jsx(HR,{content:n,isStreaming:e,showCursor:t,className:r,renderMarkdown:!0,components:l})}function UR({contextEntryIds:n,aiConfig:e,samplerSettings:t,promptSettings:r,getContextContent:l,onClose:s,isMobile:o=!1}){const[c,h]=$.useState(!1),[d,p]=$.useState(null),[g,b]=$.useState(""),[w,T]=$.useState([]),[N,D]=$.useState([]),[j,U]=$.useState(!1),[I,ce]=$.useState(""),[F,z]=$.useState(""),ee=$.useRef(null),[ye,Ce]=$.useState([]),[P,pe]=$.useState([]),[fe,De]=$.useState(""),[ke,J]=$.useState(""),[q,le]=$.useState(!1),[Ae,Se]=$.useState(!1),B=$.useRef([]),Pe=$.useRef([]),qe=$.useRef(!1);$.useEffect(()=>{B.current=ye},[ye]),$.useEffect(()=>{Pe.current=P},[P]),$.useEffect(()=>{qe.current=Ae},[Ae]);const R=$.useRef(null),je=$.useRef(null),Ee=$.useRef(null);$.useEffect(()=>{(async()=>{if(l&&n.length>0)try{const He=await l(n);D(He)}catch(He){console.error("Failed to resolve context:",He),D([])}else D([])})()},[n,l]);const Ke=$.useRef(!1);$.useEffect(()=>{if(R.current){const Ye=R.current,He=Ye.scrollHeight-Ye.scrollTop-Ye.clientHeight<100;(j||!Ke.current&&He)&&Ye.scrollTo({top:Ye.scrollHeight,behavior:"smooth"})}},[w,c,fe,ke,j]),$.useEffect(()=>{Ae&&R.current&&R.current.scrollTo({top:R.current.scrollHeight,behavior:"smooth"})},[Ae]),$.useEffect(()=>{const Ye=R.current;if(!Ye)return;const He=()=>{const at=Ye.scrollHeight-Ye.scrollTop-Ye.clientHeight<100;Ke.current=!at};return Ye.addEventListener("scroll",He),()=>Ye.removeEventListener("scroll",He)},[]),$.useEffect(()=>{ee.current&&ke&&ee.current.scrollTo({top:ee.current.scrollHeight,behavior:"smooth"})},[ke]),$.useEffect(()=>{if(!j&&B.current.length===0&&Pe.current.length===0){le(!1);return}(B.current.length>0||Pe.current.length>0)&&!q&&le(!0);const Ye=setInterval(()=>{if(Pe.current.length>0){const He=Pe.current[0],at=Pe.current.slice(1);Pe.current=at,pe(at),J(be=>be+He)}if(qe.current&&B.current.length>0){const He=B.current[0],at=B.current.slice(1);B.current=at,Ce(at),De(be=>be+He)}!j&&B.current.length===0&&Pe.current.length===0&&le(!1)},30);return()=>clearInterval(Ye)},[j]),$.useEffect(()=>{j&&(De(""),J(""),Ce([]),pe([]),Se(!1),B.current=[],Pe.current=[],qe.current=!1)},[j]);const $e=Zi.useMemo(()=>typeof e.modelId=="string"&&e.modelId.trim().length>0,[e.modelId]),ft=()=>`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,et=$.useCallback(async()=>{if(w.length===0)return;if(!$e){p("Please configure AI settings first");return}const Ye=w.map((be,Ge)=>({...be,originalIndex:Ge})).reverse().find(be=>be.role==="user");if(!Ye)return;const He=w.slice(0,Ye.originalIndex+1),at=Ye.content;T(He),h(!0),p(null),await new Promise(be=>setTimeout(be,600)),U(e.enableStreaming),ce(""),z(""),De(""),J("");try{const be=new Nt(e,t,r);Ee.current=be;const Ge=He.map(ue=>({role:ue.role,content:ue.content})),zt=[];N.length>0&&zt.push(...N);const Jt=e.enableStreaming?ue=>{if(ue.reasoning){const Ne=[...Pe.current,ue.reasoning];Pe.current=Ne,pe(Ne),z(rt=>rt+ue.reasoning)}if(ue.content){!ue.reasoning&&Pe.current.length===0&&!qe.current&&(qe.current=!0,Se(!0));const Ne=[...B.current,ue.content];B.current=Ne,Ce(Ne),ce(rt=>rt+ue.content)}}:void 0,Yt=await be.askAIWithConversation(at,zt,Ge,void 0,Jt),vt={id:ft(),role:"assistant",content:Yt.content,reasoning:Yt.reasoning,timestamp:Date.now()};T(ue=>[...ue,vt])}catch(be){be instanceof An&&be.message==="Request was cancelled"?console.log("[AIChatPanel] AI request cancelled by user"):(console.error("AI regenerate failed:",be),be instanceof An?p(be.message):p("Failed to get AI response. Please try again."))}finally{if((ke||Pe.current.length>0)&&(qe.current=!0,Se(!0)),Pe.current.length>0){const be=Pe.current.join("");J(Ge=>Ge+be),Pe.current=[],pe([])}if(B.current.length>0){const be=B.current.join("");De(Ge=>Ge+be),B.current=[],Ce([])}De(be=>be.length<I.length?I:be),J(be=>be.length<F.length?F:be),le(!1),h(!1),U(!1),ce(""),z(""),Ee.current=null}},[w,N,e,t,r,$e,ke,I,F]),ve=$.useCallback(async()=>{if(!g.trim()){if(w[w.length-1]?.role==="user"){await et();return}return}if(!$e){p("Please configure AI settings first");return}const Ye=g.trim(),He={id:ft(),role:"user",content:Ye,timestamp:Date.now()};T(at=>[...at,He]),b(""),h(!0),p(null),await new Promise(at=>setTimeout(at,600)),U(e.enableStreaming),ce(""),z(""),De(""),J("");try{const at=new Nt(e,t,r);Ee.current=at;const be=w.map(vt=>({role:vt.role,content:vt.content})),Ge=[];N.length>0&&Ge.push(...N);const zt=e.enableStreaming?vt=>{if(vt.reasoning){const ue=[...Pe.current,vt.reasoning];Pe.current=ue,pe(ue),z(Ne=>Ne+vt.reasoning)}if(vt.content){!vt.reasoning&&Pe.current.length===0&&!qe.current&&(qe.current=!0,Se(!0));const ue=[...B.current,vt.content];B.current=ue,Ce(ue),ce(Ne=>Ne+vt.content)}}:void 0,Jt=await at.askAIWithConversation(Ye,Ge,be,void 0,zt),Yt={id:ft(),role:"assistant",content:Jt.content,reasoning:Jt.reasoning,timestamp:Date.now()};T(vt=>[...vt,Yt])}catch(at){at instanceof An&&at.message==="Request was cancelled"?console.log("[AIChatPanel] AI request cancelled by user"):(console.error("AI ask failed:",at),at instanceof An?p(at.message):p("Failed to get AI response. Please try again."))}finally{if((ke||Pe.current.length>0)&&(qe.current=!0,Se(!0)),Pe.current.length>0){const Ge=Pe.current.join("");J(zt=>zt+Ge),Pe.current=[],pe([])}if(B.current.length>0){const Ge=B.current.join("");De(zt=>zt+Ge),B.current=[],Ce([])}De(Ge=>Ge.length<I.length?I:Ge),J(Ge=>Ge.length<F.length?F:Ge);const at=w[w.length-1];if(j&&at?.role==="user"&&(fe||ke)){const Ge={id:ft(),role:"assistant",content:fe||I,reasoning:ke||F,timestamp:Date.now()};T(zt=>[...zt,Ge])}le(!1),h(!1),U(!1),ce(""),z(""),Ee.current=null}},[g,N,e,t,r,$e,w,et]),gt=$.useCallback(()=>{T([])},[]),nt=$.useCallback(()=>{Ee.current&&Ee.current.abort()},[]),Gt=Ye=>new Date(Ye).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),yn=({reasoning:Ye,defaultExpanded:He=!1})=>{const[at,be]=$.useState(He),Ge=$.useRef(null);return $.useEffect(()=>{Ge.current&&Ye&&(Ge.current.scrollTop=Ge.current.scrollHeight)},[Ye]),!Ye||Ye.trim().length===0?null:k.jsxs("div",{className:"mb-2 border border-vault-300 dark:border-vault-600 rounded-md overflow-hidden",children:[k.jsxs("button",{onClick:()=>be(!at),className:"w-full flex items-center justify-between px-2 py-1.5 bg-vault-100 dark:bg-vault-700/50 hover:bg-vault-200 dark:hover:bg-vault-700 transition-colors text-left",children:[k.jsxs("span",{className:"text-xs font-medium text-vault-600 dark:text-vault-400 flex items-center gap-1",children:[k.jsx(jl,{className:"w-3 h-3"}),"Thinking process"]}),k.jsx("span",{className:"text-xs text-vault-500 dark:text-vault-500",children:at?"Hide":"Show"})]}),at&&k.jsx("div",{ref:Ge,className:"max-h-40 overflow-y-auto px-2 py-2 bg-vault-50 dark:bg-vault-800/50 border-t border-vault-200 dark:border-vault-700",children:k.jsx("pre",{className:"text-xs font-mono text-vault-700 dark:text-vault-300 whitespace-pre-wrap wrap-break-word leading-relaxed",children:Ye})})]})},wt=({content:Ye})=>{const[He,at]=$.useState(!1),be=async()=>{try{await navigator.clipboard.writeText(Ye),at(!0),setTimeout(()=>at(!1),2e3)}catch(Ge){console.error("Failed to copy:",Ge)}};return k.jsx("button",{onClick:be,className:"p-1.5 rounded-md text-vault-400 hover:text-vault-600 dark:hover:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-700/50 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100",title:He?"Copied!":"Copy to clipboard",children:He?k.jsx(Wk,{className:"w-3.5 h-3.5 text-green-500"}):k.jsx(j0,{className:"w-3.5 h-3.5"})})},dn=({messageIndex:Ye})=>Ye===w.length-1?k.jsx("button",{onClick:()=>{et()},disabled:c,className:"p-1.5 rounded-md text-vault-400 hover:text-vault-600 dark:hover:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-700/50 transition-all opacity-0 group-hover:opacity-100 focus:opacity-100 disabled:opacity-50",title:"Regenerate response",children:k.jsx(_T,{className:"w-3.5 h-3.5"})}):null;return k.jsxs("div",{className:"h-full flex flex-col bg-vault-50 dark:bg-vault-900 border-l border-vault-200 dark:border-vault-800 animate-fade-in-slow",children:[k.jsx("style",{children:`
        @keyframes message-appear {
          0% {
            opacity: 0;
            transform: translateY(8px) scale(0.98);
          }
          100% {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }
        .message-animate {
          animation: message-appear 0.25s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
      `}),k.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-vault-200 dark:border-vault-800 bg-vault-100 dark:bg-vault-800/50 shrink-0",children:[k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx(_o,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),k.jsx("h2",{className:"font-semibold text-vault-900 dark:text-vault-100",children:"Ask Zoggy"})]}),k.jsxs("div",{className:"flex items-center gap-1",children:[w.length>0&&k.jsx("button",{onClick:gt,className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-800 rounded-lg transition-colors",title:"New Chat",children:k.jsx(Xo,{className:"w-4 h-4"})}),o&&s&&k.jsx("button",{onClick:s,className:"p-1.5 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-200 dark:hover:bg-vault-800 rounded-lg transition-colors ml-1",title:"Close AI Chat Panel",children:k.jsx(vs,{className:"w-4 h-4"})})]})]}),d&&k.jsxs("div",{className:"mx-3 mt-3 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg flex items-start gap-2 text-red-600 dark:text-red-400 text-sm shrink-0",children:[k.jsx(Aa,{className:"w-4 h-4 shrink-0 mt-0.5"}),k.jsx("span",{className:"flex-1",children:d}),k.jsx("button",{onClick:()=>p(null),className:"p-0.5 text-red-400 hover:text-red-600 dark:hover:text-red-300",children:k.jsx(vs,{className:"w-3.5 h-3.5"})})]}),k.jsx("div",{className:"border-b border-vault-200 dark:border-vault-800 flex-1 flex flex-col min-h-0",children:k.jsxs("div",{ref:R,className:"px-4 pt-2 pb-4 space-y-4 overflow-y-auto flex-1 min-h-0",children:[w.length===0&&k.jsxs("div",{className:"text-center py-8 text-vault-400 dark:text-vault-500",children:[k.jsx(_o,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),k.jsx("p",{className:"text-sm",children:"Hi, I'm Zoggy!"}),k.jsx("p",{className:"text-xs mt-1",children:"Ask me anything about your character card, or just chat with me! Don't forget to add your context!"})]}),w.map(Ye=>k.jsx("div",{className:`flex ${Ye.role==="user"?"justify-end":"justify-start"}`,children:k.jsxs("div",{className:`relative max-w-[90%] rounded-lg px-3 py-2 group message-animate ${Ye.role==="user"?"bg-vault-600 text-white rounded-br-none":"bg-white dark:bg-vault-800 border border-vault-200 dark:border-vault-700 text-vault-900 dark:text-vault-100 rounded-bl-none"}`,children:[Ye.role==="user"?k.jsx("p",{className:"text-sm whitespace-pre-wrap",children:Ye.content}):k.jsxs("div",{className:"text-sm prose prose-sm dark:prose-invert max-w-none pb-6",children:[Ye.reasoning&&e.showReasoning!==!1&&k.jsx(yn,{reasoning:Ye.reasoning}),k.jsx(N0,{remarkPlugins:[_0],components:{code({className:He,children:at,...be}){const Ge=!He?.includes("language-");return k.jsx("code",{className:`${He||""} ${Ge?"bg-vault-100 dark:bg-vault-700 px-1 py-0.5 rounded text-vault-800 dark:text-vault-200":"block bg-vault-900 text-vault-100 p-3 rounded-lg overflow-x-auto"} font-mono text-sm`,...be,children:at})},pre({children:He}){return k.jsx("pre",{className:"bg-vault-900 text-vault-100 p-3 rounded-lg overflow-x-auto my-2",children:He})},a({href:He,children:at,...be}){return k.jsx("a",{href:He,className:"text-vault-600 dark:text-vault-400 hover:underline",target:"_blank",rel:"noopener noreferrer",...be,children:at})},ul({children:He}){return k.jsx("ul",{className:"list-disc pl-5 my-2",children:He})},ol({children:He}){return k.jsx("ol",{className:"list-decimal pl-5 my-2",children:He})},blockquote({children:He}){return k.jsx("blockquote",{className:"border-l-4 border-vault-300 dark:border-vault-600 pl-4 italic my-2 text-vault-600 dark:text-vault-400",children:He})},hr(){return k.jsx("hr",{className:"border-vault-200 dark:border-vault-700 my-4"})},h1({children:He}){return k.jsx("h1",{className:"text-lg font-bold my-3",children:He})},h2({children:He}){return k.jsx("h2",{className:"text-base font-bold my-2",children:He})},h3({children:He}){return k.jsx("h3",{className:"text-sm font-bold my-2",children:He})},p({children:He}){return k.jsx("p",{className:"my-1.5",children:He})},table({children:He}){return k.jsx("div",{className:"overflow-x-auto my-4 rounded-lg border border-vault-200 dark:border-vault-700",children:k.jsx("table",{className:"min-w-full divide-y divide-vault-200 dark:divide-vault-700",children:He})})},thead({children:He}){return k.jsx("thead",{className:"bg-vault-100 dark:bg-vault-800",children:He})},tbody({children:He}){return k.jsx("tbody",{className:"divide-y divide-vault-200 dark:divide-vault-700",children:He})},tr({children:He}){return k.jsx("tr",{children:He})},th({children:He}){return k.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-vault-500 dark:text-vault-400 uppercase tracking-wider bg-vault-50 dark:bg-vault-900/50",children:He})},td({children:He}){return k.jsx("td",{className:"px-3 py-2 text-sm text-vault-700 dark:text-vault-300",children:He})}},children:Ye.content}),k.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-1",children:[k.jsx(wt,{content:Ye.content}),k.jsx(dn,{messageIndex:w.findIndex(He=>He.id===Ye.id)})]})]}),k.jsx("span",{className:`text-xs mt-1 block ${Ye.role==="user"?"text-vault-200":"text-vault-500 dark:text-vault-400"}`,children:Gt(Ye.timestamp)})]})},Ye.id)),j&&(fe||ke)&&k.jsx("div",{className:"flex justify-start",children:k.jsxs("div",{className:"max-w-[90%] bg-white dark:bg-vault-800 border border-vault-200 dark:border-vault-700 rounded-lg rounded-bl-none px-3 py-2 message-animate",children:[ke&&e.showReasoning!==!1&&k.jsxs("div",{className:"mb-2 border border-vault-300 dark:border-vault-600 rounded-md overflow-hidden",children:[k.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5 bg-vault-100 dark:bg-vault-700/50",children:[k.jsxs("span",{className:"text-xs font-medium text-vault-600 dark:text-vault-400 flex items-center gap-1",children:[k.jsx(jl,{className:"w-3 h-3"}),"Thinking process"]}),k.jsx("span",{className:"text-xs text-vault-500 dark:text-vault-500",children:"Streaming..."})]}),k.jsx("div",{ref:ee,className:"max-h-40 overflow-y-auto px-2 py-2 bg-vault-50 dark:bg-vault-800/50 border-t border-vault-200 dark:border-vault-700",children:k.jsx("pre",{className:"text-xs font-mono text-vault-700 dark:text-vault-300 whitespace-pre-wrap wrap-break-word leading-relaxed",children:ke})})]}),fe&&k.jsx("div",{className:"text-sm prose prose-sm dark:prose-invert max-w-none text-vault-900 dark:text-vault-100",children:k.jsx(qR,{content:fe,isStreaming:q,showCursor:!0})})]})}),c&&(!j||!fe&&!ke)&&k.jsx("div",{className:"flex justify-start",children:k.jsxs("div",{className:"bg-white dark:bg-vault-800 border border-vault-200 dark:border-vault-700 rounded-lg rounded-bl-none px-3 py-2 flex items-center gap-2 message-animate",children:[k.jsx(Uf,{className:"w-4 h-4 animate-spin text-vault-600 dark:text-vault-400"}),k.jsx("span",{className:"text-sm text-vault-600 dark:text-vault-400",children:"AI is thinking..."})]})})]})}),k.jsx("div",{className:"p-3 space-y-3 bg-vault-100 dark:bg-vault-800/50 shrink-0",children:k.jsxs("div",{className:"flex gap-2",children:[k.jsx("input",{ref:je,type:"text",value:g,onChange:Ye=>b(Ye.target.value),placeholder:"Ask a question...",className:"flex-1 px-3 py-2 text-sm border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-700 text-vault-900 dark:text-vault-100 placeholder-vault-400 focus:outline-none focus:ring-2 focus:ring-vault-500",onKeyDown:Ye=>{Ye.key==="Enter"&&!c&&g.trim()&&ve()},disabled:c}),k.jsx("button",{onClick:()=>{c?nt():ve()},disabled:!c&&!g.trim()&&(!w.length||w[w.length-1]?.role!=="user"),className:`px-3 py-2 text-white text-sm rounded-lg transition-colors flex items-center gap-1.5 ${c?"bg-red-600 hover:bg-red-700":"bg-vault-600 hover:bg-vault-700 disabled:opacity-50"}`,children:c?k.jsx(VT,{className:"w-4 h-4"}):k.jsx(jl,{className:"w-4 h-4"})})]})})]})}const ko=({id:n,label:e,icon:t,value:r,min:l,max:s,step:o,onChange:c,formatValue:h=g=>g.toString(),showWarning:d=!1,warningMessage:p=""})=>{const g=(r-l)/(s-l)*100;return k.jsxs("div",{className:"space-y-2",children:[k.jsxs("label",{htmlFor:n,className:"flex items-center gap-2 text-sm font-medium text-vault-700 dark:text-vault-300",children:[k.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:t}),e]}),k.jsxs("div",{className:"relative",children:[k.jsx("input",{id:n,type:"range",min:l,max:s,step:o,value:r,onChange:b=>c(parseFloat(b.target.value)),className:"w-full h-2 bg-vault-200 dark:bg-vault-700 rounded-lg appearance-none cursor-pointer accent-vault-600 dark:accent-vault-400 focus:outline-none focus:ring-2 focus:ring-vault-500/50",style:{background:`linear-gradient(to right, var(--color-vault-600) 0%, var(--color-vault-600) ${g}%, var(--color-vault-200) ${g}%, var(--color-vault-200) 100%)`}}),k.jsxs("div",{className:"flex justify-between items-center mt-1.5",children:[k.jsx("span",{className:"text-xs text-vault-500",children:h(l)}),k.jsx("span",{className:`text-sm font-semibold ${d?"text-amber-600 dark:text-amber-400":"text-vault-700 dark:text-vault-300"}`,children:h(r)}),k.jsx("span",{className:"text-xs text-vault-500",children:h(s)})]}),d&&p&&k.jsxs("div",{className:"mt-2 flex items-center gap-1.5 text-xs text-amber-600 dark:text-amber-400",children:[k.jsx(Aa,{className:"w-3.5 h-3.5"}),k.jsx("span",{children:p})]})]})]})},FR=({settings:n,onChange:e})=>{const t=l=>{e({...n,...{creative:{temperature:.9,minP:.05,topK:50,repetitionPenalty:1.05,topP:.95,contextLength:4096,maxTokens:2048},balanced:{temperature:.7,minP:.05,topK:40,repetitionPenalty:1.1,topP:1,contextLength:4096,maxTokens:2048},factual:{temperature:.3,minP:.1,topK:20,repetitionPenalty:1.2,topP:.5,contextLength:4096,maxTokens:1024}}[l]})},r=(l,s)=>{e({...n,[l]:s})};return k.jsxs("div",{className:"space-y-6",children:[k.jsxs("div",{className:"bg-linear-to-br from-vault-50 to-vault-100 dark:from-vault-800/50 dark:to-vault-800 rounded-xl p-4 border border-vault-200 dark:border-vault-700",children:[k.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[k.jsx(iw,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),k.jsx("span",{className:"text-sm font-semibold text-vault-700 dark:text-vault-300",children:"Quick Presets"})]}),k.jsx("div",{className:"flex gap-2",children:["creative","balanced","factual"].map(l=>k.jsx("button",{onClick:()=>t(l),className:"flex-1 px-3 py-2 text-sm font-medium bg-white dark:bg-vault-700 hover:bg-vault-50 dark:hover:bg-vault-600 text-vault-700 dark:text-vault-300 rounded-lg transition-all duration-200 border border-vault-200 dark:border-vault-600 hover:shadow-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50",children:k.jsx("span",{className:"capitalize",children:l})},l))})]}),k.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-4 border border-vault-200 dark:border-vault-700 shadow-sm",children:[k.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[k.jsx(tw,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),k.jsx("span",{className:"text-sm font-semibold text-vault-700 dark:text-vault-300",children:"Primary Samplers"})]}),k.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[k.jsx(ko,{id:"temperature",label:"Temperature",icon:k.jsx(tE,{className:"w-4 h-4"}),value:n.temperature,min:0,max:2,step:.1,onChange:l=>r("temperature",l),formatValue:l=>l.toFixed(1)}),k.jsx(ko,{id:"topP",label:"Top P",icon:k.jsx(vT,{className:"w-4 h-4"}),value:n.topP,min:0,max:1,step:.05,onChange:l=>r("topP",l),formatValue:l=>l.toFixed(2)}),k.jsx(ko,{id:"minP",label:"Min P",icon:k.jsx(H4,{className:"w-4 h-4"}),value:n.minP,min:0,max:1,step:.01,onChange:l=>r("minP",l),formatValue:l=>l.toFixed(2)}),k.jsx(ko,{id:"topK",label:"Top K",icon:k.jsx(W4,{className:"w-4 h-4"}),value:n.topK,min:1,max:100,step:1,onChange:l=>r("topK",l),formatValue:l=>Math.round(l).toString()})]})]}),k.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-4 border border-vault-200 dark:border-vault-700 shadow-sm",children:[k.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[k.jsx(nw,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),k.jsx("span",{className:"text-sm font-semibold text-vault-700 dark:text-vault-300",children:"Secondary Samplers"})]}),k.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[k.jsx(ko,{id:"repetitionPenalty",label:"Repetition Penalty",icon:k.jsx(ET,{className:"w-4 h-4"}),value:n.repetitionPenalty,min:1,max:2,step:.05,onChange:l=>r("repetitionPenalty",l),formatValue:l=>l.toFixed(2)}),k.jsx(ko,{id:"maxTokens",label:"Max Tokens",icon:k.jsx(U4,{className:"w-4 h-4"}),value:n.maxTokens,min:100,max:8192,step:100,onChange:l=>r("maxTokens",Math.round(l)),formatValue:l=>Math.round(l).toString()}),k.jsxs("div",{className:"sm:col-span-2",children:[k.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-vault-700 dark:text-vault-300 mb-2",children:[k.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:k.jsx(qf,{className:"w-4 h-4"})}),"Context Length"]}),k.jsxs("select",{value:n.contextLength,onChange:l=>r("contextLength",parseInt(l.target.value)),className:"w-full px-3 py-2.5 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-vault-500/50 transition-all duration-200",children:[k.jsx("option",{value:2048,children:"2K tokens"}),k.jsx("option",{value:4096,children:"4K tokens"}),k.jsx("option",{value:8192,children:"8K tokens"}),k.jsx("option",{value:16384,children:"16K tokens"}),k.jsx("option",{value:32768,children:"32K tokens"}),k.jsx("option",{value:65536,children:"64K tokens"}),k.jsx("option",{value:128e3,children:"128K tokens"})]}),k.jsx("p",{className:"mt-2 text-xs text-vault-500",children:"Maximum context window for AI requests"})]})]})]})]})},VR=({models:n,selectedModelId:e,onSelect:t,onFetch:r,isFetching:l,disabled:s=!1})=>{const[o,c]=$.useState(!1),[h,d]=$.useState(""),p=$.useRef(null),g=$.useRef(null),b=n.find(D=>D.id===e),w=n.filter(D=>D.name.toLowerCase().includes(h.toLowerCase())||D.id.toLowerCase().includes(h.toLowerCase()));$.useEffect(()=>{const D=j=>{p.current&&!p.current.contains(j.target)&&c(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]),$.useEffect(()=>{o&&g.current&&g.current.focus()},[o]);const T=D=>{t(D),c(!1),d("")},N=D=>{D.key==="Enter"&&w.length>0?T(w[0].id):D.key==="Escape"&&c(!1)};return k.jsxs("div",{className:"space-y-2",ref:p,children:[k.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-vault-800 dark:text-vault-200",children:[k.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:k.jsx($k,{className:"w-4 h-4"})}),"Model"]}),k.jsxs("div",{className:"flex gap-2",children:[k.jsxs("div",{className:"flex-1 relative",children:[k.jsxs("button",{onClick:()=>!s&&c(!o),disabled:s,className:`w-full px-3 py-2.5 border rounded-lg text-left transition-all duration-200 flex items-center justify-between ${s?"bg-vault-100 dark:bg-vault-800 text-vault-400 cursor-not-allowed border-vault-200 dark:border-vault-700":"bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 border-vault-300 dark:border-vault-600 hover:border-vault-400 dark:hover:border-vault-500 focus:outline-none focus:ring-2 focus:ring-vault-500/50"}`,children:[k.jsx("span",{className:e?"font-medium":"text-vault-400",children:b?.name||"Select or type to search models..."}),k.jsx(Ea,{className:`w-4 h-4 text-vault-400 transition-transform duration-200 ${o?"rotate-180":""}`})]}),o&&k.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-vault-800 border border-vault-300 dark:border-vault-600 rounded-lg shadow-xl z-50 max-h-64 overflow-hidden",children:[k.jsx("div",{className:"p-2 border-b border-vault-200 dark:border-vault-700",children:k.jsxs("div",{className:"relative",children:[k.jsx(Ff,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-vault-400"}),k.jsx("input",{ref:g,type:"text",value:h,onChange:D=>d(D.target.value),onKeyDown:N,placeholder:"Type to filter models...",className:"w-full pl-9 pr-3 py-2 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50"})]})}),k.jsx("div",{className:"overflow-y-auto max-h-48",children:w.length===0?k.jsxs("div",{className:"px-3 py-4 text-sm text-vault-500 text-center",children:['No models found matching "',h,'"']}):w.map(D=>k.jsxs("button",{onClick:()=>T(D.id),className:`w-full px-3 py-2 text-left text-sm transition-colors duration-150 ${D.id===e?"bg-vault-100 dark:bg-vault-700 text-vault-900 dark:text-vault-100 font-medium":"text-vault-700 dark:text-vault-300 hover:bg-vault-50 dark:hover:bg-vault-700/50"}`,children:[k.jsx("div",{className:"font-medium",children:D.name}),k.jsx("div",{className:"text-xs text-vault-500 truncate",children:D.id})]},D.id))})]})]}),k.jsxs("button",{onClick:r,disabled:l||s,className:"px-4 py-2 bg-vault-100 dark:bg-vault-800 hover:bg-vault-200 dark:hover:bg-vault-700 disabled:opacity-50 disabled:cursor-not-allowed text-vault-700 dark:text-vault-300 rounded-lg transition-all duration-200 flex items-center gap-2 font-medium focus:outline-none focus:ring-2 focus:ring-vault-500/50",children:[l?k.jsx(Uf,{className:"w-4 h-4 animate-spin"}):k.jsx(Jk,{className:"w-4 h-4"}),"Fetch"]})]})]})},KR=({toasts:n,onRemove:e})=>k.jsx("div",{className:"fixed top-4 right-4 z-100 space-y-2",children:n.map(t=>k.jsxs("div",{className:`flex items-center gap-2 px-4 py-3 rounded-lg shadow-lg transform transition-all duration-300 animate-in slide-in-from-right ${t.type==="success"?"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 text-green-700 dark:text-green-400":t.type==="error"?"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-400":"bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-800 text-amber-700 dark:text-amber-400"}`,children:[t.type==="success"?k.jsx(Wk,{className:"w-4 h-4"}):t.type==="error"?k.jsx(Aa,{className:"w-4 h-4"}):k.jsx(Aa,{className:"w-4 h-4"}),k.jsx("span",{className:"text-sm font-medium",children:t.message}),k.jsx("button",{onClick:()=>e(t.id),className:"ml-2 p-1 hover:bg-black/5 dark:hover:bg-white/10 rounded",children:k.jsx(vs,{className:"w-3 h-3"})})]},t.id))});function GR({isOpen:n,onClose:e}){const{reloadSettings:t}=bd(),[r,l]=$.useState(!1),[s,o]=$.useState(!1),[c,h]=$.useState({baseUrl:"https://nano-gpt.com/api/v1",apiKey:"",modelId:"",availableModels:[],enableStreaming:!1,enableReasoning:!1,showReasoning:!1}),[d,p]=$.useState({temperature:.7,minP:.05,topK:40,repetitionPenalty:1.1,topP:1,contextLength:4096,maxTokens:2048}),[g,b]=$.useState(tr.prompts),[w,T]=$.useState(!1),[N,D]=$.useState(!1),[j,U]=$.useState(!1),[I,ce]=$.useState([]),[F,z]=$.useState("ai"),[ee,ye]=$.useState({}),Ce=$.useRef(null),P=$.useCallback((J,q)=>{const le=Math.random().toString(36).substring(7);ce(Ae=>[...Ae,{id:le,type:J,message:q}]),setTimeout(()=>{ce(Ae=>Ae.filter(Se=>Se.id!==le))},5e3)},[]),pe=$.useCallback(J=>{ce(q=>q.filter(le=>le.id!==J))},[]);$.useEffect(()=>{if(!n)return;(async()=>{T(!0);try{const[q,le,Ae]=await Promise.all([cr.getAISettings(),cr.getSamplerSettings(),cr.getPromptSettings()]);h(Se=>({...Se,...q})),p({temperature:le?.temperature??.7,minP:le?.minP??.05,topK:le?.topK??40,repetitionPenalty:le?.repetitionPenalty??1.1,topP:le?.topP??1,contextLength:le?.contextLength??4096,maxTokens:Math.min(le?.maxTokens??2048,8192)}),b(Ae)}catch(q){console.error("Failed to load settings:",q),P("error","Failed to load settings")}finally{T(!1)}})()},[n,P]),$.useEffect(()=>{const J=q=>{if(n&&(q.key==="Escape"&&e(),q.key==="ArrowLeft"||q.key==="ArrowRight")){const le=["ai","sampler","prompts"],Ae=le.indexOf(F);let Se;q.key==="ArrowLeft"?Se=Ae>0?Ae-1:le.length-1:Se=Ae<le.length-1?Ae+1:0,z(le[Se])}};return document.addEventListener("keydown",J),()=>document.removeEventListener("keydown",J)},[n,F,e,P]),$.useEffect(()=>{if(!n||!Ce.current)return;const q=Ce.current.querySelectorAll('button, input, select, textarea, [tabindex]:not([tabindex="-1"])'),le=q[0],Ae=q[q.length-1],Se=B=>{B.key==="Tab"&&(B.shiftKey?document.activeElement===le&&(B.preventDefault(),Ae?.focus()):document.activeElement===Ae&&(B.preventDefault(),le?.focus()))};return document.addEventListener("keydown",Se),le?.focus(),()=>document.removeEventListener("keydown",Se)},[n,F]),$.useEffect(()=>{n?(o(!0),requestAnimationFrame(()=>l(!0))):(l(!1),setTimeout(()=>o(!1),300))},[n]);const fe=async()=>{U(!0);try{const q=await new Nt(c,d).fetchModels();h(le=>({...le,availableModels:q})),P("success",`Fetched ${q.length} models`)}catch(J){J instanceof An?P("error",J.message):P("error","Failed to fetch models")}finally{U(!1)}},De=()=>{const J=[];g.expand.includes("${text}")||J.push("Expand prompt must contain ${text}"),g.rewrite.includes("${text}")||J.push("Rewrite prompt must contain ${text}"),g.instruct.includes("${text}")||J.push("Instruct prompt must contain ${text}"),g.instruct.includes("${instruction}")||J.push("Instruct prompt must contain ${instruction}");const q=["shorten","lengthen","vivid","emotion","grammar"];for(const le of q)g[le].includes("${text}")||J.push(`${le.charAt(0).toUpperCase()+le.slice(1)} prompt must contain \${text}`);return J.length>0?J.join(`
`):null},ke=async()=>{D(!0);const J=De();if(J){P("error",J),D(!1);return}try{const q={...d,maxTokens:Math.min(d.maxTokens,8192)};await cr.saveAllAISettings(c,q,g),await t(),P("success","Settings saved successfully!")}catch{P("error","Failed to save settings")}finally{D(!1)}};return s?k.jsxs(k.Fragment,{children:[k.jsx(KR,{toasts:I,onRemove:pe}),k.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 transition-opacity duration-300 ${r?"opacity-100":"opacity-0"}`,children:k.jsxs("div",{ref:Ce,className:`bg-vault-50 dark:bg-vault-900 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden ring-1 ring-vault-200 dark:ring-vault-800 transition-transform duration-300 scale-100 ${r?"scale-100":"scale-95"}`,role:"dialog","aria-modal":"true","aria-labelledby":"settings-title",children:[k.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-vault-200 dark:border-vault-800 bg-white dark:bg-vault-900",children:[k.jsxs("div",{className:"flex items-center gap-3",children:[k.jsx("div",{className:"p-2 rounded-xl bg-linear-to-br from-vault-500 to-vault-600",children:k.jsx(IT,{className:"w-5 h-5 text-white"})}),k.jsxs("div",{children:[k.jsx("h2",{id:"settings-title",className:"text-lg font-bold text-vault-900 dark:text-vault-100",children:"AI Settings"}),k.jsx("p",{className:"text-xs text-vault-500",children:"Configure your AI generation preferences"})]})]}),k.jsx("button",{onClick:e,className:"p-2 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-vault-500/50","aria-label":"Close settings panel",children:k.jsx(vs,{className:"w-5 h-5"})})]}),k.jsx("div",{className:"flex border-b border-vault-200 dark:border-vault-800 px-6 bg-vault-50 dark:bg-vault-900/50",children:["ai","sampler","prompts"].map(J=>k.jsx("button",{onClick:()=>z(J),className:`px-4 py-3 text-sm font-medium capitalize transition-all duration-200 border-b-2 -mb-px focus:outline-none focus:ring-2 focus:ring-vault-500/50 focus:ring-inset ${F===J?"border-vault-600 text-vault-600 dark:border-vault-400 dark:text-vault-400":"border-transparent text-vault-500 dark:text-vault-400 hover:text-vault-700 dark:hover:text-vault-300 hover:bg-vault-100/50 dark:hover:bg-vault-800/50"}`,"aria-selected":F===J,role:"tab",children:k.jsxs("span",{className:"flex items-center gap-2",children:[J==="ai"&&k.jsx($k,{className:"w-4 h-4"}),J==="sampler"&&k.jsx(tw,{className:"w-4 h-4"}),J==="prompts"&&k.jsx(_o,{className:"w-4 h-4"}),J==="ai"?"AI Config":J]})},J))}),k.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 bg-vault-50/50 dark:bg-vault-900/50",children:[w&&F!=="sampler"&&k.jsx("div",{className:"flex items-center justify-center py-12",children:k.jsxs("div",{className:"flex flex-col items-center gap-3",children:[k.jsx(Uf,{className:"w-8 h-8 animate-spin text-vault-600"}),k.jsx("span",{className:"text-sm text-vault-500",children:"Loading settings..."})]})}),F==="ai"&&!w&&k.jsxs("div",{className:"space-y-5",children:[k.jsx("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-5 border border-vault-200 dark:border-vault-700 shadow-sm",children:k.jsxs("div",{className:"space-y-4",children:[k.jsxs("div",{children:[k.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-vault-800 dark:text-vault-200 mb-2",children:[k.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:k.jsx(LT,{className:"w-4 h-4"})}),"API Base URL"]}),k.jsx("input",{type:"text",value:c.baseUrl,onChange:J=>h(q=>({...q,baseUrl:J.target.value})),className:"w-full px-3 py-2.5 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50 transition-all duration-200",placeholder:"https://nano-gpt.com/api/v1"})]}),k.jsxs("div",{children:[k.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-vault-800 dark:text-vault-200 mb-2",children:[k.jsx("span",{className:"p-1.5 rounded-md bg-vault-100 dark:bg-vault-800 text-vault-600 dark:text-vault-400",children:k.jsx(X4,{className:"w-4 h-4"})}),"API Key"]}),k.jsx("input",{type:"password",value:c.apiKey,onChange:J=>h(q=>({...q,apiKey:J.target.value})),className:"w-full px-3 py-2.5 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50 transition-all duration-200",placeholder:"Enter your API key"})]}),k.jsx(VR,{models:c.availableModels||[],selectedModelId:c.modelId,onSelect:J=>h(q=>({...q,modelId:J})),onFetch:fe,isFetching:j,disabled:!1})]})}),k.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-5 border border-vault-200 dark:border-vault-700 shadow-sm",children:[k.jsxs("h3",{className:"text-sm font-semibold text-vault-800 dark:text-vault-200 mb-4 flex items-center gap-2",children:[k.jsx(jl,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),"Advanced Options"]}),k.jsxs("div",{className:"flex flex-wrap items-center gap-6",children:[k.jsxs("label",{className:"flex items-center gap-3 text-sm text-vault-700 dark:text-vault-300 cursor-pointer group",children:[k.jsxs("div",{className:"relative",children:[k.jsx("input",{type:"checkbox",checked:c.enableStreaming,onChange:J=>h(q=>({...q,enableStreaming:J.target.checked})),className:"peer sr-only"}),k.jsx("div",{className:"w-10 h-6 bg-vault-300 dark:bg-vault-700 rounded-full peer-checked:bg-vault-600 dark:peer-checked:bg-vault-500 transition-colors duration-200"}),k.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 peer-checked:translate-x-4"})]}),k.jsx("span",{className:"group-hover:text-vault-900 dark:group-hover:text-vault-100 transition-colors",children:"Enable streaming"})]}),k.jsxs("label",{className:"flex items-center gap-3 text-sm text-vault-700 dark:text-vault-300 cursor-pointer group",children:[k.jsxs("div",{className:"relative",children:[k.jsx("input",{type:"checkbox",checked:c.enableReasoning,onChange:J=>h(q=>({...q,enableReasoning:J.target.checked})),className:"peer sr-only"}),k.jsx("div",{className:"w-10 h-6 bg-vault-300 dark:bg-vault-700 rounded-full peer-checked:bg-vault-600 dark:peer-checked:bg-vault-500 transition-colors duration-200"}),k.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 peer-checked:translate-x-4"})]}),k.jsx("span",{className:"group-hover:text-vault-900 dark:group-hover:text-vault-100 transition-colors",children:"Enable reasoning"})]}),k.jsxs("label",{className:"flex items-center gap-3 text-sm text-vault-700 dark:text-vault-300 cursor-pointer group",children:[k.jsxs("div",{className:"relative",children:[k.jsx("input",{type:"checkbox",checked:c.showReasoning!==!1,onChange:J=>h(q=>({...q,showReasoning:J.target.checked})),className:"peer sr-only"}),k.jsx("div",{className:"w-10 h-6 bg-vault-300 dark:bg-vault-700 rounded-full peer-checked:bg-vault-600 dark:peer-checked:bg-vault-500 transition-colors duration-200"}),k.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform duration-200 peer-checked:translate-x-4"})]}),k.jsx("span",{className:"group-hover:text-vault-900 dark:group-hover:text-vault-100 transition-colors",children:"Show reasoning"})]})]})]})]}),F==="sampler"&&k.jsx(FR,{settings:d,onChange:p}),F==="prompts"&&!w&&k.jsxs("div",{className:"space-y-4",children:[k.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-4 border border-vault-200 dark:border-vault-700 shadow-sm",children:[k.jsxs("h3",{className:"text-xs font-bold text-vault-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[k.jsx(nw,{className:"w-4 h-4"}),"Primary Operations"]}),["expand","rewrite","instruct"].map(J=>k.jsxs("div",{className:"border border-vault-200 dark:border-vault-700 rounded-lg overflow-hidden mb-3 last:mb-0",children:[k.jsxs("button",{onClick:()=>ye(q=>({...q,[J]:!q[J]})),className:"w-full flex items-center justify-between px-4 py-3 bg-vault-50 dark:bg-vault-800/50 hover:bg-vault-100 dark:hover:bg-vault-800 transition-colors",children:[k.jsxs("span",{className:"flex items-center gap-2 text-sm font-semibold text-vault-700 dark:text-vault-300 capitalize",children:[k.jsx(_o,{className:"w-4 h-4 text-vault-500"}),J==="expand"?"Enhance":J==="rewrite"?"Rephrase":"Custom"," Prompt"]}),ee[J]?k.jsx(zo,{className:"w-4 h-4 text-vault-500"}):k.jsx(Ea,{className:"w-4 h-4 text-vault-500"})]}),ee[J]&&k.jsxs("div",{className:"p-4",children:[k.jsx("textarea",{value:g[J],onChange:q=>b(le=>({...le,[J]:q.target.value})),className:"w-full h-32 px-3 py-2 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50 resize-none transition-all duration-200",placeholder:`Enter ${J} prompt...`}),k.jsx("div",{className:"mt-2 text-xs space-y-1",children:J==="instruct"?k.jsxs("span",{className:"text-vault-600 dark:text-vault-400",children:[k.jsx("span",{className:"font-semibold text-red-500",children:"Required:"})," Must contain $","{text}"," and $","{instruction}"]}):k.jsxs("span",{className:"text-vault-600 dark:text-vault-400",children:[k.jsx("span",{className:"font-semibold text-red-500",children:"Required:"})," Must contain $","{text}"]})}),!g[J].includes("${text}")&&k.jsxs("p",{className:"mt-2 text-xs text-red-500 flex items-center gap-1",children:[k.jsx(Aa,{className:"w-3 h-3"}),"Missing required $","{text}"," placeholder!"]}),J==="instruct"&&!g[J].includes("${instruction}")&&k.jsxs("p",{className:"mt-2 text-xs text-red-500 flex items-center gap-1",children:[k.jsx(Aa,{className:"w-3 h-3"}),"Missing required $","{instruction}"," placeholder!"]})]})]},J))]}),k.jsxs("div",{className:"bg-white dark:bg-vault-800/50 rounded-xl p-4 border border-vault-200 dark:border-vault-700 shadow-sm",children:[k.jsxs("h3",{className:"text-xs font-bold text-vault-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[k.jsx(jl,{className:"w-4 h-4"}),"Polish Operations (More Menu)"]}),["shorten","lengthen","vivid","emotion","grammar"].map(J=>k.jsxs("div",{className:"border border-vault-200 dark:border-vault-700 rounded-lg overflow-hidden mb-3 last:mb-0",children:[k.jsxs("button",{onClick:()=>ye(q=>({...q,[J]:!q[J]})),className:"w-full flex items-center justify-between px-4 py-3 bg-vault-50 dark:bg-vault-800/50 hover:bg-vault-100 dark:hover:bg-vault-800 transition-colors",children:[k.jsxs("span",{className:"flex items-center gap-2 text-sm font-semibold text-vault-700 dark:text-vault-300 capitalize",children:[k.jsx(_o,{className:"w-4 h-4 text-vault-500"}),J==="grammar"?"Fix":J," Prompt"]}),ee[J]?k.jsx(zo,{className:"w-4 h-4 text-vault-500"}):k.jsx(Ea,{className:"w-4 h-4 text-vault-500"})]}),ee[J]&&k.jsxs("div",{className:"p-4",children:[k.jsx("textarea",{value:g[J],onChange:q=>b(le=>({...le,[J]:q.target.value})),className:"w-full h-32 px-3 py-2 border border-vault-300 dark:border-vault-600 rounded-lg bg-white dark:bg-vault-800 text-vault-900 dark:text-vault-100 text-sm focus:outline-none focus:ring-2 focus:ring-vault-500/50 resize-none transition-all duration-200",placeholder:`Enter ${J} prompt...`}),k.jsx("div",{className:"mt-2 text-xs",children:k.jsxs("span",{className:"text-vault-600 dark:text-vault-400",children:[k.jsx("span",{className:"font-semibold text-red-500",children:"Required:"})," Must contain $","{text}"]})}),!g[J].includes("${text}")&&k.jsxs("p",{className:"mt-2 text-xs text-red-500 flex items-center gap-1",children:[k.jsx(Aa,{className:"w-3 h-3"}),"Missing required $","{text}"," placeholder!"]})]})]},J))]})]})]}),k.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-vault-200 dark:border-vault-800 bg-white dark:bg-vault-900",children:[k.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-vault-700 dark:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-vault-500/50",children:"Cancel"}),k.jsxs("button",{onClick:ke,disabled:N,className:"flex items-center gap-2 px-4 py-2 bg-linear-to-r from-vault-600 to-vault-700 hover:from-vault-700 hover:to-vault-800 disabled:opacity-50 disabled:cursor-not-allowed text-white text-sm font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-vault-500/50",children:[N?k.jsx(Uf,{className:"w-4 h-4 animate-spin"}):k.jsx(ew,{className:"w-4 h-4"}),"Save Settings"]})]})]})})]}):null}class YR{async exportAsJSON(e){try{const t=this.characterToV3(e),r=JSON.stringify(t,null,2);return{success:!0,blob:new Blob([r],{type:"application/json"}),filename:`${this.sanitizeFilename(e.name)}.json`}}catch(t){return console.error("JSON export error:",t),{success:!1,error:t instanceof Error?t.message:"Error exporting character"}}}async exportAsV2(e){try{const t=this.characterToV2Full(e),r=JSON.stringify(t,null,2);return{success:!0,blob:new Blob([r],{type:"application/json"}),filename:`${this.sanitizeFilename(e.name)}_v2.json`}}catch(t){return console.error("V2 JSON export error:",t),{success:!1,error:t instanceof Error?t.message:"Error exporting character"}}}async exportAsPNG(e){try{if(!e.imageData)return{success:!1,error:"Character has no image. Please add an image before exporting as PNG."};const t=this.characterToV3(e),r=this.unicodeToBase64(JSON.stringify(t)),s=await(await this.dataURLToBlob(e.imageData)).arrayBuffer(),o=await this.embedCharaInPNG(s,r);return{success:!0,blob:new Blob([o],{type:"image/png"}),filename:`${this.sanitizeFilename(e.name)}.png`}}catch(t){return console.error("PNG export error:",t),{success:!1,error:t instanceof Error?t.message:"Error exporting character"}}}async exportAsCharacterVault(e){try{const t={...e,id:e.id,name:e.name,imageData:e.imageData,data:e.data,version:e.version,createdAt:e.createdAt,updatedAt:e.updatedAt,lastOpenedAt:e.lastOpenedAt},r=JSON.stringify(t,null,2);return{success:!0,blob:new Blob([r],{type:"application/json"}),filename:`${this.sanitizeFilename(e.name)}.charactervault.json`}}catch(t){return console.error("CharacterVault export error:",t),{success:!1,error:t instanceof Error?t.message:"Error exporting character"}}}characterToV3(e){return{spec:"chara_card_v3",spec_version:"3.0",data:this.characterDataToV2(e)}}characterToV2Full(e){return{spec:"chara_card_v2",spec_version:"2.0",data:this.characterDataToV2(e)}}characterDataToV2(e){const t=e.data.spec;return{name:t.name||e.name,description:t.description,personality:t.personality,scenario:t.scenario,first_mes:t.first_mes,mes_example:t.mes_example,system_prompt:t.system_prompt,post_history_instructions:t.post_history_instructions,alternate_greetings:t.alternate_greetings,character_book:e.data.characterBook,extensions:e.data.extensions||{},creator:t.creator||"",character_version:t.character_version||"1.0",tags:t.tags||[],creator_notes:t.creator_notes||"",avatar:t.avatar||""}}async embedCharaInPNG(e,t){const r=new DataView(e);let l=0;const s=new Uint8Array(e,0,8),o=[137,80,78,71,13,10,26,10];for(let w=0;w<8;w++)if(s[w]!==o[w])throw new Error("Invalid PNG file signature");l=8;const c=[new Uint8Array(s)],h=this.createTextChunk("chara",t);let d=!1;for(;l<e.byteLength;){const w=r.getUint32(l),T=r.getUint32(l+4),N=new Uint8Array(e,l,12+w);if(c.push(N),T===1229472850&&!d&&(c.push(h),d=!0),T===1229278788)break;l+=12+w}const p=c.reduce((w,T)=>w+T.length,0),g=new Uint8Array(p);let b=0;for(const w of c)g.set(w,b),b+=w.length;return g.buffer}createTextChunk(e,t){const r=new TextEncoder().encode(e),l=new TextEncoder().encode(t),s=new Uint8Array(r.length+1+l.length);s.set(r),s[r.length]=0,s.set(l,r.length+1);const o=new Uint8Array(12+s.length),c=new DataView(o.buffer);c.setUint32(0,s.length),o[4]=116,o[5]=69,o[6]=88,o[7]=116,o.set(s,8);const h=this.calculateCRC(o.slice(4,8+s.length));return c.setUint32(8+s.length,h),o}calculateCRC(e){const t=this.getCRCTable();let r=4294967295;for(let l=0;l<e.length;l++)r=t[(r^e[l])&255]^r>>>8;return(r^4294967295)>>>0}getCRCTable(){if(this.crcTable)return this.crcTable;const e=new Uint32Array(256);for(let t=0;t<256;t++){let r=t;for(let l=0;l<8;l++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return this.crcTable=e,e}crcTable=null;async dataURLToBlob(e){return(await fetch(e)).blob()}sanitizeFilename(e){return e.replace(/[^a-z0-9]/gi,"_").toLowerCase()}unicodeToBase64(e){const t=new TextEncoder().encode(e);let r="";const l=t.byteLength;for(let s=0;s<l;s++)r+=String.fromCharCode(t[s]);return btoa(r)}}const Fk=new YR,Cg={Image:O0,Type:rw,FileText:Ao,User:R0,Map:nT,MessageCircle:Eg,MessagesSquare:aT,Terminal:JT,History:V4,Eye:z4,Puzzle:CT,Link:J4,NotebookPen:cT,UserCircle:D4,Tag:QT,Tags:$T,Book:D0};function QR({activeSection:n,onSectionChange:e}){const[t,r]=$.useState(!1),l=Zi.useRef(null),s=Zi.useRef(null);$.useEffect(()=>{const h=d=>{const p=d.target,g=l.current?.contains(p),b=s.current?.contains(p);!g&&!b&&r(!1)};return t&&document.addEventListener("click",h),()=>document.removeEventListener("click",h)},[t]);const o=Mo.find(h=>h.id===n),c=o&&Cg[o.icon]||Ao;return k.jsxs("div",{className:"border-b border-vault-200 dark:border-vault-800 bg-white/60 dark:bg-vault-900/60 backdrop-blur-xl shrink-0",children:[k.jsx("div",{className:"hidden md:flex items-center gap-1 px-4 py-2 overflow-x-auto scrollbar-thin",children:Mo.map(h=>{const d=Cg[h.icon]||Ao,p=n===h.id;return k.jsxs("button",{onClick:()=>e(h.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all whitespace-nowrap
                ${p?"bg-vault-600 text-white shadow-sm":"text-vault-600 dark:text-vault-400 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,children:[k.jsx(d,{className:"w-4 h-4"}),h.label]},h.id)})}),k.jsxs("div",{className:"md:hidden relative",ref:l,children:[k.jsxs("button",{onClick:()=>r(!t),className:"flex items-center justify-between w-full px-4 py-3 text-left hover:bg-vault-50 dark:hover:bg-vault-800/50 transition-colors",children:[k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx(c,{className:"w-4 h-4 text-vault-600 dark:text-vault-400"}),k.jsx("span",{className:"font-medium text-vault-900 dark:text-vault-100",children:o?.label||"Select Section"})]}),k.jsx(Ea,{className:`w-4 h-4 text-vault-500 transition-transform ${t?"rotate-180":""}`})]}),t&&u4.createPortal(k.jsx("div",{ref:s,className:"fixed inset-x-0 top-26.25 z-9999 bg-white dark:bg-vault-900 border-b border-vault-200 dark:border-vault-800 shadow-lg max-h-[50vh] overflow-y-auto md:hidden",children:Mo.map(h=>{const d=Cg[h.icon]||Ao,p=n===h.id;return k.jsxs("button",{type:"button",onClick:g=>{g.preventDefault(),g.stopPropagation(),e(h.id),r(!1)},className:`flex items-center gap-2 w-full px-4 py-3 text-sm transition-colors
                    ${p?"bg-vault-100 dark:bg-vault-800 text-vault-900 dark:text-vault-100 font-medium":"text-vault-600 dark:text-vault-400 hover:bg-vault-50 dark:hover:bg-vault-800/50"}`,children:[k.jsx(d,{className:`w-4 h-4 ${p?"text-vault-600 dark:text-vault-400":""}`}),h.label]},h.id)})}),document.body)]})]})}function XR(){const{currentCharacter:n,updateCharacter:e}=Qo(),[t,r]=Zi.useState(!1),l=async d=>{if(!d.type.startsWith("image/")){alert("Please select an image file");return}const p=new FileReader;p.onload=g=>{const b=g.target?.result;n&&b&&e(n.id,{imageData:b})},p.readAsDataURL(d)},s=d=>{d.preventDefault(),r(!1);const p=d.dataTransfer.files[0];p&&l(p)},o=d=>{d.preventDefault(),r(!0)},c=()=>{r(!1)},h=d=>{const p=d.target.files?.[0];p&&l(p)};return k.jsxs("div",{className:"space-y-6",children:[k.jsx("h2",{className:"text-xl font-bold text-vault-900 dark:text-vault-50",children:"Character Image"}),k.jsx("div",{className:"flex justify-center",children:n?.imageData?k.jsxs("div",{className:"relative group",children:[k.jsx("img",{src:n.imageData,alt:n.name,className:"w-96 h-96 max-w-full max-h-[60vh] object-contain rounded-2xl border-2 border-vault-200 dark:border-vault-700 shadow-lg"}),k.jsx("button",{onClick:()=>n&&void e(n.id,{imageData:""}),className:`absolute top-2 right-2 p-2 bg-red-500 hover:bg-red-600 text-white rounded-lg\r
                opacity-0 group-hover:opacity-100 transition-opacity duration-200 shadow-lg`,children:k.jsx($o,{className:"w-4 h-4"})})]}):k.jsxs("div",{onDrop:s,onDragOver:o,onDragLeave:c,className:`w-96 h-96 max-w-full max-h-[60vh] rounded-2xl border-2 border-dashed 
              ${t?"border-vault-500 bg-vault-100 dark:bg-vault-800/50":"border-vault-300 dark:border-vault-700 bg-vault-50 dark:bg-vault-900/30"}
              flex flex-col items-center justify-center gap-3 transition-colors duration-200`,children:[k.jsx(O0,{className:"w-16 h-16 text-vault-400 dark:text-vault-600"}),k.jsxs("p",{className:"text-sm text-vault-500 dark:text-vault-400 text-center px-4",children:["Drag and drop an image here",k.jsx("br",{}),"or click to browse"]})]})}),k.jsx("div",{className:"flex justify-center",children:k.jsxs("label",{className:"cursor-pointer",children:[k.jsx("input",{type:"file",accept:"image/*",onChange:h,className:"hidden"}),k.jsxs("span",{className:`inline-flex items-center gap-2 px-4 py-2 bg-vault-600 hover:bg-vault-700 \r
            text-white rounded-xl font-medium transition-colors duration-200 cursor-pointer`,children:[k.jsx(Nc,{className:"w-4 h-4"}),n?.imageData?"Change Image":"Upload Image"]})]})})]})}function $R({onOpenSettings:n,isContextOpen:e,isChatOpen:t,onToggleContext:r,onToggleChat:l,isMobile:s}){const{currentCharacter:o,closeCharacter:c}=Qo();if(!o)return k.jsx(k.Fragment,{});const h=async()=>{if(!o)return;const p=await Fk.exportAsJSON(o);if(p.success&&p.blob){const g=URL.createObjectURL(p.blob),b=document.createElement("a");b.href=g,b.download=p.filename||`${o.name}.json`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(g)}else alert(p.error||"Failed to export character")},d=async()=>{if(!o)return;const p=await Fk.exportAsPNG(o);if(p.success&&p.blob){const g=URL.createObjectURL(p.blob),b=document.createElement("a");b.href=g,b.download=p.filename||`${o.name}.png`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(g)}else alert(p.error||"Failed to export character")};return k.jsxs("header",{className:`h-16 flex items-center justify-between px-4 md:px-6\r
      bg-white/60 dark:bg-vault-900/60 backdrop-blur-xl\r
      border-b border-vault-200/60 dark:border-vault-800/50 shrink-0`,children:[k.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[k.jsx("button",{onClick:c,className:`p-2 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200\r
            hover:bg-vault-100 dark:hover:bg-vault-800/50 rounded-xl transition-all duration-200\r
            focus:outline-none focus:ring-2 focus:ring-vault-500 active:scale-95 shrink-0`,title:"Back to characters",children:k.jsx(g4,{className:"w-5 h-5"})}),k.jsxs("div",{className:"flex items-center gap-2 md:gap-3 min-w-0",children:[o.imageData?k.jsx("img",{src:o.imageData,alt:o.name,className:"w-8 h-8 md:w-10 md:h-10 rounded-lg object-cover border border-vault-200 dark:border-vault-700 shrink-0"}):k.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-lg bg-vault-200 dark:bg-vault-800 flex items-center justify-center shrink-0",children:k.jsx(R0,{className:"w-4 h-4 md:w-5 md:h-5 text-vault-500 dark:text-vault-400"})}),k.jsxs("div",{className:"min-w-0",children:[k.jsx("h1",{className:"font-semibold text-vault-900 dark:text-vault-50 text-sm md:text-base truncate",children:o.name}),k.jsx("p",{className:"text-xs text-vault-500 dark:text-vault-400 hidden sm:block",children:"Editing character"})]})]})]}),k.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[s&&k.jsxs(k.Fragment,{children:[k.jsx("button",{onClick:r,className:`p-2 rounded-lg transition-colors ${e?"bg-vault-600 text-white":"text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,title:"Toggle AI Context Panel",children:k.jsx(jl,{className:"w-4 h-4 md:w-5 md:h-5"})}),k.jsx("button",{onClick:l,className:`p-2 rounded-lg transition-colors ${t?"bg-vault-600 text-white":"text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,title:"Toggle Ask AI Panel",children:k.jsx(_o,{className:"w-4 h-4 md:w-5 md:h-5"})})]}),!s&&k.jsxs(k.Fragment,{children:[k.jsx("button",{onClick:r,className:`hidden lg:flex p-2 rounded-lg transition-colors ${e?"bg-vault-200 dark:bg-vault-700 text-vault-700 dark:text-vault-200":"text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,title:e?"Hide AI Context Panel":"Show AI Context Panel",children:k.jsx(pT,{className:"w-5 h-5"})}),k.jsx("button",{onClick:l,className:`hidden lg:flex p-2 rounded-lg transition-colors ${t?"bg-vault-200 dark:bg-vault-700 text-vault-700 dark:text-vault-200":"text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200 hover:bg-vault-100 dark:hover:bg-vault-800/50"}`,title:t?"Hide Ask AI Panel":"Show Ask AI Panel",children:k.jsx(gT,{className:"w-5 h-5"})})]}),k.jsx("div",{className:"h-6 w-px bg-vault-200 dark:bg-vault-800 mx-1 hidden sm:block"}),k.jsx("button",{onClick:n,className:`p-2 text-vault-500 hover:text-vault-700 dark:text-vault-400 dark:hover:text-vault-200\r
            hover:bg-vault-100 dark:hover:bg-vault-800/50 rounded-xl transition-colors`,title:"AI Settings",children:k.jsx(HT,{className:"w-5 h-5"})}),k.jsxs("button",{onClick:h,className:`hidden sm:flex items-center gap-2 px-3 py-2 text-sm font-medium\r
            text-vault-700 dark:text-vault-300\r
            hover:bg-vault-100 dark:hover:bg-vault-800/50 rounded-xl\r
            transition-colors duration-200`,children:[k.jsx(ew,{className:"w-4 h-4"}),k.jsx("span",{className:"hidden md:inline",children:"Export JSON"})]}),k.jsxs("button",{onClick:d,className:`flex items-center gap-2 px-3 py-2 text-sm font-medium\r
            bg-vault-600 hover:bg-vault-700 text-white rounded-xl\r
            transition-colors duration-200`,children:[k.jsx(Zk,{className:"w-4 h-4"}),k.jsx("span",{className:"hidden md:inline",children:"Export PNG"})]})]})]})}function WR({isOpen:n,onClick:e}){return n?k.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-30 lg:hidden",onClick:e}):k.jsx(k.Fragment,{})}function ZR(){const{currentCharacter:n}=Qo(),[e,t]=$.useState(!1),[r,l]=$.useState(!0),[s,o]=$.useState(!0),[c,h]=$.useState(!1);return $.useEffect(()=>{const d=()=>{const p=window.innerWidth<1024;h(p),p?(l(!1),o(!1)):(l(!0),o(!0))};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]),n?k.jsx(o4,{children:k.jsx(JR,{isSettingsOpen:e,setIsSettingsOpen:t,isContextOpen:r,isChatOpen:s,setIsContextOpen:l,setIsChatOpen:o,isMobile:c})}):k.jsx("div",{className:"h-screen w-full flex items-center justify-center",children:k.jsx("div",{className:"text-center",children:k.jsx("p",{className:"text-vault-500",children:"No character selected"})})})}function JR({isSettingsOpen:n,setIsSettingsOpen:e,isContextOpen:t,isChatOpen:r,setIsContextOpen:l,setIsChatOpen:s,isMobile:o}){const{activeSection:c,setActiveSection:h,selectedText:d,contextSectionIds:p,aiConfig:g,samplerSettings:b,promptSettings:w,handleAIOperation:T,getContextContent:N}=bd(),D=()=>l(!t),j=()=>s(!r),U=()=>{o&&(l(!1),s(!1))};return k.jsxs("div",{className:`h-screen w-full flex flex-col bg-linear-to-br from-vault-50 via-vault-50 to-vault-100/50 \r
      dark:from-vault-950 dark:via-vault-950 dark:to-vault-900/50 overflow-hidden`,children:[k.jsx($R,{onOpenSettings:()=>e(!0),isContextOpen:t,isChatOpen:r,onToggleContext:D,onToggleChat:j,isMobile:o}),k.jsx(WR,{isOpen:o&&(t||r),onClick:U}),k.jsx(QR,{activeSection:c,onSectionChange:h}),k.jsxs("div",{className:"flex-1 flex overflow-hidden relative",children:[k.jsx("aside",{className:`
            ${t&&o?"fixed inset-y-0 left-0 z-40 w-80 shadow-2xl translate-x-0":""}
            ${!t&&o?"fixed inset-y-0 left-0 z-40 w-80 shadow-2xl -translate-x-full":""}
            ${t&&!o?"lg:w-72 xl:w-80 translate-x-0":""}
            ${!t&&!o?"lg:w-0 lg:opacity-0 lg:overflow-hidden":""}
            transition-all duration-300 ease-in-out
            bg-vault-50 dark:bg-vault-900
            border-r border-vault-200 dark:border-vault-800
            flex flex-col
            shrink-0
          `,children:k.jsx(y_,{onClose:()=>l(!1),isMobile:o})}),k.jsx("main",{className:"flex-1 flex flex-col min-w-0 relative z-0 overflow-hidden",children:k.jsx("div",{className:"flex-1 p-3 md:p-4 lg:p-6 min-h-0",children:k.jsx("div",{className:`h-full w-full bg-white/60 dark:bg-vault-900/60 backdrop-blur-xl \r
              rounded-2xl border border-vault-200/60 dark:border-vault-800/50 p-4 md:p-6 shadow-lg overflow-hidden`,children:c==="image"?k.jsx(XR,{}):k.jsx(g_,{section:c})})})}),k.jsx("aside",{className:`
            ${r&&o?"fixed inset-y-0 right-0 z-40 w-80 shadow-2xl translate-x-0":""}
            ${!r&&o?"fixed inset-y-0 right-0 z-40 w-80 shadow-2xl translate-x-full":""}
            ${r&&!o?"lg:w-80 xl:w-96 translate-x-0":""}
            ${!r&&!o?"lg:w-0 lg:opacity-0 lg:overflow-hidden":""}
            transition-all duration-300 ease-in-out
            bg-vault-50 dark:bg-vault-900
            border-l border-vault-200 dark:border-vault-800
            flex flex-col
            shrink-0
          `,children:k.jsx(UR,{selectedText:d,contextEntryIds:p,aiConfig:g,samplerSettings:b,promptSettings:w,onComplete:I=>T(I,"ask",d),getContextContent:async I=>N(I),activeSection:c,onClose:()=>s(!1),isMobile:o})})]}),k.jsx(GR,{isOpen:n,onClose:()=>e(!1)})]})}function eB(){return k.jsx(ZR,{})}const Df=[{id:0,title:"Welcome to CharacterVault",subtitle:"Your distraction-free character card workshop",description:"CharacterVault is your all-in-one workspace for creating, editing, and managing character spec cards. Built for SillyTavern and compatible platforms  supporting both V2 and V3 card formats out of the box.",features:[{icon:Vf,label:"Your Library",detail:"Manage your entire character collection in one place, stored locally in your browser"},{icon:Pb,label:"Full-Featured Editor",detail:"Section-based editing with dedicated tabs for every card field"},{icon:jl,label:"AI-Powered Tools",detail:"Built-in AI toolbar and chat assistant to help craft your characters"}],accentIcon:qf},{id:1,title:"Import or Create",subtitle:"Start with what you have  or from scratch",description:'Bring in your existing character cards or start fresh. CharacterVault reads V2 and V3 PNG cards with embedded metadata, as well as raw JSON files. Click "Import" in the header or the "+ New" button to get started.',features:[{icon:Nc,label:"Import Cards",detail:"Import PNG cards with embedded data or raw JSON character files"},{icon:Xo,label:"Create New",detail:"Start fresh with a blank character template and build from scratch"},{icon:Ao,label:"V2 & V3 Support",detail:"Full compatibility with both character card specifications"}],accentIcon:Nc},{id:2,title:"Edit Your Character",subtitle:"Every field organized in dedicated sections",description:"Navigate through tabs for each part of your character card. Every section has a focused CodeMirror editor with search & replace so you can work without distractions.",features:[{icon:rw,label:"Core Sections",detail:"Name, Description, Personality, Scenario, First Message, Example Messages, System Prompt, and more"},{icon:O0,label:"Image",detail:"Upload or drag & drop your character's portrait image directly"},{icon:D0,label:"Lorebook",detail:"Built-in lorebook editor  manage entries with trigger keys, priority, position, and AI-assisted content"}],accentIcon:Pb},{id:3,title:"AI Writing Tools",subtitle:"Your editing suite, supercharged",description:"Select any text in the editor to reveal the AI toolbar. Use one-click operations to transform your writing, or give custom instructions. All AI results stream in real-time and can be accepted or rejected.",features:[{icon:cE,label:"Enhance & Rephrase",detail:"Expand your text with more depth, or rephrase for better clarity and flow"},{icon:fT,label:"Style Polish",detail:"Make text more Vivid, add Emotion, Shorten, Lengthen, or Fix Grammar  all one click"},{icon:iw,label:"Custom Instructions",detail:"Type any instruction and the AI applies it to your selected text"}],accentIcon:jl},{id:4,title:"Zoggy & Export",subtitle:"Chat with your AI assistant  and ship your cards",description:"Zoggy is CharacterVault's built-in chat assistant. Add sections to the AI Context panel so Zoggy can read your card and give tailored advice. When you're done, export as PNG with embedded data or raw JSON.",features:[{icon:Eg,label:"Ask Zoggy",detail:"Chat about best practices, get help writing sections, or brainstorm character ideas"},{icon:OT,label:"AI Context",detail:"Pin card sections to context so the AI has full awareness of your character"},{icon:Zk,label:"Export",detail:"Save as a PNG with embedded card data, or export the raw JSON file"}],accentIcon:Eg},{id:5,title:"You're All Set!",subtitle:"Start building your characters",description:"That's everything you need to know. Your characters are stored locally in your browser  private and always available. You can replay this tutorial anytime by clicking the help icon in the header bar.",features:[{icon:Ng,label:"Get Started",detail:"Create your first character or import an existing card"},{icon:qf,label:"Replay Tutorial",detail:"Click the help icon (?) in the header bar anytime"},{icon:Vf,label:"Your Data, Your Control",detail:"Everything stays local in your browser  no servers, no sign-up required"}],accentIcon:Ng}],Ey="charactervault-tutorial-completed";function tB({onComplete:n}){const[e,t]=$.useState(0),[r,l]=$.useState("next"),[s,o]=$.useState(!1),[c,h]=$.useState(!1);$.useEffect(()=>{const I=setTimeout(()=>h(!0),50);return()=>clearTimeout(I)},[]);const d=Df[e],p=e===0,g=e===Df.length-1,b=$.useCallback((I,ce)=>{s||(o(!0),l(ce),setTimeout(()=>{t(I),o(!1)},250))},[s]),w=$.useCallback(()=>{g||b(e+1,"next")},[e,g,b]),T=$.useCallback(()=>{p||b(e-1,"prev")},[e,p,b]),N=$.useCallback(()=>{localStorage.setItem(Ey,"true"),h(!1),setTimeout(n,400)},[n]),D=$.useCallback(()=>{N()},[N]);$.useEffect(()=>{const I=ce=>{(ce.key==="ArrowRight"||ce.key==="Enter")&&(g?N():w()),ce.key==="ArrowLeft"&&T(),ce.key==="Escape"&&D()};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[w,T,N,D,g]);const j=d.accentIcon,U=s?r==="next"?"tutorial-step-exiting-next":"tutorial-step-exiting-prev":"tutorial-step-entering";return k.jsxs("div",{className:`fixed inset-0 z-100 flex items-center justify-center transition-all duration-500
        ${c?"opacity-100":"opacity-0 pointer-events-none"}`,children:[k.jsx("div",{className:"absolute inset-0 bg-vault-950/80 dark:bg-black/85 tutorial-backdrop",onClick:D}),k.jsxs("div",{className:`relative z-10 w-full max-w-2xl mx-4 transition-all duration-500 ease-out
          ${c?"scale-100 translate-y-0 opacity-100":"scale-95 translate-y-8 opacity-0"}`,children:[!g&&k.jsxs("button",{onClick:D,className:`absolute -top-10 sm:-top-12 right-0 flex items-center gap-1.5 px-3 py-1.5 text-xs sm:text-sm font-medium\r
              text-vault-400 hover:text-white transition-colors rounded-lg hover:bg-white/10`,children:[k.jsx("span",{children:"Skip tutorial"}),k.jsx(vs,{className:"w-3.5 h-3.5"})]}),k.jsxs("div",{className:"bg-white dark:bg-vault-900 rounded-2xl shadow-2xl border border-vault-200 dark:border-vault-800 overflow-hidden tutorial-card-enter",children:[k.jsxs("div",{className:"relative px-5 pt-6 pb-4 sm:px-8 sm:pt-8 sm:pb-6 overflow-hidden",children:[k.jsx("div",{className:"absolute -top-2 -right-1 w-24 h-24 sm:w-40 sm:h-40 opacity-[0.06] dark:opacity-[0.08] tutorial-float rotate-15 pointer-events-none",style:{animationDelay:"1.2s"},children:k.jsx(j,{className:"w-full h-full",strokeWidth:1.5})}),k.jsx("div",{className:"absolute inset-0 tutorial-shimmer pointer-events-none"}),k.jsxs("div",{className:"flex items-center gap-1.5 mb-6 relative",children:[Df.map((I,ce)=>k.jsx("div",{className:`h-1.5 rounded-full tutorial-dot
                    ${ce===e?"w-8 bg-vault-900 dark:bg-vault-100":ce<e?"w-3 bg-vault-400 dark:bg-vault-500":"w-3 bg-vault-200 dark:bg-vault-700"}`},ce)),k.jsxs("span",{className:"ml-auto text-xs font-medium text-vault-400 dark:text-vault-500 tabular-nums",children:[e+1," / ",Df.length]})]}),k.jsxs("div",{className:`tutorial-step-content ${U}`,children:[k.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-vault-400 dark:text-vault-500 mb-2",children:d.subtitle}),k.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-vault-900 dark:text-vault-50 tracking-tight",children:d.title})]})]}),k.jsx("div",{className:"px-5 pb-5 sm:px-8 sm:pb-6",children:k.jsxs("div",{className:`tutorial-step-content ${U}`,children:[k.jsx("p",{className:"text-vault-600 dark:text-vault-400 text-[15px] leading-relaxed mb-6",children:d.description}),k.jsx("div",{className:"grid gap-3",children:d.features.map((I,ce)=>{const F=I.icon;return k.jsxs("div",{className:`tutorial-feature-card group flex items-start gap-3 sm:gap-4 p-3 sm:p-4 rounded-xl\r
                        bg-vault-50 dark:bg-vault-800/60\r
                        border border-vault-100 dark:border-vault-800\r
                        hover:border-vault-300 dark:hover:border-vault-600`,style:{opacity:s?0:1,transform:s?"translateY(8px)":"translateY(0)"},children:[k.jsx("div",{className:`shrink-0 p-2.5 rounded-lg bg-vault-200/70 dark:bg-vault-700/50\r
                        group-hover:bg-vault-900 dark:group-hover:bg-vault-100\r
                        transition-colors duration-200`,children:k.jsx(F,{className:`w-4 h-4 text-vault-600 dark:text-vault-300\r
                          group-hover:text-white dark:group-hover:text-vault-900\r
                          transition-colors duration-200`})}),k.jsxs("div",{className:"min-w-0",children:[k.jsx("h4",{className:"text-sm font-semibold text-vault-900 dark:text-vault-100 mb-0.5",children:I.label}),k.jsx("p",{className:"text-xs text-vault-500 dark:text-vault-400 leading-relaxed",children:I.detail})]})]},`${d.id}-${ce}`)})})]})}),k.jsxs("div",{className:"px-5 py-4 sm:px-8 sm:py-5 border-t border-vault-100 dark:border-vault-800 bg-vault-50/50 dark:bg-vault-800/30 flex items-center justify-between",children:[k.jsxs("button",{onClick:T,disabled:p,className:`flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200
                ${p?"text-vault-300 dark:text-vault-700 cursor-not-allowed":"text-vault-600 dark:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-800 active:scale-95"}`,children:[k.jsx(S4,{className:"w-4 h-4"}),"Back"]}),k.jsx("button",{onClick:g?N:w,className:`flex items-center gap-2 px-6 py-2.5 text-sm font-semibold rounded-lg\r
                bg-vault-900 dark:bg-vault-100 text-white dark:text-vault-900\r
                hover:opacity-90 active:scale-95\r
                shadow-sm hover:shadow-md transition-all duration-200`,children:g?k.jsxs(k.Fragment,{children:["Get Started",k.jsx(Ng,{className:"w-4 h-4"})]}):k.jsxs(k.Fragment,{children:["Next",k.jsx(A4,{className:"w-4 h-4"})]})})]})]})]})]})}function nB(){return localStorage.getItem(Ey)==="true"}function rB(){localStorage.removeItem(Ey)}class iB{async importFromFile(e){try{return console.log("Importing file:",e.name,"type:",e.type),e.type==="application/json"||e.name.endsWith(".json")?await this.importFromJSON(e):e.type.startsWith("image/")||e.name.endsWith(".png")?await this.importFromPNG(e):{success:!1,error:"Unsupported file type. Please upload a PNG or JSON file."}}catch(t){return console.error("Import error:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error during import"}}}async importFromJSON(e){const t=await e.text();let r;try{r=JSON.parse(t)}catch{return{success:!1,error:"Invalid JSON file"}}if(this.isCharacterVaultExport(r))return{success:!0,character:await this.createCharacterFromExport(r)};const l=this.extractV3Data(r);if(l)return{success:!0,character:await this.createCharacterFromV2(l,"")};if(this.isCharacterCardV2(r)){const s=r,o={name:String(s.name||""),description:String(s.description||""),personality:String(s.personality||""),scenario:String(s.scenario||""),first_mes:String(s.first_mes||""),mes_example:String(s.mes_example||""),system_prompt:String(s.system_prompt||""),post_history_instructions:String(s.post_history_instructions||""),alternate_greetings:Array.isArray(s.alternate_greetings)?s.alternate_greetings:[],extensions:s.extensions||{},character_book:s.character_book,creator:typeof s.creator=="string"?s.creator:void 0,character_version:typeof s.character_version=="string"?s.character_version:void 0,tags:Array.isArray(s.tags)?s.tags:void 0,creator_notes:typeof s.creator_notes=="string"?s.creator_notes:void 0,avatar:typeof s.avatar=="string"?s.avatar:void 0};return{success:!0,character:await this.createCharacterFromV2(o,"")}}return{success:!1,error:"Unrecognized JSON format. Expected Character Card V2, V3, or CharacterVault export."}}extractV3Data(e){if(!e||typeof e!="object")return null;const t=e,r=t.data&&typeof t.data=="object"?t.data:null,l=r&&typeof r.name=="string"?r.name:typeof t.name=="string"?t.name:null;if(!l)return null;const s=(h,d)=>{const p=r&&typeof r[h]=="string"?r[h]:typeof t[h]=="string"?t[h]:d&&r&&typeof r[d]=="string"?r[d]:d&&typeof t[d]=="string"?t[d]:"";return String(p||"")},o=h=>r&&Array.isArray(r[h])?r[h]:Array.isArray(t[h])?t[h]:void 0;return{name:l,description:s("description"),personality:s("personality"),scenario:s("scenario"),first_mes:s("first_mes"),mes_example:s("mes_example"),system_prompt:s("system_prompt"),post_history_instructions:s("post_history_instructions"),alternate_greetings:o("alternate_greetings")||[],extensions:r&&r.extensions||t.extensions||{},character_book:r&&r.character_book||t.character_book,creator:s("creator")||void 0,character_version:s("character_version","create_date")||void 0,tags:o("tags"),creator_notes:s("creator_notes","creatorcomment")||void 0,avatar:s("avatar")||void 0}}async importFromPNG(e){try{const t=await e.arrayBuffer(),r=this.extractCharaFromPNG(t);if(!r)return{success:!1,error:"No character data found in PNG. Make sure this is a valid character card."};let l;try{const h=atob(r),d=new Uint8Array(h.length);for(let g=0;g<h.length;g++)d[g]=h.charCodeAt(g);const p=new TextDecoder("utf-8").decode(d);l=JSON.parse(p)}catch(h){return console.error("Failed to decode/parse character data:",h),{success:!1,error:"Invalid character data in PNG file"}}const s=await this.fileToDataURL(e),o=this.extractV3Data(l);if(o)return{success:!0,character:await this.createCharacterFromV2(o,s)};let c=l;if(l&&typeof l=="object"){const h=l;h.data&&typeof h.data=="object"&&(c=h.data)}if(this.isCharacterCardV2(c)){const h=c,d={name:String(h.name||""),description:String(h.description||""),personality:String(h.personality||""),scenario:String(h.scenario||""),first_mes:String(h.first_mes||""),mes_example:String(h.mes_example||""),system_prompt:String(h.system_prompt||""),post_history_instructions:String(h.post_history_instructions||""),alternate_greetings:Array.isArray(h.alternate_greetings)?h.alternate_greetings:[],extensions:h.extensions||{},character_book:h.character_book,creator:typeof h.creator=="string"?h.creator:void 0,character_version:typeof h.character_version=="string"?h.character_version:void 0,tags:Array.isArray(h.tags)?h.tags:void 0,creator_notes:typeof h.creator_notes=="string"?h.creator_notes:void 0,avatar:typeof h.avatar=="string"?h.avatar:void 0};return{success:!0,character:await this.createCharacterFromV2(d,s)}}if(c&&typeof c=="object"){const h=c,d=typeof h.name=="string"?h.name:typeof h.char_name=="string"?h.char_name:"Imported Character",p={name:d,description:String(h.description||h.char_persona||""),personality:String(h.personality||""),scenario:String(h.scenario||h.world_scenario||""),first_mes:String(h.first_mes||h.first_message||""),mes_example:String(h.mes_example||""),system_prompt:String(h.system_prompt||""),post_history_instructions:String(h.post_history_instructions||""),alternate_greetings:Array.isArray(h.alternate_greetings)?h.alternate_greetings:[],physical_description:String(h.physical_description||""),creator:typeof h.creator=="string"?h.creator:void 0,character_version:typeof h.character_version=="string"?h.character_version:void 0,tags:Array.isArray(h.tags)?h.tags:void 0,creator_notes:typeof h.creator_notes=="string"?h.creator_notes:void 0,avatar:typeof h.avatar=="string"?h.avatar:void 0};return{success:!0,character:await Vt.createCharacter({name:d,imageData:s,data:{spec:p,characterBook:h.character_book,extensions:h.extensions}})}}return{success:!1,error:"Invalid character card format in PNG"}}catch(t){return console.error("PNG import error:",t),{success:!1,error:t instanceof Error?t.message:"Error reading PNG file"}}}extractCharaFromPNG(e){const t=new DataView(e);let r=0;const l=new Uint8Array(e,0,8),s=[137,80,78,71,13,10,26,10];for(let o=0;o<8;o++)if(l[o]!==s[o])throw console.error("Invalid PNG signature"),new Error("Invalid PNG file signature");for(r=8;r<e.byteLength&&!(r+8>e.byteLength);){const o=t.getUint32(r),c=this.readChunkType(t,r+4);if(o>10*1024*1024){console.error("Chunk too large:",o);break}if(r+12+o>e.byteLength){console.error("Incomplete chunk at offset:",r);break}const h=new Uint8Array(e,r+8,o);if(c==="tEXt"){const d=this.readNullTerminatedString(h);if(d==="chara"){const p=new TextEncoder().encode(d),g=h.slice(p.length+1);return new TextDecoder().decode(g)}}if(c==="iTXt"){const d=this.parseITXtChunk(h);if(d.keyword==="chara")return d.text}if(c==="IEND")break;r+=12+o}return null}readChunkType(e,t){const r=[e.getUint8(t),e.getUint8(t+1),e.getUint8(t+2),e.getUint8(t+3)];return String.fromCharCode(...r)}readNullTerminatedString(e){let t=0;for(let r=0;r<e.length;r++)if(e[r]===0){t=r;break}return new TextDecoder("utf-8").decode(e.slice(0,t))}parseITXtChunk(e){let t=0,r=t;for(;r<e.length&&e[r]!==0;)r++;const l=new TextDecoder("utf-8").decode(e.slice(t,r));if(t=r+1,t>=e.length)return{keyword:l,text:""};const s=e[t];for(t++,t++;t<e.length&&e[t]!==0;)t++;for(t++;t<e.length&&e[t]!==0;)t++;t++;const o=new TextDecoder("utf-8").decode(e.slice(t));if(s===1)try{const c=new Uint8Array(e.slice(t)),h=this.inflate(c);return{keyword:l,text:new TextDecoder().decode(h)}}catch(c){return console.warn("Failed to decompress iTXt chunk:",c),{keyword:l,text:o}}return{keyword:l,text:o}}inflate(e){return e}fileToDataURL(e){return new Promise((t,r)=>{const l=new FileReader;l.onload=()=>t(l.result),l.onerror=r,l.readAsDataURL(e)})}isCharacterCardV2(e){return!e||typeof e!="object"?!1:typeof e.name=="string"}isCharacterVaultExport(e){if(!e||typeof e!="object")return!1;const t=e;return typeof t.id=="string"&&typeof t.name=="string"&&t.data!==void 0}async createCharacterFromV2(e,t){const r={name:e.name||"",description:e.description||"",personality:e.personality||"",scenario:e.scenario||"",first_mes:e.first_mes||"",mes_example:e.mes_example||"",system_prompt:e.system_prompt||"",post_history_instructions:e.post_history_instructions||"",alternate_greetings:e.alternate_greetings||[],physical_description:"",avatar:e.avatar,creator_notes:e.creator_notes,creator:e.creator,character_version:e.character_version,tags:e.tags};return await Vt.createCharacter({name:e.name||"Imported Character",imageData:t,data:{spec:r,characterBook:e.character_book,extensions:e.extensions}})}async createCharacterFromExport(e){return await Vt.createCharacter({name:e.name,imageData:e.imageData,data:e.data})}}const lB=new iB,Ag=({icon:n,onClick:e,title:t,variant:r="ghost",className:l="",type:s="button"})=>{const o="p-2 rounded-lg transition-all duration-200 active:scale-95",c={ghost:"text-vault-500 hover:text-vault-900 dark:text-vault-400 dark:hover:text-vault-100 hover:bg-vault-100 dark:hover:bg-vault-800",primary:"bg-vault-900 dark:bg-vault-50 text-white dark:text-vault-900 hover:opacity-90 shadow-sm",danger:"text-vault-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20"};return k.jsx("button",{type:s,onClick:e,title:t,className:`${o} ${c[r]} ${l}`,children:k.jsx(n,{className:"w-4 h-4"})})};function aB({character:n,onOpen:e,onDuplicate:t,onDelete:r}){const l=s=>{if(!s)return"New";const o=new Date().getTime()-new Date(s).getTime(),c=Math.floor(o/(1e3*60*60*24));return c===0?"Today":c===1?"Yesterday":`${c}d ago`};return k.jsxs("div",{className:`group relative flex flex-col bg-white dark:bg-vault-900 rounded-xl border border-vault-200 dark:border-vault-800 \r
      hover:border-vault-300 dark:hover:border-vault-700 shadow-xs hover:shadow-lg\r
      transition-all duration-300 overflow-hidden cursor-pointer`,onClick:()=>e(n.id),children:[k.jsxs("div",{className:"relative aspect-3/4 w-full overflow-hidden bg-vault-100 dark:bg-vault-800",children:[n.imageData?k.jsx("img",{src:n.imageData,alt:n.name,className:"w-full h-full object-cover transition-transform duration-500 ease-out group-hover:scale-105 will-change-transform",loading:"lazy"}):k.jsx("div",{className:"flex items-center justify-center w-full h-full text-vault-300 dark:text-vault-700",children:k.jsx(R0,{className:"w-16 h-16"})}),k.jsx("div",{className:"absolute inset-0 bg-linear-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),k.jsxs("div",{className:`absolute top-2 right-2 flex gap-1 transition-all duration-200 \r
          opacity-100 translate-y-0 \r
          sm:opacity-0 sm:-translate-y-2 \r
          sm:group-hover:opacity-100 sm:group-hover:translate-y-0`,children:[k.jsx("button",{onClick:s=>{s.stopPropagation(),t(n.id,n.name)},className:"p-1.5 bg-white/90 dark:bg-vault-900/90 backdrop-blur-sm rounded-md text-vault-600 dark:text-vault-300 hover:text-vault-900 hover:bg-white shadow-sm",title:"Duplicate",children:k.jsx(j0,{className:"w-3.5 h-3.5"})}),k.jsx("button",{onClick:s=>{s.stopPropagation(),r(n.id,n.name)},className:"p-1.5 bg-white/90 dark:bg-vault-900/90 backdrop-blur-sm rounded-md text-red-500 hover:text-red-600 hover:bg-white shadow-sm",title:"Delete",children:k.jsx($o,{className:"w-3.5 h-3.5"})})]})]}),k.jsxs("div",{className:"p-4 flex flex-col gap-1",children:[k.jsx("div",{className:"flex items-start justify-between gap-2",children:k.jsx("h3",{className:"font-semibold text-vault-900 dark:text-vault-50 truncate text-sm leading-tight",children:n.name})}),k.jsx("div",{className:"flex items-center justify-between mt-2",children:k.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-vault-500 dark:text-vault-400",children:[k.jsx(O4,{className:"w-3 h-3"}),k.jsx("span",{children:l(n.lastOpenedAt)})]})})]})]})}function sB({onReplayTutorial:n}){const{characters:e,isLoading:t,createCharacter:r,openCharacter:l,deleteCharacter:s,duplicateCharacter:o,refreshCharacters:c}=Qo(),[h,d]=$.useState(""),[p,g]=$.useState(!1),[b,w]=$.useState(""),[T,N]=$.useState(null),[D,j]=$.useState(null),U=$.useRef(null),I=()=>typeof window<"u"&&window.innerWidth<640?12:18,[ce,F]=$.useState(I);$.useEffect(()=>{const Se=setTimeout(()=>{F(I())},0);return()=>clearTimeout(Se)},[h]);const[z,ee]=Zi.useState(()=>typeof document>"u"?!0:document.documentElement.classList.contains("dark")),ye=()=>{const Se=!z;ee(Se),document.documentElement.classList.toggle("dark",Se),localStorage.setItem("theme",Se?"dark":"light")},Ce=$.useMemo(()=>{let Se=[...e];return h&&(Se=Se.filter(B=>B.name.toLowerCase().includes(h.toLowerCase()))),Se.sort((B,Pe)=>{const qe=B.lastOpenedAt?new Date(B.lastOpenedAt).getTime():0;return(Pe.lastOpenedAt?new Date(Pe.lastOpenedAt).getTime():0)-qe})},[e,h]),P=Ce[0],pe=async Se=>{if(Se.preventDefault(),!!b.trim())try{await r({name:b.trim()}),w(""),g(!1)}catch{alert("Failed to create character")}},fe=async Se=>{const B=Se.target.files?.[0];if(B){try{const Pe=await lB.importFromFile(B);Pe.success&&Pe.character?await c():alert(Pe.error)}catch{alert("Import failed")}Se.target.value=""}},De=(Se,B)=>{N({id:Se,name:B})},ke=async()=>{T&&(await s(T.id),N(null))},J=()=>{N(null)},q=(Se,B)=>{j({id:Se,name:B})},le=async()=>{D&&(await o(D.id,`${D.name} (Copy)`),j(null))},Ae=()=>{j(null)};return k.jsxs("div",{className:"h-screen overflow-y-auto bg-vault-50 dark:bg-vault-950 text-vault-900 dark:text-vault-100 transition-colors duration-500 animate-fade-in-slow",children:[k.jsx("header",{className:"sticky top-0 z-30 w-full backdrop-blur-xl bg-white/80 dark:bg-vault-950/80 border-b border-vault-200 dark:border-vault-800",children:k.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between gap-4",children:[k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx("div",{className:"p-2 bg-vault-900 dark:bg-vault-700 rounded-lg",children:k.jsx(Vf,{className:"w-5 h-5 text-white dark:text-vault-100"})}),k.jsx("h1",{className:"font-bold text-lg tracking-tight hidden sm:block text-vault-900 dark:text-vault-100",children:"Character Vault"})]}),k.jsx("div",{className:"flex-1 max-w-md hidden sm:block",children:k.jsxs("div",{className:"relative group",children:[k.jsx(Ff,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-vault-400 group-focus-within:text-vault-600 dark:group-focus-within:text-vault-300 transition-colors"}),k.jsx("input",{type:"text",placeholder:"Search characters...",value:h,onChange:Se=>d(Se.target.value),className:"w-full bg-vault-100 dark:bg-vault-900 border border-transparent focus:bg-white dark:focus:bg-vault-800 focus:border-vault-300 dark:focus:border-vault-700 rounded-full py-1.5 pl-9 pr-4 text-sm transition-all outline-none"})]})}),k.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[k.jsx("input",{ref:U,type:"file",accept:".png,.json,image/png,application/json",onChange:fe,className:"hidden"}),k.jsxs("button",{onClick:()=>U.current?.click(),className:"hidden sm:flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-vault-600 dark:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-colors",children:[k.jsx(Nc,{className:"w-4 h-4"}),"Import"]}),k.jsx("button",{onClick:()=>U.current?.click(),className:"sm:hidden p-2 text-vault-600 dark:text-vault-300 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-colors",title:"Import",children:k.jsx(Nc,{className:"w-4 h-4"})}),k.jsx("div",{className:"h-6 w-px bg-vault-200 dark:bg-vault-800 mx-1 hidden sm:block"}),k.jsx(Ag,{icon:z?GT:oT,onClick:ye,title:"Toggle Theme"}),k.jsx(Ag,{icon:M4,onClick:n,title:"Replay Tutorial"}),k.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-4 py-2 bg-vault-900 dark:bg-vault-700 text-white dark:text-vault-100 text-sm font-medium rounded-lg hover:opacity-90 transition-opacity ml-2",children:[k.jsx(Xo,{className:"w-4 h-4"}),k.jsx("span",{className:"hidden sm:inline",children:"New"})]})]})]})}),k.jsx("div",{className:"sm:hidden px-4 pt-3",children:k.jsxs("div",{className:"relative group",children:[k.jsx(Ff,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-vault-400 group-focus-within:text-vault-600 dark:group-focus-within:text-vault-300 transition-colors"}),k.jsx("input",{type:"text",placeholder:"Search characters...",value:h,onChange:Se=>d(Se.target.value),className:"w-full bg-vault-100 dark:bg-vault-900 border border-transparent focus:bg-white dark:focus:bg-vault-800 focus:border-vault-300 dark:focus:border-vault-700 rounded-full py-2 pl-9 pr-4 text-sm transition-all outline-none"})]})}),k.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[p&&k.jsx("div",{className:"mb-8 animate-in fade-in slide-in-from-top-2",children:k.jsxs("form",{onSubmit:pe,className:"bg-white dark:bg-vault-900 p-4 rounded-2xl border border-vault-200 dark:border-vault-800 shadow-lg max-w-lg mx-auto flex gap-2 items-center",children:[k.jsx("input",{autoFocus:!0,type:"text",placeholder:"Character Name...",value:b,onChange:Se=>w(Se.target.value),className:"flex-1 bg-transparent border-none focus:ring-0 text-lg font-medium placeholder:text-vault-300 dark:placeholder:text-vault-700"}),k.jsxs("div",{className:"flex gap-2",children:[k.jsx(Ag,{icon:vs,onClick:()=>g(!1),title:"Cancel"}),k.jsx("button",{type:"submit",disabled:!b.trim(),className:"px-4 py-2 bg-vault-900 dark:bg-vault-50 text-white dark:text-vault-900 rounded-lg text-sm font-medium disabled:opacity-50",children:"Create"})]})]})}),e.length>0&&!h&&k.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center justify-between gap-4 mb-8",children:[k.jsxs("div",{children:[k.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Library"}),k.jsxs("p",{className:"text-vault-500 dark:text-vault-400 text-sm mt-1",children:[e.length," ",e.length===1?"character":"characters"," stored locally"]})]}),P&&k.jsxs("button",{onClick:()=>l(P.id),className:"group flex items-center gap-3 pl-4 pr-3 py-2 bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-800 rounded-full hover:border-vault-300 dark:hover:border-vault-700 hover:shadow-md transition-all",children:[k.jsxs("div",{className:"text-right",children:[k.jsx("p",{className:"text-[10px] font-bold text-vault-400 uppercase tracking-wider",children:"Continue"}),k.jsx("p",{className:"text-sm font-semibold max-w-37.5 truncate",children:P.name})]}),k.jsx("div",{className:"w-8 h-8 rounded-full bg-vault-100 dark:bg-vault-800 flex items-center justify-center group-hover:bg-vault-900 group-hover:text-white dark:group-hover:bg-vault-50 dark:group-hover:text-vault-900 transition-colors",children:k.jsx(kT,{className:"w-4 h-4 fill-current"})})]})]}),t?k.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6",children:[...Array(5)].map((Se,B)=>k.jsx("div",{className:"aspect-3/4 rounded-xl bg-vault-100 dark:bg-vault-800/50 animate-pulse"},B))}):Ce.length===0?k.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center",children:[k.jsx("div",{className:"w-24 h-24 bg-vault-100 dark:bg-vault-900 rounded-full flex items-center justify-center mb-6",children:k.jsx(Vf,{className:"w-10 h-10 text-vault-300 dark:text-vault-700"})}),k.jsx("h3",{className:"text-lg font-medium",children:"No characters found"}),k.jsx("p",{className:"text-vault-500 dark:text-vault-400 mt-2 mb-8 max-w-sm",children:h?`No results for "${h}"`:"Get started by creating a new character or importing a card."}),!h&&k.jsx("button",{onClick:()=>U.current?.click(),className:"px-6 py-2.5 border border-vault-300 dark:border-vault-700 rounded-xl hover:bg-vault-50 dark:hover:bg-vault-900 transition-colors font-medium",children:"Import Card"})]}):k.jsxs(k.Fragment,{children:[k.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 sm:gap-6",children:Ce.slice(0,ce).map(Se=>k.jsx(aB,{character:Se,onOpen:l,onDuplicate:q,onDelete:De},Se.id))}),ce<Ce.length&&k.jsx("div",{className:"flex justify-center pt-8 pb-20",children:k.jsxs("button",{onClick:()=>F(Se=>Se+I()),className:"group flex items-center gap-2 px-8 py-3 bg-white dark:bg-vault-900 border border-vault-200 dark:border-vault-800 rounded-full hover:border-vault-400 dark:hover:border-vault-600 hover:shadow-md transition-all text-sm font-medium text-vault-600 dark:text-vault-300",children:["Load More",k.jsxs("span",{className:"text-xs text-vault-400 dark:text-vault-500",children:["(",Ce.length-ce," remaining)"]})]})}),ce>=Ce.length&&k.jsx("div",{className:"pb-20"})]})]}),T&&k.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 dark:bg-black/70 backdrop-blur-sm animate-in fade-in",children:k.jsxs("div",{className:"bg-white dark:bg-vault-900 rounded-2xl shadow-2xl max-w-sm w-full p-6 animate-in zoom-in-95",children:[k.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[k.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 rounded-full",children:k.jsx($o,{className:"w-6 h-6 text-red-500"})}),k.jsx("h3",{className:"text-lg font-semibold text-vault-900 dark:text-vault-100",children:"Delete Character?"})]}),k.jsxs("p",{className:"text-vault-600 dark:text-vault-400 mb-6",children:["Are you sure you want to delete ",k.jsx("span",{className:"font-medium text-vault-900 dark:text-vault-100",children:T.name}),"? This action cannot be undone."]}),k.jsxs("div",{className:"flex gap-3 justify-end",children:[k.jsx("button",{onClick:J,className:"px-4 py-2 text-sm font-medium text-vault-600 dark:text-vault-400 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-colors",children:"Cancel"}),k.jsx("button",{onClick:ke,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Delete"})]})]})}),D&&k.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 dark:bg-black/70 backdrop-blur-sm animate-in fade-in",children:k.jsxs("div",{className:"bg-white dark:bg-vault-900 rounded-2xl shadow-2xl max-w-sm w-full p-6 animate-in zoom-in-95",children:[k.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[k.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full",children:k.jsx(j0,{className:"w-6 h-6 text-blue-500"})}),k.jsx("h3",{className:"text-lg font-semibold text-vault-900 dark:text-vault-100",children:"Copy Character?"})]}),k.jsxs("p",{className:"text-vault-600 dark:text-vault-400 mb-6",children:["Are you sure you want to create a copy of ",k.jsx("span",{className:"font-medium text-vault-900 dark:text-vault-100",children:D.name}),"?"]}),k.jsxs("div",{className:"flex gap-3 justify-end",children:[k.jsx("button",{onClick:Ae,className:"px-4 py-2 text-sm font-medium text-vault-600 dark:text-vault-400 hover:bg-vault-100 dark:hover:bg-vault-800 rounded-lg transition-colors",children:"Cancel"}),k.jsx("button",{onClick:le,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"Copy"})]})]})})]})}function oB(){const{isCharacterOpen:n}=Qo(),[e,t]=$.useState(()=>!nB()),r=$.useCallback(()=>{t(!1)},[]),l=$.useCallback(()=>{rB(),t(!0)},[]);return k.jsxs(k.Fragment,{children:[e&&k.jsx(tB,{onComplete:r}),n?k.jsx(eB,{}):k.jsx(sB,{onReplayTutorial:l})]})}function uB(){return k.jsx(a4,{children:k.jsx(oB,{})})}const CC=document.getElementById("root");if(!CC)throw new Error("Root element not found");XA.createRoot(CC).render(k.jsx($.StrictMode,{children:k.jsx(uB,{})}));
//# sourceMappingURL=index-Dy2awRsq.js.map
